<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.542">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jasmine Kobayashi">

<title>Lab 3: Motion of falling objects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Lab3_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lab3_files/libs/quarto-html/quarto.js"></script>
<script src="Lab3_files/libs/quarto-html/popper.min.js"></script>
<script src="Lab3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lab3_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lab3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lab3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lab3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lab3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lab3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lab-3-motion-of-falling-objects" id="toc-lab-3-motion-of-falling-objects" class="nav-link active" data-scroll-target="#lab-3-motion-of-falling-objects">Lab 3: Motion of falling objects</a>
  <ul class="collapse">
  <li><a href="#d-motion" id="toc-d-motion" class="nav-link" data-scroll-target="#d-motion">1-D motion</a>
  <ul class="collapse">
  <li><a href="#exercise-1-free-fall" id="toc-exercise-1-free-fall" class="nav-link" data-scroll-target="#exercise-1-free-fall">Exercise 1: Free fall</a></li>
  <li><a href="#exercise-2-accent-and-descent-of-a-pebble" id="toc-exercise-2-accent-and-descent-of-a-pebble" class="nav-link" data-scroll-target="#exercise-2-accent-and-descent-of-a-pebble">Exercise 2: Accent and descent of a pebble</a></li>
  </ul></li>
  <li><a href="#d-motion-1" id="toc-d-motion-1" class="nav-link" data-scroll-target="#d-motion-1">2-D motion</a></li>
  <li><a href="#exercise-3-two-dimensional-trajectories" id="toc-exercise-3-two-dimensional-trajectories" class="nav-link" data-scroll-target="#exercise-3-two-dimensional-trajectories">Exercise 3: Two-dimensional trajectories</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 3: Motion of falling objects</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jasmine Kobayashi </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="lab-3-motion-of-falling-objects" class="level1">
<h1>Lab 3: Motion of falling objects</h1>
<p><strong>Goal:</strong> Introduce a method for obtaining numerical solutions to Newton’s equations of motion and discuss the qualitative and quantitative behavior of bodies falling near Earth’s surface.</p>
<section id="d-motion" class="level2">
<h2 class="anchored" data-anchor-id="d-motion">1-D motion</h2>
<ul>
<li>Start with one dimensional motion (vertical). The equations of motion are</li>
</ul>
<p><span class="math display">\[\begin{equation}
v(t) = \frac{dz(t)}{dt}
\end{equation}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{equation}
a(t) = \frac{dv(t)}{dt}
\end{equation}\]</span></p>
<p>where</p>
<p><span class="math display">\[\begin{equation}
a(t) = \frac{1}{m}F(z,v,t)
\end{equation}\]</span></p>
<ul>
<li>The description of motion requires the solution of the two coupled first-order differential equations. One could combine to obtain a second-order differential equation for position, i.e.,</li>
</ul>
<p><span class="math display">\[\begin{equation*}
\frac{d z^2(t)}{dt^2} = \frac{F}{m}
\end{equation*}\]</span></p>
<ul>
<li>In the absence of air resistance, all objects have the same acceleration at the same point near the Earth’s surface. We call this ``free fall’’.</li>
<li>The acceleration of the freely falling object is denoted as <span class="math inline">\(g
\approx 9.8\)</span> m/s<span class="math inline">\(^2\)</span>.</li>
<li>Adopt a coordinate system with the positive direction down so that <span class="math inline">\(a = +g\)</span>. The solution to the second-order ODE (by integration) is</li>
</ul>
<p><span class="math display">\[\begin{equation*}
v(t) = v_0 + gt
\end{equation*}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{equation*}
z(t) = z_0 + v_0t + \frac{1}{2}gt^2
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(z_0\)</span> and <span class="math inline">\(v_0\)</span> are the initial position and velocity of the object. - In general the force due to Earth on an object of mass <span class="math inline">\(m\)</span> is</p>
<p><span class="math display">\[\begin{equation*}
F = \frac{GMm}{(R+z)^2}
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(z\)</span> is measured from the Earth’s surface, <span class="math inline">\(R\)</span> is Earth’s radius, <span class="math inline">\(G\)</span> is the gravitational constant, <span class="math inline">\(M\)</span> is Earth’s mass, and <span class="math inline">\(g = GM/R^2\)</span>.</p>
<ul>
<li>Now consider the effects of air resistance. It can be shown that air resistance is a force that is proportional to the square of the velocity, and it acts in a direction opposite to the velocity vector:</li>
</ul>
<p><span class="math display">\[\begin{equation*}
{F}_{d} =  \frac{1}{2} C_d \rho A v^2 = k v^2
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(k = \frac{1}{2}C_d \rho A\)</span>. - Here <span class="math inline">\(C_d\)</span> is the drag coefficient that is dependent on the shape of the projectile (i.e., <span class="math inline">\(0&lt;C_d&lt;1\)</span>), <span class="math inline">\(A\)</span> is the cross-sectional area of the projectile, and <span class="math inline">\(\rho\)</span> is the density of air (or density of fluid that the projectile is moving through). - For vertical motion (drag acts upward, or in the negative direction)</p>
<p><span class="math display">\[\begin{equation*}
F = F_g - F_{d} = mg - F_{d}
\end{equation*}\]</span></p>
<ul>
<li>Since <span class="math inline">\(F_{d}(v)\)</span> increases as <span class="math inline">\(v\)</span> increases, there is a limiting or <em>terminal</em> speed at which <span class="math inline">\(F_g = F_d\)</span>. The terminal speed is</li>
</ul>
<p><span class="math display">\[\begin{equation*}
v_t = \left ( \frac{mg}{k}\right)^{1/2}
\end{equation*}\]</span></p>
<ul>
<li>The net force on the falling object is</li>
</ul>
<p><span class="math display">\[\begin{equation*}
F = mg - F_d = mg  - k v_t^2 \left (\frac{v^2}{v_t^2} \right) =  mg
\left(1-  \frac{v^2}{v_t^2} \right)
\end{equation*}\]</span></p>
<ul>
<li><p>For a pebble of radius 0.01 m, <span class="math inline">\(k\)</span> is found empirically to be <span class="math inline">\(k
\approx 10^{-4}\)</span> kg/m. The terminal speed is about 30 m/s. Terminal speed is achieved in about 3 seconds or in a vertical fall of about 50 m.</p></li>
<li><p>Solve as coupled first-order differential equations with Euler algorithm.</p></li>
</ul>
<p><span class="math display">\[\begin{equation*}
t^n = t^0 + n \Delta t
\end{equation*}\]</span> where superscript <span class="math inline">\(n\)</span> is the time step index, or <span class="math inline">\(t^n\)</span> is the <span class="math inline">\(n\)</span>th step.</p>
<p><span class="math display">\[\begin{equation*}
v^{n+1} = v^n + a^n \Delta t
\end{equation*}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{equation*}
z^{n+1} = z^n + v^n \Delta t
\end{equation*}\]</span></p>
<ul>
<li>Note that <span class="math inline">\(v^{n+1}\)</span> is determined by <span class="math inline">\(a^n\)</span> at the <em>beginning</em> of the interval. Similarly, <span class="math inline">\(z^{n+1}\)</span> is determined by <span class="math inline">\(v^{n}\)</span> at the <em>beginning</em> of the interval.</li>
</ul>
<section id="exercise-1-free-fall" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1-free-fall">Exercise 1: Free fall</h3>
<ol type="1">
<li>Write a Python program to implement the Euler method for the motion of a freely falling object.</li>
<li>Use your program to determine the time-dependence of the velocity and position of a freely falling object near the Earth’s surface. Assume the initial values <span class="math inline">\(z=0\)</span> m, <em>height</em> = 10 m, and <span class="math inline">\(v=0\)</span> (m/s). The parameter <em>height</em> is the initial distance of the Earth’s surface from the origin. Note that <span class="math inline">\(+z\)</span> is in the downward direction. What is a suitable value of <span class="math inline">\(\Delta t\)</span>? Compare your output with the exact result.</li>
<li>Plot <span class="math inline">\(z(t)\)</span> and <span class="math inline">\(v(t)\)</span>.</li>
<li>Now add air resistance. The table below shows the vertical fall of a styrofoam ball of mass 0.254 gm and a radius of 2.54 cm. Determine the value of the terminal velocity which yields the best agreement between the computed values of <span class="math inline">\(z(t)\)</span> and the experimental values.</li>
</ol>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">t(s)</th>
<th style="text-align: right;">position (m)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-0.132</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.075</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">0.260</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">0.525</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.3</td>
<td style="text-align: right;">0.870</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.4</td>
<td style="text-align: right;">1.27</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">1.73</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">2.23</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">2.77</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">3.35</td>
</tr>
</tbody>
</table>
<div id="cell-4" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1-D free fall motion near the Earth's surface.  </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math <span class="im">as</span> m</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------------------------------------------------------------------------------------------------------</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">0</span>           <span class="co">#initial position </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>v0 <span class="op">=</span> <span class="dv">0</span>           <span class="co">#the initial velocity</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="dv">10</span>           <span class="co">#height (meters)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.05</span>        <span class="co">#time step </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="dv">0</span>            <span class="co">#initial time</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> <span class="fl">9.81</span>         <span class="co">#m/s^2</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------Euler free fall w/o drag-------------------------------------------------------</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euler_no_drag(x0,v0,h,dt):      </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#x0 is initial position</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#v0 is the initial velocity</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#h is the height</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#dt is the time step</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> []                <span class="co">#initialize an array for the velocity output</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> []                <span class="co">#initialize an array for the position output</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    xp <span class="op">=</span> <span class="fl">0.0245</span>           <span class="co">#n+1 value</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="dv">0</span>                 <span class="co">#initial time</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    time <span class="op">=</span> []             <span class="co">#initialize an array for the time output</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> xp <span class="op">&lt;</span> h:         <span class="co">#run until object reaches the ground, watch out for infinite loops!</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        time.append(t)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        v.append(v0)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        x.append(x0)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        vp <span class="op">=</span> v0 <span class="op">+</span> g<span class="op">*</span>dt             <span class="co">#velocity update        </span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        xp <span class="op">=</span> x0 <span class="op">+</span> v0<span class="op">*</span>dt            <span class="co">#position update         </span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        v0 <span class="op">=</span> vp                    <span class="co">#update the velocity, v^n = v^n+1</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> xp                    <span class="co">#update the position, x^n = x^n+1</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> t<span class="op">+</span>dt                   <span class="co">#update time</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x,v,time</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------Euler free fall WITH drag.---------------------------------------------------------</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>v_t <span class="op">=</span> <span class="fl">6.36</span>             <span class="co">#terminal velocity (m/s) (free parameter variable)</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>v0 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euler_drag(x0,v0,t,h,dt,v_t):  <span class="co">#euler free fall with drag.</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#x0 is initial position</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">#v0 is the initial velocity</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">#t is the initial time</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">#h is the height</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">#dt is the time step</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">#v_t is the terminal velocity</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> []                  <span class="co">#initialize an array for the velocity output</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> []                  <span class="co">#initialize an array for the position output</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    xp <span class="op">=</span> <span class="fl">0.0245</span>             <span class="co">#n+1 value</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="dv">0</span>                   <span class="co">#initial time</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    time <span class="op">=</span> []               <span class="co">#initialize an array for the time output</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    <span class="co">#add your code here</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> xp <span class="op">&lt;</span> h:                       <span class="co">#run until object reaches the ground, watch out for infinite loops!</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>        time.append(t)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        v.append(v0)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        x.append(x0)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>        vp <span class="op">=</span> v0 <span class="op">+</span> (g<span class="op">-</span>g<span class="op">*</span>(v0<span class="op">/</span>v_t)<span class="op">*</span>np.<span class="bu">abs</span>(v0<span class="op">/</span>v_t))<span class="op">*</span>dt  <span class="co">#velocity update        </span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>        xp <span class="op">=</span> x0 <span class="op">+</span> v0<span class="op">*</span>dt                 <span class="co">#position update         </span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>        v0 <span class="op">=</span> vp                         <span class="co">#update the velocity, v^n = v^n+1</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> xp                         <span class="co">#update the position, x^n = x^n+1</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> t<span class="op">+</span>dt                        <span class="co">#update time </span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x,v,time</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------------------------End of functions--------------------------------------------------------------</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>[x,v,time] <span class="op">=</span> euler_no_drag(x0,v0,h,dt)                 <span class="co">#recalling functions and defining to specific variables</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>[xd,vd,time_d] <span class="op">=</span> euler_drag(x0,v0,t,h,dt,v_t)          <span class="co">#recalling again (for function with drag)</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="co">#x = position</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="co">#v = velocity </span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="co">#styrofoam ball-------------------------------------------------------------------------------------------------------------</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> [<span class="fl">0.0</span>,<span class="fl">0.132</span>,<span class="fl">0.232</span>,<span class="fl">0.332</span>,<span class="fl">0.432</span>,<span class="fl">0.532</span>,<span class="fl">0.632</span>,<span class="fl">0.732</span>,<span class="fl">0.832</span>,<span class="fl">0.932</span>]     <span class="co">#rewrote time data so start at time = 0</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>zs <span class="op">=</span> [<span class="fl">0.0</span>,<span class="fl">0.075</span>, <span class="fl">0.260</span>, <span class="fl">0.525</span>, <span class="fl">0.870</span>, <span class="fl">1.27</span>, <span class="fl">1.73</span>, <span class="fl">2.23</span>, <span class="fl">2.77</span>, <span class="fl">3.35</span>]</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="co">#graphing-------------------------------------------------------------------------------------------------------------------</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="co">#Data graph</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>plt.plot(ts,zs,label <span class="op">=</span> <span class="st">"data"</span>)</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()    <span class="co">#command for inverting y-axis</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Data graph"</span>,fontsize <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"time"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"position"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>Text(0, 0.5, 'position')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab3_files/figure-html/cell-2-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-5" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Graph for Euler w/o drag</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>plt.plot(time,x,label <span class="op">=</span> <span class="st">"position"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>plt.plot(time,v,label <span class="op">=</span> <span class="st">"velocity"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.plot(ts,zs,<span class="st">"x"</span>,label <span class="op">=</span> <span class="st">"data"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Euler w/o drag"</span>,fontsize <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"time (sec)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"position(m) and velocity(m/s)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>Text(0, 0.5, 'position(m) and velocity(m/s)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab3_files/figure-html/cell-3-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-6" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Graph for Euler w/ drag</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.plot(time_d,xd,label <span class="op">=</span> <span class="st">"position"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.plot(time_d,vd,label <span class="op">=</span> <span class="st">"velocity"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.plot(ts,zs,<span class="st">"x"</span>,label <span class="op">=</span> <span class="st">"data"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Euler with drag"</span>,fontsize <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"time (sec)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"position(m) and velocity(m/s)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>Text(0, 0.5, 'position(m) and velocity(m/s)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab3_files/figure-html/cell-4-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-2-accent-and-descent-of-a-pebble" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2-accent-and-descent-of-a-pebble">Exercise 2: Accent and descent of a pebble</h3>
<ol type="1">
<li><p>Compute the speed at which a pebble reaches the ground if it is dropped from a height of 50 m. Compare with a freely falling object (no air resistance). Assume that the terminal speed of the pebble is 30 m/s.</p></li>
<li><p>Now throw the pebble vertically upward with an initial velocity <span class="math inline">\(v_0\)</span>. The maximum height (no air resistance) reached by an object is <span class="math inline">\(v_0^2/2g\)</span>, and its velocity upon return to Earth is <span class="math inline">\(v_0\)</span>. The time of ascent equals descent, and the total time in the air is <span class="math inline">\(2v_0/g\)</span>. How does air resistance affect your result? Hint: watch out for the <em>sign</em> of the velocity in the drag force.</p></li>
</ol>
<div id="cell-8" class="cell" data-scrolled="true" data-execution_count="31">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ex.2;part1: Dropped pebble from 50m</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>v_tp <span class="op">=</span> <span class="dv">30</span>            <span class="co">#pebble terminal velocity (m/s)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>hp <span class="op">=</span> <span class="dv">50</span>              <span class="co">#starting height of pebbel (meters)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#recalling functions with new pebble specific variables</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>[xr,vr,time_r] <span class="op">=</span> euler_no_drag(x0,v0,hp,dt)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>[xdp,vdp,time_dp] <span class="op">=</span> euler_drag(x0,v0,t,hp,dt,v_tp)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting dropped pebble graph</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>plt.plot(time_dp,vdp,label <span class="op">=</span> <span class="st">"w/ Drag"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plt.plot(time_r,vr, label <span class="op">=</span> <span class="st">"No drag"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Dropped pebble"</span>,fontsize <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"time (sec)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"velocity (m/s)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>Text(0, 0.5, 'velocity (m/s)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab3_files/figure-html/cell-5-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ex.2;part 2: Pebble thrown upwards w/ some intitial velocity</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>v0_p <span class="op">=</span> <span class="op">-</span><span class="dv">10</span>                         <span class="co">#initial upward thrown velocity</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>h_p <span class="op">=</span> v0_p<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>g                  <span class="co">#max height (w/o drag)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">0</span>                             <span class="co">#initial position</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#recalling functions with specific variables</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>[xtp,vtp,時tp] <span class="op">=</span> euler_no_drag(x0,v0_p,h_p,dt)                <span class="co">#Discovery!: it is possible to use foreign language characters as variables! </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>[xdtp,vdtp,時dtp] <span class="op">=</span> euler_drag(x0,v0_p,t,h_p,dt,v_tp)         <span class="co">#時 is the Chinese character for time</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting graph for pebble first thrown upwards</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>plt.plot(時tp,xtp,<span class="st">"x"</span>,label <span class="op">=</span> <span class="st">"position (no drag)"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>plt.plot(時tp,vtp,<span class="st">"+"</span>,label <span class="op">=</span> <span class="st">"velocity (no drag)"</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>plt.plot(時dtp,xdtp,<span class="st">"-."</span>,label <span class="op">=</span> <span class="st">"position (w/ drag)"</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>plt.plot(時dtp,vdtp,label <span class="op">=</span> <span class="st">"velocity (w/ drag)"</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>np.<span class="bu">abs</span>(v0_p)<span class="op">/</span>g)         <span class="co">#shortening x-axis so that time ends at 2v0/g</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="dv">11</span>,<span class="dv">11</span>) </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Pebble thrown upwards"</span>,fontsize <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Time(sec)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"position(m) and velocity(m/s)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>Text(0, 0.5, 'position(m) and velocity(m/s)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab3_files/figure-html/cell-6-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="d-motion-1" class="level2">
<h2 class="anchored" data-anchor-id="d-motion-1">2-D motion</h2>
<ul>
<li>Newton’s equations of motion for <span class="math inline">\(x\)</span> and <span class="math inline">\(z\)</span> components of motion are <span class="math display">\[\begin{eqnarray*}
m \frac{d v_x}{dt} &amp;=&amp; - F_d \cos\theta\\
m \frac{d v_z}{dt} &amp; = &amp; - mg - F_d \sin \theta
\end{eqnarray*}\]</span></li>
<li>Since <span class="math inline">\(v_x = v \cos \theta\)</span> and <span class="math inline">\(v_z = \sin \theta\)</span>, this can be rewritten as <span class="math display">\[\begin{eqnarray*}
\frac{d v_x}{dt} &amp;=&amp; - \frac{k}{m} v (v \cos\theta) = - \frac{k}{m} v v_x\\
\frac{d v_z}{dt} &amp; = &amp; - g - \frac{k}{m} v (v \sin \theta)= - g - \frac{k}{m} v v_z
\end{eqnarray*}\]</span></li>
<li>Note that both equations involve the magnitude of the velocity, <span class="math inline">\(v^2 = v_x^2 + v_z^2\)</span>. Hence, we cannot calculate the vertical motion without reference to the horizontal component.</li>
</ul>
</section>
<section id="exercise-3-two-dimensional-trajectories" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3-two-dimensional-trajectories">Exercise 3: Two-dimensional trajectories</h2>
<ol type="1">
<li><p>Modify your code so that the two-dimensional trajectory of a ball moving in the air is computed.</p></li>
<li><p>First compare your results with the expected result without air resistance. Let <span class="math inline">\(\theta_0 = 15^\circ\)</span> and <span class="math inline">\(v_0\)</span> = 15 m/s. Vary <span class="math inline">\(\theta_0\)</span> and show that the range is maximized when <span class="math inline">\(\theta_0 \approx 45^\circ\)</span>.</p></li>
<li><p>Repeat part 2, but now suppose the ball is thrown from a height <span class="math inline">\(h\)</span> at an angle <span class="math inline">\(\theta_0\)</span> above the horizontal with <span class="math inline">\(v_0 = 15\)</span> m/s. Numerically determine the angle <span class="math inline">\(\theta_0\)</span> that maximizes range.</p></li>
<li><p>Finally, consider the effects of air resistance on the optimum range and launch angle. Estimate the value of <span class="math inline">\(k/m\)</span> (a realistic value for a shot put is $$0.001, but choose any type of ball that you like!). It might be helpful to initially exaggerate the effects of air resistance.</p></li>
</ol>
<div id="cell-12" class="cell" data-scrolled="true" data-execution_count="33">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2-D motion</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Ex.3;part1/part2: Modifying the code/comparing when launched at 15deg and 15m/s</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------Variables-------------------------------------------------------------------------------</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>度<span class="dv">0</span> <span class="op">=</span> <span class="dv">15</span>                               <span class="co">#Launch angle (in degrees) (度=degrees)</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>v全<span class="dv">0</span> <span class="op">=</span> <span class="dv">15</span>                              <span class="co">#complete initial velocity (with BOTH x &amp; z components)(m/s) (全=all/whole)</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>vx0 <span class="op">=</span> v全<span class="dv">0</span><span class="op">*</span>np.cos(np.deg2rad(度<span class="dv">0</span>))     <span class="co">#x velocity component (converted degrees to radians b/c sin &amp; cos is calculated w/ rad)</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>vz0 <span class="op">=</span> <span class="op">-</span>v全<span class="dv">0</span><span class="op">*</span>np.sin(np.deg2rad(度<span class="dv">0</span>))    <span class="co">#z vel. component (negative b/c up is negative)</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> <span class="fl">9.81</span>                               <span class="co">#m/s^2</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> (vz0<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>g)                     <span class="co">#max height (my equation from hw2)</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">0</span>                                 <span class="co">#initial x position</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>z0 <span class="op">=</span> <span class="dv">0</span>                                 <span class="co">#initial z position (or initial height)</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------Expected values (My functions derived from HW2)-----------------------------------------------------------</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> exp_時(vz0,g):                     <span class="co">#TOTAL time of flight</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">2</span><span class="op">*</span>np.<span class="bu">abs</span>(vz0))<span class="op">/</span>g</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>e時 <span class="op">=</span> exp_時(vz0,g)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dist(vx0,e時):                     <span class="co">#Total distance in x travelled</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vx0<span class="op">*</span>e時</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------2D Euler w/o Drag-----------------------------------------------------------------</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euler_2D_空無(x0,z0,vx0,vz0,h,dt):          <span class="co">#空 = air, 無 = none (no air resistance)        </span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    vx <span class="op">=</span> vx0         <span class="co">#With no air resistance velocity in x never changes  </span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    vz <span class="op">=</span> []          <span class="co">#initialize an array for the z velocity output</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> []           <span class="co">#initialize an array for the x position output</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> []           <span class="co">#initialize an array for the z position output</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    xp <span class="op">=</span> <span class="fl">0.724</span>       <span class="co">#n+1 x value</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    zp <span class="op">=</span> <span class="op">-</span><span class="fl">0.194</span>      <span class="co">#n+1 z value</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> zp <span class="op">&lt;=</span> <span class="fl">0.0</span>:      <span class="co">#run until while zp is less than (since up is negative) or equal to 0.0 (ground level)</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        vz.append(vz0)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        x.append(x0)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>        z.append(z0)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>        vzp <span class="op">=</span> vz0 <span class="op">+</span> g<span class="op">*</span>dt           <span class="co">#velocity update      </span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>        zp <span class="op">=</span> z0 <span class="op">+</span> vz0<span class="op">*</span>dt           <span class="co">#z position update</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>        xp <span class="op">=</span> x0 <span class="op">+</span> vx0<span class="op">*</span>dt           <span class="co">#x position update                             </span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>        vz0 <span class="op">=</span> vzp                  <span class="co">#update the velocity, v^n = v^n+1</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> xp                    <span class="co">#update the position, x^n = x^n+1</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>        z0 <span class="op">=</span> zp</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x[<span class="op">-</span><span class="dv">1</span>]                   <span class="co">#only want finishing trajectory distance, so taking only last distance array value</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Loop to compare trajectory distances w/ varying angles--------------------------------------------------------------------</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> np.linspace(<span class="dv">15</span>,<span class="dv">55</span>,<span class="dv">100</span>)          <span class="co">#testing angles 15-60 degress</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>vxa<span class="op">=</span>[]                                  <span class="co">#array for x intial velocity with varying angles</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>vza<span class="op">=</span>[]                                  <span class="co">#array for z intial velocity with varying angles</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>xa <span class="op">=</span> []                                 <span class="co">#array for total trajectory distance for varying angles (Euler)</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>et <span class="op">=</span> []                                 <span class="co">#array for expected total time of flight </span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>exa <span class="op">=</span> []                                <span class="co">#array for expected total traj. dist. for varying angles (Not Euler)</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(alpha)):</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Euler</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">#adding to initial velocity component arrays</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    alp <span class="op">=</span> alpha[i]</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    vxp <span class="op">=</span> v全<span class="dv">0</span><span class="op">*</span>np.cos(np.deg2rad(alp))</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    vzp <span class="op">=</span> <span class="op">-</span>v全<span class="dv">0</span><span class="op">*</span>np.sin(np.deg2rad(alp)) </span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    vx <span class="op">=</span> vxp</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>    vz <span class="op">=</span> vzp</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>    vxa.append(vx)</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    vza.append(vz)</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="co">#adding to Euler travelled dist. array using initial velocity components with varying angles</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>    速x <span class="op">=</span> vxa[i]</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>    速z <span class="op">=</span> vza[i]</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>    xap <span class="op">=</span> euler_2D_空無(x0,z0,速x,速z,h,dt)</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>    xaa <span class="op">=</span> xap</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>    xa.append(xaa)</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Expected (non-Euler)</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Expected total time</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>    etp <span class="op">=</span> exp_時(np.<span class="bu">abs</span>(速z),g)</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    eta <span class="op">=</span> etp</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>    et.append(eta)</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>    <span class="co">#adding to expected distance travelled array</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>    etd <span class="op">=</span> et[i]</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>    exap <span class="op">=</span> dist(速x,etd)</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>    exaa <span class="op">=</span> exap</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>    exa.append(exaa)</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a><span class="co">#Expected vs. Euler print statements----------------------------------------------------------------------------------------</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Expected trajectory distance @ 15</span><span class="ch">\xb0</span><span class="st"> :"</span>,dist(vx0,e時),<span class="st">"meters"</span>)</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Euler trajectory distance @ 15</span><span class="ch">\xb0</span><span class="st"> :"</span>,euler_2D_空無(x0,z0,vx0,vz0,h,dt),<span class="st">"meters"</span>)</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a><span class="co">#Graphing Trajectory dist. vs Angle-----------------------------------------------------------------------------------------</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>plt.plot(alpha,xa,label <span class="op">=</span> <span class="st">"Euler"</span>) </span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>plt.plot(alpha,exa, label <span class="op">=</span> <span class="st">"Expected"</span>)    </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distance vs Angle"</span>, fontsize <span class="op">=</span> <span class="dv">15</span>)        </span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Angle (degrees)"</span>, fontsize <span class="op">=</span> <span class="dv">13</span>)</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Trajectory Dist. (meters)"</span>, fontsize <span class="op">=</span> <span class="dv">13</span>)</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>plt.grid()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expected trajectory distance @ 15° : 11.46788990825688 meters
Euler trajectory distance @ 15° : 11.59110991546882 meters</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab3_files/figure-html/cell-7-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ex.3;Part 3: Changing initial height</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>zi <span class="op">=</span> <span class="op">-</span><span class="dv">10</span>               <span class="co">#New starting height (meters)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> np.linspace(<span class="dv">15</span>,<span class="dv">55</span>,<span class="dv">100</span>)          <span class="co">#testing angles 15-60 degress</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>vxh<span class="op">=</span>[]                                  <span class="co">#array for x intial velocity with varying angles</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>vzh<span class="op">=</span>[]                                  <span class="co">#array for z intial velocity with varying angles</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>xh <span class="op">=</span> []                                 <span class="co">#array for total trajectory distance for varying angles </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(alpha)):</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Euler</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#adding to initial velocity component arrays</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    alp <span class="op">=</span> alpha[i]</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    vxp <span class="op">=</span> v全<span class="dv">0</span><span class="op">*</span>np.cos(np.deg2rad(alp))</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    vzp <span class="op">=</span> <span class="op">-</span>v全<span class="dv">0</span><span class="op">*</span>np.sin(np.deg2rad(alp)) </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    vx <span class="op">=</span> vxp</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    vz <span class="op">=</span> vzp</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    vxh.append(vx)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    vzh.append(vz)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#adding to Euler travelled dist. array using initial velocity components with varying angles</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    速x <span class="op">=</span> vxa[i]</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    速z <span class="op">=</span> vza[i]</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    xap <span class="op">=</span> euler_2D_空無(x0,zi,速x,速z,h,dt)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    xaa <span class="op">=</span> xap</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    xh.append(xaa)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding angle value that gives maximum distance----------------------------------------------------------------------------</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>度 <span class="op">=</span> np.where(xh <span class="op">==</span> np.amax(xh))             <span class="co">#finding at what index of the xa array has the max value</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>al <span class="op">=</span> alpha[度]</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Angle that gives maximum range = "</span>,al,<span class="st">"</span><span class="ch">\xb0</span><span class="st">"</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Graph for verification-----------------------------------------------------------------------------------------------------</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>plt.plot(alpha,xh)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Dist. vs. Angle; With initial height h"</span>,fontsize <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Angle (degrees)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Distance travelled (m)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Angle that gives maximum range =  [36.81818182] °</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>Text(0, 0.5, 'Distance travelled (m)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab3_files/figure-html/cell-8-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Ex.3;Part 4: Comparing Drag vs. no Drag</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------------------Set up for k/m------------------------------------------------------------------</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>Cd <span class="op">=</span> <span class="fl">0.47</span>            <span class="co">#avg. drag coefficient of a sphere according to wikipedia</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>Rh <span class="op">=</span> <span class="fl">0.145</span>           <span class="co">#air density (kg/m^3)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">0.03</span>             <span class="co">#radius (meters)</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.pi<span class="op">*</span>(r<span class="op">**</span><span class="dv">2</span>)     <span class="co">#Cross sectional area</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> (Cd<span class="op">*</span>Rh<span class="op">*</span>A)<span class="op">/</span><span class="dv">2</span>      <span class="co">#kappa </span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>m<span class="op">=</span> <span class="fl">0.005</span>             <span class="co">#mass of ball (kg)</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>km <span class="op">=</span> k<span class="op">/</span>m</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------2D Euler w/ Drag----------------------------------------------------------------</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>度<span class="dv">0</span> <span class="op">=</span> <span class="dv">15</span>                               <span class="co">#Launch angle (in degrees) </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>v全<span class="dv">0</span> <span class="op">=</span> <span class="dv">15</span>                              <span class="co">#complete initial velocity (with BOTH x &amp; z components)(m/s)</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>vx0 <span class="op">=</span> v全<span class="dv">0</span><span class="op">*</span>np.cos(np.deg2rad(度<span class="dv">0</span>))     <span class="co">#x velocity component (converted degrees to radians b/c sin &amp; cos is calculated w/ rad)</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>vz0 <span class="op">=</span> <span class="op">-</span>v全<span class="dv">0</span><span class="op">*</span>np.sin(np.deg2rad(度<span class="dv">0</span>))    <span class="co">#z vel. component (negative b/c up is negative)</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> <span class="fl">9.81</span>                               <span class="co">#m/s^2</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> (vz0<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>g)                     <span class="co">#max height (my equation from hw2)</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">0</span>                                 <span class="co">#initial x position</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>z0 <span class="op">=</span> <span class="dv">0</span>                                 <span class="co">#initial z position (or initial height)</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euler_2D_空(x0,z0,vx0,vz0,h,dt):                  </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    vx <span class="op">=</span> []          <span class="co">#initialize an array for the x velocity output  </span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    vz <span class="op">=</span> []          <span class="co">#initialize an array for the z velocity output</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> []           <span class="co">#initialize an array for the x position output</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> []           <span class="co">#initialize an array for the z position output</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    xp <span class="op">=</span> <span class="fl">0.724</span>       <span class="co">#n+1 x value</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    zp <span class="op">=</span> <span class="op">-</span><span class="fl">0.194</span>      <span class="co">#n+1 z value</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="fl">0.0</span>          <span class="co">#initial time</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> zp <span class="op">&lt;=</span> <span class="fl">0.0</span>:    <span class="co">#run until object reaches the ground, watch out for infinite loops!</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>        vx.append(vx0)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>        vz.append(vz0)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>        x.append(x0)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>        z.append(z0)   </span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>        vp <span class="op">=</span> np.sqrt(vx0<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> vz0<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>        v全 <span class="op">=</span> vp</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        vxp <span class="op">=</span> vx0 <span class="op">-</span>(km<span class="op">*</span>v全<span class="op">*</span>vx0)<span class="op">*</span>dt </span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        vzp <span class="op">=</span> vz0 <span class="op">+</span> (g<span class="op">-</span>(km<span class="op">*</span>v全<span class="op">*</span>vz0))<span class="op">*</span>dt  <span class="co">#velocity update</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        vx0 <span class="op">=</span> vxp                        <span class="co">#update the velocity, v^n = v^n+1</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>        vz0 <span class="op">=</span> vzp</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        zp <span class="op">=</span> z0 <span class="op">+</span> vz0<span class="op">*</span>dt                 <span class="co">#position update  </span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>        xp <span class="op">=</span> x0 <span class="op">+</span> vx0<span class="op">*</span>dt                  </span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> xp                          <span class="co">#update the position, x^n = x^n+1</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>        z0 <span class="op">=</span> zp</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> t<span class="op">+</span>dt                         <span class="co">#update time</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="co">#Loop for varying angles----------------------------------------------------------------------------------------------------</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> np.linspace(<span class="dv">15</span>,<span class="dv">55</span>,<span class="dv">100</span>)           <span class="co">#testing angles 15-60 degress</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>vxd<span class="op">=</span>[]                                   <span class="co">#array for x intial velocity with varying angles</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>vzd<span class="op">=</span>[]                                   <span class="co">#array for z intial velocity with varying angles</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>xd <span class="op">=</span> []                                  <span class="co">#array for total trajectory distance for varying angles </span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(alpha)):</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Euler</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>    <span class="co">#adding to initial velocity component arrays</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>    alp <span class="op">=</span> alpha[i]</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>    vxp <span class="op">=</span> v全<span class="dv">0</span><span class="op">*</span>np.cos(np.deg2rad(alp))</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>    vzp <span class="op">=</span> <span class="op">-</span>v全<span class="dv">0</span><span class="op">*</span>np.sin(np.deg2rad(alp)) </span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>    vx <span class="op">=</span> vxp</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>    vz <span class="op">=</span> vzp</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>    vxd.append(vx)</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>    vzd.append(vz)</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">#adding to Euler travelled dist. array using initial velocity components with varying angles</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>    速x <span class="op">=</span> vxa[i]</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>    速z <span class="op">=</span> vza[i]</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>    xap <span class="op">=</span> euler_2D_空(x0,z0,速x,速z,h,dt)</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>    xaa <span class="op">=</span> xap</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>    xd.append(xaa)</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a><span class="co">#Graphing for Drag vs. no drag comparison (for specific ball, w/ specific air resistance as defined by k/m)----------------</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>plt.plot(alpha,xa,label <span class="op">=</span> <span class="st">"Euler W/o Drag"</span>)</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>plt.plot(alpha,exa,label <span class="op">=</span> <span class="st">"Non-Euler(no drag)"</span>)</span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>plt.plot(alpha,xd,label <span class="op">=</span> <span class="st">"Euler With Drag"</span>)</span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Drag vs. No drag"</span>,fontsize <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Angle (degrees)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Dist. travelled (m)"</span>,fontsize <span class="op">=</span> <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>Text(0, 0.5, 'Dist. travelled (m)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab3_files/figure-html/cell-9-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-15" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Comparing angles of max distance (drag vs. no drag)------------------------------------------------------------------------</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>度d <span class="op">=</span> np.where(xd <span class="op">==</span> np.amax(xd))               <span class="co">#finding at what index of the xd array has the max value</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>ald <span class="op">=</span> alpha[度d]                                <span class="co">#Angle for max value</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>e度 <span class="op">=</span> np.where(exa <span class="op">==</span> np.amax(exa))             <span class="co">#finding at what index of the exa array has the max value</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>eal <span class="op">=</span> alpha[e度]                                <span class="co">#Angle for max value</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>度 <span class="op">=</span> np.where(xa <span class="op">==</span> np.amax(xa))                <span class="co">#finding at what index of the xa array has the max value</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>al <span class="op">=</span> alpha[度]                                  <span class="co">##Angle for max value</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------------------------------------------------------------------------------------------------------</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Expected max range angle ="</span>,eal,<span class="st">"</span><span class="ch">\xb0</span><span class="st">"</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Euler no drag max range angle ="</span>,al,<span class="st">"</span><span class="ch">\xb0</span><span class="st">"</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Euler WITH drag max range angle = "</span>,ald,<span class="st">"</span><span class="ch">\xb0</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expected max range angle = [44.8989899] °
Euler no drag max range angle = [46.11111111] °
Euler WITH drag max range angle =  [42.87878788] °</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>