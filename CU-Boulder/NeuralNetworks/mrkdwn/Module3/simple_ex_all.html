<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Professor Ami Gates">

<title>Simple Examples of ANNs, RNNs (LSTM, BRNN), and CNNs in Python/Keras</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="simple_ex_all_files/libs/clipboard/clipboard.min.js"></script>
<script src="simple_ex_all_files/libs/quarto-html/quarto.js"></script>
<script src="simple_ex_all_files/libs/quarto-html/popper.min.js"></script>
<script src="simple_ex_all_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="simple_ex_all_files/libs/quarto-html/anchor.min.js"></script>
<link href="simple_ex_all_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="simple_ex_all_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="simple_ex_all_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="simple_ex_all_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="simple_ex_all_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#movies-dataset" id="toc-movies-dataset" class="nav-link active" data-scroll-target="#movies-dataset">Movies Dataset</a>
  <ul class="collapse">
  <li><a href="#clean-up-traindata" id="toc-clean-up-traindata" class="nav-link" data-scroll-target="#clean-up-traindata">Clean Up TrainData</a></li>
  <li><a href="#check-content" id="toc-check-content" class="nav-link" data-scroll-target="#check-content">Check Content</a>
  <ul class="collapse">
  <li><a href="#tokenize-and-vectorize" id="toc-tokenize-and-vectorize" class="nav-link" data-scroll-target="#tokenize-and-vectorize">Tokenize and Vectorize</a></li>
  </ul></li>
  <li><a href="#optional---for-stemming-the-data" id="toc-optional---for-stemming-the-data" class="nav-link" data-scroll-target="#optional---for-stemming-the-data">Optional - for Stemming the data</a>
  <ul class="collapse">
  <li><a href="#use-nltks-porterstemmer-in-a-function" id="toc-use-nltks-porterstemmer-in-a-function" class="nav-link" data-scroll-target="#use-nltks-porterstemmer-in-a-function">Use NLTK’s PorterStemmer in a function</a></li>
  <li><a href="#vectorize" id="toc-vectorize" class="nav-link" data-scroll-target="#vectorize">Vectorize</a></li>
  </ul></li>
  <li><a href="#check-your-new-df-and-you-new-labels-df" id="toc-check-your-new-df-and-you-new-labels-df" class="nav-link" data-scroll-target="#check-your-new-df-and-you-new-labels-df">Check your new DF and you new Labels df:</a></li>
  <li><a href="#define-a-function-that-returns-true-if-numbers-are-in-a-string" id="toc-define-a-function-that-returns-true-if-numbers-are-in-a-string" class="nav-link" data-scroll-target="#define-a-function-that-returns-true-if-numbers-are-in-a-string">DEFINE A FUNCTION that returns <code>True</code> if numbers are in a string</a></li>
  <li><a href="#final-training-and-testing-data-and-labels" id="toc-final-training-and-testing-data-and-labels" class="nav-link" data-scroll-target="#final-training-and-testing-data-and-labels">Final Training and Testing data and labels</a></li>
  </ul></li>
  <li><a href="#ann" id="toc-ann" class="nav-link" data-scroll-target="#ann">ANN</a></li>
  <li><a href="#simplernn" id="toc-simplernn" class="nav-link" data-scroll-target="#simplernn">SimpleRNN</a>
  <ul class="collapse">
  <li><a href="#rnn-with-bidirectional" id="toc-rnn-with-bidirectional" class="nav-link" data-scroll-target="#rnn-with-bidirectional">RNN with Bidirectional</a></li>
  </ul></li>
  <li><a href="#lstm" id="toc-lstm" class="nav-link" data-scroll-target="#lstm">LSTM</a></li>
  <li><a href="#cnn" id="toc-cnn" class="nav-link" data-scroll-target="#cnn">CNN</a></li>
  <li><a href="#one-more-example---an-ann-used-on-image-data-that-is-flattened" id="toc-one-more-example---an-ann-used-on-image-data-that-is-flattened" class="nav-link" data-scroll-target="#one-more-example---an-ann-used-on-image-data-that-is-flattened">One more example - An ANN used on image data that is Flattened</a>
  <ul class="collapse">
  <li><a href="#load-the-cifar-10-dataset" id="toc-load-the-cifar-10-dataset" class="nav-link" data-scroll-target="#load-the-cifar-10-dataset">Load the CIFAR-10 dataset</a></li>
  <li><a href="#scale-the-pixel-values-to-between-0-and-1" id="toc-scale-the-pixel-values-to-between-0-and-1" class="nav-link" data-scroll-target="#scale-the-pixel-values-to-between-0-and-1">Scale the pixel values to between 0 and 1</a></li>
  <li><a href="#convert-the-labels-to-one-hot-encoding" id="toc-convert-the-labels-to-one-hot-encoding" class="nav-link" data-scroll-target="#convert-the-labels-to-one-hot-encoding">Convert the labels to one-hot encoding</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Simple Examples of ANNs, RNNs (LSTM, BRNN), and CNNs in Python/Keras</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Professor Ami Gates </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>Reference: Professor Ami Gates, Dept. Applied Math, Data Science, University of Colorado</p>
<p><a href="https://gatesboltonanalytics.com/?page_id=903">Dr.&nbsp;Gates’ Website</a></p>
<hr>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/Input" class="uri">https://www.tensorflow.org/api_docs/python/tf/keras/Input</a></p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Activation</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re  </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud, STOPWORDS</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow.keras</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#from tensorflow.keras.datasets import mnist</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> LSTM, Dense, Dropout, LSTM</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> Adam</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.probability <span class="im">import</span> FreqDist</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">## For Stemming</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> PorterStemmer</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> sent_tokenize, word_tokenize</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem.wordnet <span class="im">import</span> WordNetLemmatizer</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem.porter <span class="im">import</span> PorterStemmer</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co">#nltk.download('stopwords')</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co">## These settings show/print dfs in diff ways</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="dv">50</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.width'</span>, <span class="dv">50</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co">#pd.options.display.max_seq_items = None</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co">#pd.pandas.set_option('display.max_columns', None)</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>pd.options.display.max_colwidth <span class="op">=</span> <span class="dv">50</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="movies-dataset" class="level1">
<h1>Movies Dataset</h1>
<p><a href="https://www.kaggle.com/datasets/columbine/imdb-dataset-sentiment-analysis-in-csv-format" class="uri">https://www.kaggle.com/datasets/columbine/imdb-dataset-sentiment-analysis-in-csv-format</a></p>
<p>(Update the path for YOUR computer)</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">"IMBD_data/"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>TrainData <span class="op">=</span> pd.read_csv(<span class="bu">str</span>(path<span class="op">+</span><span class="st">"Train.csv"</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TrainData.shape)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TrainData.head(<span class="dv">10</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(TrainData))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(40000, 2)
                                                text  \
0  I grew up (b. 1965) watching and loving the Th...   
1  When I put this movie in my DVD player, and sa...   
2  Why do people who do not know what a particula...   
3  Even though I have great interest in Biblical ...   
4  Im a die hard Dads Army fan and nothing will e...   
5  A terrible movie as everyone has said. What ma...   
6  Finally watched this shocking movie last night...   
7  I caught this film on AZN on cable. It sounded...   
8  It may be the remake of 1987 Autumn's Tale aft...   
9  My Super Ex Girlfriend turned out to be a plea...   

   label  
0      0  
1      0  
2      0  
3      0  
4      1  
5      0  
6      1  
7      0  
8      1  
9      1  
&lt;class 'pandas.core.frame.DataFrame'&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>TestData <span class="op">=</span> pd.read_csv(<span class="bu">str</span>(path<span class="op">+</span><span class="st">"Test.csv"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TestData.shape)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>TestData.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(5000, 2)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>I always wrote this series off as being a comp...</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1st watched 12/7/2002 - 3 out of 10(Dir-Steve ...</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>This movie was so poorly written and directed ...</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>The most interesting thing about Miryang (Secr...</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>when i first read about "berlin am meer" i did...</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>I saw this film on September 1st, 2005 in Indi...</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>I saw a screening of this movie last night. I ...</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>William Hurt may not be an American matinee id...</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>IT IS A PIECE OF CRAP! not funny at all. durin...</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>I'M BOUT IT(1997)&lt;br /&gt;&lt;br /&gt;Developed &amp; publi...</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ValidData <span class="op">=</span> pd.read_csv(<span class="bu">str</span>(path<span class="op">+</span><span class="st">"Valid.csv"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ValidData.shape)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ValidData.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(5000, 2)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>It's been about 14 years since Sharon Stone aw...</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>someone needed to make a car payment... this i...</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>The Guidelines state that a comment must conta...</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>This movie is a muddled mish-mash of clichés f...</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Before Stan Laurel became the smaller half of ...</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>This is the best movie I've ever seen! &lt;br /&gt;&lt;...</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>The morbid Catholic writer Gerard Reve (Jeroen...</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>"Semana Santa" or "Angel Of Death" is a very w...</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Somebody mastered the difficult task of mergin...</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Why did I waste 1.5 hours of my life watching ...</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Concat requires a list</p>
<p>Place all data from above into one dataframe</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>FullDataset<span class="op">=</span>pd.concat([TrainData,TestData, ValidData])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(FullDataset.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(50000, 2)</code></pre>
</div>
</div>
<section id="clean-up-traindata" class="level2">
<h2 class="anchored" data-anchor-id="clean-up-traindata">Clean Up TrainData</h2>
<p>Get the vocab</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TrainData.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                text  \
0  I grew up (b. 1965) watching and loving the Th...   
1  When I put this movie in my DVD player, and sa...   
2  Why do people who do not know what a particula...   
3  Even though I have great interest in Biblical ...   
4  Im a die hard Dads Army fan and nothing will e...   

   label  
0      0  
1      0  
2      0  
3      0  
4      1  </code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing iterating the columns </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> TrainData.columns: </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(col) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>text
label</code></pre>
</div>
</div>
</section>
<section id="check-content" class="level2">
<h2 class="anchored" data-anchor-id="check-content">Check Content</h2>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TrainData[<span class="st">"text"</span>])</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TrainData[<span class="st">"label"</span>]) <span class="co">##0 is negative, 1 is positive</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0        I grew up (b. 1965) watching and loving the Th...
1        When I put this movie in my DVD player, and sa...
2        Why do people who do not know what a particula...
3        Even though I have great interest in Biblical ...
4        Im a die hard Dads Army fan and nothing will e...
                               ...                        
39995    "Western Union" is something of a forgotten cl...
39996    This movie is an incredible piece of work. It ...
39997    My wife and I watched this movie because we pl...
39998    When I first watched Flatliners, I was amazed....
39999    Why would this film be so good, but only gross...
Name: text, Length: 40000, dtype: object
0        0
1        0
2        0
3        0
4        1
        ..
39995    1
39996    1
39997    0
39998    1
39999    1
Name: label, Length: 40000, dtype: int64</code></pre>
</div>
</div>
<section id="tokenize-and-vectorize" class="level3">
<h3 class="anchored" data-anchor-id="tokenize-and-vectorize">Tokenize and Vectorize</h3>
<ul>
<li>Create the list</li>
<li>Keep the labels</li>
</ul>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ReviewsLIST<span class="op">=</span>[]  <span class="co">## from the text column</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>LabelLIST<span class="op">=</span>[]    </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> nextreview, nextlabel <span class="kw">in</span> <span class="bu">zip</span>(TrainData[<span class="st">"text"</span>], TrainData[<span class="st">"label"</span>]):</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    ReviewsLIST.append(nextreview)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    LabelLIST.append(nextlabel)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A Look at some of the reviews list is:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ReviewsLIST[<span class="dv">0</span>:<span class="dv">20</span>])</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A Look at some of the labels list is:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(LabelLIST[<span class="dv">0</span>:<span class="dv">20</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A Look at some of the reviews list is:

['I grew up (b. 1965) watching and loving the Thunderbirds. All my mates at school watched. We played "Thunderbirds" before school, during lunch and after school. We all wanted to be Virgil or Scott. No one wanted to be Alan. Counting down from 5 became an art form. I took my children to see the movie hoping they would get a glimpse of what I loved as a child. How bitterly disappointing. The only high point was the snappy theme tune. Not that it could compare with the original score of the Thunderbirds. Thankfully early Saturday mornings one television channel still plays reruns of the series Gerry Anderson and his wife created. Jonatha Frakes should hand in his directors chair, his version was completely hopeless. A waste of film. Utter rubbish. A CGI remake may be acceptable but replacing marionettes with Homo sapiens subsp. sapiens was a huge error of judgment.', "When I put this movie in my DVD player, and sat down with a coke and some chips, I had some expectations. I was hoping that this movie would contain some of the strong-points of the first movie: Awsome animation, good flowing story, excellent voice cast, funny comedy and a kick-ass soundtrack. But, to my disappointment, not any of this is to be found in Atlantis: Milo's Return. Had I read some reviews first, I might not have been so let down. The following paragraph will be directed to those who have seen the first movie, and who enjoyed it primarily for the points mentioned.&lt;br /&gt;&lt;br /&gt;When the first scene appears, your in for a shock if you just picked Atlantis: Milo's Return from the display-case at your local videoshop (or whatever), and had the expectations I had. The music feels as a bad imitation of the first movie, and the voice cast has been replaced by a not so fitting one. (With the exception of a few characters, like the voice of Sweet). The actual drawings isnt that bad, but the animation in particular is a sad sight. The storyline is also pretty weak, as its more like three episodes of Schooby-Doo than the single adventurous story we got the last time. But dont misunderstand, it's not very good Schooby-Doo episodes. I didnt laugh a single time, although I might have sniggered once or twice.&lt;br /&gt;&lt;br /&gt;To the audience who haven't seen the first movie, or don't especially care for a similar sequel, here is a fast review of this movie as a stand-alone product: If you liked schooby-doo, you might like this movie. If you didn't, you could still enjoy this movie if you have nothing else to do. And I suspect it might be a good kids movie, but I wouldn't know. It might have been better if Milo's Return had been a three-episode series on a cartoon channel, or on breakfast TV.", 'Why do people who do not know what a particular time in the past was like feel the need to try to define that time for others? Replace Woodstock with the Civil War and the Apollo moon-landing with the Titanic sinking and you\'ve got as realistic a flick as this formulaic soap opera populated entirely by low-life trash. Is this what kids who were too young to be allowed to go to Woodstock and who failed grade school composition do? "I\'ll show those old meanies, I\'ll put out my own movie and prove that you don\'t have to know nuttin about your topic to still make money!" Yeah, we already know that. The one thing watching this film did for me was to give me a little insight into underclass thinking. The next time I see a slut in a bar who looks like Diane Lane, I\'m running the other way. It\'s child abuse to let parents that worthless raise kids. It\'s audience abuse to simply stick Woodstock and the moonlanding into a flick as if that ipso facto means the film portrays 1969.', 'Even though I have great interest in Biblical movies, I was bored to death every minute of the movie. Everything is bad. The movie is too long, the acting is most of the time a Joke and the script is horrible. I did not get the point in mixing the story about Abraham and Noah together. So if you value your time and sanity stay away from this horror.', 'Im a die hard Dads Army fan and nothing will ever change that. I got all the tapes, DVD\'s and audiobooks and every time i watch/listen to them its brand new. &lt;br /&gt;&lt;br /&gt;The film. The film is a re run of certain episodes, Man and the hour, Enemy within the gates, Battle School and numerous others with a different edge. Introduction of a new General instead of Captain Square was a brilliant move - especially when he wouldn\'t cash the cheque (something that is rarely done now).&lt;br /&gt;&lt;br /&gt;It follows through the early years of getting equipment and uniforms, starting up and training. All in all, its a great film for a boring Sunday afternoon. &lt;br /&gt;&lt;br /&gt;Two draw backs. One is the Germans bogus dodgy accents (come one, Germans cant pronounced the letter "W" like us) and Two The casting of Liz Frazer instead of the familiar Janet Davis. I like Liz in other films like the carry ons but she doesn\'t carry it correctly in this and Janet Davis would have been the better choice.', "A terrible movie as everyone has said. What made me laugh was the cameo appearance by Scott McNealy, giving an award to one of the murdered programmers in front of a wall of SUN logos. McNealy is the CEO of SUN Microsystem, a company that practically defines itself by its hatred of Microsoft. They have been instrumental in filing antitrust complaints against Microsoft. So, were they silly enough to think this bad movie would add fuel to that fire?&lt;br /&gt;&lt;br /&gt;There's no public record I see of SUN's involvement, but clearly the makers of this movie know Scott McNealy. An interesting mystery.", 'Finally watched this shocking movie last night, and what a disturbing mindf**ker it is, and unbelievably bloody and some unforgettable scenes, and a total assault on the senses. Looks like a movie from the minds of Lynch (specifically ERASERHEAD), Buttgereit, and even a little of "Begotten". What this guy does to his pregnant sister is beyond belief, but then again, did it really happen or is it his brain\'s left and right sides doing battle. That\'s the main theme of this piece of art, to draw a fine line between fantasy and reality, and what would happen if the right side of the brain that dreams and fantasizes overtakes the reasoning and logical left side. And the music in this movie is unbelievable, a kind of electronic score that is absolutely perfect. Even though this movie is totally shocking and pretty disgusting in some of the most extreme scenes (including hard core sex) you will ever see in any movie, I viewed it as a work of art, and loved it. And that music still amazes me, I have to try and find the soundtrack if is available. Watching "Subconscious Cruelty" is a real event, and not something the viewer will easily forget. And a note to gorehounds, this is a must-have.&lt;br /&gt;&lt;br /&gt;Warning... Be careful buying this movie, because some prints have fogging on the graphic sex scenes and extreme gore, especially the copies from the Japanese release.', 'I caught this film on AZN on cable. It sounded like it would be a good film, a Japanese "Green Card". I can\'t say I\'ve ever disliked an Asian film, quite the contrary. Some of the most incredible horror films of all time are Japanese and Korean, and I am a HUGE fan of John Woo\'s Hong Kong films. I an not adverse to a light hearted films, like Tampopo or Chung King Express (two of my favourites), so I thought I would like this. Well, I would rather slit my wrists and drink my own blood than watch this laborious, badly acted film ever again.&lt;br /&gt;&lt;br /&gt;I think the director Steven Okazaki must have spiked the water with Quaalude, because no one in this film had a personality. And when any of the characters DID try to act, as opposed to mumbling a line or two, their performance came across as forced and incredibly fake. I honestly did not think that anyone had ever acted before...the ONLY person who sounded genuine was Brenda Aoki.. I find it amazing that this is promoted as a comedy, because I didn\'t laugh once. Even MORE surprising is that CBS morning news called this "a refreshing breath of comedy". It was neither refreshing, nor a breath of comedy. And the ending was very predictable, the previous reviewer must be an idiot to think such things.&lt;br /&gt;&lt;br /&gt;AVOID this film unless you want to see a boring predictable plot line and wooden acting. I actually think that "Spike of Bensonhurst" is a better acted film than this...and I walked out half way through that film!', "It may be the remake of 1987 Autumn's Tale after eleven years, as the director Mabel Cheung claimed. Mabel employs rock music as the medium in this movie to express her personal attitude to life, in which love, desire and the consequential frustration play significantly crucial roles. Rock music may not be the best vehicle to convey the profound sentiment, and yet it is not too inappropriate to utilize it as the life of underground rock musicians is bitterly more intense than an ordinary one. The director focuses on the depiction of subtle affection and ultimate vanity of life rather than mere rock music. The love between father and son, lovers, and friends is delicately and touchingly delivered through the fine performance. Mabel does not attempt to beautify rock musicians as artists at all, instead, she tries to reproduce a true life on screen, making huge efforts of years' working on this project and gathering information in Beijing underground pubs.&lt;br /&gt;&lt;br /&gt;Daniel has given probably the best performance in all his movies made so far. His innate dispiritedness and reticence fit the blue mood of the film perfectly.", "My Super Ex Girlfriend turned out to be a pleasant surprise for me, I was really expecting a horrible movie that would probably be stupid and predictable, and you know what? It was! But this movie did have so many wonderful laughs and a fun plot that anyone could get a kick out of. I know that this was a very cheesy movie, but Uma and Anna were just so cool and Steve was such a great addition along with a great cast that looked like they had so much fun and that's what made the movie really work.&lt;br /&gt;&lt;br /&gt;Jenny Johnson(scary, that's my best friend's actual name) is not your typical average librarian looking woman, when Matt, your average male, asks her out, he's in for more than he expected, he's asked G-Girl out on a date, the super hero of the world! But when he finds out what a jealous and crazy girl she really is and decides that it may be a good idea that they spend some time apart, but Jenny won't have it since he's fallen for another girl, Hannah, and she will make his life a living hell, I mean, let's face it, he couldn't have chosen a better girl to break up with.&lt;br /&gt;&lt;br /&gt;The effect were corny, but you seriously move past them quickly, the story and cast made the story really work and I loved Uma in this movie, it was such a step up from Prime. My Super Ex Girlfriend is a fun movie that you shouldn't really take seriously, it's just a cute romantic comedy that I think if I could get a laugh out of it, anyone could.&lt;br /&gt;&lt;br /&gt;7/10", "I can't believe people are looking for a plot in this film. This is Laural and Hardy. Lighten up already. These two were a riot. Their comic genius is as funny today as it was 70 years ago. Not a filthy word out of either mouth and they were able to keep audiences in stitches. Their comedy wasn't sophisticated by any stretch. If a whoopee cushion can't make you grin, there's no reason to watch any of the stuff these guys did. It was a simpler time, and people laughed at stuff that was funny without a plot. I guess it takes a simple mind to enjoy this stuff, so I qualify. Two man comedy teams don't compute, We're just too sophisticated... Aren't we fortunate?", "If you haven't seen the gong show TV series then you won't like this movie much at all, not that knowing the series makes this a great movie. &lt;br /&gt;&lt;br /&gt;I give it a 5 out of 10 because a few things make it kind of amusing that help make up for its obvious problems.&lt;br /&gt;&lt;br /&gt;1) It's a funny snapshot of the era it was made in, the late 1970's and early 1980's. 2) You get a lot of funny cameos of people you've seen on the show. 3) It's interesting to see Chuck (the host) when he isn't doing his on air TV personality. 4) You get to see a lot of bizarre people doing all sorts of weirdness just like you see on the TV show.&lt;br /&gt;&lt;br /&gt;I won't list all the bad things because there's a lot of them, but here's a few of the most prominent.&lt;br /&gt;&lt;br /&gt;1) The Gong Show Movie has a lot of the actual TV show clips which gets tired at movie length. 2) The movie's story line outside of the clip segments is very weak and basically is made up of just one plot point. 3) Chuck is actually halfway decent as an actor, but most of the rest of the actors are doing typical way over the top 1970's flatness.&lt;br /&gt;&lt;br /&gt;It's a good movie to watch when you don't have an hour and a half you want to watch all at once. Watch 20 minutes at a time and it's not so bad. But even then it's not so good either. ;)", 'I have always been a huge fan of "Homicide: Life On The Street" so when I heard there was a reunion movie coming up, I couldn\'t wait.&lt;br /&gt;&lt;br /&gt;Let me just say, I was not disappointed at all. It was one of the most powerful 2 hours of television I\'ve ever seen. It was great to see everyone back again, but the biggest pleasure of all was to have Andre Braugher back, because the relationship between Pembleton and Bayliss was always the strongest part of an all-together great show.', 'Greg Davis and Bryan Daly take some crazed statements by a terrorists, add some commentary by a bunch of uber-right reactionaries, ascribe the most extreme positions of the most fundamentalist Moslems on the planet to everyone who calls themselves a Moslem, and presents this as the theology of Islam. Maybe their next film will involve interviewing Fred Phelps and the congregation of the Westboro Baptist Church, adding commentary by some militant atheist "scholars, and call their film "What the World Needs to Know About Christianity." Ultimately, this film suffers from both poor production values and lack of attention to the most basic standards of journalism. Don\'t waste your time and money; just turn on your AM radio and listen to Rush Limbaugh for a couple of days for free and you\'ll get the same message with the same level of intellectual analysis.', 'A half-hearted attempt to bring Elvis Presley into the modern day, but despite a sexy little shower scene and a pseudo-Playboy magazine subplot, Presley is surrounded by the same old coy, winking clichés. A woman picks E.P. up on the beach and then proceeds to take over his life--and he doesn\'t seem to care! Dick Sargent is grueling in another sidebar, but Don Porter and Rudy Vallee (!) try hard as Elvis\' two bosses (he\'s moonlighting, you see). Some of the songs are quite good, especially "Almost in Love", but if you want to see a looser, hipper, updated Elvis sex-comedy--look elsewhere. When Elvis and his Fatal Attraction get into bed together, there\'s actually a wooden board in between them! Get real. ** from ****', 'If you want a fun romp with loads of subtle humor, then you will enjoy this flick.&lt;br /&gt;&lt;br /&gt;I don\'t understand why anyone wouldn\'t enjoy this one. Take it for what it is: a vehicle for Dennis Hopper to mess with your head and make you laugh. It ain\'t Shakespeare, but it is well done. Ericka Eleniak is absolutely beautiful and holds her own in this one - Better than any episode of Baywatch - and shows a knack for subtle humor. Too bad she hasn\'t had many opportunities to expand on that.&lt;br /&gt;&lt;br /&gt;Tom Berenger fits his role of "real Navy" perfectly and William McNamara does a solid job as a hustler.&lt;br /&gt;&lt;br /&gt;Throw in a walk-on by Hopper in the middle of the chase for "the Cherry on this Sundae" and you\'ve got a movie that kept my attention and kept me laughing. I bought this one as soon as it was available.&lt;br /&gt;&lt;br /&gt;Brain-candy.', 'I really wanted to be able to give this film a 10. I\'ve long thought it was my favorite of the four modern live-action Batman films to date (and maybe it still will be--I have yet to watch the Schumacher films again). I\'m also starting to become concerned about whether I\'m somehow subconsciously being contrarian. You see, I always liked the Schumacher films. As far as I can remember, they were either 9s or 10s to me. But the conventional wisdom is that the two Tim Burton directed films are far superior. I had serious problems with the first Burton Batman this time around--I ended up giving it a 7--and apologize as I might, I just couldn\'t help feel that Batman Returns just has too many small direction, plot and script problems scattered throughout to justify a 10.&lt;br /&gt;&lt;br /&gt;But Burton _almost_ trumps the problems with sheer force of style, and even though there are a lot of small flaws, Batman Returns is still a great film, especially if you\'re a Burton fan, as Batman Returns has just as much in common with The Nightmare Before Christmas (1993) and Edward Scissorhands (1990) as it does with anything else in the Batman universe.&lt;br /&gt;&lt;br /&gt;The film begins strongly, with the Cobblepots having a baby. We see their dismay--people walk out of the birthing room with horror on their faces, ready to vomit. Later, they have the baby in a small cage. Finally they take it out for an evening stroll and dump it in the Gotham City River. The baby ends up becoming Batman villain The Penguin (Danny DeVito).&lt;br /&gt;&lt;br /&gt;Meanwhile, Max Shreck (Christopher Walken) is the film\'s "evil capitalist", comparable to Grissom (Jack Palance) in Batman. He is planning on duping Gotham City in various ways, and we see him emotionally abusing his secretary, the timid Selina Kyle (Michelle Pfeiffer). When Kyle discovers one of the nefarious plots, Grissom tries to get rid of her, but she is rescued by cats, becoming Catwoman.&lt;br /&gt;&lt;br /&gt;While all of this is going on, The Penguin, who has long been only rumored to exist and who is thought to be dangerous, begins a scheme to be presented to the public as a good guy, despite having less than benevolent, ulterior motives.&lt;br /&gt;&lt;br /&gt;Before re-watching Burton\'s Batman films this time, I didn\'t remember just how little the films are about Batman (Michael Keaton). It\'s almost as if Burton didn\'t feel the character was interesting enough to focus on. The focus here is much more on the villains, especially The Penguin. Batman doesn\'t appear very often, especially in the beginning of the film, and surprisingly often, we\'re watching him watching The Penguin.&lt;br /&gt;&lt;br /&gt;Although some viewers necessarily count the above as a flaw, I can\'t say that I do, even if I\'d like to know more about Batman and follow his story more. The villains\' stories are interesting, too, and as an "origin story" for two major Batman villains, Batman Returns is already more than complex in terms of plot.&lt;br /&gt;&lt;br /&gt;However, there are some character problems that I do count as a flaw. The Penguin has a cadre of circus performers who do his bidding, but even though they\'re frequently on screen, we never get to learn anything about them. Burton has a core of characters as intriguing as those in Tod Browning\'s Freaks (1932) available, with actors as interesting as Vincent Schiavelli, but he just doesn\'t have the space to use them.&lt;br /&gt;&lt;br /&gt;For that matter, he hardly has space to explore Catwoman. The film plays as if Catwoman may have been as developed and featured in as many scenes as The Penguin, but that cut of the film would have been 4 hours long. So the bulk of the Catwoman scenes had to be excised. Of course, all of this barely leaves any room for Batman. Burton has Batman turn very dark in the public\'s eye in this film, and unusually, he never bothers to resolve this. As far as we know, at the end, Gothamites still think that Batman is a murdering lunatic. That\'s an interesting development, but unfortunately it ended up being dropped between this film and the next.&lt;br /&gt;&lt;br /&gt;As for the script, although there are minor problems including some non-sequiturs and bizarre decisions (in terms of logic) made by characters, it\'s clear that Burton and writers Sam Hamm and Daniel Waters are not exactly trying to tell a traditional story. A lot of the dialogue is pun-oriented, but often this is fairly subtle and/or complex (of course, sometimes it is very blatant or transparent, too). It helps to look at Batman Returns as a more "poetic" film, as I believe was the intention. This also carries over into more general plot and directorial decisions--plenty of odd character actions, including from minor characters, are done in service of a general mood or style, and that style works very well.&lt;br /&gt;&lt;br /&gt;"Dark" is the easiest way to sum up Batman Returns in a word, and whether that\'s a positive or negative depends on your disposition. Anyone who knows me knows that I love dark. So for me, Burton\'s style largely transcends the flaws in the plot and the script. In many ways, Batman Returns is like an insane, campy horror film, with beautifully eerie production design. Like Batman, Burton is still making many references to other films, but instead of Vertigo (1958) and Star Wars (1977) (well, there\'s still a slight Star Wars reference), he invokes films like Nosferatu (1922) (including that "Max Schreck" was the name of the actor who played the Dracula-like character there), Motel Hell (1980), the aforementioned Freaks, Willy Wonka and the Chocolate Factory (1971) (which has a surreal, dark edge to it) and zombie films--made most explicit in The Penguin\'s final scene.&lt;br /&gt;&lt;br /&gt;In terms of visuals and general atmosphere--and that includes the general "feel" of the story, the characters and so on--this couldn\'t be a stronger 10.', 'The main problem with "Power" is that it features way too may pointless characters and subplots that add absolutely nothing to the movie whatsoever. It gets boring after awhile, sitting around waiting through scenes that don\'t connect to find something that drives the movie forward. You could probably pass it all off as character development, but all of them are either recycled from earlier scenes in the movie, or are just simply to flat and uninteresting. Lumet never gives enough time to let any of the supporting cast blossom. He should have cut a few of the characters (hackman, the wife) and concentrated harder on others (Billings). It could have been a great, hard political thriller instead of a jumbled mess that loses any message in a sea of bad writing and acting, a fact that amazed me considering the cast. Even Gene Hackman performance wasn\'t up to par. Denzel Washington is the only real actor of note here. Gere and the others have all done much better performances elsewhere. &lt;br /&gt;&lt;br /&gt;Sidney Lumet needs to go back to the fierce one man shows he did in the seventies (i.e, Serpico) and stop trying to recapture his success with "12 Angry Men" and "Fail Safe". It hasn\'t worked yet Sidney, and it most likely never will. leave the ensemble dramas to Altman. &lt;br /&gt;&lt;br /&gt;3/10&lt;br /&gt;&lt;br /&gt;* / * * * *', 'The folks at Disney have a lot to explain. First and foremost, why anyone thought this lesser-sitcom material would ever make even a half-decent motion picture. In the kooky 60\'s teleplay, the unique idea of Martians among us had not yet been given the sophisticated X-Files treatment. Quaint visions of little green men have long since been dispelled by the likes of E.T., CLOSE ENCOUNTERS and ALIENS 1-3.&lt;br /&gt;&lt;br /&gt;Any charm the property had was mainly due to the endearing relationship created between the late Bill Bixby as Tim and Ray Walston as the unworldly visitor. The conceit that Martians have antenna seemed dopey back then. Now it seems positively idiotic. Yet, Christopher Lloyd\'s Uncle Martin sports the metallic appendages. In an early shot, the antenna on a sign for the TV station Tim works at is supposed to make us think "martian"! When\'s the last time you saw a TV with rabbit ears, eh?&lt;br /&gt;&lt;br /&gt;Disney doesn\'t trust quaint or relationships and crams this flick with youth-wooing special effects that include a talking space suit named Zoot! Yes, you read that correctly - Uncle Martin\'s silver space suit speaks. He is supposed to be a real hilarious cut-up! Figure again. I got stretch socks that are funnier than Zoot. Whenever the action lags (and it lags constantly), computer graphics are put into play to liven things up. Tim is here played by the amiable Jeff Daniels, who can\'t (or won\'t) do anything to save this floudering mess. Zesty Christine Ebersole brings some comic zeal to her neighbor lady role. Even Ray Walston himself is dragged painfully into the procedings - all to no avail. This alien visitor is dead on arrival.&lt;br /&gt;&lt;br /&gt;Constant talk of sitcoms turning to screen makes me only hope that the I DREAM OF JEANNIE movie won\'t feature a talking harem outfit. I pray that Samantha\'s cat in the movie BEWITCHED doesn\'t have lines. I live in fear that I LOVE LUCY - THE MOVIE will proudly feature a CG Conga Drum named Bongo.&lt;br /&gt;&lt;br /&gt;Paging Michael Eisner! Mickey Mouse - take me to your leader.', "A friend told me of John Fante last summer after we got into a conversation about Charles Bukowski. I did not know that Fante was a favorite writer of Bukowski's - an author with similar edge and humor except from one generation earlier. 'Ask the Dust' was the first Fante book I read, and it remains one of my favorite novels. The novel was a brilliant piece of writing about a sad, frightened young writer posing to himself and the outside world as an overconfident, masterfully talented author who had no idea how to write about the real world experiences he had none of. In the novel the protagonist is a virgin, with no idea how to win the graces of the women he desperately wants to write about in magazines. The story of his bizarre relationship with Camilla, how he settles for his first sexual experience with a 'wounded' admirer, and how he eventually is left with nothing but the story of his failed attempts at love is biting and real, with no touching Hollywood ending. The film adaptation stays true to the book for a while, but meanders into the cinematic trap of love persevering through racism, sickness and death. The heart of this story lies in the fact that Bandini is a jerk and Camilla is f-ing crazy, and their love never was and never would be the real thing, no matter how much either of them wanted to find it in each other. This movie tore out the real meaning of the story out and replaced it with schlock. I can't believe the man who wrote Chinatown could read this book and make a movie about it that got it so wrong."]
A Look at some of the labels list is:

[0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0]</code></pre>
</div>
</div>
</section>
</section>
<section id="optional---for-stemming-the-data" class="level2">
<h2 class="anchored" data-anchor-id="optional---for-stemming-the-data">Optional - for Stemming the data</h2>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Instantiate it</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>A_STEMMER<span class="op">=</span>PorterStemmer()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">## test it</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A_STEMMER.stem(<span class="st">"fishers"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fisher</code></pre>
</div>
</div>
<section id="use-nltks-porterstemmer-in-a-function" class="level3">
<h3 class="anchored" data-anchor-id="use-nltks-porterstemmer-in-a-function">Use NLTK’s PorterStemmer in a function</h3>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DEFINE THE FUNCTION</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> MY_STEMMER(str_input):</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Only use letters, no punct, no nums, make lowercase...</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    words <span class="op">=</span> re.sub(<span class="vs">r"[^A-Za-z\-]"</span>, <span class="st">" "</span>, str_input).lower().split()</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    words <span class="op">=</span> [A_STEMMER.stem(word) <span class="cf">for</span> word <span class="kw">in</span> words] <span class="co">## Use the Stemmer...</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> words</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Build the labeled dataframe</p>
<p>Get the Vocab - here keeping top 10,000</p>
</section>
<section id="vectorize" class="level3">
<h3 class="anchored" data-anchor-id="vectorize">Vectorize</h3>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Instantiate your CV</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>MyCountV<span class="op">=</span>CountVectorizer(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">input</span><span class="op">=</span><span class="st">"content"</span>,  </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        lowercase<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">#stop_words = "english", ## This is optional</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">#tokenizer=MY_STEMMER, ## Stemming is optional</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        max_features<span class="op">=</span><span class="dv">11000</span>  <span class="co">## This can be updated</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">## Use your CV </span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>MyDTM <span class="op">=</span> MyCountV.fit_transform(ReviewsLIST)  <span class="co"># create a sparse matrix</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(MyDTM))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'scipy.sparse._csr.csr_matrix'&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ColumnNames<span class="op">=</span>MyCountV.get_feature_names_out() <span class="co">## This is the vocab</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ColumnNames)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['00' '000' '007' ... 'zoom' 'zorro' 'zucco']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(ColumnNames))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'numpy.ndarray'&gt;</code></pre>
</div>
</div>
<p>Here we can clean up the columns</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Build the data frame</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>MyDTM_DF<span class="op">=</span>pd.DataFrame(MyDTM.toarray(),columns<span class="op">=</span>ColumnNames)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Convert the labels from list to df</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Labels_DF <span class="op">=</span> pd.DataFrame(LabelLIST,columns<span class="op">=</span>[<span class="st">'LABEL'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="check-your-new-df-and-you-new-labels-df" class="level2">
<h2 class="anchored" data-anchor-id="check-your-new-df-and-you-new-labels-df">Check your new DF and you new Labels df:</h2>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Labels</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Labels_DF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Labels

       LABEL
0          0
1          0
2          0
3          0
4          1
...      ...
39995      1
39996      1
39997      0
39998      1
39999      1

[40000 rows x 1 columns]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DF</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyDTM_DF.iloc[:,<span class="dv">0</span>:<span class="dv">20</span>])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyDTM_DF.shape) <span class="co">## 40,000 by 11000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DF

       00  000  007  10  100  1000  101  11  12  \
0       0    0    0   0    0     0    0   0   0   
1       0    0    0   0    0     0    0   0   0   
2       0    0    0   0    0     0    0   0   0   
3       0    0    0   0    0     0    0   0   0   
4       0    0    0   0    0     0    0   0   0   
...    ..  ...  ...  ..  ...   ...  ...  ..  ..   
39995   0    0    0   0    0     0    0   0   0   
39996   0    0    0   0    0     0    0   0   0   
39997   0    0    0   0    0     0    0   0   0   
39998   0    0    0   1    0     0    0   0   0   
39999   0    2    0   0    0     0    0   0   0   

       13  13th  14  15  150  16  17  18  180  \
0       0     0   0   0    0   0   0   0    0   
1       0     0   0   0    0   0   0   0    0   
2       0     0   0   0    0   0   0   0    0   
3       0     0   0   0    0   0   0   0    0   
4       0     0   0   0    0   0   0   0    0   
...    ..   ...  ..  ..  ...  ..  ..  ..  ...   
39995   0     0   0   0    0   0   0   0    0   
39996   0     0   0   0    0   0   0   0    0   
39997   0     0   0   0    0   0   0   0    0   
39998   0     0   0   0    0   0   0   0    0   
39999   0     0   0   0    0   0   0   0    0   

       18th  19  
0         0   0  
1         0   0  
2         0   0  
3         0   0  
4         0   0  
...     ...  ..  
39995     0   0  
39996     0   0  
39997     0   0  
39998     0   0  
39999     0   0  

[40000 rows x 20 columns]
(40000, 11000)</code></pre>
</div>
</div>
<p>Remove any columns that contain numbers</p>
<p>Remove columns with words not the size you want. For example, words &lt; 3 <code>chars</code></p>
</section>
<section id="define-a-function-that-returns-true-if-numbers-are-in-a-string" class="level2">
<h2 class="anchored" data-anchor-id="define-a-function-that-returns-true-if-numbers-are-in-a-string">DEFINE A FUNCTION that returns <code>True</code> if numbers are in a string</h2>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Logical_Numbers_Present(anyString):</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">any</span>(char.isdigit() <span class="cf">for</span> char <span class="kw">in</span> anyString)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">##----------------------------------------------------</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> nextcol <span class="kw">in</span> MyDTM_DF.columns:</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(nextcol)</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Remove unwanted columns</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Result=str.isdigit(nextcol) ## Fast way to check numbers</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(Result)</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">##-------------call the function -------</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    LogResult<span class="op">=</span>Logical_Numbers_Present(nextcol)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(LogResult)</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">## The above returns a logical of True or False</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">## The following will remove all columns that contains numbers</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(LogResult<span class="op">==</span><span class="va">True</span>):</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(LogResult)</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(nextcol)</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>        MyDTM_DF<span class="op">=</span>MyDTM_DF.drop([nextcol], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">## The following will remove any column with name</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">## of 3 or smaller - like "it" or "of" or "pre".</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">##print(len(nextcol))  ## check it first</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">## </span><span class="al">NOTE</span><span class="co">: You can also use this code to CONTROL</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">## the words in the columns. For example - you can</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">## have only words between lengths 5 and 9. </span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">## In this case, we remove columns with words &lt;= 3.</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span>(<span class="bu">len</span>(<span class="bu">str</span>(nextcol))<span class="op">&lt;</span><span class="dv">3</span>):</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(nextcol)</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>        MyDTM_DF<span class="op">=</span>MyDTM_DF.drop([nextcol], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: total: 18min 49s
Wall time: 22min 41s</code></pre>
</div>
</div>
<p>Save original DF - without the labels</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>My_Orig_DF<span class="op">=</span>MyDTM_DF</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(My_Orig_DF.head(<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   aamir  aaron  abandon  abandoned  abbey  \
0      0      0        0          0      0   
1      0      0        0          0      0   
2      0      0        0          0      0   
3      0      0        0          0      0   
4      0      0        0          0      0   
5      0      0        0          0      0   
6      0      0        0          0      0   
7      0      0        0          0      0   
8      0      0        0          0      0   
9      0      0        0          0      0   

   abbott  abc  abduction  abilities  ability  \
0       0    0          0          0        0   
1       0    0          0          0        0   
2       0    0          0          0        0   
3       0    0          0          0        0   
4       0    0          0          0        0   
5       0    0          0          0        0   
6       0    0          0          0        0   
7       0    0          0          0        0   
8       0    0          0          0        0   
9       0    0          0          0        0   

   able  ably  aboard  abomination  abortion  \
0     0     0       0            0         0   
1     0     0       0            0         0   
2     0     0       0            0         0   
3     0     0       0            0         0   
4     0     0       0            0         0   
5     0     0       0            0         0   
6     0     0       0            0         0   
7     0     0       0            0         0   
8     0     0       0            0         0   
9     0     0       0            0         0   

   abound  about  above  abraham  abroad  \
0       0      0      0        0       0   
1       0      0      0        0       0   
2       0      1      0        0       0   
3       0      1      0        1       0   
4       0      0      0        0       0   
5       0      0      0        0       0   
6       0      0      0        0       0   
7       0      0      0        0       0   
8       0      0      0        0       0   
9       0      0      0        0       0   

   abrupt  abruptly  absence  absent  absolute  \
0       0         0        0       0         0   
1       0         0        0       0         0   
2       0         0        0       0         0   
3       0         0        0       0         0   
4       0         0        0       0         0   
5       0         0        0       0         0   
6       0         0        0       0         0   
7       0         0        0       0         0   
8       0         0        0       0         0   
9       0         0        0       0         0   

   ...  yourselves  youth  youthful  youtube  \
0  ...           0      0         0        0   
1  ...           0      0         0        0   
2  ...           0      0         0        0   
3  ...           0      0         0        0   
4  ...           0      0         0        0   
5  ...           0      0         0        0   
6  ...           0      0         0        0   
7  ...           0      0         0        0   
8  ...           0      0         0        0   
9  ...           0      0         0        0   

   yul  yup  zach  zane  zany  zealand  \
0    0    0     0     0     0        0   
1    0    0     0     0     0        0   
2    0    0     0     0     0        0   
3    0    0     0     0     0        0   
4    0    0     0     0     0        0   
5    0    0     0     0     0        0   
6    0    0     0     0     0        0   
7    0    0     0     0     0        0   
8    0    0     0     0     0        0   
9    0    0     0     0     0        0   

   zellweger  zero  zeta  zhang  zizek  zodiac  \
0          0     0     0      0      0       0   
1          0     0     0      0      0       0   
2          0     0     0      0      0       0   
3          0     0     0      0      0       0   
4          0     0     0      0      0       0   
5          0     0     0      0      0       0   
6          0     0     0      0      0       0   
7          0     0     0      0      0       0   
8          0     0     0      0      0       0   
9          0     0     0      0      0       0   

   zoey  zombi  zombie  zombies  zone  zoo  \
0     0      0       0        0     0    0   
1     0      0       0        0     0    0   
2     0      0       0        0     0    0   
3     0      0       0        0     0    0   
4     0      0       0        0     0    0   
5     0      0       0        0     0    0   
6     0      0       0        0     0    0   
7     0      0       0        0     0    0   
8     0      0       0        0     0    0   
9     0      0       0        0     0    0   

   zoom  zorro  zucco  
0     0      0      0  
1     0      0      0  
2     0      0      0  
3     0      0      0  
4     0      0      0  
5     0      0      0  
6     0      0      0  
7     0      0      0  
8     0      0      0  
9     0      0      0  

[10 rows x 10711 columns]</code></pre>
</div>
</div>
<p>Now - let’s create a complete and labeled dataframe:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> [Labels_DF, MyDTM_DF]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dfs)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"shape of labels</span><span class="ch">\n</span><span class="st">"</span>, Labels_DF.shape)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"shape of data</span><span class="ch">\n</span><span class="st">"</span>, MyDTM_DF.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[       LABEL
0          0
1          0
2          0
3          0
4          1
...      ...
39995      1
39996      1
39997      0
39998      1
39999      1

[40000 rows x 1 columns],        aamir  aaron  abandon  abandoned  abbey  \
0          0      0        0          0      0   
1          0      0        0          0      0   
2          0      0        0          0      0   
3          0      0        0          0      0   
4          0      0        0          0      0   
...      ...    ...      ...        ...    ...   
39995      0      0        0          0      0   
39996      0      0        0          0      0   
39997      0      0        0          0      0   
39998      0      0        0          0      0   
39999      0      0        0          0      0   

       abbott  abc  abduction  abilities  \
0           0    0          0          0   
1           0    0          0          0   
2           0    0          0          0   
3           0    0          0          0   
4           0    0          0          0   
...       ...  ...        ...        ...   
39995       0    0          0          0   
39996       0    0          0          0   
39997       0    0          0          0   
39998       0    0          0          0   
39999       0    0          0          0   

       ability  able  ably  aboard  abomination  \
0            0     0     0       0            0   
1            0     0     0       0            0   
2            0     0     0       0            0   
3            0     0     0       0            0   
4            0     0     0       0            0   
...        ...   ...   ...     ...          ...   
39995        0     0     0       0            0   
39996        0     0     0       0            0   
39997        0     0     0       0            0   
39998        0     0     0       0            0   
39999        0     0     0       0            0   

       abortion  abound  about  above  abraham  \
0             0       0      0      0        0   
1             0       0      0      0        0   
2             0       0      1      0        0   
3             0       0      1      0        1   
4             0       0      0      0        0   
...         ...     ...    ...    ...      ...   
39995         0       0      0      0        0   
39996         0       0      1      0        0   
39997         0       0      0      0        0   
39998         0       0      0      0        0   
39999         0       0      1      0        0   

       abroad  abrupt  abruptly  absence  \
0           0       0         0        0   
1           0       0         0        0   
2           0       0         0        0   
3           0       0         0        0   
4           0       0         0        0   
...       ...     ...       ...      ...   
39995       0       0         0        0   
39996       0       0         0        0   
39997       0       0         0        0   
39998       0       0         0        0   
39999       0       0         0        0   

       absent  absolute  ...  yourselves  youth  \
0           0         0  ...           0      0   
1           0         0  ...           0      0   
2           0         0  ...           0      0   
3           0         0  ...           0      0   
4           0         0  ...           0      0   
...       ...       ...  ...         ...    ...   
39995       0         0  ...           0      0   
39996       0         0  ...           0      0   
39997       0         0  ...           0      0   
39998       0         0  ...           0      0   
39999       0         0  ...           0      0   

       youthful  youtube  yul  yup  zach  zane  \
0             0        0    0    0     0     0   
1             0        0    0    0     0     0   
2             0        0    0    0     0     0   
3             0        0    0    0     0     0   
4             0        0    0    0     0     0   
...         ...      ...  ...  ...   ...   ...   
39995         0        0    0    0     0     0   
39996         0        0    0    0     0     0   
39997         0        0    0    0     0     0   
39998         0        0    0    0     0     0   
39999         0        0    0    0     0     0   

       zany  zealand  zellweger  zero  zeta  \
0         0        0          0     0     0   
1         0        0          0     0     0   
2         0        0          0     0     0   
3         0        0          0     0     0   
4         0        0          0     0     0   
...     ...      ...        ...   ...   ...   
39995     0        0          0     0     0   
39996     0        0          0     0     0   
39997     0        0          0     0     0   
39998     0        0          0     0     0   
39999     0        0          0     0     0   

       zhang  zizek  zodiac  zoey  zombi  \
0          0      0       0     0      0   
1          0      0       0     0      0   
2          0      0       0     0      0   
3          0      0       0     0      0   
4          0      0       0     0      0   
...      ...    ...     ...   ...    ...   
39995      0      0       0     0      0   
39996      0      0       0     0      0   
39997      0      0       0     0      0   
39998      0      0       0     0      0   
39999      0      0       0     0      0   

       zombie  zombies  zone  zoo  zoom  zorro  \
0           0        0     0    0     0      0   
1           0        0     0    0     0      0   
2           0        0     0    0     0      0   
3           0        0     0    0     0      0   
4           0        0     0    0     0      0   
...       ...      ...   ...  ...   ...    ...   
39995       0        0     0    0     0      0   
39996       0        0     0    0     0      0   
39997       0        0     0    0     0      0   
39998       0        0     0    0     0      0   
39999       0        0     0    0     0      0   

       zucco  
0          0  
1          0  
2          0  
3          0  
4          0  
...      ...  
39995      0  
39996      0  
39997      0  
39998      0  
39999      0  

[40000 rows x 10711 columns]]
shape of labels
 (40000, 1)
shape of data
 (40000, 10711)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>Final_DF_Labeled <span class="op">=</span> pd.concat(dfs,axis<span class="op">=</span><span class="dv">1</span>, join<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">## DF with labels</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Final_DF_Labeled.iloc[:, <span class="dv">0</span>:<span class="dv">2</span>])</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Final_DF_Labeled.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       LABEL  aamir
0          0      0
1          0      0
2          0      0
3          0      0
4          1      0
...      ...    ...
39995      1      0
39996      1      0
39997      0      0
39998      1      0
39999      1      0

[40000 rows x 2 columns]
(40000, 10712)</code></pre>
</div>
</div>
<p>FYI</p>
<p>An alternative option for most frequent 10,000 words</p>
<p>Not needed here as we used <code>CountVectorizer</code> with option <code>max_features</code></p>
<pre><code>print (df.shape[0])
print (df[:10000].value.sum()/df.value.sum())
top_words = list(df[:10000].key.values)
print(top_words)
## Example using index
index = top_words.index("humiliating")
print(index)</code></pre>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Create list of all words</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Final_DF_Labeled.columns[<span class="dv">0</span>])</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>NumCols<span class="op">=</span>Final_DF_Labeled.shape[<span class="dv">1</span>]</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(NumCols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LABEL
10712</code></pre>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(<span class="bu">list</span>(Final_DF_Labeled.columns)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10712</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>top_words<span class="op">=</span><span class="bu">list</span>(Final_DF_Labeled.columns[<span class="dv">1</span>:NumCols<span class="op">+</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Exclude the Label</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_words[<span class="dv">0</span>])</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_words[<span class="op">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>aamir
zucco</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(top_words))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_words.index(<span class="st">"aamir"</span>)) <span class="co">## index 0 in top_words</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_words.index(<span class="st">"zucco"</span>)) <span class="co">#index NumCols - 2 in top_words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'list'&gt;
0
10710</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Encoding the data</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Encode(review):</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    words <span class="op">=</span> review.split()</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>   <span class="co"># print(words)</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(words) <span class="op">&gt;</span> <span class="dv">500</span>:</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        words <span class="op">=</span> words[:<span class="dv">500</span>]</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(words)</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    encoding <span class="op">=</span> []</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word <span class="kw">in</span> words:</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>            index <span class="op">=</span> top_words.index(word)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>            index <span class="op">=</span> (NumCols <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>        encoding.append(index)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(encoding) <span class="op">&lt;</span> <span class="dv">500</span>:</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>        encoding.append(NumCols)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> encoding</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Test the code to assure that it is doing what you think it should</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>result1 <span class="op">=</span> Encode(<span class="st">"aaron aamir abbey abbott abilities zucco "</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result1)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>result2 <span class="op">=</span> Encode(<span class="st">"york young younger youngest youngsters youth youthful youtube zach zane zany zealand zellweger"</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result2)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(result2)) <span class="co">## Will be 500 because we set it that way above</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 0, 4, 5, 8, 10710, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712]
[10677, 10679, 10680, 10681, 10682, 10687, 10688, 10689, 10692, 10693, 10694, 10695, 10696, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712, 10712]
500</code></pre>
</div>
</div>
<p>Now we are ready to encode all of our reviews - which are called “text” in our dataset.</p>
<p>Using vocab from above i - convert reviews (text) into numerical form. Replacing each word with its corresponding integer index value from the vocabulary. Words not in the vocab will be assigned as the max length of the vocab + 1</p>
<p>Encode our training and testing datasets with same vocab.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TestData.head(<span class="dv">10</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TestData.shape)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TrainData.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                text  \
0  I always wrote this series off as being a comp...   
1  1st watched 12/7/2002 - 3 out of 10(Dir-Steve ...   
2  This movie was so poorly written and directed ...   
3  The most interesting thing about Miryang (Secr...   
4  when i first read about "berlin am meer" i did...   
5  I saw this film on September 1st, 2005 in Indi...   
6  I saw a screening of this movie last night. I ...   
7  William Hurt may not be an American matinee id...   
8  IT IS A PIECE OF CRAP! not funny at all. durin...   
9  I'M BOUT IT(1997)&lt;br /&gt;&lt;br /&gt;Developed &amp; publi...   

   label  
0      0  
1      0  
2      0  
3      1  
4      0  
5      1  
6      0  
7      1  
8      0  
9      0  
(5000, 2)
(40000, 2)</code></pre>
</div>
</div>
</section>
<section id="final-training-and-testing-data-and-labels" class="level2">
<h2 class="anchored" data-anchor-id="final-training-and-testing-data-and-labels">Final Training and Testing data and labels</h2>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>training_data <span class="op">=</span> np.array([Encode(review) <span class="cf">for</span> review <span class="kw">in</span> TrainData[<span class="st">"text"</span>]])</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data[<span class="dv">20</span>])</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[10711  8675 10711  4420 10711  9599 10711 10711 10204 10711 10711 10711
 10711  9599 10711 10711 10711 10711  9599  4453 10711 10711 10711 10711
 10711  3646  3822 10711 10711  8268  9645  6251    16  9666 10666   202
  6491  4397   412  4710 10483 10711 10711 10711 10711 10711  5556 10711
 10711 10711 10711  4116  9150 10711 10711  3291  4378 10711  5604  1522
  2624 10473 10711  4189  3773 10711 10711 10711 10711 10711 10678  4026
  1060 10558  2030 10711 10711  4026 10711 10711 10711  6491  8270 10711
  5219 10711  6423 10711 10711 10711  7298  4116  6251 10711 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712]
(40000, 500)
CPU times: total: 59min
Wall time: 1h 10min 44s</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>testing_data <span class="op">=</span> np.array([Encode(review) <span class="cf">for</span> review <span class="kw">in</span> TestData[<span class="st">'text'</span>]])</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(testing_data[<span class="dv">20</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[10711 10711  1714  7176 10679 10711  5993   343 10579 10711 10711 10711
 10711  7657 10711 10711  3572  9597   259 10711  9599    94   343    96
 10445  5768   343  7666  2649 10711  4189  5150 10711  1359  9599 10711
 10711 10711   343 10711 10711 10599 10439  9741   343 10711  4601 10711
  8388  6208 10598  3884  9599  9965 10711 10711 10711 10711  5917 10711
  3459   259 10711  9599 10711  2649  9273 10711  3655  5150 10711 10622
 10711  4189 10711  8388   393 10711  3884 10711 10711  6251  1320 10711
  1883 10711  6223   412 10711  8101 10711 10711 10678  4395  6491  8400
  9645  6251   285 10711  9194  7695  9597 10678 10711 10711  1320  2471
  4060 10678   393  6952 10711  5535   343 10711 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712 10712
 10712 10712 10712 10712 10712 10712 10712 10712]
CPU times: total: 7min 6s
Wall time: 8min 21s</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>validation_data <span class="op">=</span> np.array([Encode(review) <span class="cf">for</span> review <span class="kw">in</span> ValidData[<span class="st">'text'</span>]])</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (training_data.shape, testing_data.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(40000, 500) (5000, 500)
CPU times: total: 7min 1s
Wall time: 8min 11s</code></pre>
</div>
</div>
<p>Prepare the labels if they are not already 0 and 1. In our case they are so these lines are commented out and just FYI</p>
<pre><code>train_labels = [1 if label=='positive' else 0 for sentiment in TrainData['label']]
test_labels = [1 if label=='positive' else 0 for sentiment in TestData['label']]</code></pre>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>train_labels <span class="op">=</span> np.array([TrainData[<span class="st">'label'</span>]])</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>train_labels<span class="op">=</span>train_labels.T</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_labels.shape)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>test_labels <span class="op">=</span> np.array([TestData[<span class="st">'label'</span>]])</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>test_labels<span class="op">=</span>test_labels.T</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test_labels.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(40000, 1)
(5000, 1)</code></pre>
</div>
</div>
</section>
</section>
<section id="ann" class="level1">
<h1>ANN</h1>
<p>Simple Dense NN for sentiment analysis (classification 0 neg, 1 pos)</p>
<ul>
<li><em>First layer</em>: Embedding Layer (Keras Embedding Layer) that will learn embeddings for different words.
<ul>
<li><strong>RE:</strong> <a href="https://keras.io/api/layers/core_layers/embedding/" class="uri">https://keras.io/api/layers/core_layers/embedding/</a></li>
</ul></li>
<li><code>input_dim</code>: Integer. Size of the vocabulary</li>
<li><code>input_length</code>: Length of input sequences, when it is constant.</li>
</ul>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(NumCols)   </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>input_dim <span class="op">=</span> NumCols <span class="op">+</span> <span class="dv">1</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10712</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>My_ANN_Model <span class="op">=</span> tf.keras.models.Sequential([</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Embedding(input_dim<span class="op">=</span>input_dim, output_dim<span class="op">=</span><span class="dv">32</span>, input_length<span class="op">=</span><span class="dv">500</span>),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">32</span>, activation<span class="op">=</span><span class="st">'relu'</span>), </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">16</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dropout(<span class="fl">.5</span>), </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">8</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dropout(<span class="fl">.5</span>), </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>My_ANN_Model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 embedding (Embedding)       (None, 500, 32)           342816    
                                                                 
 dense (Dense)               (None, 500, 32)           1056      
                                                                 
 dense_1 (Dense)             (None, 500, 16)           528       
                                                                 
 dropout (Dropout)           (None, 500, 16)           0         
                                                                 
 dense_2 (Dense)             (None, 500, 8)            136       
                                                                 
 dropout_1 (Dropout)         (None, 500, 8)            0         
                                                                 
 dense_3 (Dense)             (None, 500, 1)            9         
                                                                 
=================================================================
Total params: 344,545
Trainable params: 344,545
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>loss_function <span class="op">=</span> keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>My_ANN_Model.<span class="bu">compile</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                 loss<span class="op">=</span>loss_function,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                 metrics<span class="op">=</span>[<span class="st">"accuracy"</span>],</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>                 optimizer<span class="op">=</span><span class="st">'adam'</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data[<span class="dv">0</span>:<span class="dv">3</span>, <span class="dv">0</span>:<span class="dv">3</span>])</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data.shape)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_labels[<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[10711  4207 10711]
 [10711 10711  7496]
 [10711 10711  6912]]
(40000, 500)
[1]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>Hist<span class="op">=</span>My_ANN_Model.fit(training_data, train_labels, epochs<span class="op">=</span><span class="dv">5</span>, validation_data<span class="op">=</span>(testing_data, test_labels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/5
1250/1250 [==============================] - 44s 33ms/step - loss: 0.6921 - accuracy: 0.5078 - val_loss: 0.6909 - val_accuracy: 0.5157
Epoch 2/5
1250/1250 [==============================] - 39s 31ms/step - loss: 0.6913 - accuracy: 0.5099 - val_loss: 0.6903 - val_accuracy: 0.5169
Epoch 3/5
1250/1250 [==============================] - 39s 31ms/step - loss: 0.6910 - accuracy: 0.5157 - val_loss: 0.6903 - val_accuracy: 0.5166
Epoch 4/5
1250/1250 [==============================] - 43s 34ms/step - loss: 0.6910 - accuracy: 0.5121 - val_loss: 0.6905 - val_accuracy: 0.5097
Epoch 5/5
1250/1250 [==============================] - 42s 34ms/step - loss: 0.6910 - accuracy: 0.5112 - val_loss: 0.6902 - val_accuracy: 0.5171
CPU times: total: 12min 49s
Wall time: 3min 27s</code></pre>
</div>
</div>
</section>
<section id="simplernn" class="level1">
<h1>SimpleRNN</h1>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">##batch_size=256,</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>output_dim<span class="op">=</span><span class="dv">32</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(input_dim)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10713
(40000, 500)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>My_SimpleRNN_Model <span class="op">=</span> tf.keras.models.Sequential([</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Embedding(input_dim<span class="op">=</span>input_dim, output_dim<span class="op">=</span>output_dim, input_length<span class="op">=</span><span class="dv">500</span>),</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.SimpleRNN(units <span class="op">=</span><span class="dv">50</span>, input_shape<span class="op">=</span>(<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">3</span>)),</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">## If not using Embedding, you would use SimpleRNN(units, input_shape=(x,y))</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>My_SimpleRNN_Model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 embedding_1 (Embedding)     (None, 500, 32)           342816    
                                                                 
 simple_rnn (SimpleRNN)      (None, 50)                4150      
                                                                 
 dense_4 (Dense)             (None, 1)                 51        
                                                                 
=================================================================
Total params: 347,017
Trainable params: 347,017
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>loss_function <span class="op">=</span> keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>My_SimpleRNN_Model.<span class="bu">compile</span>(</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>                 loss<span class="op">=</span>loss_function,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>                 metrics<span class="op">=</span>[<span class="st">"accuracy"</span>],</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>                 optimizer<span class="op">=</span><span class="st">'adam'</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data[<span class="dv">0</span>:<span class="dv">3</span>, <span class="dv">0</span>:<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[10711  4207 10711]
 [10711 10711  7496]
 [10711 10711  6912]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_labels[<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>Hist<span class="op">=</span>My_SimpleRNN_Model.fit(training_data, train_labels, epochs<span class="op">=</span><span class="dv">5</span>, validation_data<span class="op">=</span>(testing_data, test_labels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/5
1250/1250 [==============================] - 322s 254ms/step - loss: 0.6957 - accuracy: 0.5042 - val_loss: 0.6944 - val_accuracy: 0.4996
Epoch 2/5
1250/1250 [==============================] - 315s 252ms/step - loss: 0.6939 - accuracy: 0.5048 - val_loss: 0.6935 - val_accuracy: 0.4986
Epoch 3/5
1250/1250 [==============================] - 319s 255ms/step - loss: 0.6926 - accuracy: 0.5087 - val_loss: 0.6959 - val_accuracy: 0.4992
Epoch 4/5
1250/1250 [==============================] - 315s 252ms/step - loss: 0.6898 - accuracy: 0.5146 - val_loss: 0.6943 - val_accuracy: 0.5046
Epoch 5/5
1250/1250 [==============================] - 332s 265ms/step - loss: 0.6846 - accuracy: 0.5196 - val_loss: 0.7058 - val_accuracy: 0.5044
CPU times: total: 1h 42min 34s
Wall time: 26min 43s</code></pre>
</div>
</div>
<section id="rnn-with-bidirectional" class="level2">
<h2 class="anchored" data-anchor-id="rnn-with-bidirectional">RNN with Bidirectional</h2>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Bidirectional" class="uri">https://www.tensorflow.org/api_docs/python/tf/keras/layers/Bidirectional</a></p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>My_RNN_Model <span class="op">=</span> tf.keras.models.Sequential([</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Embedding(input_dim<span class="op">=</span>input_dim, output_dim<span class="op">=</span><span class="dv">32</span>, input_length<span class="op">=</span><span class="dv">500</span>),</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Bidirectional(tf.keras.layers.SimpleRNN(<span class="dv">50</span>)),</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>My_RNN_Model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 embedding_2 (Embedding)     (None, 500, 32)           342816    
                                                                 
 bidirectional (Bidirectiona  (None, 100)              8300      
 l)                                                              
                                                                 
 dense_5 (Dense)             (None, 1)                 101       
                                                                 
=================================================================
Total params: 351,217
Trainable params: 351,217
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>loss_function <span class="op">=</span> keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>My_RNN_Model.<span class="bu">compile</span>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>                 loss<span class="op">=</span>loss_function,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>                 metrics<span class="op">=</span>[<span class="st">"accuracy"</span>],</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>                 optimizer<span class="op">=</span><span class="st">'adam'</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data[<span class="dv">0</span>:<span class="dv">3</span>, <span class="dv">0</span>:<span class="dv">3</span>])</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data.shape)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_labels[<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[10711  4207 10711]
 [10711 10711  7496]
 [10711 10711  6912]]
(40000, 500)
[1]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>Hist<span class="op">=</span>My_RNN_Model.fit(training_data, train_labels, epochs<span class="op">=</span><span class="dv">5</span>, validation_data<span class="op">=</span>(testing_data, test_labels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/5
1250/1250 [==============================] - 519s 409ms/step - loss: 0.6839 - accuracy: 0.5469 - val_loss: 0.6778 - val_accuracy: 0.5798
Epoch 2/5
1250/1250 [==============================] - 498s 398ms/step - loss: 0.6762 - accuracy: 0.5644 - val_loss: 0.6895 - val_accuracy: 0.5192
Epoch 3/5
1250/1250 [==============================] - 498s 398ms/step - loss: 0.6738 - accuracy: 0.5724 - val_loss: 0.6717 - val_accuracy: 0.5856
Epoch 4/5
1250/1250 [==============================] - 492s 394ms/step - loss: 0.6091 - accuracy: 0.6740 - val_loss: 0.5643 - val_accuracy: 0.7342
Epoch 5/5
1250/1250 [==============================] - 491s 392ms/step - loss: 0.5536 - accuracy: 0.7282 - val_loss: 0.5849 - val_accuracy: 0.6972
CPU times: total: 2h 42min 33s
Wall time: 41min 36s</code></pre>
</div>
</div>
</section>
</section>
<section id="lstm" class="level1">
<h1>LSTM</h1>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>My_LSTM_Model <span class="op">=</span> tf.keras.models.Sequential([</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Embedding(input_dim<span class="op">=</span>input_dim, output_dim<span class="op">=</span><span class="dv">32</span>, input_length<span class="op">=</span><span class="dv">500</span>),</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Bidirectional(tf.keras.layers.LSTM(<span class="dv">50</span>)),</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>My_LSTM_Model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_3"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 embedding_3 (Embedding)     (None, 500, 32)           342816    
                                                                 
 bidirectional_1 (Bidirectio  (None, 100)              33200     
 nal)                                                            
                                                                 
 dense_6 (Dense)             (None, 1)                 101       
                                                                 
=================================================================
Total params: 376,117
Trainable params: 376,117
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>loss_function <span class="op">=</span> keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>My_LSTM_Model.<span class="bu">compile</span>(</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                 loss<span class="op">=</span>loss_function,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>                 metrics<span class="op">=</span>[<span class="st">"accuracy"</span>],</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>                 optimizer<span class="op">=</span><span class="st">'adam'</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data[<span class="dv">0</span>:<span class="dv">3</span>, <span class="dv">0</span>:<span class="dv">3</span>])</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data.shape)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_labels[<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[10711  4207 10711]
 [10711 10711  7496]
 [10711 10711  6912]]
(40000, 500)
[1]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>Hist<span class="op">=</span>My_LSTM_Model.fit(training_data, train_labels, batch_size<span class="op">=</span><span class="dv">12</span>, epochs<span class="op">=</span><span class="dv">5</span>, validation_data<span class="op">=</span>(testing_data, test_labels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/5
3334/3334 [==============================] - 2175s 648ms/step - loss: 0.5643 - accuracy: 0.7034 - val_loss: 0.5807 - val_accuracy: 0.6936
Epoch 2/5
3334/3334 [==============================] - 1951s 585ms/step - loss: 0.4498 - accuracy: 0.8035 - val_loss: 0.4740 - val_accuracy: 0.7794
Epoch 3/5
3334/3334 [==============================] - 1900s 570ms/step - loss: 0.3775 - accuracy: 0.8396 - val_loss: 0.3382 - val_accuracy: 0.8596
Epoch 4/5
3334/3334 [==============================] - 1883s 565ms/step - loss: 0.3046 - accuracy: 0.8789 - val_loss: 0.3539 - val_accuracy: 0.8608
Epoch 5/5
3334/3334 [==============================] - 1892s 567ms/step - loss: 0.2644 - accuracy: 0.8964 - val_loss: 0.3355 - val_accuracy: 0.8662
CPU times: total: 9h 38min 1s
Wall time: 2h 43min 21s</code></pre>
</div>
</div>
</section>
<section id="cnn" class="level1">
<h1>CNN</h1>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>My_CNN_Model <span class="op">=</span> tf.keras.models.Sequential([</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Embedding(input_dim<span class="op">=</span>input_dim, output_dim<span class="op">=</span><span class="dv">32</span>, input_length<span class="op">=</span><span class="dv">500</span>),</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Conv1D(<span class="dv">50</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.MaxPool1D(pool_size<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Conv1D(<span class="dv">40</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.MaxPool1D(pool_size<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Conv1D(<span class="dv">30</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.MaxPool1D(pool_size<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Conv1D(<span class="dv">30</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.MaxPool1D(pool_size<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Flatten(),</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">20</span>),</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dropout(<span class="fl">0.5</span>),</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">"sigmoid"</span>),</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>)</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>My_CNN_Model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_4"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 embedding_4 (Embedding)     (None, 500, 32)           342816    
                                                                 
 conv1d (Conv1D)             (None, 498, 50)           4850      
                                                                 
 max_pooling1d (MaxPooling1D  (None, 249, 50)          0         
 )                                                               
                                                                 
 conv1d_1 (Conv1D)           (None, 247, 40)           6040      
                                                                 
 max_pooling1d_1 (MaxPooling  (None, 123, 40)          0         
 1D)                                                             
                                                                 
 conv1d_2 (Conv1D)           (None, 121, 30)           3630      
                                                                 
 max_pooling1d_2 (MaxPooling  (None, 60, 30)           0         
 1D)                                                             
                                                                 
 conv1d_3 (Conv1D)           (None, 58, 30)            2730      
                                                                 
 max_pooling1d_3 (MaxPooling  (None, 29, 30)           0         
 1D)                                                             
                                                                 
 flatten (Flatten)           (None, 870)               0         
                                                                 
 dense_7 (Dense)             (None, 20)                17420     
                                                                 
 dropout_2 (Dropout)         (None, 20)                0         
                                                                 
 dense_8 (Dense)             (None, 1)                 21        
                                                                 
 dense_9 (Dense)             (None, 1)                 2         
                                                                 
=================================================================
Total params: 377,509
Trainable params: 377,509
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>loss_function <span class="op">=</span> keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>My_CNN_Model.<span class="bu">compile</span>(</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                 loss<span class="op">=</span>loss_function,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>                 metrics<span class="op">=</span>[<span class="st">"accuracy"</span>],</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>                 optimizer<span class="op">=</span><span class="st">'adam'</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data[<span class="dv">0</span>:<span class="dv">3</span>, <span class="dv">0</span>:<span class="dv">3</span>])</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_data.shape)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_labels[<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[10711  4207 10711]
 [10711 10711  7496]
 [10711 10711  6912]]
(40000, 500)
[1]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>Hist<span class="op">=</span>My_CNN_Model.fit(training_data, train_labels, batch_size<span class="op">=</span><span class="dv">12</span>, epochs<span class="op">=</span><span class="dv">5</span>, validation_data<span class="op">=</span>(testing_data, test_labels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/5
3334/3334 [==============================] - 555s 165ms/step - loss: 0.6934 - accuracy: 0.4997 - val_loss: 0.6932 - val_accuracy: 0.4990
Epoch 2/5
3334/3334 [==============================] - 598s 179ms/step - loss: 0.6932 - accuracy: 0.5035 - val_loss: 0.6932 - val_accuracy: 0.5010
Epoch 3/5
3334/3334 [==============================] - 629s 189ms/step - loss: 0.6932 - accuracy: 0.5025 - val_loss: 0.6932 - val_accuracy: 0.4990
Epoch 4/5
3334/3334 [==============================] - 536s 161ms/step - loss: 0.6932 - accuracy: 0.5001 - val_loss: 0.6931 - val_accuracy: 0.4990
Epoch 5/5
3334/3334 [==============================] - 557s 167ms/step - loss: 0.6932 - accuracy: 0.4998 - val_loss: 0.6932 - val_accuracy: 0.5010
CPU times: total: 3h 23min 17s
Wall time: 47min 55s</code></pre>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Evaluate model on test data"</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> My_CNN_Model.evaluate(testing_data, test_labels, batch_size<span class="op">=</span><span class="dv">256</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"test loss, test acc:"</span>, results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Evaluate model on test data
20/20 [==============================] - 2s 94ms/step - loss: 0.6932 - accuracy: 0.5010
test loss, test acc: [0.6931760907173157, 0.5009999871253967]</code></pre>
</div>
</div>
<p>Generate a prediction using <code>model.predict()</code> and calculate it’s shape:</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Generate a prediction"</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> My_CNN_Model.predict(testing_data)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(prediction)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"prediction shape:"</span>, prediction.shape)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(prediction))</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>prediction[prediction <span class="op">&gt;</span> <span class="fl">.5</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>prediction[prediction <span class="op">&lt;=</span> <span class="fl">.5</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(prediction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generate a prediction
157/157 [==============================] - 7s 34ms/step
[[0.504932]
 [0.504932]
 [0.504932]
 ...
 [0.504932]
 [0.504932]
 [0.504932]]
prediction shape: (5000, 1)
&lt;class 'numpy.ndarray'&gt;
[[1.]
 [1.]
 [1.]
 ...
 [1.]
 [1.]
 [1.]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(prediction, test_labels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[   0    0]
 [2495 2505]]</code></pre>
</div>
</div>
</section>
<section id="one-more-example---an-ann-used-on-image-data-that-is-flattened" class="level1">
<h1>One more example - An ANN used on image data that is Flattened</h1>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.datasets <span class="im">import</span> cifar10</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> to_categorical</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-the-cifar-10-dataset" class="level2">
<h2 class="anchored" data-anchor-id="load-the-cifar-10-dataset">Load the CIFAR-10 dataset</h2>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>(training_data2, train_labels2), (testing_data2, test_labels2) <span class="op">=</span> cifar10.load_data()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Downloading data from https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz
170498071/170498071 [==============================] - 4s 0us/step</code></pre>
</div>
</div>
</section>
<section id="scale-the-pixel-values-to-between-0-and-1" class="level2">
<h2 class="anchored" data-anchor-id="scale-the-pixel-values-to-between-0-and-1">Scale the pixel values to between 0 and 1</h2>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>training_data2 <span class="op">=</span> training_data2 <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>testing_data2 <span class="op">=</span> testing_data2 <span class="op">/</span> <span class="fl">255.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="convert-the-labels-to-one-hot-encoding" class="level2">
<h2 class="anchored" data-anchor-id="convert-the-labels-to-one-hot-encoding">Convert the labels to one-hot encoding</h2>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>train_labels2 <span class="op">=</span> to_categorical(train_labels2)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>test_labels2 <span class="op">=</span> to_categorical(test_labels2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>ANN_Model_Images <span class="op">=</span> tf.keras.models.Sequential([</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Flatten(input_shape<span class="op">=</span>(<span class="dv">32</span>, <span class="dv">32</span>, <span class="dv">3</span>)),</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">200</span>, activation<span class="op">=</span><span class="st">'relu'</span>), </span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">150</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">10</span>, activation<span class="op">=</span><span class="st">"softmax"</span>),  </span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>ANN_Model_Images.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_5"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten_1 (Flatten)         (None, 3072)              0         
                                                                 
 dense_10 (Dense)            (None, 200)               614600    
                                                                 
 dense_11 (Dense)            (None, 150)               30150     
                                                                 
 dense_12 (Dense)            (None, 10)                1510      
                                                                 
=================================================================
Total params: 646,260
Trainable params: 646,260
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>ANN_Model_Images.<span class="bu">compile</span>(</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>                 loss<span class="op">=</span><span class="st">"categorical_crossentropy"</span>,</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>                 metrics<span class="op">=</span>[<span class="st">"accuracy"</span>],</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>                 optimizer<span class="op">=</span><span class="st">'adam'</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>Hist<span class="op">=</span> ANN_Model_Images.fit(training_data2, train_labels2, epochs<span class="op">=</span><span class="dv">50</span>, validation_data<span class="op">=</span>(testing_data2, test_labels2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/50
1563/1563 [==============================] - 30s 17ms/step - loss: 1.8601 - accuracy: 0.3287 - val_loss: 1.7122 - val_accuracy: 0.3851
Epoch 2/50
1563/1563 [==============================] - 29s 18ms/step - loss: 1.6742 - accuracy: 0.3992 - val_loss: 1.6167 - val_accuracy: 0.4124
Epoch 3/50
1563/1563 [==============================] - 25s 16ms/step - loss: 1.5954 - accuracy: 0.4274 - val_loss: 1.5727 - val_accuracy: 0.4323
Epoch 4/50
1563/1563 [==============================] - 29s 18ms/step - loss: 1.5512 - accuracy: 0.4451 - val_loss: 1.5428 - val_accuracy: 0.4461
Epoch 5/50
1563/1563 [==============================] - 23s 15ms/step - loss: 1.5186 - accuracy: 0.4585 - val_loss: 1.5605 - val_accuracy: 0.4435
Epoch 6/50
1563/1563 [==============================] - 42s 27ms/step - loss: 1.4969 - accuracy: 0.4639 - val_loss: 1.4981 - val_accuracy: 0.4638
Epoch 7/50
1563/1563 [==============================] - 32s 20ms/step - loss: 1.4738 - accuracy: 0.4731 - val_loss: 1.5250 - val_accuracy: 0.4551
Epoch 8/50
1563/1563 [==============================] - 34s 22ms/step - loss: 1.4578 - accuracy: 0.4779 - val_loss: 1.4636 - val_accuracy: 0.4785
Epoch 9/50
1563/1563 [==============================] - 41s 27ms/step - loss: 1.4427 - accuracy: 0.4845 - val_loss: 1.4763 - val_accuracy: 0.4742
Epoch 10/50
1563/1563 [==============================] - 51s 33ms/step - loss: 1.4292 - accuracy: 0.4875 - val_loss: 1.4734 - val_accuracy: 0.4753
Epoch 11/50
1563/1563 [==============================] - 33s 21ms/step - loss: 1.4149 - accuracy: 0.4950 - val_loss: 1.4384 - val_accuracy: 0.4869
Epoch 12/50
1563/1563 [==============================] - 27s 18ms/step - loss: 1.4014 - accuracy: 0.4998 - val_loss: 1.4699 - val_accuracy: 0.4720
Epoch 13/50
1563/1563 [==============================] - 30s 19ms/step - loss: 1.3958 - accuracy: 0.4997 - val_loss: 1.4845 - val_accuracy: 0.4649
Epoch 14/50
1563/1563 [==============================] - 24s 15ms/step - loss: 1.3798 - accuracy: 0.5066 - val_loss: 1.5352 - val_accuracy: 0.4449
Epoch 15/50
1563/1563 [==============================] - 31s 20ms/step - loss: 1.3748 - accuracy: 0.5081 - val_loss: 1.4495 - val_accuracy: 0.4811
Epoch 16/50
1563/1563 [==============================] - 31s 20ms/step - loss: 1.3666 - accuracy: 0.5102 - val_loss: 1.4380 - val_accuracy: 0.4921
Epoch 17/50
1563/1563 [==============================] - 32s 21ms/step - loss: 1.3569 - accuracy: 0.5161 - val_loss: 1.4789 - val_accuracy: 0.4778
Epoch 18/50
1563/1563 [==============================] - 24s 16ms/step - loss: 1.3469 - accuracy: 0.5174 - val_loss: 1.4350 - val_accuracy: 0.4884
Epoch 19/50
1563/1563 [==============================] - 26s 16ms/step - loss: 1.3441 - accuracy: 0.5190 - val_loss: 1.4504 - val_accuracy: 0.4865
Epoch 20/50
1563/1563 [==============================] - 27s 17ms/step - loss: 1.3344 - accuracy: 0.5233 - val_loss: 1.4724 - val_accuracy: 0.4732
Epoch 21/50
1563/1563 [==============================] - 34s 22ms/step - loss: 1.3296 - accuracy: 0.5242 - val_loss: 1.4524 - val_accuracy: 0.4840
Epoch 22/50
1563/1563 [==============================] - 25s 16ms/step - loss: 1.3219 - accuracy: 0.5267 - val_loss: 1.4421 - val_accuracy: 0.4882
Epoch 23/50
1563/1563 [==============================] - 25s 16ms/step - loss: 1.3159 - accuracy: 0.5285 - val_loss: 1.4370 - val_accuracy: 0.4954
Epoch 24/50
1563/1563 [==============================] - 24s 16ms/step - loss: 1.3128 - accuracy: 0.5306 - val_loss: 1.4503 - val_accuracy: 0.4901
Epoch 25/50
1563/1563 [==============================] - 27s 17ms/step - loss: 1.3066 - accuracy: 0.5329 - val_loss: 1.4566 - val_accuracy: 0.4820
Epoch 26/50
1563/1563 [==============================] - 26s 17ms/step - loss: 1.3008 - accuracy: 0.5357 - val_loss: 1.4677 - val_accuracy: 0.4873
Epoch 27/50
1563/1563 [==============================] - 24s 15ms/step - loss: 1.2973 - accuracy: 0.5347 - val_loss: 1.4553 - val_accuracy: 0.4900
Epoch 28/50
1563/1563 [==============================] - 32s 20ms/step - loss: 1.2921 - accuracy: 0.5377 - val_loss: 1.4420 - val_accuracy: 0.4916
Epoch 29/50
1563/1563 [==============================] - 25s 16ms/step - loss: 1.2861 - accuracy: 0.5391 - val_loss: 1.4309 - val_accuracy: 0.4967
Epoch 30/50
1563/1563 [==============================] - 22s 14ms/step - loss: 1.2842 - accuracy: 0.5398 - val_loss: 1.4378 - val_accuracy: 0.4938
Epoch 31/50
1563/1563 [==============================] - 31s 20ms/step - loss: 1.2783 - accuracy: 0.5429 - val_loss: 1.4515 - val_accuracy: 0.4921
Epoch 32/50
1563/1563 [==============================] - 37s 24ms/step - loss: 1.2773 - accuracy: 0.5404 - val_loss: 1.4527 - val_accuracy: 0.4945
Epoch 33/50
1563/1563 [==============================] - 32s 20ms/step - loss: 1.2727 - accuracy: 0.5432 - val_loss: 1.4349 - val_accuracy: 0.4970
Epoch 34/50
1563/1563 [==============================] - 52s 33ms/step - loss: 1.2735 - accuracy: 0.5435 - val_loss: 1.4382 - val_accuracy: 0.4970
Epoch 35/50
1563/1563 [==============================] - 33s 21ms/step - loss: 1.2631 - accuracy: 0.5469 - val_loss: 1.4326 - val_accuracy: 0.4986
Epoch 36/50
1563/1563 [==============================] - 34s 22ms/step - loss: 1.2629 - accuracy: 0.5467 - val_loss: 1.4831 - val_accuracy: 0.4810
Epoch 37/50
1563/1563 [==============================] - 59s 38ms/step - loss: 1.2589 - accuracy: 0.5493 - val_loss: 1.4521 - val_accuracy: 0.4972
Epoch 38/50
1563/1563 [==============================] - 63s 40ms/step - loss: 1.2541 - accuracy: 0.5509 - val_loss: 1.4785 - val_accuracy: 0.4909
Epoch 39/50
1563/1563 [==============================] - 39s 25ms/step - loss: 1.2498 - accuracy: 0.5515 - val_loss: 1.4610 - val_accuracy: 0.4901
Epoch 40/50
1563/1563 [==============================] - 43s 27ms/step - loss: 1.2492 - accuracy: 0.5513 - val_loss: 1.4695 - val_accuracy: 0.4911
Epoch 41/50
1563/1563 [==============================] - 30s 19ms/step - loss: 1.2410 - accuracy: 0.5554 - val_loss: 1.4745 - val_accuracy: 0.4902
Epoch 42/50
1563/1563 [==============================] - 32s 20ms/step - loss: 1.2436 - accuracy: 0.5534 - val_loss: 1.4564 - val_accuracy: 0.4924
Epoch 43/50
1563/1563 [==============================] - 27s 17ms/step - loss: 1.2363 - accuracy: 0.5551 - val_loss: 1.4671 - val_accuracy: 0.4834
Epoch 44/50
1563/1563 [==============================] - 27s 17ms/step - loss: 1.2365 - accuracy: 0.5550 - val_loss: 1.4527 - val_accuracy: 0.4968
Epoch 45/50
1563/1563 [==============================] - 29s 19ms/step - loss: 1.2346 - accuracy: 0.5567 - val_loss: 1.4663 - val_accuracy: 0.4925
Epoch 46/50
1563/1563 [==============================] - 29s 19ms/step - loss: 1.2293 - accuracy: 0.5580 - val_loss: 1.4728 - val_accuracy: 0.4837
Epoch 47/50
1563/1563 [==============================] - 30s 19ms/step - loss: 1.2313 - accuracy: 0.5597 - val_loss: 1.4722 - val_accuracy: 0.4935
Epoch 48/50
1563/1563 [==============================] - 41s 27ms/step - loss: 1.2214 - accuracy: 0.5605 - val_loss: 1.4735 - val_accuracy: 0.4899
Epoch 49/50
1563/1563 [==============================] - 33s 21ms/step - loss: 1.2212 - accuracy: 0.5628 - val_loss: 1.5285 - val_accuracy: 0.4802
Epoch 50/50
1563/1563 [==============================] - 31s 20ms/step - loss: 1.2267 - accuracy: 0.5612 - val_loss: 1.4773 - val_accuracy: 0.4844
CPU times: total: 1h 12min 54s
Wall time: 26min 57s</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>