<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jasmine Kobayashi">

<title>Module 2 Assignment - Part 2: Multinomial NN with Softmax, Categorical Cross Entropy, and One-Hot Encoding</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="A2_Part2_JasmineKobayashi_files/libs/clipboard/clipboard.min.js"></script>
<script src="A2_Part2_JasmineKobayashi_files/libs/quarto-html/quarto.js"></script>
<script src="A2_Part2_JasmineKobayashi_files/libs/quarto-html/popper.min.js"></script>
<script src="A2_Part2_JasmineKobayashi_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="A2_Part2_JasmineKobayashi_files/libs/quarto-html/anchor.min.js"></script>
<link href="A2_Part2_JasmineKobayashi_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="A2_Part2_JasmineKobayashi_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="A2_Part2_JasmineKobayashi_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="A2_Part2_JasmineKobayashi_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="A2_Part2_JasmineKobayashi_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#draw-nn-architecture" id="toc-draw-nn-architecture" class="nav-link active" data-scroll-target="#draw-nn-architecture">1) Draw NN architecture</a></li>
  <li><a href="#write-out-all-the-feed-forward-equations" id="toc-write-out-all-the-feed-forward-equations" class="nav-link" data-scroll-target="#write-out-all-the-feed-forward-equations">2) Write out all the Feed Forward equations</a></li>
  <li><a href="#what-are-the-following-derivatives" id="toc-what-are-the-following-derivatives" class="nav-link" data-scroll-target="#what-are-the-following-derivatives">3) What are the following derivatives</a></li>
  <li><a href="#calculate-softmax-results" id="toc-calculate-softmax-results" class="nav-link" data-scroll-target="#calculate-softmax-results">4) Calculate Softmax results</a></li>
  <li><a href="#derivative-of-softmax" id="toc-derivative-of-softmax" class="nav-link" data-scroll-target="#derivative-of-softmax">5) Derivative of Softmax</a></li>
  <li><a href="#combination" id="toc-combination" class="nav-link" data-scroll-target="#combination">6) Combination</a></li>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code">7) Code</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Module 2 Assignment - Part 2: Multinomial NN with Softmax, Categorical Cross Entropy, and One-Hot Encoding</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jasmine Kobayashi </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>Module 2 Assignment - Part 2: Multinomial NN with Softmax, Categorical Cross Entropy, and One-Hot Encoding</p>
<hr>
<p><strong>Instructions:</strong></p>
<p>This assignment has a two large parts with many sub-parts. Each part will enable you to practice with a neural networks and to practice for Exam 2.</p>
<p>This Assignment will TAKE TIME so use all of the time you have to work on it. Please avoid waiting until the last few days as this will not be enough time. You need weeks - not days :)</p>
<p>Be sure to show all work and (when requested) to code using Python (and no NN/TF/Keras packages). Do not worry, we will use packages in coming modules but first it is best to learn about what is going on inside the model.</p>
<p>You may use examples and code that I have shared as a reference. Using my code will not be considered cheating although I strongly recommend that you write as much (if not all) of your own code so that you learn the concepts more robustly.</p>
<p>This is not a team assignment. Please work and code alone. You may discuss concepts, but you cannot share code or work with others. Papers that look too similar with split the grade (first offense) and can suffer less pleasant outcomes for further offenses. Keep it simple and smart - do your own work.</p>
<section id="draw-nn-architecture" class="level1">
<h1>1) Draw NN architecture</h1>
<p>In Part 1 above, I created (with an illustration) the NN architecture for you. In this part, you will illustrate (draw) the architecture.</p>
<ol type="a">
<li><p>Your NN architecture (draw this) will expect input vectors of three values (3D data). It will have one hidden layer with two units. It will create four outputs (for four categories), it will use softmax to convert those 4 outputs into a probability distribution, and it will choose the max as the prediction.</p></li>
<li><p>The hidden layer (H1) will be activated with reLU.</p></li>
</ol>
<p>Draw the NN.</p>
<p>Use my slides and what we did during class lecture to help you. Label everything - including the x’s, the W1’s, the B, the C, the H1 values, the Z2 values, the y^ values (after softmax), and the final output. Again, the class slides have an exact example of this.</p>
<p><strong><em>JK:</em></strong> <em>Check Word Document</em></p>
</section>
<section id="write-out-all-the-feed-forward-equations" class="level1">
<h1>2) Write out all the Feed Forward equations</h1>
<p>You will have equations for <span class="math inline">\(Z_1\)</span>, <span class="math inline">\(H_1\)</span>, <span class="math inline">\(Z_2\)</span>, <span class="math inline">\(\hat{Y}\)</span>.</p>
<p><strong><em>JK:</em></strong></p>
</section>
<section id="what-are-the-following-derivatives" class="level1">
<h1>3) What are the following derivatives</h1>
<p>(using reLU to activate <span class="math inline">\(Z_1\)</span> to <span class="math inline">\(H_1\)</span>, and using Softmax to activate <span class="math inline">\(Z_2\)</span> to <span class="math inline">\(\hat{Y}\)</span>)</p>
<p><strong>Hint:</strong> The slides show a very similar example. The only difference is that the slides use Sigmoid and not reLU. So you will need to update this part. Start by determining the derivative of the reLU.</p>
<p>Use the Categorical Cross Entropy Loss function.</p>
<p>Use One-Hot Encoding for <span class="math inline">\(\mathbf{y}\)</span> (your label)</p>
<p>Show all your work</p>
<p><strong><em>JK:</em></strong></p>
<p><span class="math inline">\(\frac{\partial L}{\partial W_1} = ?\)</span></p>
<p><span class="math inline">\(\frac{\partial L}{\partial W_2} = ?\)</span></p>
<p><span class="math inline">\(\frac{\partial L}{\partial B} = ?\)</span></p>
<p><span class="math inline">\(\frac{\partial L}{\partial C} = ?\)</span></p>
</section>
<section id="calculate-softmax-results" class="level1">
<h1>4) Calculate Softmax results</h1>
<p>If your four <span class="math inline">\(Z_2\)</span> values are <span class="math inline">\(1.1, 2.2, 0.2\)</span> and <span class="math inline">\(-1.7\)</span>, calculate (by hand and show your work) the four softmax results.</p>
<p>(Yes you can use a calculator or Google for the math - but SHOW THE WORK and steps) If you show just the answer, you will get -50%.</p>
<p><strong><em>JK:</em></strong></p>
</section>
<section id="derivative-of-softmax" class="level1">
<h1>5) Derivative of Softmax</h1>
<p>Write out the derivative of the Softmax for the case where <span class="math inline">\(i=j\)</span> and for the case <span class="math inline">\(i\)</span> does not equal <span class="math inline">\(j\)</span>. Show all work and steps.</p>
<p>Find and paste in the Jacobian for the derivative of the Softmax and assure that your results (for <span class="math inline">\(i=j\)</span> and <span class="math inline">\(i\neq j\)</span>) match the Jacobian values.</p>
<p><strong><em>JK:</em></strong></p>
</section>
<section id="combination" class="level1">
<h1>6) Combination</h1>
<p>When using the combination of Softmax, Categorical Cross Entropy, and One-Hot Encoding, what is <span class="math inline">\(\frac{\partial L}{\partial Z_2}\)</span> (sometimes written as <span class="math inline">\(\frac{dL}{dz}\)</span> or as “Error” on the slides)?</p>
<p>(Just give the final answer here. You are not required to show work for this part.)</p>
<p><strong><em>JK:</em></strong></p>
<p><span class="math inline">\(\frac{\partial L}{\partial Z_2} = ?\)</span></p>
</section>
<section id="code" class="level1">
<h1>7) Code</h1>
<p>In <strong>(1)</strong> above, you created a NN architecture for 3D data, a 4-category label (0,1,2,3), one hidden layer (with two units). Write code for this NN without using any NN packages (so by hand)</p>
<ul>
<li>Use One-hot Encoding for the label.</li>
<li>For the Loss Fucntion, use Categorical Cross Entropy.</li>
<li>For the activation from <span class="math inline">\(Z_1\)</span> to <span class="math inline">\(H_1\)</span>, use reLU.</li>
<li>Run it for 1000 epochs and include the same visualizations as were required in <strong>Part 1 <em>(5)</em></strong> above.</li>
<li><strong>YOU</strong> create the dataset and also submit the dataset with your submission.</li>
<li>Be sure to illustrate some of your results so that the viewer can see what you did.</li>
</ul>
<p>This code will help (a lot). Here again, I suggest that you try not to use my code :) Try to write this yourself and only use my code as a reference or if you must. (<a href="https://gatesboltonanalytics.com/?page_id=707">Prof Gates’ Code Example</a>)</p>
<p>(Note - my code uses Sigmoid - not reLU - so you will need to make some updates anyway).</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>