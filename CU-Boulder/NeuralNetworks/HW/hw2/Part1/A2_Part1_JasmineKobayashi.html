<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jasmine Kobayashi">

<title>Module 2 Assignment - Part 1: One Layer NN with One Output</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="A2_Part1_JasmineKobayashi_files/libs/clipboard/clipboard.min.js"></script>
<script src="A2_Part1_JasmineKobayashi_files/libs/quarto-html/quarto.js"></script>
<script src="A2_Part1_JasmineKobayashi_files/libs/quarto-html/popper.min.js"></script>
<script src="A2_Part1_JasmineKobayashi_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="A2_Part1_JasmineKobayashi_files/libs/quarto-html/anchor.min.js"></script>
<link href="A2_Part1_JasmineKobayashi_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="A2_Part1_JasmineKobayashi_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="A2_Part1_JasmineKobayashi_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="A2_Part1_JasmineKobayashi_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="A2_Part1_JasmineKobayashi_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#fill-out-this-network-by-hand-and-create-all-the-needed-matrices-etc.-show-all-multiplications-and-shapes." id="toc-fill-out-this-network-by-hand-and-create-all-the-needed-matrices-etc.-show-all-multiplications-and-shapes." class="nav-link active" data-scroll-target="#fill-out-this-network-by-hand-and-create-all-the-needed-matrices-etc.-show-all-multiplications-and-shapes.">1) Fill out this network by hand and create all the needed matrices, etc. Show all multiplications and shapes.</a>
  <ul class="collapse">
  <li><a href="#jks-answer" id="toc-jks-answer" class="nav-link" data-scroll-target="#jks-answer">JK’s answer:</a>
  <ul class="collapse">
  <li><a href="#input-matrix-x" id="toc-input-matrix-x" class="nav-link" data-scroll-target="#input-matrix-x">Input Matrix <span class="math inline">\(X\)</span></a></li>
  <li><a href="#targets-y" id="toc-targets-y" class="nav-link" data-scroll-target="#targets-y">Targets <span class="math inline">\(y\)</span></a></li>
  <li><a href="#weight-matrix-w1" id="toc-weight-matrix-w1" class="nav-link" data-scroll-target="#weight-matrix-w1">Weight matrix <span class="math inline">\(W1\)</span></a></li>
  <li><a href="#bias-b" id="toc-bias-b" class="nav-link" data-scroll-target="#bias-b">Bias <span class="math inline">\(B\)</span></a></li>
  <li><a href="#z_1" id="toc-z_1" class="nav-link" data-scroll-target="#z_1"><span class="math inline">\(Z_1\)</span></a></li>
  <li><a href="#h_1" id="toc-h_1" class="nav-link" data-scroll-target="#h_1"><span class="math inline">\(H_1\)</span></a></li>
  <li><a href="#w2" id="toc-w2" class="nav-link" data-scroll-target="#w2"><span class="math inline">\(W2\)</span></a></li>
  <li><a href="#c" id="toc-c" class="nav-link" data-scroll-target="#c"><span class="math inline">\(C\)</span></a></li>
  <li><a href="#z_2" id="toc-z_2" class="nav-link" data-scroll-target="#z_2"><span class="math inline">\(Z_2\)</span></a></li>
  <li><a href="#mathbfhaty" id="toc-mathbfhaty" class="nav-link" data-scroll-target="#mathbfhaty"><span class="math inline">\(\mathbf{\hat{y}}\)</span></a></li>
  <li><a href="#mathbfhaty---mathbfy" id="toc-mathbfhaty---mathbfy" class="nav-link" data-scroll-target="#mathbfhaty---mathbfy"><span class="math inline">\(\mathbf{\hat{y}} - \mathbf{y}\)</span></a></li>
  <li><a href="#loss-l" id="toc-loss-l" class="nav-link" data-scroll-target="#loss-l">Loss <span class="math inline">\(L\)</span></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#use-python-to-code-the-feed-forward-portion-of-this-nn." id="toc-use-python-to-code-the-feed-forward-portion-of-this-nn." class="nav-link" data-scroll-target="#use-python-to-code-the-feed-forward-portion-of-this-nn.">2) Use Python to code the <strong>Feed-Forward</strong> portion of this NN.</a></li>
  <li><a href="#compare-by-hand-and-code" id="toc-compare-by-hand-and-code" class="nav-link" data-scroll-target="#compare-by-hand-and-code">3) Compare <em>by-hand</em> and code</a>
  <ul class="collapse">
  <li><a href="#jks-answer-1" id="toc-jks-answer-1" class="nav-link" data-scroll-target="#jks-answer-1">JK’s answer</a>
  <ul class="collapse">
  <li><a href="#x-matrix" id="toc-x-matrix" class="nav-link" data-scroll-target="#x-matrix">X Matrix</a></li>
  <li><a href="#targets-mathbfy" id="toc-targets-mathbfy" class="nav-link" data-scroll-target="#targets-mathbfy">Targets <span class="math inline">\(\mathbf{y}\)</span></a></li>
  <li><a href="#w1-matrix" id="toc-w1-matrix" class="nav-link" data-scroll-target="#w1-matrix"><span class="math inline">\(W^{(1)}\)</span> Matrix</a></li>
  <li><a href="#bias-vector-mathbfb" id="toc-bias-vector-mathbfb" class="nav-link" data-scroll-target="#bias-vector-mathbfb">Bias vector <span class="math inline">\(\mathbf{B}\)</span></a></li>
  <li><a href="#z_1-matrix" id="toc-z_1-matrix" class="nav-link" data-scroll-target="#z_1-matrix"><span class="math inline">\(Z_1\)</span> Matrix</a></li>
  <li><a href="#h_1-matrix" id="toc-h_1-matrix" class="nav-link" data-scroll-target="#h_1-matrix"><span class="math inline">\(H_1\)</span> Matrix</a></li>
  <li><a href="#w2-matrix" id="toc-w2-matrix" class="nav-link" data-scroll-target="#w2-matrix"><span class="math inline">\(W^{(2)}\)</span> Matrix</a></li>
  <li><a href="#mathbfc-bias-vector" id="toc-mathbfc-bias-vector" class="nav-link" data-scroll-target="#mathbfc-bias-vector"><span class="math inline">\(\mathbf{C}\)</span> bias vector</a></li>
  <li><a href="#z_2-matrix" id="toc-z_2-matrix" class="nav-link" data-scroll-target="#z_2-matrix"><span class="math inline">\(Z_2\)</span> Matrix</a></li>
  <li><a href="#mse-loss" id="toc-mse-loss" class="nav-link" data-scroll-target="#mse-loss">MSE Loss</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#writing-out-the-derivatives-by-hand." id="toc-writing-out-the-derivatives-by-hand." class="nav-link" data-scroll-target="#writing-out-the-derivatives-by-hand.">4) Writing out the derivatives by hand.</a></li>
  <li><a href="#adding-back-propagation-to-your-code-so-that-mathbfw_1-mathbfb-and-c-are-updated." id="toc-adding-back-propagation-to-your-code-so-that-mathbfw_1-mathbfb-and-c-are-updated." class="nav-link" data-scroll-target="#adding-back-propagation-to-your-code-so-that-mathbfw_1-mathbfb-and-c-are-updated.">5) Adding Back Propagation to your code so that <span class="math inline">\(\mathbf{W_1}\)</span>, <span class="math inline">\(\mathbf{B}\)</span>, and <span class="math inline">\(C\)</span> are updated.</a></li>
  <li><a href="#test-model" id="toc-test-model" class="nav-link" data-scroll-target="#test-model">6) Test model</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Module 2 Assignment - Part 1: One Layer NN with One Output</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jasmine Kobayashi </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>Module 2 Assignment - Part 1: One Layer NN with One Output</p>
<hr>
<p><strong>Instructions:</strong></p>
<p>This assignment has a two large parts with many sub-parts. Each part will enable you to practice with a neural networks and to practice for Exam 2.</p>
<p>This Assignment will TAKE TIME so use all of the time you have to work on it. Please avoid waiting until the last few days as this will not be enough time. You need weeks - not days :)</p>
<p>Be sure to show all work and (when requested) to code using Python (and no NN/TF/Keras packages). Do not worry, we will use packages in coming modules but first it is best to learn about what is going on inside the model.</p>
<p>You may use examples and code that I have shared as a reference. Using my code will not be considered cheating although I strongly recommend that you write as much (if not all) of your own code so that you learn the concepts more robustly.</p>
<p>This is not a team assignment. Please work and code alone. You may discuss concepts, but you cannot share code or work with others. Papers that look too similar with split the grade (first offense) and can suffer less pleasant outcomes for further offenses. Keep it simple and smart - do your own work.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="network.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">NN_architecture</figcaption>
</figure>
</div>
<section id="fill-out-this-network-by-hand-and-create-all-the-needed-matrices-etc.-show-all-multiplications-and-shapes." class="level1">
<h1>1) Fill out this network by hand and create all the needed matrices, etc. Show all multiplications and shapes.</h1>
<p>In other words, illustrate the <span class="math inline">\(X\)</span>, <span class="math inline">\(y\)</span>, <span class="math inline">\(W1\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(Z_1\)</span>, <span class="math inline">\(H_1\)</span>, <span class="math inline">\(W2\)</span>, <span class="math inline">\(Z_2\)</span>, <span class="math inline">\(C\)</span>, <span class="math inline">\(\hat{y}\)</span>, <span class="math inline">\(\hat{y}-y\)</span>, and <span class="math inline">\(L\)</span>. Assume that <span class="math inline">\(H_1\)</span> uses the Sigmoid Function.</p>
<p>As you do this - ask yourself: - How many columns does <span class="math inline">\(X\)</span> have? - How many hidden layers are there in this architecture? - How many hidden units are there in teh hidden layer? - How many outputs are there?</p>
<section id="jks-answer" class="level2">
<h2 class="anchored" data-anchor-id="jks-answer">JK’s answer:</h2>
<section id="input-matrix-x" class="level3">
<h3 class="anchored" data-anchor-id="input-matrix-x">Input Matrix <span class="math inline">\(X\)</span></h3>
<p><span class="math display">\[\begin{equation}
X =

\begin{bmatrix}
x_{11} &amp; x_{12} &amp; x_{13} \\
\vdots  &amp; \vdots  &amp; \vdots  \\
x_{n1} &amp; x_{n2} &amp; x_{n3} \\
\end{bmatrix}
\nonumber
\end{equation}\]</span></p>
<p>Where <span class="math inline">\(n\)</span> is any integer.</p>
<p>In any case, the point being: this architecture implies <span class="math inline">\(X\)</span> has 3 columns (but gives no restriction/information about the number of rows of <span class="math inline">\(X\)</span>.)</p>
</section>
<section id="targets-y" class="level3">
<h3 class="anchored" data-anchor-id="targets-y">Targets <span class="math inline">\(y\)</span></h3>
<p><span class="math display">\[\begin{align*}
\mathbf{y} =
\begin{bmatrix}
y_1 \\
\vdots \\
y_n
\end{bmatrix}
\end{align*}\]</span></p>
</section>
<section id="weight-matrix-w1" class="level3">
<h3 class="anchored" data-anchor-id="weight-matrix-w1">Weight matrix <span class="math inline">\(W1\)</span></h3>
<p>The weight matrix connecting inputs <span class="math inline">\(X\)</span> with the first hidden layer (or in this case, the only hidden layer).</p>
<p>I will use both notations <span class="math inline">\(W1 = W^{(1)}\)</span>, to be clear and be able to distinct weights <span class="math inline">\(w\)</span> in <span class="math inline">\(W1\)</span> and <span class="math inline">\(W2\)</span></p>
<p><span class="math display">\[\begin{align*}
W1 = W^{(1)} =
\begin{bmatrix}
w_{11} &amp; w_{12} &amp; w_{13} &amp; w_{14} \\
w_{21} &amp; w_{22} &amp; w_{23} &amp; w_{24} \\
w_{31} &amp; w_{32} &amp; w_{33} &amp; w_{34}
\end{bmatrix}
\end{align*}\]</span></p>
<p>When matching the notation that the first number in the subscript of <span class="math inline">\(w\)</span> is associated with the connected <span class="math inline">\(x\)</span> value and the second number is associated with the hidden unit <span class="math inline">\(h\)</span> (i.e.&nbsp;<span class="math inline">\(w_{12}\)</span> is the weight between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(h_2\)</span>), then the <span class="math inline">\(W_1\)</span> matrix is an <span class="math inline">\(m \times p\)</span> matrix, where <span class="math inline">\(m\)</span> is the number of columns of <span class="math inline">\(X\)</span> and <span class="math inline">\(p\)</span> is the number of units in the first hidden layer (which is also the number of rows of <span class="math inline">\(H_1\)</span>).</p>
</section>
<section id="bias-b" class="level3">
<h3 class="anchored" data-anchor-id="bias-b">Bias <span class="math inline">\(B\)</span></h3>
<p>The “bias”. Column vector with length that matches the number of rows in <span class="math inline">\(X\)</span>.</p>
<p><span class="math display">\[\mathbf{B} = [b_1,\cdots, b_n]^\top\]</span></p>
</section>
<section id="z_1" class="level3">
<h3 class="anchored" data-anchor-id="z_1"><span class="math inline">\(Z_1\)</span></h3>
<p><span class="math display">\[\begin{align*}
Z_1 &amp; =  X\cdot W_1 + B

\\
&amp; =
\begin{bmatrix}
x_{11} &amp; x_{12} &amp; x_{13} \\
\vdots  &amp; \vdots  &amp; \vdots  \\
x_{n1} &amp; x_{n2} &amp; x_{n3} \\
\end{bmatrix}

\begin{bmatrix}
w_{11} &amp; w_{12} &amp; w_{13} &amp; w_{14} \\
w_{21} &amp; w_{22} &amp; w_{23} &amp; w_{24} \\
w_{31} &amp; w_{32} &amp; w_{33} &amp; w_{34}
\end{bmatrix}

+
\begin{bmatrix}
b_1 \\
\vdots \\
b_n
\end{bmatrix}

\\

&amp; =
\begin{bmatrix}
z_{11} &amp; z_{12} &amp; z_{13} &amp; z_{14} \\
z_{21} &amp; z_{22} &amp; z_{23} &amp; z_{24} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
z_{n1} &amp; z_{n2} &amp; z_{n3} &amp; z_{n4}
\end{bmatrix}
\end{align*}\]</span></p>
<p>Where we have:</p>
<p><span class="math display">\[\begin{align*}
&amp; z_{11} = x_{11}w_{11} + x_{12}w_{21} + x_{13}w_{31} + b_1 &amp; &amp; \\
&amp; z_{12} = x_{11}w_{12} + x_{12}w_{22} + x_{13}w_{32} + b_1 &amp; &amp;\\
\end{align*}\]</span></p>
<p><span class="math display">\[\vdots\]</span></p>
<p><span class="math display">\[\begin{align*}
z_{n4} = x_{n1}w_{14} + x_{n2}w_{24} + x_{n3}w_{34} + b_n
\end{align*}\]</span></p>
<p>In other words, I guess any <span class="math inline">\(Z\)</span> element can be summarized as,</p>
<p><span class="math display">\[z_{j,k} = \sum_i^3 x_{j,i}w_{i,k} + b_j\]</span></p>
</section>
<section id="h_1" class="level3">
<h3 class="anchored" data-anchor-id="h_1"><span class="math inline">\(H_1\)</span></h3>
<p>We’re assuming the first hidden layer uses the Simoid activation function. Thus <span class="math inline">\(S(z)\)</span> is the Sigmoid of <span class="math inline">\(z\)</span>.</p>
<p>(Very) Generically we have, <span class="math display">\[h = S(z) = \frac{1}{1+e^{-z}}\]</span></p>
<p>Thus the matrix is as follows:</p>
<p><span class="math display">\[\begin{align*}
H_1 &amp; =
\begin{bmatrix}
S(z_{11}) &amp; S(z_{12}) &amp; S(z_{13}) &amp; S(z_{14}) \\
\vdots    &amp;   \vdots  &amp;   \vdots  &amp;   \vdots  \\
S(z_{n1}) &amp; S(z_{n2}) &amp; S(z_{n3}) &amp; S(z_{n4}) \\
\end{bmatrix}

\\

&amp; =
\begin{bmatrix}
h_{11} &amp; h_{12} &amp; h_{13} &amp; h_{14} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
h_{n1} &amp; h_{n2} &amp; h_{n3} &amp; h_{n4} \\
\end{bmatrix}
\end{align*}\]</span></p>
<p>The number of columns in <span class="math inline">\(H_1\)</span> is the number of hidden units in the hidden layer.</p>
</section>
<section id="w2" class="level3">
<h3 class="anchored" data-anchor-id="w2"><span class="math inline">\(W2\)</span></h3>
<p>The weight matrix connecting the hidden layer and the last node.</p>
<p>Again, I will use both notations <span class="math inline">\(W1 = W^{(1)}\)</span> and <span class="math inline">\(W2 = W^{(2)}\)</span>, to be able to distinguish weights from each weight matrix.</p>
<p><span class="math display">\[\begin{align*}
W2 = W^{(2)} =
\begin{bmatrix}
w_1^{(2)} \\[6pt]
w_2^{(2)} \\[6pt]
w_3^{(2)} \\[6pt]
w_4^{(2)} \\[6pt]
\end{bmatrix}
\end{align*}\]</span></p>
</section>
<section id="c" class="level3">
<h3 class="anchored" data-anchor-id="c"><span class="math inline">\(C\)</span></h3>
<p>I believe this is the “bias” associated to calculate <span class="math inline">\(Z_2\)</span>. So much like <span class="math inline">\(B\)</span> it’s going to be a column vector with length that matches the number of rows in <span class="math inline">\(X\)</span>.</p>
<p><span class="math display">\[\begin{equation*}
C =
\begin{bmatrix}
c_1 \\
\vdots \\
c_n
\end{bmatrix}
\end{equation*}\]</span></p>
</section>
<section id="z_2" class="level3">
<h3 class="anchored" data-anchor-id="z_2"><span class="math inline">\(Z_2\)</span></h3>
<p><span class="math display">\[\begin{align*}
Z_2 &amp;= H_1 W^{(2)} + C \\
&amp;=
\begin{bmatrix}
h_{11} &amp; h_{12} &amp; h_{13} &amp; h_{14} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
h_{n1} &amp; h_{n2} &amp; h_{n3} &amp; h_{n4} \\
\end{bmatrix}
\begin{bmatrix}
w_1^{(2)} \\[6pt]
w_2^{(2)} \\[6pt]
w_3^{(2)} \\[6pt]
w_4^{(2)} \\[6pt]
\end{bmatrix}

+

\begin{bmatrix}
c_1 \\
\vdots \\
c_n
\end{bmatrix}
\\
&amp;=
\begin{bmatrix}
h_{11}w_2^{(2)} + h_{12}w_2^{(2)} + h_{13}w_3^{(2)} + h_{14}w_4^{(2)} + c_1\\
\vdots \\
h_{n1}w_2^{(2)} + h_{n2}w_2^{(2)} + h_{n3}w_3^{(2)} + h_{n4}w_4^{(2)} + c_n
\end{bmatrix}
\\
&amp;=
\begin{bmatrix}
z_1^{(2)} \\
\vdots \\
z_n^{(2)}
\end{bmatrix}
\end{align*}\]</span></p>
</section>
<section id="mathbfhaty" class="level3">
<h3 class="anchored" data-anchor-id="mathbfhaty"><span class="math inline">\(\mathbf{\hat{y}}\)</span></h3>
<p>In terms of notation,</p>
<p><span class="math display">\[\begin{align*}
\mathbf{\hat{y}} =
\begin{bmatrix}
\hat{y}_1 \\
\vdots \\
\hat{y}_n \\
\end{bmatrix}
\end{align*}\]</span></p>
<p>(Should have the same shape as <span class="math inline">\(\mathbf{y}\)</span>)</p>
<p>I’m guessing I have to do sigmoid again to get probability for binary labels?</p>
<p><span class="math display">\[\begin{align*}
\Rightarrow
\mathbf{\hat{y}} =
\begin{bmatrix}
\hat{y}_1 \\
\vdots \\
\hat{y}_n \\
\end{bmatrix}
=
\begin{bmatrix}
S(z_1^{(2)}) \\
\vdots \\
S(z_n^{(2)})
\end{bmatrix}
\end{align*}\]</span></p>
</section>
<section id="mathbfhaty---mathbfy" class="level3">
<h3 class="anchored" data-anchor-id="mathbfhaty---mathbfy"><span class="math inline">\(\mathbf{\hat{y}} - \mathbf{y}\)</span></h3>
<p><span class="math display">\[\begin{align*}
\mathbf{\hat{y}} - \mathbf{y} =
\begin{bmatrix}
\hat{y}_1 \\
\vdots \\
\hat{y}_n \\
\end{bmatrix}

-

\begin{bmatrix}
y_1 \\
\vdots \\
y_n
\end{bmatrix}

=

\begin{bmatrix}
\hat{y}_1 - y_1 \\
\vdots \\
\hat{y}_n - y_n \\
\end{bmatrix}

\end{align*}\]</span></p>
</section>
<section id="loss-l" class="level3">
<h3 class="anchored" data-anchor-id="loss-l">Loss <span class="math inline">\(L\)</span></h3>
<p>There’s really no limit of what Loss function <span class="math inline">\(L\)</span> to use. (A NN architecture doesn’t define this, the NN model builder does :)) It could be LCE or a simple one.</p>
<p>For the purpose of this assignment I’ll use a simple MSE (that’s supposedly pretty commonly used as well), since it uses <span class="math inline">\(\mathbf{\hat{y}} - \mathbf{y}\)</span>.</p>
<p><span class="math display">\[\begin{align*}
Loss = L &amp;= \frac{1}{2} (\mathbf{y} - \mathbf{\hat{y}})^2 \\
&amp;= \frac{1}{2}
\begin{bmatrix}
\hat{y}_1 - y_1 \\
\vdots \\
\hat{y}_n - y_n
\end{bmatrix}^2
\\
&amp;=\frac{1}{2}
\begin{bmatrix}
\hat{y}_1 - y_1 \\
\vdots \\
\hat{y}_n - y_n
\end{bmatrix}
\begin{bmatrix}
\hat{y}_1 - y_1, &amp; \cdots, &amp; \hat{y}_1 - y_1
\end{bmatrix}
\\
&amp;= \frac{1}{2} \sum_i^n (\hat{y}_i - y_i)^2
\end{align*}\]</span></p>
</section>
</section>
</section>
<section id="use-python-to-code-the-feed-forward-portion-of-this-nn." class="level1">
<h1>2) Use Python to code the <strong>Feed-Forward</strong> portion of this NN.</h1>
<p>Print out <span class="math inline">\(X\)</span>, <span class="math inline">\(y\)</span>, <span class="math inline">\(W1\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(Z_1\)</span>, <span class="math inline">\(H_1\)</span>, <span class="math inline">\(W_2\)</span>, <span class="math inline">\(Z_2\)</span>, <span class="math inline">\(C\)</span>, <span class="math inline">\(\hat{y}\)</span>, <span class="math inline">\(\hat{y}-y\)</span>, and <span class="math inline">\(L\)</span>.</p>
<p><strong>Assumptions and Notes</strong>:</p>
<ol type="a">
<li><p>Create your own small labeled dataset. Have the right number of columns and have a column called “LABEL” which is 0 or 1.</p></li>
<li><p>Read in the data and create <span class="math inline">\(X\)</span> and <span class="math inline">\(y\)</span></p></li>
<li><p>YOU create the dataset so that everyone will have a unique dataset. Have between 5 and 7 rows (no more), assure that your labels “make sense” for the data, and have a balance of labels (so nearish 50% <span class="math inline">\(0\)</span> and 50% <span class="math inline">\(1\)</span>). You want your NN to “work” so again make sure your labeled data has a predictable pattern. <em>INVENT</em> the data yourself - type it into a <code>.csv</code> file - save the file as <strong>A2_Data_YourName.csv</strong>. You will submit this dataset with your Assignment submission.</p></li>
<li><p>Create <span class="math inline">\(H_1\)</span> using Sigmoid. You will need to <strong>code</strong> a function for the Sigmoid (and its derivative) into your code. Do this using <code>def</code>.</p></li>
<li><p>Use <span class="math inline">\(L = \frac{1}{n} \displaystyle \sum^n (\hat{y} - y)^2\)</span> as the Loss Function when <span class="math inline">\(n\)</span> is the number of rows in your dataset. Do not “hard code”. The TAs or I should be able to use your code to read ANY dataset that has 3 columns of data, one label column called “LABEL” (of 0 or 1), and any number of rows.</p></li>
</ol>
<p><strong><em>JK answer:</em></strong></p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#%% libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder,MinMaxScaler</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix  </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> OneLayer_OneOutput_FF():</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                 data_filename <span class="op">=</span> <span class="st">"A2_Data_JasmineKobayashi.csv"</span>, </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                 scale_data <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                 verbose <span class="op">=</span> <span class="va">True</span>):</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Read Data</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.df <span class="op">=</span> pd.read_csv(data_filename)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># create X and y, assuming data has column "LABEL" as column with labels</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">## X matrix</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> scale_data:</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            mm_scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            X <span class="op">=</span> mm_scaler.fit_transform(<span class="va">self</span>.df.drop(columns<span class="op">=</span><span class="st">"LABEL"</span>,axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>            X <span class="op">=</span> np.array(<span class="va">self</span>.df.drop(columns<span class="op">=</span>[<span class="st">'LABEL'</span>],axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.X <span class="op">=</span> X</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">## y</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.y <span class="op">=</span> np.array(<span class="va">self</span>.df[[<span class="st">'LABEL'</span>]])</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Shape of X:"</span>, <span class="va">self</span>.X.shape)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"X matrix: </span><span class="ch">\n</span><span class="st">"</span>, <span class="va">self</span>.X)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Shape of y:"</span>, <span class="va">self</span>.y.shape)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"y vector: </span><span class="ch">\n</span><span class="st">"</span>, <span class="va">self</span>.y)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> MSE_loss(<span class="va">self</span>,y_hat,y):</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># L = mean((y_hat - y)^2)</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.mean((y_hat <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> lin_eq(<span class="va">self</span>,X,W,B):</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> X.shape[<span class="dv">1</span>] <span class="op">==</span> W.shape[<span class="dv">0</span>], <span class="st">"Linear eq: z = X @ W + B. Shape of X: </span><span class="sc">{}</span><span class="st">; Shape of W: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(X.shape,W.shape)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> B.shape[<span class="dv">0</span>] <span class="op">==</span> X.shape[<span class="dv">0</span>], <span class="st">"Linear eq: z = X @ W + B. Length of B should match X rows; Length B = </span><span class="sc">{}</span><span class="st">; Shape of X = </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(B.shape[<span class="dv">0</span>],X.shape)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> X <span class="op">@</span> W <span class="op">+</span> B</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> Sigmoid(<span class="va">self</span>,z,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>                derivative <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> derivative:</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.Sigmoid(z) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.Sigmoid(z)) <span class="co"># dS/dz = S(z)(1-S(z))</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sigmoid</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> math.e<span class="op">**</span>(<span class="op">-</span>z)) <span class="co"># S(z) = 1/(1 + e^(-z))</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> FeedForward(<span class="va">self</span>,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>                    hidden_units<span class="op">=</span> <span class="dv">4</span>,</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>                    randomize_parameters <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>                    activation <span class="op">=</span> <span class="st">"sigmoid"</span>,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>                    verbose <span class="op">=</span> <span class="va">True</span>):</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Shape of W1</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        w1_ncol <span class="op">=</span> hidden_units        <span class="co"># Number of W1 cols should be number of hidden units in H1</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        w1_nrow <span class="op">=</span> <span class="va">self</span>.X.shape[<span class="dv">1</span>]     <span class="co"># Number of W1 rows should be number of X columns (dim of X)</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Shape of B (column vector)</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        b_length <span class="op">=</span> <span class="va">self</span>.X.shape[<span class="dv">0</span>]    <span class="co"># length of X rows</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Shape of W2:</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        w2_ncol <span class="op">=</span> <span class="dv">1</span>                   <span class="co"># Number of W2 cols should be number of outputs (in this case, only one output)</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        w2_nrow <span class="op">=</span> hidden_units        <span class="co"># Number of W2 rows should be number of hidden units in H1</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Shape of C (column vector)</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        c_length <span class="op">=</span> <span class="va">self</span>.X.shape[<span class="dv">0</span>]    <span class="co"># length of X rows</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> randomize_parameters: </span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>            <span class="co"># </span><span class="al">TODO</span><span class="co">: Finish potential code of randomized parameters</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>            <span class="co"># # bounds of randomized weights</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># bound = 1/np.sqrt(w1_nrow)   # I found online that supposedly this is a standard range for randomized weights</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>            <span class="co"># rand_w = [np.random.uniform(-bound,bound) for i in range(w1_ncol)]</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>            <span class="co"># self.W1 = np.array([rand_w]*w1_nrow)</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>            <span class="co"># self.W2 = np.array([]*w2_nrow)</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('All parameters were randomized')</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:   <span class="co"># These are the parameters defined by the question 2 in Assignment2</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.W1 <span class="op">=</span> np.array([[<span class="dv">1</span>]<span class="op">*</span>w1_ncol]<span class="op">*</span>w1_nrow) <span class="co"># otherwise, all weights of W1 = 1</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.B <span class="op">=</span> np.array([[<span class="dv">0</span>]]<span class="op">*</span>b_length)         <span class="co"># otherwise, all bias (B) = 0</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.W2 <span class="op">=</span> np.array([[<span class="dv">2</span>]<span class="op">*</span>w2_ncol]<span class="op">*</span>w2_nrow) <span class="co"># otherwise, all weights of W2 = 2</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.C <span class="op">=</span> np.array([[<span class="dv">0</span>]]<span class="op">*</span>c_length)</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Parameters built for simple calculation (not randomized)"</span>)</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print("# of X cols (should be # of W1 rows):", self.X.shape[1])</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print("# of hidden units (should be # of W1 cols):", hidden_units)</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"W1 has shape:"</span>, <span class="va">self</span>.W1.shape)</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"W1 matrix: </span><span class="ch">\n</span><span class="st">"</span>, <span class="va">self</span>.W1)</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Shape of B:"</span>, <span class="va">self</span>.B.shape)</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"B (bias vector for Z1): </span><span class="ch">\n</span><span class="st">"</span>, <span class="va">self</span>.B)</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Shape of W2:"</span>,<span class="va">self</span>.W2.shape)</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"W2 matrix: </span><span class="ch">\n</span><span class="st">"</span>, <span class="va">self</span>.W2)</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Shape of C :"</span>, <span class="va">self</span>.C.shape)</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"C (bias vector for Z2): </span><span class="ch">\n</span><span class="st">"</span>,<span class="va">self</span>.C)</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create H1</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Z1 = X @ W1 + B</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.Z1 <span class="op">=</span> <span class="va">self</span>.lin_eq(<span class="va">self</span>.X,<span class="va">self</span>.W1,<span class="va">self</span>.B)</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Shape of Z1:"</span>,<span class="va">self</span>.Z1.shape)</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Z1 matrix: </span><span class="ch">\n</span><span class="st">"</span>,<span class="va">self</span>.Z1)</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.H1 <span class="op">=</span> <span class="va">self</span>.Sigmoid(<span class="va">self</span>.Z1)</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># </span><span class="al">TODO</span><span class="co">: Add flexibility with other activation functions</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose: </span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Activation function:"</span>,activation)</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"H1 matrix: </span><span class="ch">\n</span><span class="st">"</span>, <span class="va">self</span>.H1)</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Z2 and y-hat</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Z2 = H1 @ W2 + C</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.Z2 <span class="op">=</span> <span class="va">self</span>.lin_eq(<span class="va">self</span>.H1,<span class="va">self</span>.W2,<span class="va">self</span>.C)</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.y_hat <span class="op">=</span> <span class="va">self</span>.Sigmoid(<span class="va">self</span>.Z2)</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Shape of Z2:"</span>, <span class="va">self</span>.Z2.shape)</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Z2 matrix: </span><span class="ch">\n</span><span class="st">"</span>, <span class="va">self</span>.Z2)</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"y_hat:</span><span class="ch">\n</span><span class="st">"</span>,<span class="va">self</span>.y_hat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>NN <span class="op">=</span> OneLayer_OneOutput_FF()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>NN.FeedForward()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MSE Loss:"</span>,NN.MSE_loss(y_hat<span class="op">=</span>NN.y_hat,y<span class="op">=</span>NN.y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of X: (6, 3)
X matrix: 
 [[0.86363636 0.         0.07894737]
 [0.09090909 0.4        0.81578947]
 [0.         0.8        1.        ]
 [1.         0.2        0.05263158]
 [0.90909091 1.         0.        ]
 [0.04545455 0.6        0.94736842]]
Shape of y: (6, 1)
y vector: 
 [[0]
 [1]
 [1]
 [0]
 [0]
 [1]]
Parameters built for simple calculation (not randomized)
W1 has shape: (3, 4)
W1 matrix: 
 [[1 1 1 1]
 [1 1 1 1]
 [1 1 1 1]]
Shape of B: (6, 1)
B (bias vector for Z1): 
 [[0]
 [0]
 [0]
 [0]
 [0]
 [0]]
Shape of W2: (4, 1)
W2 matrix: 
 [[2]
 [2]
 [2]
 [2]]
Shape of C : (6, 1)
C (bias vector for Z2): 
 [[0]
 [0]
 [0]
 [0]
 [0]
 [0]]
Shape of Z1: (6, 4)
Z1 matrix: 
 [[0.94258373 0.94258373 0.94258373 0.94258373]
 [1.30669856 1.30669856 1.30669856 1.30669856]
 [1.8        1.8        1.8        1.8       ]
 [1.25263158 1.25263158 1.25263158 1.25263158]
 [1.90909091 1.90909091 1.90909091 1.90909091]
 [1.59282297 1.59282297 1.59282297 1.59282297]]
Activation function: sigmoid
H1 matrix: 
 [[0.71962126 0.71962126 0.71962126 0.71962126]
 [0.78696018 0.78696018 0.78696018 0.78696018]
 [0.85814894 0.85814894 0.85814894 0.85814894]
 [0.77775507 0.77775507 0.77775507 0.77775507]
 [0.87091698 0.87091698 0.87091698 0.87091698]
 [0.8310129  0.8310129  0.8310129  0.8310129 ]]
Shape of Z2: (6, 1)
Z2 matrix: 
 [[5.75697011]
 [6.29568146]
 [6.86519148]
 [6.22204054]
 [6.96733585]
 [6.64810323]]
y_hat:
 [[0.99684928]
 [0.99815914]
 [0.99895761]
 [0.99801874]
 [0.99905873]
 [0.9987052 ]]
MSE Loss: 0.4979790666878168</code></pre>
</div>
</div>
</section>
<section id="compare-by-hand-and-code" class="level1">
<h1>3) Compare <em>by-hand</em> and code</h1>
<p>Here, will compare your by-hand work in (1) with your code in (2).</p>
<p>To do this, use your dataset values (just the first row) and your label (for the first row) to FF <em>by hand on paper</em> through the network. Show numeric and clear results for <span class="math inline">\(X\)</span>, <span class="math inline">\(y\)</span>, <span class="math inline">\(W_1\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(Z_1\)</span>, <span class="math inline">\(H_1\)</span>, <span class="math inline">\(W_2\)</span>, <span class="math inline">\(Z_2\)</span>, <span class="math inline">\(C\)</span>, <span class="math inline">\(\hat{y}\)</span>, <span class="math inline">\(\hat{y}-y\)</span>, and <span class="math inline">\(L\)</span>.</p>
<p>Then, using your code and the same <span class="math inline">\(X\)</span> (first row) and <span class="math inline">\(y\)</span> (first label), print out <span class="math inline">\(X\)</span>, <span class="math inline">\(y\)</span>, <span class="math inline">\(W_1\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(Z_1\)</span>, <span class="math inline">\(H_1\)</span>, <span class="math inline">\(W_2\)</span>, <span class="math inline">\(Z_2\)</span>, <span class="math inline">\(C\)</span>, <span class="math inline">\(\hat{y}\)</span>, <span class="math inline">\(\hat{y}-y\)</span>, and <span class="math inline">\(L\)</span>.</p>
<p>Both the “by hand on paper” and the “by code” results should be the same.</p>
<p>If they are not, find and fix your bugs until they are the same.</p>
<p><strong>Notes</strong>: <span class="math inline">\(\mathbf{W_1}\)</span>, <span class="math inline">\(\mathbf{W_2}\)</span>, <span class="math inline">\(\mathbf{B}\)</span> (which is <span class="math inline">\(b_1\)</span>, <span class="math inline">\(b_2\)</span>, <span class="math inline">\(b_3\)</span>, <span class="math inline">\(b_4\)</span>), and <span class="math inline">\(C\)</span> (which is <span class="math inline">\(c_1\)</span>) would normally be randomly initialized. However, to make your code and “by hand” comparison easier, let all the values in <span class="math inline">\(W_1\)</span> be <span class="math inline">\(1\)</span>, let all the values in <span class="math inline">\(W_2\)</span> be 2, let all the <span class="math inline">\(\mathbf{B}\)</span> values be <span class="math inline">\(0\)</span>, and let <span class="math inline">\(c\)</span> be <span class="math inline">\(-1\)</span>. You will code this in and will use this by hand so that your code and by-hand results will be the same.</p>
<p>Print out all key matrices and results.</p>
<p>Illustrate and compare your “by-hand” results with your code print outs to show that they are the same.</p>
<section id="jks-answer-1" class="level2">
<h2 class="anchored" data-anchor-id="jks-answer-1">JK’s answer</h2>
<section id="x-matrix" class="level3">
<h3 class="anchored" data-anchor-id="x-matrix">X Matrix</h3>
<p><span class="math display">\[\begin{align*}
X &amp;=

\begin{bmatrix}
x_{11} &amp; x_{12} &amp; x_{13} \\
x_{21} &amp; x_{22} &amp; x_{23} \\
\vdots  &amp; \vdots  &amp; \vdots  \\
x_{n1} &amp; x_{n2} &amp; x_{n3} \\
\end{bmatrix}
\\
&amp;=
\begin{bmatrix}
22 &amp; 10 &amp; 24 \\
5  &amp; 12 &amp; 52 \\
3  &amp; 15 &amp; 59 \\
25 &amp; 11 &amp; 23 \\
23 &amp; 14 &amp; 21 \\
4  &amp; 13 &amp; 57
\end{bmatrix}
\end{align*}\]</span></p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>NN <span class="op">=</span> OneLayer_OneOutput_FF(scale_data<span class="op">=</span><span class="va">False</span>,verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"non-scaled X:</span><span class="ch">\n</span><span class="st">"</span>,NN.X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>non-scaled X:
 [[22 10 24]
 [ 5 12 52]
 [ 3 14 59]
 [25 11 23]
 [23 15 21]
 [ 4 13 57]]</code></pre>
</div>
</div>
<p>To avoid errors with Sigmoid, so going to Min-Max scale the data. I’m not going to calculate individually I”m going to leave it to the Sklearn package min-max normalizer and trust it works.</p>
<p>But this is the formula I would use if I did calculate by hand:</p>
<p><span class="math display">\[x' = \frac{x - min}{max - min}\]</span></p>
<p>Where <span class="math inline">\(x'\)</span> is the scaled value, <span class="math inline">\(x\)</span> is the value to scale. (<span class="math inline">\(min\)</span> &amp; <span class="math inline">\(max\)</span> are the minimum value and maximum value of the list of values to scale to.)</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>NN <span class="op">=</span> OneLayer_OneOutput_FF(scale_data<span class="op">=</span><span class="va">True</span>,verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Min-Max Scaled X:</span><span class="ch">\n</span><span class="st">"</span>,NN.X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Min-Max Scaled X:
 [[0.86363636 0.         0.07894737]
 [0.09090909 0.4        0.81578947]
 [0.         0.8        1.        ]
 [1.         0.2        0.05263158]
 [0.90909091 1.         0.        ]
 [0.04545455 0.6        0.94736842]]</code></pre>
</div>
</div>
</section>
<section id="targets-mathbfy" class="level3">
<h3 class="anchored" data-anchor-id="targets-mathbfy">Targets <span class="math inline">\(\mathbf{y}\)</span></h3>
<p><span class="math display">\[\begin{align*}
\mathbf{y} &amp;=
\begin{bmatrix}
y_1 \\
\vdots \\
y_n
\end{bmatrix}
\\
&amp;=
\begin{bmatrix}
0 \\
1 \\
1 \\
0 \\
0 \\
1
\end{bmatrix}
\end{align*}\]</span></p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"y target vector:</span><span class="ch">\n</span><span class="st">"</span>,NN.y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>y target vector:
 [[0]
 [1]
 [1]
 [0]
 [0]
 [1]]</code></pre>
</div>
</div>
</section>
<section id="w1-matrix" class="level3">
<h3 class="anchored" data-anchor-id="w1-matrix"><span class="math inline">\(W^{(1)}\)</span> Matrix</h3>
<p>For this assignment we’re using all weights in <span class="math inline">\(W^{(1)}\)</span> are equal to <span class="math inline">\(1\)</span></p>
<p><span class="math display">\[\begin{align*}
W^{(1)} &amp;=
\begin{bmatrix}
w_{11} &amp; w_{12} &amp; w_{13} &amp; w_{14} \\
w_{21} &amp; w_{22} &amp; w_{23} &amp; w_{24} \\
w_{31} &amp; w_{32} &amp; w_{33} &amp; w_{34}
\end{bmatrix}
\\
&amp;=
\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; 1 &amp; 1 &amp; 1
\end{bmatrix}
\end{align*}\]</span></p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>NN.FeedForward(verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"W1 matrix: </span><span class="ch">\n</span><span class="st">"</span>,NN.W1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameters built for simple calculation (not randomized)
W1 matrix: 
 [[1 1 1 1]
 [1 1 1 1]
 [1 1 1 1]]</code></pre>
</div>
</div>
</section>
<section id="bias-vector-mathbfb" class="level3">
<h3 class="anchored" data-anchor-id="bias-vector-mathbfb">Bias vector <span class="math inline">\(\mathbf{B}\)</span></h3>
<p>For this assignment we using all bias = 0</p>
<p><span class="math display">\[\begin{align*}
\mathbf{B} =
\begin{bmatrix}
b_1 \\
\vdots \\
b_n
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0 \\
0 \\
0 \\
0 \\
0 \\
\end{bmatrix}
\end{align*}\]</span></p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Bias vector B: </span><span class="ch">\n</span><span class="st">"</span>,NN.B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bias vector B: 
 [[0]
 [0]
 [0]
 [0]
 [0]
 [0]]</code></pre>
</div>
</div>
</section>
<section id="z_1-matrix" class="level3">
<h3 class="anchored" data-anchor-id="z_1-matrix"><span class="math inline">\(Z_1\)</span> Matrix</h3>
<p><span class="math display">\[\begin{align*}
Z_1 &amp;= X \cdot W^{(1)} + B \\
&amp;=
\begin{bmatrix}
x_{11} &amp; x_{12} &amp; x_{13} \\
x_{21} &amp; x_{22} &amp; x_{23} \\
\vdots  &amp; \vdots  &amp; \vdots  \\
x_{n1} &amp; x_{n2} &amp; x_{n3} \\
\end{bmatrix}
\begin{bmatrix}
w_{11} &amp; w_{12} &amp; w_{13} &amp; w_{14} \\
w_{21} &amp; w_{22} &amp; w_{23} &amp; w_{24} \\
w_{31} &amp; w_{32} &amp; w_{33} &amp; w_{34}
\end{bmatrix}
+
\begin{bmatrix}
b_1 \\
\vdots \\
b_n
\end{bmatrix}
\\
&amp;=
\begin{bmatrix}
0.863 &amp; 0.0 &amp; 0.0789 \\
0.091 &amp; 0.4 &amp; 0.816  \\
0.0   &amp; 0.8 &amp; 1.0    \\
1.0   &amp; 0.2 &amp; 0.0526 \\
0.909 &amp; 1.0 &amp; 0.0    \\
0.045 &amp; 0.6 &amp; 0.947
\end{bmatrix}
\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; 1 &amp; 1 &amp; 1
\end{bmatrix}
+
\begin{bmatrix}
0 \\
0 \\
0 \\
0 \\
0 \\
0 \\
\end{bmatrix}
\\
&amp;=
\begin{bmatrix}
0.942 &amp; 0.942 &amp; 0.942 &amp; 0.942 \\
1.306 &amp; 1.306 &amp; 1.306 &amp; 1.306 \\
1.8   &amp; 1.8   &amp; 1.8   &amp; 1.8   \\
1.253 &amp; 1.253 &amp; 1.253 &amp; 1.253 \\
1.91  &amp; 1.91  &amp; 1.91  &amp; 1.91  \\
1.597 &amp; 1.597 &amp; 1.597 &amp; 1.597
\end{bmatrix}
\end{align*}\]</span></p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>NN.Z1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([[0.94258373, 0.94258373, 0.94258373, 0.94258373],
       [1.30669856, 1.30669856, 1.30669856, 1.30669856],
       [1.8       , 1.8       , 1.8       , 1.8       ],
       [1.25263158, 1.25263158, 1.25263158, 1.25263158],
       [1.90909091, 1.90909091, 1.90909091, 1.90909091],
       [1.59282297, 1.59282297, 1.59282297, 1.59282297]])</code></pre>
</div>
</div>
</section>
<section id="h_1-matrix" class="level3">
<h3 class="anchored" data-anchor-id="h_1-matrix"><span class="math inline">\(H_1\)</span> Matrix</h3>
<p>Using the Sigmoid as the activation function which is defined as follows,</p>
<p><span class="math display">\[\begin{align*}
S(z) &amp;= \frac{e^z}{1+e^z} \\[6pt]
&amp;= \frac{1}{1+e^{-z}}
\end{align*}\]</span></p>
<p>And <span class="math inline">\(h=S(z)\)</span></p>
<p><span class="math display">\[\begin{align*}
H_1 &amp; =
\begin{bmatrix}
S(z_{11}) &amp; S(z_{12}) &amp; S(z_{13}) &amp; S(z_{14}) \\
\vdots    &amp;   \vdots  &amp;   \vdots  &amp;   \vdots  \\
S(z_{n1}) &amp; S(z_{n2}) &amp; S(z_{n3}) &amp; S(z_{n4}) \\
\end{bmatrix}

\\

&amp; =
\begin{bmatrix}
0.7195 &amp; 0.7195 &amp; 0.7195 &amp; 0.7195 \\
0.787  &amp; 0.787  &amp; 0.787  &amp; 0.787  \\
0.858  &amp; 0.858  &amp; 0.858  &amp; 0.858  \\
0.778  &amp; 0.778  &amp; 0.778  &amp; 0.778  \\
0.871  &amp; 0.871  &amp; 0.871  &amp; 0.871  \\
0.832  &amp; 0.832  &amp; 0.832  &amp; 0.832  
\end{bmatrix}
\end{align*}\]</span></p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"H1 matrix: </span><span class="ch">\n</span><span class="st">"</span>,NN.H1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>H1 matrix: 
 [[0.71962126 0.71962126 0.71962126 0.71962126]
 [0.78696018 0.78696018 0.78696018 0.78696018]
 [0.85814894 0.85814894 0.85814894 0.85814894]
 [0.77775507 0.77775507 0.77775507 0.77775507]
 [0.87091698 0.87091698 0.87091698 0.87091698]
 [0.8310129  0.8310129  0.8310129  0.8310129 ]]</code></pre>
</div>
</div>
</section>
<section id="w2-matrix" class="level3">
<h3 class="anchored" data-anchor-id="w2-matrix"><span class="math inline">\(W^{(2)}\)</span> Matrix</h3>
<p>For this assignment we’re using all weights in <span class="math inline">\(W^{(2)}\)</span> are equal to <span class="math inline">\(2\)</span></p>
<p><span class="math display">\[\begin{align*}
W^{(2)} =
\begin{bmatrix}
w_1^{(2)} \\[6pt]
w_2^{(2)} \\[6pt]
w_3^{(2)} \\[6pt]
w_4^{(2)} \\[6pt]
\end{bmatrix}
=
\begin{bmatrix}
2 \\
2 \\
2 \\
2
\end{bmatrix}
\end{align*}\]</span></p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"W2 matrix: </span><span class="ch">\n</span><span class="st">"</span>,NN.W2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>W2 matrix: 
 [[2]
 [2]
 [2]
 [2]]</code></pre>
</div>
</div>
</section>
<section id="mathbfc-bias-vector" class="level3">
<h3 class="anchored" data-anchor-id="mathbfc-bias-vector"><span class="math inline">\(\mathbf{C}\)</span> bias vector</h3>
<p>For this assignment we using all bias = 0</p>
<p><span class="math display">\[\begin{equation*}
C =
\begin{bmatrix}
c_1 \\
\vdots \\
c_n
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0 \\
0 \\
0 \\
0 \\
0
\end{bmatrix}
\end{equation*}\]</span></p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"C bias vector: </span><span class="ch">\n</span><span class="st">"</span>,NN.C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>C bias vector: 
 [[0]
 [0]
 [0]
 [0]
 [0]
 [0]]</code></pre>
</div>
</div>
</section>
<section id="z_2-matrix" class="level3">
<h3 class="anchored" data-anchor-id="z_2-matrix"><span class="math inline">\(Z_2\)</span> Matrix</h3>
<p><span class="math display">\[\begin{align*}
Z_2 &amp;= H_1 W^{(2)} + C \\
&amp;=
\begin{bmatrix}
h_{11} &amp; h_{12} &amp; h_{13} &amp; h_{14} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
h_{n1} &amp; h_{n2} &amp; h_{n3} &amp; h_{n4} \\
\end{bmatrix}
\begin{bmatrix}
w_1^{(2)} \\[6pt]
w_2^{(2)} \\[6pt]
w_3^{(2)} \\[6pt]
w_4^{(2)} \\[6pt]
\end{bmatrix}

+

\begin{bmatrix}
c_1 \\
\vdots \\
c_n
\end{bmatrix}

=
\begin{bmatrix}
z_1^{(2)} \\
\vdots \\
z_n^{(2)}
\end{bmatrix}
\\
&amp;=
\begin{bmatrix}
0.7195 &amp; 0.7195 &amp; 0.7195 &amp; 0.7195 \\
0.787  &amp; 0.787  &amp; 0.787  &amp; 0.787  \\
0.858  &amp; 0.858  &amp; 0.858  &amp; 0.858  \\
0.778  &amp; 0.778  &amp; 0.778  &amp; 0.778  \\
0.871  &amp; 0.871  &amp; 0.871  &amp; 0.871  \\
0.832  &amp; 0.832  &amp; 0.832  &amp; 0.832  
\end{bmatrix}
\begin{bmatrix}
2 \\
2 \\
2 \\
2
\end{bmatrix}
+
\begin{bmatrix}
0 \\
0 \\
0 \\
0 \\
0 \\
0
\end{bmatrix}
\\
&amp;=
\begin{bmatrix}
5.756 \\
6.296 \\
6.864 \\
6.224 \\
6.968 \\
6.656
\end{bmatrix}
\end{align*}\]</span></p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Z2 matrix: </span><span class="ch">\n</span><span class="st">"</span>,NN.Z2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Z2 matrix: 
 [[5.75697011]
 [6.29568146]
 [6.86519148]
 [6.22204054]
 [6.96733585]
 [6.64810323]]</code></pre>
</div>
</div>
<section id="mathbfhaty-prediction-vector" class="level4">
<h4 class="anchored" data-anchor-id="mathbfhaty-prediction-vector"><span class="math inline">\(\mathbf{\hat{y}}\)</span> prediction vector</h4>
<p>I’m guessing I have to do sigmoid again to get probability for binary labels.</p>
<p>So something like,</p>
<p><span class="math display">\[\begin{align*}
\mathbf{\hat{y}} &amp;=
\begin{bmatrix}
\hat{y}_1 \\
\vdots \\
\hat{y}_n \\
\end{bmatrix}
=
\begin{bmatrix}
S(z_1^{(2)}) \\
\vdots \\
S(z_n^{(2)})
\end{bmatrix}
\\
&amp; =
\begin{bmatrix}
0.997 \\
0.998 \\
0.999 \\
0.998 \\
0.999 \\
0.999
\end{bmatrix}
\end{align*}\]</span></p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"y-hat prediction vector:</span><span class="ch">\n</span><span class="st">"</span>,NN.y_hat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>y-hat prediction vector:
 [[0.99684928]
 [0.99815914]
 [0.99895761]
 [0.99801874]
 [0.99905873]
 [0.9987052 ]]</code></pre>
</div>
</div>
</section>
</section>
<section id="mse-loss" class="level3">
<h3 class="anchored" data-anchor-id="mse-loss">MSE Loss</h3>
<p>We’re using MSE</p>
<p><span class="math display">\[\begin{align*}
L = \frac{1}{n} \displaystyle \sum_i^n (\hat{y}_i - y_i)^2
\end{align*}\]</span></p>
<p>Gonna start with <span class="math inline">\(\hat{y} - y\)</span></p>
<p><span class="math display">\[\begin{align*}
\mathbf{\hat{y}} - \mathbf{y} &amp;=
\begin{bmatrix}
\hat{y}_1 \\
\vdots \\
\hat{y}_n \\
\end{bmatrix}

-

\begin{bmatrix}
y_1 \\
\vdots \\
y_n
\end{bmatrix}

=

\begin{bmatrix}
\hat{y}_1 - y_1 \\
\vdots \\
\hat{y}_n - y_n \\
\end{bmatrix}
\\
&amp;=
\begin{bmatrix}
0.997 \\
0.998 \\
0.999 \\
0.998 \\
0.999 \\
0.999
\end{bmatrix}
-
\begin{bmatrix}
0 \\
1 \\
1 \\
0 \\
0 \\
1
\end{bmatrix}
=
\begin{bmatrix}
0.997  \\
-0.002 \\
-0.001 \\
0.998  \\
0.999  \\
-0.001
\end{bmatrix}
\end{align*}\]</span></p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"(y_hat) - y:</span><span class="ch">\n</span><span class="st">"</span>, NN.y_hat<span class="op">-</span>NN.y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(y_hat) - y:
 [[ 0.99684928]
 [-0.00184086]
 [-0.00104239]
 [ 0.99801874]
 [ 0.99905873]
 [-0.0012948 ]]</code></pre>
</div>
</div>
<p><span class="math display">\[\begin{align*}
\Rightarrow
L  \frac{1}{n} \displaystyle \sum_i^n (\hat{y}_i - y_i)^2
\approx 0.498
\end{align*}\]</span></p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MSE Loss:"</span>,NN.MSE_loss(y_hat<span class="op">=</span>NN.y_hat,y<span class="op">=</span>NN.y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MSE Loss: 0.4979790666878168</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="writing-out-the-derivatives-by-hand." class="level1">
<h1>4) Writing out the derivatives by hand.</h1>
<p>For this part and in order to help you to code the back propagation, write out the derivatives for updating <span class="math inline">\(\mathbf{W_1}\)</span>, <span class="math inline">\(\mathbf{W_2}\)</span>, <span class="math inline">\(\mathbf{B}\)</span>, and <span class="math inline">\(C\)</span>.</p>
<p>Please write them clearly :)</p>
<p>You can do this “matrix style” - so for example, <span class="math inline">\(\frac{\partial L}{\partial \mathbf{W_1}}\)</span>, or you can write them out individually, such as <span class="math inline">\(\frac{\partial L}{dw_{11}}\)</span>, <span class="math inline">\(\frac{\partial L}{\partial w_{12}}\)</span>, etc…</p>
<p>Either way, show all your work and illustrate how the matrices (such as <span class="math inline">\(\mathbf{X}\)</span>, <span class="math inline">\(\mathbf{W_1}\)</span>, <span class="math inline">\(\mathbf{W_2}\)</span>, etc. etc.) will all fit together to create the final derivative.</p>
<p><strong>Hints:</strong> There are many examples on the PowerPoints. We reviewed this in class. You can also see examples of this in my code examples which are all here: <a href="https://gatesboltonanalytics.com/?page_id=680">Gates Bolton Analytics - Neural Networks Page</a></p>
<p><strong><em>JK answer:</em></strong></p>
</section>
<section id="adding-back-propagation-to-your-code-so-that-mathbfw_1-mathbfb-and-c-are-updated." class="level1">
<h1>5) Adding Back Propagation to your code so that <span class="math inline">\(\mathbf{W_1}\)</span>, <span class="math inline">\(\mathbf{B}\)</span>, and <span class="math inline">\(C\)</span> are updated.</h1>
<p>For this step, you will add back propagation to your code. Specifically, you already have code <strong>(2)</strong> above. In your code (so far) you have read in your dataset, have created <span class="math inline">\(X\)</span> and <span class="math inline">\(y\)</span>, and have function (or class if you OO programming) for Feed Forward.</p>
<p>In this next step, you will add a function for Back Propagation that will update your parameters. Recall that the parameters for this NN architecture are <span class="math inline">\(\mathbf{W_1}\)</span>, <span class="math inline">\(\mathbf{W_2}\)</span>, <span class="math inline">\(\mathbf{B}\)</span>, and <span class="math inline">\(C\)</span>. Each must be updated (using a learning rate) and the derivatives you calculated in <strong>(4)</strong>.</p>
<p>Once you create code for the Back Propagation, add further code for epochs so that your code will “update” (FF and BP and calculate the Loss each time) for as many iterations (epochs) as you wish.</p>
<p>Be sure to have a visualization of the change in the average Loss over epochs.</p>
<p>Be sure to have a final visualization that is a confusion matrix that shows the label predictions.</p>
<p>Be sure to <strong>print out</strong> some of your matrices so that a viewer can see what you are doing. While there are many ways to do this, you can consider printing <span class="math inline">\(\mathbf{W_1}\)</span>, the updates for <span class="math inline">\(\mathbf{W_1}\)</span>, the new <span class="math inline">\(\mathbf{W_1}\)</span> (which will be the derivative updates times the learning rate added to <span class="math inline">\(\mathbf{W_1}\)</span>). In other words, <strong>make your code verbose (shows/tells what its doing)</strong> so you can print out the last epoch steps. (An example on Canvas)</p>
<p><strong>NOTE:</strong> At this point, you should have code that will read in any dataset with 3 columns of numeric data and one column called “LABEL” (of <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>) and will perform NN modeling and a prediction result on the dataset.</p>
<p><strong><em>JK answer:</em></strong></p>
</section>
<section id="test-model" class="level1">
<h1>6) Test model</h1>
<p>Finally, create a test dataset and use your model to predict the labels of that test dataset. Then create a confusion matrix to show the prediction accuracy. Remember, to do this you will need labeled data, BUT you will remove the labels from the data before trying to predict it. Once the model makes predictions, you can then compare the predictions to the actual labels.</p>
<ol type="1">
<li><p>EXPLAIN in words what you plan to do</p></li>
<li><p>Code it</p></li>
<li><p>Give the results as a confusion matrix</p></li>
<li><p>Include your test dataset with your submission.</p></li>
</ol>
<p><strong><em>JK answer:</em></strong></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>