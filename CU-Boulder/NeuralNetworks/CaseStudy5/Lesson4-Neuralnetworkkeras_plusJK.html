<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sanchit Tanwar (JK edited some parts)">

<title>First Neural Network in Keras</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Lesson4-Neuralnetworkkeras_plusJK_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lesson4-Neuralnetworkkeras_plusJK_files/libs/quarto-html/quarto.js"></script>
<script src="Lesson4-Neuralnetworkkeras_plusJK_files/libs/quarto-html/popper.min.js"></script>
<script src="Lesson4-Neuralnetworkkeras_plusJK_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lesson4-Neuralnetworkkeras_plusJK_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lesson4-Neuralnetworkkeras_plusJK_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lesson4-Neuralnetworkkeras_plusJK_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lesson4-Neuralnetworkkeras_plusJK_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lesson4-Neuralnetworkkeras_plusJK_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lesson4-Neuralnetworkkeras_plusJK_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#first-neural-network-in-keras" id="toc-first-neural-network-in-keras" class="nav-link active" data-scroll-target="#first-neural-network-in-keras">First neural network in keras</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">First Neural Network in Keras</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sanchit Tanwar (JK edited some parts) </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="first-neural-network-in-keras" class="level3">
<h3 class="anchored" data-anchor-id="first-neural-network-in-keras">First neural network in keras</h3>
<p>We will use simple data of mobile price range classifier. The dataset consists of 20 features and we need to predict the price range in which phone lies. These ranges are divided into 4 classes. <br> Link to dataset - https://www.kaggle.com/iabhishekofficial/mobile-price-classification <br> Link to blog -</p>
<div class="cell" data-scrolled="true" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#dataset import</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> pd.read_csv(<span class="st">'data/train.csv'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>dataset.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">battery_power</th>
<th data-quarto-table-cell-role="th">blue</th>
<th data-quarto-table-cell-role="th">clock_speed</th>
<th data-quarto-table-cell-role="th">dual_sim</th>
<th data-quarto-table-cell-role="th">fc</th>
<th data-quarto-table-cell-role="th">four_g</th>
<th data-quarto-table-cell-role="th">int_memory</th>
<th data-quarto-table-cell-role="th">m_dep</th>
<th data-quarto-table-cell-role="th">mobile_wt</th>
<th data-quarto-table-cell-role="th">n_cores</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">px_height</th>
<th data-quarto-table-cell-role="th">px_width</th>
<th data-quarto-table-cell-role="th">ram</th>
<th data-quarto-table-cell-role="th">sc_h</th>
<th data-quarto-table-cell-role="th">sc_w</th>
<th data-quarto-table-cell-role="th">talk_time</th>
<th data-quarto-table-cell-role="th">three_g</th>
<th data-quarto-table-cell-role="th">touch_screen</th>
<th data-quarto-table-cell-role="th">wifi</th>
<th data-quarto-table-cell-role="th">price_range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>842</td>
<td>0</td>
<td>2.2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>7</td>
<td>0.6</td>
<td>188</td>
<td>2</td>
<td>...</td>
<td>20</td>
<td>756</td>
<td>2549</td>
<td>9</td>
<td>7</td>
<td>19</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1021</td>
<td>1</td>
<td>0.5</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>53</td>
<td>0.7</td>
<td>136</td>
<td>3</td>
<td>...</td>
<td>905</td>
<td>1988</td>
<td>2631</td>
<td>17</td>
<td>3</td>
<td>7</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>563</td>
<td>1</td>
<td>0.5</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>41</td>
<td>0.9</td>
<td>145</td>
<td>5</td>
<td>...</td>
<td>1263</td>
<td>1716</td>
<td>2603</td>
<td>11</td>
<td>2</td>
<td>9</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>615</td>
<td>1</td>
<td>2.5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>10</td>
<td>0.8</td>
<td>131</td>
<td>6</td>
<td>...</td>
<td>1216</td>
<td>1786</td>
<td>2769</td>
<td>16</td>
<td>8</td>
<td>11</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1821</td>
<td>1</td>
<td>1.2</td>
<td>0</td>
<td>13</td>
<td>1</td>
<td>44</td>
<td>0.6</td>
<td>141</td>
<td>2</td>
<td>...</td>
<td>1208</td>
<td>1212</td>
<td>1411</td>
<td>8</td>
<td>2</td>
<td>15</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1859</td>
<td>0</td>
<td>0.5</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>22</td>
<td>0.7</td>
<td>164</td>
<td>1</td>
<td>...</td>
<td>1004</td>
<td>1654</td>
<td>1067</td>
<td>17</td>
<td>1</td>
<td>10</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>1821</td>
<td>0</td>
<td>1.7</td>
<td>0</td>
<td>4</td>
<td>1</td>
<td>10</td>
<td>0.8</td>
<td>139</td>
<td>8</td>
<td>...</td>
<td>381</td>
<td>1018</td>
<td>3220</td>
<td>13</td>
<td>8</td>
<td>18</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>1954</td>
<td>0</td>
<td>0.5</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>24</td>
<td>0.8</td>
<td>187</td>
<td>4</td>
<td>...</td>
<td>512</td>
<td>1149</td>
<td>700</td>
<td>16</td>
<td>3</td>
<td>5</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>1445</td>
<td>1</td>
<td>0.5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>53</td>
<td>0.7</td>
<td>174</td>
<td>7</td>
<td>...</td>
<td>386</td>
<td>836</td>
<td>1099</td>
<td>17</td>
<td>1</td>
<td>20</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>509</td>
<td>1</td>
<td>0.6</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>9</td>
<td>0.1</td>
<td>93</td>
<td>5</td>
<td>...</td>
<td>1137</td>
<td>1224</td>
<td>513</td>
<td>19</td>
<td>10</td>
<td>12</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>10 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dataset.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>Index(['battery_power', 'blue', 'clock_speed', 'dual_sim', 'fc', 'four_g',
       'int_memory', 'm_dep', 'mobile_wt', 'n_cores', 'pc', 'px_height',
       'px_width', 'ram', 'sc_h', 'sc_w', 'talk_time', 'three_g',
       'touch_screen', 'wifi', 'price_range'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Changing pandas dataframe to numpy array</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> dataset.iloc[:,:<span class="dv">20</span>].values</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> dataset.iloc[:,<span class="dv">20</span>:<span class="dv">21</span>].values</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#One hot encode</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>ohe <span class="op">=</span> OneHotEncoder()</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> ohe.fit_transform(y).toarray()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'One hot encoded array:'</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y[<span class="dv">0</span>:<span class="dv">5</span>])</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Train test split of model</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>X_train,X_test,y_train,y_test <span class="op">=</span> train_test_split(X,y,test_size <span class="op">=</span> <span class="fl">0.1</span>,random_state <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Normalizing the data</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>sc <span class="op">=</span> StandardScaler()</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> sc.fit_transform(X_train)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> sc.transform(X_test)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Normalized data:'</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train[<span class="dv">0</span>])</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_test[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>One hot encoded array:
[[0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 1. 0.]
 [0. 0. 1. 0.]
 [0. 1. 0. 0.]]
Normalized data:
[-0.5390358   1.02589061 -1.26199175 -1.01793865  1.78495109 -1.0327585
  1.70200842  0.69159324  1.11448677  1.5240457   1.34736843  1.98951834
  1.16224611  1.51509727 -0.32332484 -1.09870945 -0.73208384 -1.77142063
 -1.00333891  0.99115027]
[ 0.49007136  1.02589061 -1.26199175  0.98237747 -0.758373   -1.0327585
  0.11029193  0.69159324 -1.61046602 -0.23362354 -1.13465024 -0.89856997
 -0.51391173  1.21460218 -1.27622653 -0.18407099 -1.09746604  0.56451866
  0.9966722  -1.00892875]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> keras</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-11-26 16:30:45.068078: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-26 16:30:45.122120: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">16</span>, input_dim<span class="op">=</span><span class="dv">20</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">12</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">4</span>, activation<span class="op">=</span><span class="st">'softmax'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-11-26 16:30:47.312485: E tensorflow/compiler/xla/stream_executor/cuda/cuda_driver.cc:266] failed call to cuInit: UNKNOWN ERROR (100)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To visualize neural network</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (None, 16)                336       
                                                                 
 dense_1 (Dense)             (None, 12)                204       
                                                                 
 dense_2 (Dense)             (None, 4)                 52        
                                                                 
=================================================================
Total params: 592
Trainable params: 592
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'categorical_crossentropy'</span>, optimizer<span class="op">=</span><span class="st">'adam'</span>, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(X, y, epochs<span class="op">=</span><span class="dv">100</span>, batch_size<span class="op">=</span><span class="dv">64</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/100
32/32 [==============================] - 1s 3ms/step - loss: 226.6462 - accuracy: 0.2255
Epoch 2/100
32/32 [==============================] - 0s 3ms/step - loss: 64.7195 - accuracy: 0.3305
Epoch 3/100
32/32 [==============================] - 0s 3ms/step - loss: 42.0689 - accuracy: 0.3615
Epoch 4/100
32/32 [==============================] - 0s 2ms/step - loss: 31.1793 - accuracy: 0.4215
Epoch 5/100
32/32 [==============================] - 0s 2ms/step - loss: 23.2212 - accuracy: 0.4390
Epoch 6/100
32/32 [==============================] - 0s 2ms/step - loss: 17.4432 - accuracy: 0.4620
Epoch 7/100
32/32 [==============================] - 0s 2ms/step - loss: 13.9453 - accuracy: 0.4810
Epoch 8/100
32/32 [==============================] - 0s 2ms/step - loss: 12.0224 - accuracy: 0.4915
Epoch 9/100
32/32 [==============================] - 0s 2ms/step - loss: 10.2798 - accuracy: 0.4785
Epoch 10/100
32/32 [==============================] - 0s 2ms/step - loss: 8.6972 - accuracy: 0.4950
Epoch 11/100
32/32 [==============================] - 0s 3ms/step - loss: 7.7168 - accuracy: 0.4920
Epoch 12/100
32/32 [==============================] - 0s 2ms/step - loss: 6.6590 - accuracy: 0.5125
Epoch 13/100
32/32 [==============================] - 0s 2ms/step - loss: 6.2088 - accuracy: 0.5100
Epoch 14/100
32/32 [==============================] - 0s 3ms/step - loss: 5.3597 - accuracy: 0.5215
Epoch 15/100
32/32 [==============================] - 0s 2ms/step - loss: 4.8983 - accuracy: 0.5255
Epoch 16/100
32/32 [==============================] - 0s 3ms/step - loss: 4.3311 - accuracy: 0.5310
Epoch 17/100
32/32 [==============================] - 0s 2ms/step - loss: 4.8607 - accuracy: 0.5080
Epoch 18/100
32/32 [==============================] - 0s 2ms/step - loss: 4.1195 - accuracy: 0.5340
Epoch 19/100
32/32 [==============================] - 0s 2ms/step - loss: 3.8093 - accuracy: 0.5295
Epoch 20/100
32/32 [==============================] - 0s 2ms/step - loss: 3.5667 - accuracy: 0.5315
Epoch 21/100
32/32 [==============================] - 0s 2ms/step - loss: 2.9148 - accuracy: 0.5560
Epoch 22/100
32/32 [==============================] - 0s 2ms/step - loss: 2.6710 - accuracy: 0.5535
Epoch 23/100
32/32 [==============================] - 0s 2ms/step - loss: 2.4765 - accuracy: 0.5640
Epoch 24/100
32/32 [==============================] - 0s 2ms/step - loss: 2.5533 - accuracy: 0.5520
Epoch 25/100
32/32 [==============================] - 0s 2ms/step - loss: 2.4485 - accuracy: 0.5450
Epoch 26/100
32/32 [==============================] - 0s 2ms/step - loss: 2.0887 - accuracy: 0.5735
Epoch 27/100
32/32 [==============================] - 0s 2ms/step - loss: 2.1019 - accuracy: 0.5610
Epoch 28/100
32/32 [==============================] - 0s 3ms/step - loss: 1.7082 - accuracy: 0.5975
Epoch 29/100
32/32 [==============================] - 0s 2ms/step - loss: 1.7380 - accuracy: 0.5845
Epoch 30/100
32/32 [==============================] - 0s 2ms/step - loss: 1.6994 - accuracy: 0.5870
Epoch 31/100
32/32 [==============================] - 0s 4ms/step - loss: 1.6105 - accuracy: 0.5920
Epoch 32/100
32/32 [==============================] - 0s 2ms/step - loss: 1.6166 - accuracy: 0.5880
Epoch 33/100
32/32 [==============================] - 0s 2ms/step - loss: 1.7504 - accuracy: 0.5760
Epoch 34/100
32/32 [==============================] - 0s 2ms/step - loss: 1.5842 - accuracy: 0.5820
Epoch 35/100
32/32 [==============================] - 0s 2ms/step - loss: 1.2622 - accuracy: 0.6230
Epoch 36/100
32/32 [==============================] - 0s 3ms/step - loss: 1.1901 - accuracy: 0.6170
Epoch 37/100
32/32 [==============================] - 0s 2ms/step - loss: 1.3403 - accuracy: 0.6190
Epoch 38/100
32/32 [==============================] - 0s 2ms/step - loss: 1.4143 - accuracy: 0.6000
Epoch 39/100
32/32 [==============================] - 0s 2ms/step - loss: 1.0787 - accuracy: 0.6420
Epoch 40/100
32/32 [==============================] - 0s 2ms/step - loss: 1.2755 - accuracy: 0.6010
Epoch 41/100
32/32 [==============================] - 0s 2ms/step - loss: 2.1497 - accuracy: 0.5615
Epoch 42/100
32/32 [==============================] - 0s 3ms/step - loss: 1.4324 - accuracy: 0.6000
Epoch 43/100
32/32 [==============================] - 0s 3ms/step - loss: 0.9968 - accuracy: 0.6465
Epoch 44/100
32/32 [==============================] - 0s 2ms/step - loss: 1.1046 - accuracy: 0.6400
Epoch 45/100
32/32 [==============================] - 0s 3ms/step - loss: 1.1456 - accuracy: 0.6280
Epoch 46/100
32/32 [==============================] - 0s 3ms/step - loss: 1.4660 - accuracy: 0.6250
Epoch 47/100
32/32 [==============================] - 0s 3ms/step - loss: 1.3082 - accuracy: 0.6245
Epoch 48/100
32/32 [==============================] - 0s 3ms/step - loss: 1.1148 - accuracy: 0.6315
Epoch 49/100
32/32 [==============================] - 0s 3ms/step - loss: 1.3048 - accuracy: 0.6265
Epoch 50/100
32/32 [==============================] - 0s 2ms/step - loss: 0.9404 - accuracy: 0.6540
Epoch 51/100
32/32 [==============================] - 0s 2ms/step - loss: 0.9561 - accuracy: 0.6465
Epoch 52/100
32/32 [==============================] - 0s 2ms/step - loss: 1.0383 - accuracy: 0.6400
Epoch 53/100
32/32 [==============================] - 0s 4ms/step - loss: 1.1537 - accuracy: 0.6430
Epoch 54/100
32/32 [==============================] - 0s 3ms/step - loss: 1.1241 - accuracy: 0.6410
Epoch 55/100
32/32 [==============================] - 0s 3ms/step - loss: 0.9747 - accuracy: 0.6550
Epoch 56/100
32/32 [==============================] - 0s 2ms/step - loss: 1.0523 - accuracy: 0.6345
Epoch 57/100
32/32 [==============================] - 0s 2ms/step - loss: 1.1075 - accuracy: 0.6395
Epoch 58/100
32/32 [==============================] - 0s 2ms/step - loss: 1.0992 - accuracy: 0.6425
Epoch 59/100
32/32 [==============================] - 0s 2ms/step - loss: 1.0079 - accuracy: 0.6440
Epoch 60/100
32/32 [==============================] - 0s 4ms/step - loss: 1.0070 - accuracy: 0.6395
Epoch 61/100
32/32 [==============================] - 0s 4ms/step - loss: 0.9814 - accuracy: 0.6520
Epoch 62/100
32/32 [==============================] - 0s 5ms/step - loss: 1.0108 - accuracy: 0.6370
Epoch 63/100
32/32 [==============================] - 0s 5ms/step - loss: 1.0010 - accuracy: 0.6460
Epoch 64/100
32/32 [==============================] - 0s 6ms/step - loss: 1.2416 - accuracy: 0.6180
Epoch 65/100
32/32 [==============================] - 0s 4ms/step - loss: 0.9534 - accuracy: 0.6555
Epoch 66/100
32/32 [==============================] - 0s 3ms/step - loss: 0.7988 - accuracy: 0.6820
Epoch 67/100
32/32 [==============================] - 0s 3ms/step - loss: 0.9509 - accuracy: 0.6455
Epoch 68/100
32/32 [==============================] - 0s 3ms/step - loss: 0.8774 - accuracy: 0.6655
Epoch 69/100
32/32 [==============================] - 0s 2ms/step - loss: 0.9104 - accuracy: 0.6730
Epoch 70/100
32/32 [==============================] - 0s 2ms/step - loss: 0.9801 - accuracy: 0.6415
Epoch 71/100
32/32 [==============================] - 0s 3ms/step - loss: 1.0690 - accuracy: 0.6350
Epoch 72/100
32/32 [==============================] - 0s 3ms/step - loss: 0.9068 - accuracy: 0.6660
Epoch 73/100
32/32 [==============================] - 0s 2ms/step - loss: 0.9380 - accuracy: 0.6545
Epoch 74/100
32/32 [==============================] - 0s 2ms/step - loss: 1.0616 - accuracy: 0.6385
Epoch 75/100
32/32 [==============================] - 0s 2ms/step - loss: 1.1824 - accuracy: 0.6215
Epoch 76/100
32/32 [==============================] - 0s 2ms/step - loss: 1.0018 - accuracy: 0.6470
Epoch 77/100
32/32 [==============================] - 0s 2ms/step - loss: 1.0310 - accuracy: 0.6700
Epoch 78/100
32/32 [==============================] - 0s 2ms/step - loss: 0.9614 - accuracy: 0.6540
Epoch 79/100
32/32 [==============================] - 0s 2ms/step - loss: 1.3280 - accuracy: 0.6225
Epoch 80/100
32/32 [==============================] - 0s 3ms/step - loss: 1.2471 - accuracy: 0.6155
Epoch 81/100
32/32 [==============================] - 0s 3ms/step - loss: 1.1953 - accuracy: 0.6505
Epoch 82/100
32/32 [==============================] - 0s 2ms/step - loss: 0.8137 - accuracy: 0.6815
Epoch 83/100
32/32 [==============================] - 0s 2ms/step - loss: 0.9383 - accuracy: 0.6585
Epoch 84/100
32/32 [==============================] - 0s 2ms/step - loss: 0.8368 - accuracy: 0.6790
Epoch 85/100
32/32 [==============================] - 0s 3ms/step - loss: 1.0162 - accuracy: 0.6480
Epoch 86/100
32/32 [==============================] - 0s 3ms/step - loss: 0.7870 - accuracy: 0.6915
Epoch 87/100
32/32 [==============================] - 0s 2ms/step - loss: 1.0061 - accuracy: 0.6540
Epoch 88/100
32/32 [==============================] - 0s 2ms/step - loss: 1.0010 - accuracy: 0.6485
Epoch 89/100
32/32 [==============================] - 0s 2ms/step - loss: 0.7245 - accuracy: 0.7020
Epoch 90/100
32/32 [==============================] - 0s 2ms/step - loss: 0.8457 - accuracy: 0.6860
Epoch 91/100
32/32 [==============================] - 0s 3ms/step - loss: 0.8995 - accuracy: 0.6705
Epoch 92/100
32/32 [==============================] - 0s 2ms/step - loss: 1.0980 - accuracy: 0.6425
Epoch 93/100
32/32 [==============================] - 0s 4ms/step - loss: 0.8930 - accuracy: 0.6660
Epoch 94/100
32/32 [==============================] - 0s 2ms/step - loss: 0.7972 - accuracy: 0.6930
Epoch 95/100
32/32 [==============================] - 0s 2ms/step - loss: 0.9527 - accuracy: 0.6560
Epoch 96/100
32/32 [==============================] - 0s 2ms/step - loss: 1.1284 - accuracy: 0.6490
Epoch 97/100
32/32 [==============================] - 0s 2ms/step - loss: 0.8463 - accuracy: 0.6750
Epoch 98/100
32/32 [==============================] - 0s 2ms/step - loss: 0.7647 - accuracy: 0.6955
Epoch 99/100
32/32 [==============================] - 0s 2ms/step - loss: 0.9142 - accuracy: 0.6645
Epoch 100/100
32/32 [==============================] - 0s 2ms/step - loss: 0.8664 - accuracy: 0.6700</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting predictions to label</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y_pred)):</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    pred.append(np.argmax(y_pred[i]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>7/7 [==============================] - 0s 2ms/step</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting one hot encoded test label to label</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(y_test)):</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    test.append(np.argmax(y_test[i]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> accuracy_score(pred,test)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy is:'</span>, a<span class="op">*</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy is: 21.5</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Using test data as validation data.</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>history1 <span class="op">=</span> model.fit(X_train, y_train,validation_data <span class="op">=</span> (X_test,y_test), epochs<span class="op">=</span><span class="dv">100</span>, batch_size<span class="op">=</span><span class="dv">64</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/100
21/29 [====================&gt;.........] - ETA: 0s - loss: 1.7680 - accuracy: 0.260429/29 [==============================] - 0s 11ms/step - loss: 1.7193 - accuracy: 0.2644 - val_loss: 1.6326 - val_accuracy: 0.2300
Epoch 2/100
29/29 [==============================] - 0s 5ms/step - loss: 1.4492 - accuracy: 0.2994 - val_loss: 1.3974 - val_accuracy: 0.3450
Epoch 3/100
29/29 [==============================] - 0s 6ms/step - loss: 1.2729 - accuracy: 0.3767 - val_loss: 1.2510 - val_accuracy: 0.4150
Epoch 4/100
29/29 [==============================] - 0s 6ms/step - loss: 1.1105 - accuracy: 0.4822 - val_loss: 1.0713 - val_accuracy: 0.4950
Epoch 5/100
29/29 [==============================] - 0s 6ms/step - loss: 0.9564 - accuracy: 0.5744 - val_loss: 0.9102 - val_accuracy: 0.6400
Epoch 6/100
29/29 [==============================] - 0s 3ms/step - loss: 0.8300 - accuracy: 0.6594 - val_loss: 0.7801 - val_accuracy: 0.7250
Epoch 7/100
29/29 [==============================] - 0s 2ms/step - loss: 0.7318 - accuracy: 0.7194 - val_loss: 0.6813 - val_accuracy: 0.7700
Epoch 8/100
29/29 [==============================] - 0s 3ms/step - loss: 0.6504 - accuracy: 0.7644 - val_loss: 0.6041 - val_accuracy: 0.8000
Epoch 9/100
29/29 [==============================] - 0s 6ms/step - loss: 0.5836 - accuracy: 0.7878 - val_loss: 0.5393 - val_accuracy: 0.8200
Epoch 10/100
29/29 [==============================] - 0s 6ms/step - loss: 0.5281 - accuracy: 0.8111 - val_loss: 0.4870 - val_accuracy: 0.8450
Epoch 11/100
29/29 [==============================] - 0s 3ms/step - loss: 0.4813 - accuracy: 0.8511 - val_loss: 0.4380 - val_accuracy: 0.8800
Epoch 12/100
29/29 [==============================] - 0s 3ms/step - loss: 0.4410 - accuracy: 0.8633 - val_loss: 0.4047 - val_accuracy: 0.8800
Epoch 13/100
29/29 [==============================] - 0s 6ms/step - loss: 0.4093 - accuracy: 0.8733 - val_loss: 0.3745 - val_accuracy: 0.8950
Epoch 14/100
29/29 [==============================] - 0s 6ms/step - loss: 0.3822 - accuracy: 0.8789 - val_loss: 0.3533 - val_accuracy: 0.9000
Epoch 15/100
29/29 [==============================] - 0s 3ms/step - loss: 0.3603 - accuracy: 0.8944 - val_loss: 0.3291 - val_accuracy: 0.8950
Epoch 16/100
29/29 [==============================] - 0s 3ms/step - loss: 0.3391 - accuracy: 0.9006 - val_loss: 0.3137 - val_accuracy: 0.8850
Epoch 17/100
29/29 [==============================] - 0s 3ms/step - loss: 0.3214 - accuracy: 0.9017 - val_loss: 0.2975 - val_accuracy: 0.9000
Epoch 18/100
29/29 [==============================] - 0s 3ms/step - loss: 0.3052 - accuracy: 0.9083 - val_loss: 0.2828 - val_accuracy: 0.9000
Epoch 19/100
29/29 [==============================] - 0s 4ms/step - loss: 0.2921 - accuracy: 0.9117 - val_loss: 0.2781 - val_accuracy: 0.9100
Epoch 20/100
29/29 [==============================] - 0s 7ms/step - loss: 0.2796 - accuracy: 0.9206 - val_loss: 0.2620 - val_accuracy: 0.9200
Epoch 21/100
29/29 [==============================] - 0s 5ms/step - loss: 0.2682 - accuracy: 0.9194 - val_loss: 0.2545 - val_accuracy: 0.9250
Epoch 22/100
29/29 [==============================] - 0s 4ms/step - loss: 0.2572 - accuracy: 0.9267 - val_loss: 0.2451 - val_accuracy: 0.9250
Epoch 23/100
29/29 [==============================] - 0s 4ms/step - loss: 0.2489 - accuracy: 0.9244 - val_loss: 0.2388 - val_accuracy: 0.9250
Epoch 24/100
29/29 [==============================] - 0s 4ms/step - loss: 0.2409 - accuracy: 0.9244 - val_loss: 0.2301 - val_accuracy: 0.9300
Epoch 25/100
29/29 [==============================] - 0s 3ms/step - loss: 0.2315 - accuracy: 0.9294 - val_loss: 0.2236 - val_accuracy: 0.9400
Epoch 26/100
29/29 [==============================] - 0s 4ms/step - loss: 0.2237 - accuracy: 0.9339 - val_loss: 0.2186 - val_accuracy: 0.9400
Epoch 27/100
29/29 [==============================] - 0s 3ms/step - loss: 0.2173 - accuracy: 0.9344 - val_loss: 0.2160 - val_accuracy: 0.9350
Epoch 28/100
29/29 [==============================] - 0s 3ms/step - loss: 0.2106 - accuracy: 0.9367 - val_loss: 0.2113 - val_accuracy: 0.9450
Epoch 29/100
29/29 [==============================] - 0s 3ms/step - loss: 0.2054 - accuracy: 0.9383 - val_loss: 0.2047 - val_accuracy: 0.9400
Epoch 30/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1995 - accuracy: 0.9361 - val_loss: 0.2035 - val_accuracy: 0.9350
Epoch 31/100
29/29 [==============================] - 0s 5ms/step - loss: 0.1946 - accuracy: 0.9406 - val_loss: 0.1969 - val_accuracy: 0.9400
Epoch 32/100
29/29 [==============================] - 0s 4ms/step - loss: 0.1875 - accuracy: 0.9433 - val_loss: 0.1960 - val_accuracy: 0.9400
Epoch 33/100
29/29 [==============================] - 0s 4ms/step - loss: 0.1837 - accuracy: 0.9422 - val_loss: 0.1908 - val_accuracy: 0.9450
Epoch 34/100
29/29 [==============================] - 0s 6ms/step - loss: 0.1795 - accuracy: 0.9494 - val_loss: 0.1901 - val_accuracy: 0.9300
Epoch 35/100
29/29 [==============================] - 0s 4ms/step - loss: 0.1754 - accuracy: 0.9500 - val_loss: 0.1864 - val_accuracy: 0.9400
Epoch 36/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1728 - accuracy: 0.9478 - val_loss: 0.1843 - val_accuracy: 0.9350
Epoch 37/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1690 - accuracy: 0.9483 - val_loss: 0.1776 - val_accuracy: 0.9400
Epoch 38/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1642 - accuracy: 0.9522 - val_loss: 0.1768 - val_accuracy: 0.9350
Epoch 39/100
29/29 [==============================] - 0s 4ms/step - loss: 0.1632 - accuracy: 0.9511 - val_loss: 0.1726 - val_accuracy: 0.9450
Epoch 40/100
29/29 [==============================] - 0s 5ms/step - loss: 0.1575 - accuracy: 0.9550 - val_loss: 0.1723 - val_accuracy: 0.9350
Epoch 41/100
29/29 [==============================] - 0s 6ms/step - loss: 0.1541 - accuracy: 0.9550 - val_loss: 0.1675 - val_accuracy: 0.9350
Epoch 42/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1526 - accuracy: 0.9544 - val_loss: 0.1653 - val_accuracy: 0.9400
Epoch 43/100
29/29 [==============================] - 0s 6ms/step - loss: 0.1481 - accuracy: 0.9550 - val_loss: 0.1632 - val_accuracy: 0.9400
Epoch 44/100
29/29 [==============================] - 0s 4ms/step - loss: 0.1457 - accuracy: 0.9561 - val_loss: 0.1614 - val_accuracy: 0.9400
Epoch 45/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1433 - accuracy: 0.9583 - val_loss: 0.1612 - val_accuracy: 0.9350
Epoch 46/100
29/29 [==============================] - 0s 6ms/step - loss: 0.1406 - accuracy: 0.9583 - val_loss: 0.1605 - val_accuracy: 0.9400
Epoch 47/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1380 - accuracy: 0.9600 - val_loss: 0.1587 - val_accuracy: 0.9350
Epoch 48/100
29/29 [==============================] - 0s 5ms/step - loss: 0.1363 - accuracy: 0.9600 - val_loss: 0.1582 - val_accuracy: 0.9350
Epoch 49/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1340 - accuracy: 0.9594 - val_loss: 0.1577 - val_accuracy: 0.9400
Epoch 50/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1313 - accuracy: 0.9622 - val_loss: 0.1526 - val_accuracy: 0.9500
Epoch 51/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1300 - accuracy: 0.9617 - val_loss: 0.1498 - val_accuracy: 0.9500
Epoch 52/100
29/29 [==============================] - 0s 4ms/step - loss: 0.1283 - accuracy: 0.9639 - val_loss: 0.1510 - val_accuracy: 0.9500
Epoch 53/100
29/29 [==============================] - 0s 7ms/step - loss: 0.1256 - accuracy: 0.9644 - val_loss: 0.1497 - val_accuracy: 0.9600
Epoch 54/100
29/29 [==============================] - 0s 4ms/step - loss: 0.1238 - accuracy: 0.9656 - val_loss: 0.1473 - val_accuracy: 0.9600
Epoch 55/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1221 - accuracy: 0.9661 - val_loss: 0.1446 - val_accuracy: 0.9600
Epoch 56/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1208 - accuracy: 0.9650 - val_loss: 0.1426 - val_accuracy: 0.9600
Epoch 57/100
29/29 [==============================] - 0s 6ms/step - loss: 0.1181 - accuracy: 0.9667 - val_loss: 0.1429 - val_accuracy: 0.9600
Epoch 58/100
29/29 [==============================] - 0s 5ms/step - loss: 0.1165 - accuracy: 0.9650 - val_loss: 0.1394 - val_accuracy: 0.9600
Epoch 59/100
29/29 [==============================] - 0s 5ms/step - loss: 0.1152 - accuracy: 0.9639 - val_loss: 0.1406 - val_accuracy: 0.9550
Epoch 60/100
29/29 [==============================] - 0s 6ms/step - loss: 0.1142 - accuracy: 0.9678 - val_loss: 0.1386 - val_accuracy: 0.9600
Epoch 61/100
29/29 [==============================] - 0s 4ms/step - loss: 0.1123 - accuracy: 0.9667 - val_loss: 0.1352 - val_accuracy: 0.9700
Epoch 62/100
29/29 [==============================] - 0s 5ms/step - loss: 0.1107 - accuracy: 0.9717 - val_loss: 0.1358 - val_accuracy: 0.9600
Epoch 63/100
29/29 [==============================] - 0s 4ms/step - loss: 0.1104 - accuracy: 0.9700 - val_loss: 0.1360 - val_accuracy: 0.9600
Epoch 64/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1091 - accuracy: 0.9644 - val_loss: 0.1356 - val_accuracy: 0.9550
Epoch 65/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1062 - accuracy: 0.9700 - val_loss: 0.1317 - val_accuracy: 0.9600
Epoch 66/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1057 - accuracy: 0.9689 - val_loss: 0.1331 - val_accuracy: 0.9550
Epoch 67/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1035 - accuracy: 0.9700 - val_loss: 0.1282 - val_accuracy: 0.9700
Epoch 68/100
29/29 [==============================] - 0s 3ms/step - loss: 0.1028 - accuracy: 0.9700 - val_loss: 0.1284 - val_accuracy: 0.9650
Epoch 69/100
29/29 [==============================] - 0s 5ms/step - loss: 0.1004 - accuracy: 0.9728 - val_loss: 0.1269 - val_accuracy: 0.9650
Epoch 70/100
29/29 [==============================] - 0s 7ms/step - loss: 0.0994 - accuracy: 0.9756 - val_loss: 0.1256 - val_accuracy: 0.9650
Epoch 71/100
29/29 [==============================] - 0s 5ms/step - loss: 0.0983 - accuracy: 0.9733 - val_loss: 0.1254 - val_accuracy: 0.9650
Epoch 72/100
29/29 [==============================] - 0s 4ms/step - loss: 0.0983 - accuracy: 0.9728 - val_loss: 0.1248 - val_accuracy: 0.9700
Epoch 73/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0958 - accuracy: 0.9750 - val_loss: 0.1241 - val_accuracy: 0.9650
Epoch 74/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0947 - accuracy: 0.9772 - val_loss: 0.1228 - val_accuracy: 0.9650
Epoch 75/100
29/29 [==============================] - 0s 6ms/step - loss: 0.0935 - accuracy: 0.9761 - val_loss: 0.1208 - val_accuracy: 0.9650
Epoch 76/100
29/29 [==============================] - 0s 6ms/step - loss: 0.0917 - accuracy: 0.9789 - val_loss: 0.1222 - val_accuracy: 0.9650
Epoch 77/100
29/29 [==============================] - 0s 5ms/step - loss: 0.0912 - accuracy: 0.9756 - val_loss: 0.1213 - val_accuracy: 0.9700
Epoch 78/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0899 - accuracy: 0.9772 - val_loss: 0.1194 - val_accuracy: 0.9700
Epoch 79/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0888 - accuracy: 0.9767 - val_loss: 0.1177 - val_accuracy: 0.9700
Epoch 80/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0888 - accuracy: 0.9783 - val_loss: 0.1217 - val_accuracy: 0.9650
Epoch 81/100
29/29 [==============================] - 0s 6ms/step - loss: 0.0869 - accuracy: 0.9806 - val_loss: 0.1258 - val_accuracy: 0.9500
Epoch 82/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0860 - accuracy: 0.9800 - val_loss: 0.1197 - val_accuracy: 0.9600
Epoch 83/100
29/29 [==============================] - 0s 4ms/step - loss: 0.0845 - accuracy: 0.9800 - val_loss: 0.1173 - val_accuracy: 0.9650
Epoch 84/100
29/29 [==============================] - 0s 6ms/step - loss: 0.0840 - accuracy: 0.9794 - val_loss: 0.1160 - val_accuracy: 0.9650
Epoch 85/100
29/29 [==============================] - 0s 5ms/step - loss: 0.0831 - accuracy: 0.9806 - val_loss: 0.1159 - val_accuracy: 0.9600
Epoch 86/100
29/29 [==============================] - 0s 6ms/step - loss: 0.0819 - accuracy: 0.9800 - val_loss: 0.1154 - val_accuracy: 0.9700
Epoch 87/100
29/29 [==============================] - 0s 5ms/step - loss: 0.0819 - accuracy: 0.9794 - val_loss: 0.1085 - val_accuracy: 0.9700
Epoch 88/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0804 - accuracy: 0.9806 - val_loss: 0.1118 - val_accuracy: 0.9600
Epoch 89/100
29/29 [==============================] - 0s 6ms/step - loss: 0.0798 - accuracy: 0.9761 - val_loss: 0.1100 - val_accuracy: 0.9700
Epoch 90/100
29/29 [==============================] - 0s 6ms/step - loss: 0.0806 - accuracy: 0.9806 - val_loss: 0.1138 - val_accuracy: 0.9650
Epoch 91/100
29/29 [==============================] - 0s 5ms/step - loss: 0.0781 - accuracy: 0.9800 - val_loss: 0.1128 - val_accuracy: 0.9650
Epoch 92/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0767 - accuracy: 0.9822 - val_loss: 0.1102 - val_accuracy: 0.9650
Epoch 93/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0762 - accuracy: 0.9822 - val_loss: 0.1105 - val_accuracy: 0.9600
Epoch 94/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0751 - accuracy: 0.9817 - val_loss: 0.1084 - val_accuracy: 0.9650
Epoch 95/100
29/29 [==============================] - 0s 5ms/step - loss: 0.0752 - accuracy: 0.9817 - val_loss: 0.1094 - val_accuracy: 0.9650
Epoch 96/100
29/29 [==============================] - 0s 5ms/step - loss: 0.0736 - accuracy: 0.9833 - val_loss: 0.1080 - val_accuracy: 0.9650
Epoch 97/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0735 - accuracy: 0.9839 - val_loss: 0.1087 - val_accuracy: 0.9600
Epoch 98/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0723 - accuracy: 0.9828 - val_loss: 0.1074 - val_accuracy: 0.9650
Epoch 99/100
29/29 [==============================] - 0s 4ms/step - loss: 0.0718 - accuracy: 0.9839 - val_loss: 0.1073 - val_accuracy: 0.9700
Epoch 100/100
29/29 [==============================] - 0s 3ms/step - loss: 0.0710 - accuracy: 0.9822 - val_loss: 0.1074 - val_accuracy: 0.9650</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history1.history[<span class="st">'accuracy'</span>])</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history1.history[<span class="st">'val_accuracy'</span>])</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Model accuracy'</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Accuracy'</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Train'</span>, <span class="st">'Test'</span>], loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Lesson4-Neuralnetworkkeras_plusJK_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history1.history[<span class="st">'loss'</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history1.history[<span class="st">'val_loss'</span>])</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Model loss'</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Train'</span>, <span class="st">'Test'</span>], loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Lesson4-Neuralnetworkkeras_plusJK_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>