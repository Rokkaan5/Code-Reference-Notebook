<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Python - Decision Trees (Part 1)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Python-DecisionTrees_files/libs/clipboard/clipboard.min.js"></script>
<script src="Python-DecisionTrees_files/libs/quarto-html/quarto.js"></script>
<script src="Python-DecisionTrees_files/libs/quarto-html/popper.min.js"></script>
<script src="Python-DecisionTrees_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Python-DecisionTrees_files/libs/quarto-html/anchor.min.js"></script>
<link href="Python-DecisionTrees_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Python-DecisionTrees_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Python-DecisionTrees_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Python-DecisionTrees_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Python-DecisionTrees_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#supervised-learning-example-code" id="toc-supervised-learning-example-code" class="nav-link active" data-scroll-target="#supervised-learning-example-code">Supervised Learning Example Code</a></li>
  <li><a href="#textmining-naive-bayes-example" id="toc-textmining-naive-bayes-example" class="nav-link" data-scroll-target="#textmining-naive-bayes-example">Textmining Naive Bayes Example</a></li>
  <li><a href="#use-nltks-porterstemmer-in-a-function" id="toc-use-nltks-porterstemmer-in-a-function" class="nav-link" data-scroll-target="#use-nltks-porterstemmer-in-a-function">Use NLTK’s PorterStemmer in a function</a></li>
  <li><a href="#stemming-and-lemming" id="toc-stemming-and-lemming" class="nav-link" data-scroll-target="#stemming-and-lemming">Stemming and Lemming</a></li>
  <li><a href="#vectorizing" id="toc-vectorizing" class="nav-link" data-scroll-target="#vectorizing">Vectorizing</a>
  <ul class="collapse">
  <li><a href="#new-dataframes" id="toc-new-dataframes" class="nav-link" data-scroll-target="#new-dataframes">New Dataframes</a></li>
  <li><a href="#dealing-with-nan" id="toc-dealing-with-nan" class="nav-link" data-scroll-target="#dealing-with-nan">Dealing with NaN</a></li>
  <li><a href="#remove-number-columns" id="toc-remove-number-columns" class="nav-link" data-scroll-target="#remove-number-columns">REMOVE number columns</a></li>
  </ul></li>
  <li><a href="#create-the-testing-set" id="toc-create-the-testing-set" class="nav-link" data-scroll-target="#create-the-testing-set">Create the testing set</a>
  <ul class="collapse">
  <li><a href="#for-all-four-dfs---separate-labels" id="toc-for-all-four-dfs---separate-labels" class="nav-link" data-scroll-target="#for-all-four-dfs---separate-labels">For all FOUR DFs - separate LABELS</a>
  <ul class="collapse">
  <li><a href="#test" id="toc-test" class="nav-link" data-scroll-target="#test">TEST</a></li>
  <li><a href="#train" id="toc-train" class="nav-link" data-scroll-target="#train">TRAIN</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#naive-bayes" id="toc-naive-bayes" class="nav-link" data-scroll-target="#naive-bayes">Naive Bayes</a>
  <ul class="collapse">
  <li><a href="#run-on-all-four-dfs." id="toc-run-on-all-four-dfs." class="nav-link" data-scroll-target="#run-on-all-four-dfs.">Run on all four Dfs.</a></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix">confusion matrix</a></li>
  </ul></li>
  <li><a href="#bernoulli" id="toc-bernoulli" class="nav-link" data-scroll-target="#bernoulli">Bernoulli</a></li>
  <li><a href="#decision-trees" id="toc-decision-trees" class="nav-link" data-scroll-target="#decision-trees">Decision Trees</a>
  <ul class="collapse">
  <li><a href="#confusion-matrix-visual-code-quickly-updated" id="toc-confusion-matrix-visual-code-quickly-updated" class="nav-link" data-scroll-target="#confusion-matrix-visual-code-quickly-updated">Confusion Matrix Visual Code (quickly updated)</a></li>
  <li><a href="#visualize-decision-trees-plotting-paired-surfaces" id="toc-visualize-decision-trees-plotting-paired-surfaces" class="nav-link" data-scroll-target="#visualize-decision-trees-plotting-paired-surfaces">Visualize Decision Trees plotting paired surfaces</a></li>
  </ul></li>
  <li><a href="#random-forest-for-text-data" id="toc-random-forest-for-text-data" class="nav-link" data-scroll-target="#random-forest-for-text-data">Random Forest for Text Data</a>
  <ul class="collapse">
  <li><a href="#vis-rf" id="toc-vis-rf" class="nav-link" data-scroll-target="#vis-rf">VIS RF</a>
  <ul class="collapse">
  <li><a href="#feature-names" id="toc-feature-names" class="nav-link" data-scroll-target="#feature-names">FEATURE NAMES</a></li>
  </ul></li>
  <li><a href="#feature-importance-in-rf" id="toc-feature-importance-in-rf" class="nav-link" data-scroll-target="#feature-importance-in-rf">Feature importance in RF</a>
  <ul class="collapse">
  <li><a href="#print-out-the-important-features" id="toc-print-out-the-important-features" class="nav-link" data-scroll-target="#print-out-the-important-features">print out the important features</a></li>
  <li><a href="#plot-the-top-10-features" id="toc-plot-the-top-10-features" class="nav-link" data-scroll-target="#plot-the-top-10-features">PLOT THE TOP 10 FEATURES</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#nn" id="toc-nn" class="nav-link" data-scroll-target="#nn">NN</a></li>
  <li><a href="#svm" id="toc-svm" class="nav-link" data-scroll-target="#svm">SVM</a>
  <ul class="collapse">
  <li><a href="#poly" id="toc-poly" class="nav-link" data-scroll-target="#poly">POLY</a></li>
  </ul></li>
  <li><a href="#visualizing-the-top-features" id="toc-visualizing-the-top-features" class="nav-link" data-scroll-target="#visualizing-the-top-features">Visualizing the top features</a>
  <ul class="collapse">
  <li><a href="#the-classes-of-the-training-data" id="toc-the-classes-of-the-training-data" class="nav-link" data-scroll-target="#the-classes-of-the-training-data">The classes of the training data</a>
  <ul class="collapse">
  <li><a href="#train-1" id="toc-train-1" class="nav-link" data-scroll-target="#train-1">TRAIN</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#equation-of-sep-line-in-2d" id="toc-equation-of-sep-line-in-2d" class="nav-link" data-scroll-target="#equation-of-sep-line-in-2d">Equation of sep line in 2D</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Python - Decision Trees (Part 1)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="supervised-learning-example-code" class="level1">
<h1>Supervised Learning Example Code</h1>
<ul>
<li>Naive Bayes</li>
<li>Bernoulli</li>
</ul>
<p><strong>Note 1:</strong> It is better to make your own data and update the code for YOUR data.</p>
<p><strong>Note 2:</strong> This code focuses on text data but can easily be updated for record data.</p>
<p>Datasets (corpus) can be found HERE: - <a href="https://drive.google.com/drive/folders/1UZSCzKyTKOOKqD2dPrmjIxS_IA9nnsDi?usp=sharing">DOG</a> - <a href="https://drive.google.com/drive/folders/141yq5AosVWiQSgk0fixcOn9RWIWmj2DH?usp=sharing">HIKE</a></p>
<p>Note that the other datasets for Record data are below in that section….</p>
</section>
<section id="textmining-naive-bayes-example" class="level1">
<h1>Textmining Naive Bayes Example</h1>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re  </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer, TfidfVectorizer</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.probability <span class="im">import</span> FreqDist</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">## For Stemming</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> sent_tokenize, word_tokenize</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random <span class="im">as</span> rd</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> MultinomialNB</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> BernoulliNB</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> tree</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">## conda install python-graphviz</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">## restart kernel (click the little red x next to the Console)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> graphviz </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, plot_tree</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> LinearSVC</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#from mpl_toolkits.mplot3d import Axes3D </span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">## conda install python-graphviz</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">## restart kernel (click the little red x next to the Console)</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> graphviz </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> export_graphviz</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co">#from sklearn.externals.six import StringIO  </span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image  </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co">## conda install pydotplus</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pydotplus</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co">#from nltk.stem import WordNetLemmatizer </span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co">#LEMMER = WordNetLemmatizer() </span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem.porter <span class="im">import</span> PorterStemmer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A <code>Stemmer</code> is a function that truncates and combines words such as hikings and hikers.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>STEMMER<span class="op">=</span>PorterStemmer()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(STEMMER.stem(<span class="st">"fishings"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fish</code></pre>
</div>
</div>
</section>
<section id="use-nltks-porterstemmer-in-a-function" class="level1">
<h1>Use NLTK’s PorterStemmer in a function</h1>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> MY_STEMMER(str_input):   <span class="co">#I like dogs a lot111 !!"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    words <span class="op">=</span> re.sub(<span class="vs">r"[^A-Za-z\-]"</span>, <span class="st">" "</span>, str_input).lower().split()   <span class="co"># I, like, dogs, a</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    words <span class="op">=</span> [STEMMER.stem(w) <span class="cf">for</span> w <span class="kw">in</span> words]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> words</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="stemming-and-lemming" class="level1">
<h1>Stemming and Lemming</h1>
<p>Stemming is different to Lemmatization in the approach it uses to produce root forms of words and the word produced.</p>
<p>!!! Stemming can result in words that are not actually words.</p>
<p>“trouble”, “troubling”, “troubled”, “troubles” …. all become “troubl”</p>
<p>Lemmatization is the process of grouping together the different inflected forms of a word so they can be analysed as a single item. Lemmatization is similar to stemming but it brings context to the words. So it links words with similar meaning to one word.</p>
</section>
<section id="vectorizing" class="level1">
<h1>Vectorizing</h1>
<p>Here, I am creating a few vectorizers - some with stemming and some without. One for Bernoulli, and some that normalize using Tf-Idf</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>MyVect_STEM<span class="op">=</span>CountVectorizer(<span class="bu">input</span><span class="op">=</span><span class="st">'filename'</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                        analyzer <span class="op">=</span> <span class="st">'word'</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                        stop_words<span class="op">=</span><span class="st">'english'</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                        <span class="co">##stop_words=["and", "or", "but"],</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#token_pattern='(?u)[a-zA-Z]+',</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#token_pattern=pattern,</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                        tokenizer<span class="op">=</span>MY_STEMMER,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#strip_accents = 'unicode', </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                        lowercase <span class="op">=</span> <span class="va">True</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>MyVect_STEM_Bern<span class="op">=</span>CountVectorizer(<span class="bu">input</span><span class="op">=</span><span class="st">'filename'</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                        analyzer <span class="op">=</span> <span class="st">'word'</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                        stop_words<span class="op">=</span><span class="st">'english'</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                        <span class="co">##stop_words=["and", "or", "but"],</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#token_pattern='(?u)[a-zA-Z]+',</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#token_pattern=pattern,</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                        tokenizer<span class="op">=</span>MY_STEMMER,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#strip_accents = 'unicode', </span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                        lowercase <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                        binary<span class="op">=</span><span class="va">True</span>    <span class="co">#  0 if the word is not in the doc  and a 1 if it is</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>MyVect_IFIDF<span class="op">=</span>TfidfVectorizer(<span class="bu">input</span><span class="op">=</span><span class="st">'filename'</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                        analyzer <span class="op">=</span> <span class="st">'word'</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                        stop_words<span class="op">=</span><span class="st">'english'</span>,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                        lowercase <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#binary=True</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>MyVect_IFIDF_STEM<span class="op">=</span>TfidfVectorizer(<span class="bu">input</span><span class="op">=</span><span class="st">'filename'</span>,</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>                        analyzer <span class="op">=</span> <span class="st">'word'</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                        stop_words<span class="op">=</span><span class="st">'english'</span>,</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                        tokenizer<span class="op">=</span>MY_STEMMER,</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#strip_accents = 'unicode', </span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>                        lowercase <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>                        <span class="co">#binary=True</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>                        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="new-dataframes" class="level2">
<h2 class="anchored" data-anchor-id="new-dataframes">New Dataframes</h2>
<p>We will be creating new data frames - one for NB and one for Bern.</p>
<p>These are the two new and currently empty DFs</p>
<p>Notice there are FOUR (4) of these because I have 4 vectorizers</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>FinalDF_STEM<span class="op">=</span>pd.DataFrame()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>FinalDF_STEM_Bern<span class="op">=</span>pd.DataFrame()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>FinalDF_TFIDF<span class="op">=</span>pd.DataFrame()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>FinalDF_TFIDF_STEM<span class="op">=</span>pd.DataFrame()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You will need to know where things are on your computer.</p>
<p>This code assumes that it is in the same folder/location as the folders DOG and HIKE. It will loop through the files in these two folders and will build the list needed to use <code>CounterVectorizer</code>.</p>
<p><strong>NOTICE:</strong> My loop has a path in it. This is for MY computer - not yours! You will need to adjust the path.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>os.getcwd()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>'C:\\Users\\rokka\\GH-repos\\GitHubPages\\Coding-References\\CUB-ML\\DecisionTrees\\Markdown'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name <span class="kw">in</span> [<span class="st">"DOG"</span>, <span class="st">"HIKE"</span>]:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    builder<span class="op">=</span>name<span class="op">+</span><span class="st">"DF"</span>    <span class="co">#DOGDF</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(builder)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    builderB<span class="op">=</span>name<span class="op">+</span><span class="st">"DFB"</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    path<span class="op">=</span> os.path.abspath(os.path.join(<span class="st">'../..'</span>,<span class="st">'data_files'</span>,name))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    FileList<span class="op">=</span>[]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> item <span class="kw">in</span> os.listdir(path):</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(path+ "\\" + item)</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        next1<span class="op">=</span>path<span class="op">+</span> <span class="st">"/"</span> <span class="op">+</span> item</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        FileList.append(next1)  </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"full list..."</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(FileList)</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">## Do for all three</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">## MyVect_STEM  and MyVect_IFIDF and MyVect_IFIDF_STEM</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        X1<span class="op">=</span>MyVect_STEM.fit_transform(FileList)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        X2<span class="op">=</span>MyVect_IFIDF.fit_transform(FileList)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        X3<span class="op">=</span>MyVect_IFIDF_STEM.fit_transform(FileList)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        XB<span class="op">=</span>MyVect_STEM_Bern.fit_transform(FileList)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>        ColumnNames1<span class="op">=</span>MyVect_STEM.get_feature_names_out()</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>        NumFeatures1<span class="op">=</span><span class="bu">len</span>(ColumnNames1)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        ColumnNames2<span class="op">=</span>MyVect_IFIDF.get_feature_names_out()</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        NumFeatures2<span class="op">=</span><span class="bu">len</span>(ColumnNames2)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        ColumnNames3<span class="op">=</span>MyVect_IFIDF_STEM.get_feature_names_out()</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        NumFeatures3<span class="op">=</span><span class="bu">len</span>(ColumnNames3)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        ColumnNamesB<span class="op">=</span>MyVect_STEM_Bern.get_feature_names_out()</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        NumFeatures4<span class="op">=</span><span class="bu">len</span>(ColumnNamesB)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print("Column names: ", ColumnNames2)</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Create a name</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    builderS<span class="op">=</span>pd.DataFrame(X1.toarray(),columns<span class="op">=</span>ColumnNames1)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    builderT<span class="op">=</span>pd.DataFrame(X2.toarray(),columns<span class="op">=</span>ColumnNames2)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    builderTS<span class="op">=</span>pd.DataFrame(X3.toarray(),columns<span class="op">=</span>ColumnNames3)</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    builderB<span class="op">=</span>pd.DataFrame(XB.toarray(),columns<span class="op">=</span>ColumnNamesB)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Add column</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print("Adding new column....")</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    builderS[<span class="st">"Label"</span>]<span class="op">=</span>name</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    builderT[<span class="st">"Label"</span>]<span class="op">=</span>name</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    builderTS[<span class="st">"Label"</span>]<span class="op">=</span>name</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    builderB[<span class="st">"Label"</span>]<span class="op">=</span>name</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(builderS)</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    FinalDF_STEM<span class="op">=</span> FinalDF_STEM.append(builderS)</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    FinalDF_STEM_Bern<span class="op">=</span> FinalDF_STEM_Bern.append(builderB)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>    FinalDF_TFIDF<span class="op">=</span> FinalDF_TFIDF.append(builderT)</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>    FinalDF_TFIDF_STEM<span class="op">=</span> FinalDF_TFIDF_STEM.append(builderTS)</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(FinalDF_STEM.head())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>full list...
full list...
full list...
full list...
full list...
full list...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>full list...
full list...
full list...
full list...
full list...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\rokka\AppData\Local\r-miniconda\lib\site-packages\sklearn\feature_extraction\text.py:528: UserWarning: The parameter 'token_pattern' will not be used since 'tokenizer' is not None'
  warnings.warn(
C:\Users\rokka\AppData\Local\r-miniconda\lib\site-packages\sklearn\feature_extraction\text.py:409: UserWarning: Your stop_words may be inconsistent with your preprocessing. Tokenizing the stop words generated tokens ['abov', 'afterward', 'alon', 'alreadi', 'alway', 'ani', 'anoth', 'anyon', 'anyth', 'anywher', 'becam', 'becaus', 'becom', 'befor', 'besid', 'cri', 'describ', 'dure', 'els', 'elsewher', 'empti', 'everi', 'everyon', 'everyth', 'everywher', 'fifti', 'formerli', 'forti', 'ha', 'henc', 'hereaft', 'herebi', 'hi', 'howev', 'hundr', 'inde', 'latterli', 'mani', 'meanwhil', 'moreov', 'mostli', 'nobodi', 'noon', 'noth', 'nowher', 'onc', 'onli', 'otherwis', 'ourselv', 'perhap', 'pleas', 'seriou', 'sever', 'sinc', 'sincer', 'sixti', 'someon', 'someth', 'sometim', 'somewher', 'themselv', 'thenc', 'thereaft', 'therebi', 'therefor', 'thi', 'thu', 'togeth', 'twelv', 'twenti', 'veri', 'wa', 'whatev', 'whenc', 'whenev', 'wherea', 'whereaft', 'wherebi', 'wherev', 'whi', 'yourselv'] not in stop_words.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>full list...
full list...
full list...
full list...
full list...
full list...
full list...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\4268279061.py:50: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  FinalDF_STEM= FinalDF_STEM.append(builderS)
C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\4268279061.py:51: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  FinalDF_STEM_Bern= FinalDF_STEM_Bern.append(builderB)
C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\4268279061.py:52: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  FinalDF_TFIDF= FinalDF_TFIDF.append(builderT)
C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\4268279061.py:53: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  FinalDF_TFIDF_STEM= FinalDF_TFIDF_STEM.append(builderTS)
C:\Users\rokka\AppData\Local\r-miniconda\lib\site-packages\sklearn\feature_extraction\text.py:528: UserWarning: The parameter 'token_pattern' will not be used since 'tokenizer' is not None'
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>full list...
full list...
full list...
full list...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\4268279061.py:50: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  FinalDF_STEM= FinalDF_STEM.append(builderS)
C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\4268279061.py:51: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  FinalDF_STEM_Bern= FinalDF_STEM_Bern.append(builderB)
C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\4268279061.py:52: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  FinalDF_TFIDF= FinalDF_TFIDF.append(builderT)
C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\4268279061.py:53: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  FinalDF_TFIDF_STEM= FinalDF_TFIDF_STEM.append(builderTS)</code></pre>
</div>
</div>
</section>
<section id="dealing-with-nan" class="level2">
<h2 class="anchored" data-anchor-id="dealing-with-nan">Dealing with NaN</h2>
<p>Replace the NaN with 0 because it actually means none in this case</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>FinalDF_STEM<span class="op">=</span>FinalDF_STEM.fillna(<span class="dv">0</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>FinalDF_STEM_Bern<span class="op">=</span>FinalDF_STEM_Bern.fillna(<span class="dv">0</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>FinalDF_TFIDF<span class="op">=</span>FinalDF_TFIDF.fillna(<span class="dv">0</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>FinalDF_TFIDF_STEM<span class="op">=</span>FinalDF_TFIDF_STEM.fillna(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remove-number-columns" class="level2">
<h2 class="anchored" data-anchor-id="remove-number-columns">REMOVE number columns</h2>
<p>Remove columns with number from this one</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">##-------------------------------------------------------------------</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">####### Create a function that removes columns that are/contain nums</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">##-------------------------------------------------------------------</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> RemoveNums(SomeDF):</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(SomeDF)</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Running Remove Numbers function....</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    temp<span class="op">=</span>SomeDF</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    MyList<span class="op">=</span>[]</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> temp.columns:</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(col)</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Logical1=col.isdigit()  ## is a num</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        Logical2<span class="op">=</span><span class="bu">str</span>.isalpha(col) <span class="co">## this checks for anything</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">## that is not a letter</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(Logical2<span class="op">==</span><span class="va">False</span>):<span class="co"># or Logical2==True):</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(col)</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>            MyList.append(<span class="bu">str</span>(col))</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(MyList)       </span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    temp.drop(MyList, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(temp)</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>            <span class="co">#return temp</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Call the function ….</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>FinalDF_STEM<span class="op">=</span>RemoveNums(FinalDF_STEM)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>FinalDF_STEM_Bern<span class="op">=</span>RemoveNums(FinalDF_STEM_Bern)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>FinalDF_TFIDF<span class="op">=</span>RemoveNums(FinalDF_TFIDF)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>FinalDF_TFIDF_STEM<span class="op">=</span>RemoveNums(FinalDF_TFIDF_STEM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running Remove Numbers function....

Running Remove Numbers function....

Running Remove Numbers function....

Running Remove Numbers function....
</code></pre>
</div>
</div>
<p>Have a look:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">## These print statements help you to see where you are</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print(FinalDF_STEM)</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Remove columns that contain "-"  HOW TO....</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#cols = [c for c in FinalDF_STEM.columns if "-" in c[:] ]</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#FinalDF_STEM=FinalDF_STEM.drop(cols, axis = 1) </span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(FinalDF_STEM)  <span class="co">#1</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(FinalDF_STEM_Bern) <span class="co">#4</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(FinalDF_TFIDF)  <span class="co">#2</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(FinalDF_TFIDF_STEM) <span class="co">#3</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">##################################################</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">##        Now we have 4 labeled dataframes!</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">##        Let's model them.....</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">######################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    activ  add  adult  allow  alon  anim  anxieti  appreci  attent  bacteri  \
0       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      1.0   
1       0  1.0    0.0      0     1   0.0      0.0      0.0     1.0      0.0   
2       0  0.0    0.0      0     0   0.0      0.0      0.0     3.0      0.0   
3       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
4       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
5       1  0.0    1.0      0     0   1.0      1.0      0.0     0.0      0.0   
6       0  0.0    0.0      1     0   0.0      0.0      0.0     0.0      0.0   
7       0  0.0    0.0      0     0   0.0      0.0      0.0     1.0      0.0   
8       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
9       0  0.0    0.0      0     0   0.0      0.0      1.0     0.0      0.0   
10      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
0       0  0.0    0.0      0     1   0.0      0.0      0.0     0.0      0.0   
1       0  0.0    0.0      0     1   0.0      0.0      0.0     0.0      0.0   
2       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
3       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
4       3  0.0    0.0      1     0   0.0      0.0      0.0     0.0      0.0   
5       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
6       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
7       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
8       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
9       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
10      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   

    ...  usual  vari  veri  water  weather  weight  wild  wildlif  winter  \
0   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
1   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
2   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
3   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
4   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
5   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
6   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
7   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
8   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
9   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
10  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
0   ...    0.0   0.0   1.0    0.0      0.0     0.0   0.0      0.0     4.0   
1   ...    0.0   0.0   0.0    0.0      1.0     0.0   0.0      1.0     0.0   
2   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
3   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
4   ...    1.0   1.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
5   ...    1.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
6   ...    0.0   0.0   0.0    0.0      0.0     1.0   0.0      0.0     0.0   
7   ...    0.0   0.0   0.0    0.0      0.0     0.0   1.0      0.0     0.0   
8   ...    0.0   0.0   0.0    1.0      0.0     0.0   0.0      0.0     0.0   
9   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     3.0   
10  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     3.0   

    workout  
0       0.0  
1       0.0  
2       0.0  
3       0.0  
4       0.0  
5       0.0  
6       0.0  
7       0.0  
8       0.0  
9       0.0  
10      0.0  
0       0.0  
1       0.0  
2       1.0  
3       0.0  
4       0.0  
5       0.0  
6       1.0  
7       0.0  
8       0.0  
9       0.0  
10      0.0  

[22 rows x 225 columns]
    activ  add  adult  allow  alon  anim  anxieti  appreci  attent  bacteri  \
0       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      1.0   
1       0  1.0    0.0      0     1   0.0      0.0      0.0     1.0      0.0   
2       0  0.0    0.0      0     0   0.0      0.0      0.0     1.0      0.0   
3       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
4       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
5       1  0.0    1.0      0     0   1.0      1.0      0.0     0.0      0.0   
6       0  0.0    0.0      1     0   0.0      0.0      0.0     0.0      0.0   
7       0  0.0    0.0      0     0   0.0      0.0      0.0     1.0      0.0   
8       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
9       0  0.0    0.0      0     0   0.0      0.0      1.0     0.0      0.0   
10      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
0       0  0.0    0.0      0     1   0.0      0.0      0.0     0.0      0.0   
1       0  0.0    0.0      0     1   0.0      0.0      0.0     0.0      0.0   
2       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
3       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
4       1  0.0    0.0      1     0   0.0      0.0      0.0     0.0      0.0   
5       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
6       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
7       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
8       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
9       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
10      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   

    ...  usual  vari  veri  water  weather  weight  wild  wildlif  winter  \
0   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
1   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
2   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
3   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
4   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
5   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
6   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
7   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
8   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
9   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
10  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
0   ...    0.0   0.0   1.0    0.0      0.0     0.0   0.0      0.0     1.0   
1   ...    0.0   0.0   0.0    0.0      1.0     0.0   0.0      1.0     0.0   
2   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
3   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
4   ...    1.0   1.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
5   ...    1.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
6   ...    0.0   0.0   0.0    0.0      0.0     1.0   0.0      0.0     0.0   
7   ...    0.0   0.0   0.0    0.0      0.0     0.0   1.0      0.0     0.0   
8   ...    0.0   0.0   0.0    1.0      0.0     0.0   0.0      0.0     0.0   
9   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     1.0   
10  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     1.0   

    workout  
0       0.0  
1       0.0  
2       0.0  
3       0.0  
4       0.0  
5       0.0  
6       0.0  
7       0.0  
8       0.0  
9       0.0  
10      0.0  
0       0.0  
1       0.0  
2       1.0  
3       0.0  
4       0.0  
5       0.0  
6       1.0  
7       0.0  
8       0.0  
9       0.0  
10      0.0  

[22 rows x 225 columns]
      active       add    adults    allows    animal   anxiety  appreciate  \
0   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
1   0.000000  0.200094  0.000000  0.000000  0.000000  0.000000      0.0000   
2   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
3   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
4   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
5   0.194806  0.000000  0.194806  0.000000  0.194806  0.194806      0.0000   
6   0.000000  0.000000  0.000000  0.180036  0.000000  0.000000      0.0000   
7   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
8   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
9   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.2141   
10  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
0   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
1   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
2   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
3   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
4   0.000000  0.000000  0.000000  0.179382  0.000000  0.000000      0.0000   
5   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
6   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
7   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
8   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
9   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   
10  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000      0.0000   

    attention  bacterial    bark  ...   usually    varies     water   weather  \
0    0.000000   0.217303  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
1    0.150414   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
2    0.432197   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
3    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
4    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
5    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
6    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
7    0.194426   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
8    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
9    0.000000   0.000000  0.2141  ...  0.000000  0.000000  0.000000  0.000000   
10   0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
0    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
1    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.253933   
2    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
3    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
4    0.000000   0.000000  0.0000  ...  0.153329  0.179382  0.000000  0.000000   
5    0.000000   0.000000  0.0000  ...  0.162125  0.000000  0.000000  0.000000   
6    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
7    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
8    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.265139  0.000000   
9    0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   
10   0.000000   0.000000  0.0000  ...  0.000000  0.000000  0.000000  0.000000   

      weight      wild  wildlife    winter  wonderfully   workout  
0   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
1   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
2   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
3   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
4   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
5   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
6   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
7   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
8   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
9   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
10  0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
0   0.000000  0.000000  0.000000  0.560372     0.000000  0.000000  
1   0.000000  0.000000  0.253933  0.000000     0.000000  0.000000  
2   0.000000  0.000000  0.000000  0.000000     0.000000  0.168370  
3   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
4   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
5   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
6   0.197772  0.000000  0.000000  0.000000     0.197772  0.169048  
7   0.000000  0.335146  0.000000  0.000000     0.000000  0.000000  
8   0.000000  0.000000  0.000000  0.000000     0.000000  0.000000  
9   0.000000  0.000000  0.000000  0.544941     0.000000  0.000000  
10  0.000000  0.000000  0.000000  0.544941     0.000000  0.000000  

[22 rows x 244 columns]
       activ       add     adult     allow      alon      anim   anxieti  \
0   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
1   0.000000  0.187982  0.000000  0.000000  0.187982  0.000000  0.000000   
2   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
3   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
4   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
5   0.199947  0.000000  0.199947  0.000000  0.000000  0.199947  0.199947   
6   0.000000  0.000000  0.000000  0.196713  0.000000  0.000000  0.000000   
7   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
8   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
9   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
10  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
0   0.000000  0.000000  0.000000  0.000000  0.146954  0.000000  0.000000   
1   0.000000  0.000000  0.000000  0.000000  0.207427  0.000000  0.000000   
2   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
3   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
4   0.559851  0.000000  0.000000  0.186617  0.000000  0.000000  0.000000   
5   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
6   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
7   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
8   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
9   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
10  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   

     appreci    attent   bacteri  ...     usual      vari      veri     water  \
0   0.000000  0.000000  0.222079  ...  0.000000  0.000000  0.000000  0.000000   
1   0.000000  0.141309  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
2   0.000000  0.439848  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
3   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
4   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
5   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
6   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
7   0.000000  0.200998  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
8   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
9   0.224679  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
10  0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
0   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.171924  0.000000   
1   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
2   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
3   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
4   0.000000  0.000000  0.000000  ...  0.159513  0.186617  0.000000  0.000000   
5   0.000000  0.000000  0.000000  ...  0.167176  0.000000  0.000000  0.000000   
6   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
7   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
8   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.267891   
9   0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   
10  0.000000  0.000000  0.000000  ...  0.000000  0.000000  0.000000  0.000000   

     weather    weight      wild   wildlif    winter   workout  
0   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
1   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
2   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
3   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
4   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
5   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
6   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
7   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
8   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
9   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
10  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
0   0.000000  0.000000  0.000000  0.000000  0.516953  0.000000  
1   0.242672  0.000000  0.000000  0.242672  0.000000  0.000000  
2   0.000000  0.000000  0.000000  0.000000  0.000000  0.158961  
3   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
4   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
5   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
6   0.000000  0.192475  0.000000  0.000000  0.000000  0.164520  
7   0.000000  0.000000  0.298476  0.000000  0.000000  0.000000  
8   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  
9   0.000000  0.000000  0.000000  0.000000  0.520378  0.000000  
10  0.000000  0.000000  0.000000  0.000000  0.520378  0.000000  

[22 rows x 225 columns]</code></pre>
</div>
</div>
</section>
</section>
<section id="create-the-testing-set" class="level1">
<h1>Create the testing set</h1>
<p>grab a sample from the training set.</p>
<p>Be careful. Notice that right now, our train set is sorted by label.</p>
<p>If your train set is large enough, you can take a random sample.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random <span class="im">as</span> rd</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#rd.seed(1234)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>TrainDF1, TestDF1 <span class="op">=</span> train_test_split(FinalDF_STEM, test_size<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TrainDF1)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TestDF1)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>TrainDF2, TestDF2 <span class="op">=</span> train_test_split(FinalDF_TFIDF, test_size<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>TrainDF3, TestDF3 <span class="op">=</span> train_test_split(FinalDF_TFIDF_STEM, test_size<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>TrainDF4, TestDF4 <span class="op">=</span> train_test_split(FinalDF_STEM_Bern, test_size<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TestDF4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   activ  add  adult  allow  alon  anim  anxieti  appreci  attent  bacteri  \
8      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
6      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
7      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
8      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
6      0  0.0    0.0      1     0   0.0      0.0      0.0     0.0      0.0   
7      0  0.0    0.0      0     0   0.0      0.0      0.0     1.0      0.0   
4      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
3      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
5      1  0.0    1.0      0     0   1.0      1.0      0.0     0.0      0.0   
9      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
0      0  0.0    0.0      0     1   0.0      0.0      0.0     0.0      0.0   
1      0  1.0    0.0      0     1   0.0      0.0      0.0     1.0      0.0   
9      0  0.0    0.0      0     0   0.0      0.0      1.0     0.0      0.0   
1      0  0.0    0.0      0     1   0.0      0.0      0.0     0.0      0.0   
5      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   

   ...  usual  vari  veri  water  weather  weight  wild  wildlif  winter  \
8  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
6  ...    0.0   0.0   0.0    0.0      0.0     1.0   0.0      0.0     0.0   
7  ...    0.0   0.0   0.0    0.0      0.0     0.0   1.0      0.0     0.0   
8  ...    0.0   0.0   0.0    1.0      0.0     0.0   0.0      0.0     0.0   
6  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
7  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
4  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
3  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
5  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
9  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     3.0   
0  ...    0.0   0.0   1.0    0.0      0.0     0.0   0.0      0.0     4.0   
1  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
9  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
1  ...    0.0   0.0   0.0    0.0      1.0     0.0   0.0      1.0     0.0   
5  ...    1.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   

   workout  
8      0.0  
6      1.0  
7      0.0  
8      0.0  
6      0.0  
7      0.0  
4      0.0  
3      0.0  
5      0.0  
9      0.0  
0      0.0  
1      0.0  
9      0.0  
1      0.0  
5      0.0  

[15 rows x 225 columns]
    activ  add  adult  allow  alon  anim  anxieti  appreci  attent  bacteri  \
2       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
0       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      1.0   
2       0  0.0    0.0      0     0   0.0      0.0      0.0     3.0      0.0   
10      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
4       3  0.0    0.0      1     0   0.0      0.0      0.0     0.0      0.0   
10      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
3       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   

    ...  usual  vari  veri  water  weather  weight  wild  wildlif  winter  \
2   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
0   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
2   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
10  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     3.0   
4   ...    1.0   1.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
10  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
3   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   

    workout  
2       1.0  
0       0.0  
2       0.0  
10      0.0  
4       0.0  
10      0.0  
3       0.0  

[7 rows x 225 columns]
    activ  add  adult  allow  alon  anim  anxieti  appreci  attent  bacteri  \
8       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
1       0  0.0    0.0      0     1   0.0      0.0      0.0     0.0      0.0   
1       0  1.0    0.0      0     1   0.0      0.0      0.0     1.0      0.0   
6       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
2       0  0.0    0.0      0     0   0.0      0.0      0.0     1.0      0.0   
8       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
9       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
10      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
2       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   

    ...  usual  vari  veri  water  weather  weight  wild  wildlif  winter  \
8   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
1   ...    0.0   0.0   0.0    0.0      1.0     0.0   0.0      1.0     0.0   
1   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
6   ...    0.0   0.0   0.0    0.0      0.0     1.0   0.0      0.0     0.0   
2   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
8   ...    0.0   0.0   0.0    1.0      0.0     0.0   0.0      0.0     0.0   
9   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     1.0   
10  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
2   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   

    workout  
8       0.0  
1       0.0  
1       0.0  
6       1.0  
2       0.0  
8       0.0  
9       0.0  
10      0.0  
2       1.0  

[9 rows x 225 columns]</code></pre>
</div>
</div>
<p>OK - at this point we have Train and Test data for the text data in DOG and HIKE.</p>
<p>Of course, this can be updated to work from sentiment (like POS and NEG) and can be update for multiple folders or one folder..</p>
<section id="for-all-four-dfs---separate-labels" class="level2">
<h2 class="anchored" data-anchor-id="for-all-four-dfs---separate-labels">For all FOUR DFs - separate LABELS</h2>
<section id="test" class="level3">
<h3 class="anchored" data-anchor-id="test">TEST</h3>
<p><strong>IMPORTANT</strong> - YOU CANNOT LEAVE LABELS ON THE TEST SET #### Save labels</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Test1Labels<span class="op">=</span>TestDF1[<span class="st">"Label"</span>]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Test1Labels)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Test2Labels<span class="op">=</span>TestDF2[<span class="st">"Label"</span>]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>Test3Labels<span class="op">=</span>TestDF3[<span class="st">"Label"</span>]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>Test4Labels<span class="op">=</span>TestDF4[<span class="st">"Label"</span>]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Test2Labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2     HIKE
0      DOG
2      DOG
10    HIKE
4     HIKE
10     DOG
3     HIKE
Name: Label, dtype: object
9    HIKE
3    HIKE
5     DOG
8     DOG
6     DOG
3     DOG
4    HIKE
Name: Label, dtype: object</code></pre>
</div>
</div>
<section id="remove-labels" class="level4">
<h4 class="anchored" data-anchor-id="remove-labels">remove labels</h4>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>TestDF1 <span class="op">=</span> TestDF1.drop([<span class="st">"Label"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>TestDF2 <span class="op">=</span> TestDF2.drop([<span class="st">"Label"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>TestDF3 <span class="op">=</span> TestDF3.drop([<span class="st">"Label"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>TestDF4 <span class="op">=</span> TestDF4.drop([<span class="st">"Label"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TestDF1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    activ  add  adult  allow  alon  anim  anxieti  appreci  attent  bacteri  \
2       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
0       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      1.0   
2       0  0.0    0.0      0     0   0.0      0.0      0.0     3.0      0.0   
10      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
4       3  0.0    0.0      1     0   0.0      0.0      0.0     0.0      0.0   
10      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
3       0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   

    ...  usual  vari  veri  water  weather  weight  wild  wildlif  winter  \
2   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
0   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
2   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
10  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     3.0   
4   ...    1.0   1.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
10  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
3   ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   

    workout  
2       1.0  
0       0.0  
2       0.0  
10      0.0  
4       0.0  
10      0.0  
3       0.0  

[7 rows x 224 columns]</code></pre>
</div>
</div>
</section>
</section>
<section id="train" class="level3">
<h3 class="anchored" data-anchor-id="train">TRAIN</h3>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Train1Labels<span class="op">=</span>TrainDF1[<span class="st">"Label"</span>]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>Train2Labels<span class="op">=</span>TrainDF2[<span class="st">"Label"</span>]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>Train3Labels<span class="op">=</span>TrainDF3[<span class="st">"Label"</span>]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>Train4Labels<span class="op">=</span>TrainDF4[<span class="st">"Label"</span>]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Train3Labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4     HIKE
0     HIKE
3     HIKE
6      DOG
1     HIKE
6     HIKE
7     HIKE
3      DOG
2      DOG
1      DOG
0      DOG
8      DOG
5     HIKE
10    HIKE
5      DOG
Name: Label, dtype: object</code></pre>
</div>
</div>
<section id="remove-labels-1" class="level4">
<h4 class="anchored" data-anchor-id="remove-labels-1">remove labels</h4>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>TrainDF1 <span class="op">=</span> TrainDF1.drop([<span class="st">"Label"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>TrainDF2 <span class="op">=</span> TrainDF2.drop([<span class="st">"Label"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>TrainDF3 <span class="op">=</span> TrainDF3.drop([<span class="st">"Label"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>TrainDF4 <span class="op">=</span> TrainDF4.drop([<span class="st">"Label"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TrainDF3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       activ       add     adult     allow      alon      anim   anxieti  \
4   0.559851  0.000000  0.000000  0.186617  0.000000  0.000000  0.000000   
0   0.000000  0.000000  0.000000  0.000000  0.146954  0.000000  0.000000   
3   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
6   0.000000  0.000000  0.000000  0.196713  0.000000  0.000000  0.000000   
1   0.000000  0.000000  0.000000  0.000000  0.207427  0.000000  0.000000   
6   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
7   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
3   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
2   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
1   0.000000  0.187982  0.000000  0.000000  0.187982  0.000000  0.000000   
0   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
8   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
5   0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
10  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000   
5   0.199947  0.000000  0.199947  0.000000  0.000000  0.199947  0.199947   

    appreci    attent   bacteri  ...     usual      vari      veri  water  \
4       0.0  0.000000  0.000000  ...  0.159513  0.186617  0.000000    0.0   
0       0.0  0.000000  0.000000  ...  0.000000  0.000000  0.171924    0.0   
3       0.0  0.000000  0.000000  ...  0.000000  0.000000  0.000000    0.0   
6       0.0  0.000000  0.000000  ...  0.000000  0.000000  0.000000    0.0   
1       0.0  0.000000  0.000000  ...  0.000000  0.000000  0.000000    0.0   
6       0.0  0.000000  0.000000  ...  0.000000  0.000000  0.000000    0.0   
7       0.0  0.000000  0.000000  ...  0.000000  0.000000  0.000000    0.0   
3       0.0  0.000000  0.000000  ...  0.000000  0.000000  0.000000    0.0   
2       0.0  0.439848  0.000000  ...  0.000000  0.000000  0.000000    0.0   
1       0.0  0.141309  0.000000  ...  0.000000  0.000000  0.000000    0.0   
0       0.0  0.000000  0.222079  ...  0.000000  0.000000  0.000000    0.0   
8       0.0  0.000000  0.000000  ...  0.000000  0.000000  0.000000    0.0   
5       0.0  0.000000  0.000000  ...  0.167176  0.000000  0.000000    0.0   
10      0.0  0.000000  0.000000  ...  0.000000  0.000000  0.000000    0.0   
5       0.0  0.000000  0.000000  ...  0.000000  0.000000  0.000000    0.0   

     weather    weight      wild   wildlif    winter  workout  
4   0.000000  0.000000  0.000000  0.000000  0.000000  0.00000  
0   0.000000  0.000000  0.000000  0.000000  0.516953  0.00000  
3   0.000000  0.000000  0.000000  0.000000  0.000000  0.00000  
6   0.000000  0.000000  0.000000  0.000000  0.000000  0.00000  
1   0.242672  0.000000  0.000000  0.242672  0.000000  0.00000  
6   0.000000  0.192475  0.000000  0.000000  0.000000  0.16452  
7   0.000000  0.000000  0.298476  0.000000  0.000000  0.00000  
3   0.000000  0.000000  0.000000  0.000000  0.000000  0.00000  
2   0.000000  0.000000  0.000000  0.000000  0.000000  0.00000  
1   0.000000  0.000000  0.000000  0.000000  0.000000  0.00000  
0   0.000000  0.000000  0.000000  0.000000  0.000000  0.00000  
8   0.000000  0.000000  0.000000  0.000000  0.000000  0.00000  
5   0.000000  0.000000  0.000000  0.000000  0.000000  0.00000  
10  0.000000  0.000000  0.000000  0.000000  0.520378  0.00000  
5   0.000000  0.000000  0.000000  0.000000  0.000000  0.00000  

[15 rows x 224 columns]</code></pre>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="naive-bayes" class="level1">
<h1>Naive Bayes</h1>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> MultinomialNB</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html#sklearn.naive_bayes.MultinomialNB.fit</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the modeler</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>MyModelNB<span class="op">=</span> MultinomialNB()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="run-on-all-four-dfs." class="level2">
<h2 class="anchored" data-anchor-id="run-on-all-four-dfs.">Run on all four Dfs.</h2>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>NB1<span class="op">=</span>MyModelNB.fit(TrainDF1, Train1Labels)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>Prediction1 <span class="op">=</span> MyModelNB.predict(TestDF1)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">round</span>(MyModelNB.predict_proba(TestDF1),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.01 0.99]
 [1.   0.  ]
 [1.   0.  ]
 [0.   1.  ]
 [0.03 0.97]
 [1.   0.  ]
 [0.   1.  ]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>NB2<span class="op">=</span>MyModelNB.fit(TrainDF2, Train2Labels)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>Prediction2 <span class="op">=</span> MyModelNB.predict(TestDF2)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">round</span>(MyModelNB.predict_proba(TestDF2),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.19 0.81]
 [0.42 0.58]
 [0.5  0.5 ]
 [0.62 0.38]
 [0.51 0.49]
 [0.59 0.41]
 [0.46 0.54]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>NB3<span class="op">=</span>MyModelNB.fit(TrainDF3, Train3Labels)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>Prediction3 <span class="op">=</span> MyModelNB.predict(TestDF3)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">round</span>(MyModelNB.predict_proba(TestDF3),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.52 0.48]
 [0.7  0.3 ]
 [0.18 0.82]
 [0.57 0.43]
 [0.48 0.52]
 [0.6  0.4 ]
 [0.26 0.74]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>NB4<span class="op">=</span>MyModelNB.fit(TrainDF4, Train4Labels)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>Prediction4 <span class="op">=</span> MyModelNB.predict(TestDF4)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">round</span>(MyModelNB.predict_proba(TestDF4),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1.   0.  ]
 [0.01 0.99]
 [0.53 0.47]
 [0.   1.  ]
 [1.   0.  ]
 [0.   1.  ]
 [0.   1.  ]
 [1.   0.  ]
 [0.44 0.56]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The prediction from NB is:"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Prediction1)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The actual labels are:"</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Test1Labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The prediction from NB is:
['HIKE' 'DOG' 'DOG' 'HIKE' 'HIKE' 'DOG' 'HIKE']

The actual labels are:
2     HIKE
0      DOG
2      DOG
10    HIKE
4     HIKE
10     DOG
3     HIKE
Name: Label, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The prediction from NB is:"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Prediction2)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The actual labels are:"</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Test2Labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The prediction from NB is:
['HIKE' 'HIKE' 'DOG' 'DOG' 'DOG' 'DOG' 'HIKE']

The actual labels are:
9    HIKE
3    HIKE
5     DOG
8     DOG
6     DOG
3     DOG
4    HIKE
Name: Label, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The prediction from NB is:"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Prediction3)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The actual labels are:"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Test3Labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The prediction from NB is:
['DOG' 'DOG' 'HIKE' 'DOG' 'HIKE' 'DOG' 'HIKE']

The actual labels are:
4      DOG
7      DOG
9     HIKE
2     HIKE
10     DOG
9      DOG
8     HIKE
Name: Label, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The prediction from NB is:"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Prediction4)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The actual labels are:"</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Test4Labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The prediction from NB is:
['DOG' 'HIKE' 'DOG' 'HIKE' 'DOG' 'HIKE' 'HIKE' 'DOG' 'HIKE']

The actual labels are:
8      DOG
1     HIKE
1      DOG
6     HIKE
2      DOG
8     HIKE
9     HIKE
10     DOG
2     HIKE
Name: Label, dtype: object</code></pre>
</div>
</div>
</section>
<section id="confusion-matrix" class="level2">
<h2 class="anchored" data-anchor-id="confusion-matrix">confusion matrix</h2>
<p>The confusion matrix is square and is labels X labels</p>
<p>We have two labels, so ours will be 2X2</p>
<p>The matrix shows - rows are the true labels - columns are predicted - it is alphabetical - The numbers are how many</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>cnf_matrix1 <span class="op">=</span> confusion_matrix(Test1Labels, Prediction1)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The confusion matrix is:"</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cnf_matrix1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The confusion matrix is:
[[3 0]
 [0 4]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>cnf_matrix2 <span class="op">=</span> confusion_matrix(Test2Labels, Prediction2)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The confusion matrix is:"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cnf_matrix2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The confusion matrix is:
[[4 0]
 [0 3]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>cnf_matrix3 <span class="op">=</span> confusion_matrix(Test3Labels, Prediction3)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The confusion matrix is:"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cnf_matrix3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The confusion matrix is:
[[3 1]
 [1 2]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>cnf_matrix4 <span class="op">=</span> confusion_matrix(Test4Labels, Prediction4)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The confusion matrix is:"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cnf_matrix4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The confusion matrix is:
[[4 0]
 [0 5]]</code></pre>
</div>
</div>
</section>
</section>
<section id="bernoulli" class="level1">
<h1>Bernoulli</h1>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> BernoulliNB</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>BernModel <span class="op">=</span> BernoulliNB()</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>BernModel.fit(TrainDF4, Train4Labels)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">##BernoulliNB(alpha=1.0, binarize=0.0, class_prior=None, fit_prior=True)</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Bernoulli prediction:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>Prediction<span class="op">=</span>BernModel.predict(TestDF4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Bernoulli prediction:
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Actual:"</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Test4Labels)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"\The prediction</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Prediction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Actual:
8      DOG
1     HIKE
1      DOG
6     HIKE
2      DOG
8     HIKE
9     HIKE
10     DOG
2     HIKE
Name: Label, dtype: object
\The prediction

['DOG' 'HIKE' 'DOG' 'HIKE' 'DOG' 'HIKE' 'HIKE' 'DOG' 'DOG']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>bn_matrix <span class="op">=</span> confusion_matrix(Test4Labels, Prediction)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The confusion matrix is:"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bn_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The confusion matrix is:
[[4 0]
 [1 4]]</code></pre>
</div>
</div>
</section>
<section id="decision-trees" class="level1">
<h1>Decision Trees</h1>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html" class="uri">https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html</a></p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> tree</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">## conda install python-graphviz</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co">## restart kernel (click the little red x next to the Console)</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> graphviz </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>MyDT<span class="op">=</span>DecisionTreeClassifier(criterion<span class="op">=</span><span class="st">'entropy'</span>, <span class="co">##"entropy" or "gini"</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>                            splitter<span class="op">=</span><span class="st">'best'</span>,  <span class="co">## or "random" or "best"</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>                            max_depth<span class="op">=</span><span class="va">None</span>, </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>                            min_samples_split<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>                            min_samples_leaf<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>                            min_weight_fraction_leaf<span class="op">=</span><span class="fl">0.0</span>, </span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>                            max_features<span class="op">=</span><span class="va">None</span>, </span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>                            random_state<span class="op">=</span><span class="va">None</span>, </span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>                            max_leaf_nodes<span class="op">=</span><span class="va">None</span>, </span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>                            min_impurity_decrease<span class="op">=</span><span class="fl">0.0</span>, </span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>                            <span class="co">#min_impurity_split=None, </span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>                            class_weight<span class="op">=</span><span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TrainDF1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   activ  add  adult  allow  alon  anim  anxieti  appreci  attent  bacteri  \
8      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
6      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
7      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
8      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
6      0  0.0    0.0      1     0   0.0      0.0      0.0     0.0      0.0   
7      0  0.0    0.0      0     0   0.0      0.0      0.0     1.0      0.0   
4      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
3      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
5      1  0.0    1.0      0     0   1.0      1.0      0.0     0.0      0.0   
9      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
0      0  0.0    0.0      0     1   0.0      0.0      0.0     0.0      0.0   
1      0  1.0    0.0      0     1   0.0      0.0      0.0     1.0      0.0   
9      0  0.0    0.0      0     0   0.0      0.0      1.0     0.0      0.0   
1      0  0.0    0.0      0     1   0.0      0.0      0.0     0.0      0.0   
5      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   

   ...  usual  vari  veri  water  weather  weight  wild  wildlif  winter  \
8  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
6  ...    0.0   0.0   0.0    0.0      0.0     1.0   0.0      0.0     0.0   
7  ...    0.0   0.0   0.0    0.0      0.0     0.0   1.0      0.0     0.0   
8  ...    0.0   0.0   0.0    1.0      0.0     0.0   0.0      0.0     0.0   
6  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
7  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
4  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
3  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
5  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
9  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     3.0   
0  ...    0.0   0.0   1.0    0.0      0.0     0.0   0.0      0.0     4.0   
1  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
9  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
1  ...    0.0   0.0   0.0    0.0      1.0     0.0   0.0      1.0     0.0   
5  ...    1.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   

   workout  
8      0.0  
6      1.0  
7      0.0  
8      0.0  
6      0.0  
7      0.0  
4      0.0  
3      0.0  
5      0.0  
9      0.0  
0      0.0  
1      0.0  
9      0.0  
1      0.0  
5      0.0  

[15 rows x 224 columns]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
</div>
<p>This for loop will fit and predict Decision Trees for all 4 of the dataframes. Notice that this uses dynamic variables and eval</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]:</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    temp1<span class="op">=</span><span class="bu">str</span>(<span class="st">"TrainDF"</span><span class="op">+</span><span class="bu">str</span>(i))   <span class="co">##  TrainDF1</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    temp2<span class="op">=</span><span class="bu">str</span>(<span class="st">"Train"</span><span class="op">+</span><span class="bu">str</span>(i)<span class="op">+</span><span class="st">"Labels"</span>)  <span class="co">#Train1Labels</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    temp3<span class="op">=</span><span class="bu">str</span>(<span class="st">"TestDF"</span><span class="op">+</span><span class="bu">str</span>(i))  <span class="co">#TestDF1</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    temp4<span class="op">=</span><span class="bu">str</span>(<span class="st">"Test"</span><span class="op">+</span><span class="bu">str</span>(i)<span class="op">+</span><span class="st">"Labels"</span>) <span class="co"># Test1Labels</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">## perform DT</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#MyDT.fit(TrainDF1, Train1Labels)</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    MyDT.fit(<span class="bu">eval</span>(temp1), <span class="bu">eval</span>(temp2))</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">## plot the tree</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    tree.plot_tree(MyDT)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    plt.savefig(temp1)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    feature_names<span class="op">=</span><span class="bu">eval</span>(<span class="bu">str</span>(temp1<span class="op">+</span><span class="st">".columns"</span>))</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    dot_data <span class="op">=</span> tree.export_graphviz(MyDT, out_file<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>                    <span class="co">## The following creates TrainDF.columns for each</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>                    <span class="co">## which are the feature names.</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>                      feature_names<span class="op">=</span><span class="bu">eval</span>(<span class="bu">str</span>(temp1<span class="op">+</span><span class="st">".columns"</span>)),  </span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#class_names=MyDT.class_names,  </span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>                      filled<span class="op">=</span><span class="va">True</span>, rounded<span class="op">=</span><span class="va">True</span>,  </span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>                      special_characters<span class="op">=</span><span class="va">True</span>)                                    </span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> graphviz.Source(dot_data) </span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Create dynamic graph name</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>    tempname<span class="op">=</span><span class="bu">str</span>(<span class="st">"Graph"</span> <span class="op">+</span> <span class="bu">str</span>(i))</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>    graph.render(tempname) </span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Show the predictions from the DT on the test set</span></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Actual for DataFrame: "</span>, i, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="bu">eval</span>(temp2))</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Prediction</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    DT_pred<span class="op">=</span>MyDT.predict(<span class="bu">eval</span>(temp3))</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(DT_pred)</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Show the confusion matrix</span></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>    bn_matrix <span class="op">=</span> confusion_matrix(<span class="bu">eval</span>(temp4), DT_pred)</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The confusion matrix is:"</span>)</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(bn_matrix)</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>    FeatureImp<span class="op">=</span>MyDT.feature_importances_   </span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>    indices <span class="op">=</span> np.argsort(FeatureImp)[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">## print out the important features.....</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> f <span class="kw">in</span> <span class="bu">range</span>(TrainDF4.shape[<span class="dv">1</span>]):</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> FeatureImp[indices[f]] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"</span><span class="sc">%d</span><span class="st">. feature </span><span class="sc">%d</span><span class="st"> (</span><span class="sc">%f</span><span class="st">)"</span> <span class="op">%</span> (f <span class="op">+</span> <span class="dv">1</span>, indices[f], FeatureImp[indices[f]]))</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span> (<span class="st">"feature name: "</span>, feature_names[indices[f]])</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a><span class="co">## FYI for small datasets you can zip features....</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a><span class="co"># print(dict(zip(iris_pd.columns, clf.feature_importances_)))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Actual for DataFrame:  1 

8     DOG
6    HIKE
7    HIKE
8    HIKE
6     DOG
7     DOG
4     DOG
3     DOG
5     DOG
9    HIKE
0    HIKE
1     DOG
9     DOG
1    HIKE
5    HIKE
Name: Label, dtype: object
Prediction

['DOG' 'DOG' 'DOG' 'HIKE' 'HIKE' 'DOG' 'HIKE']

The confusion matrix is:
[[3 0]
 [1 3]]
1. feature 38 (1.000000)
feature name:  dog</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Actual for DataFrame:  2 

2     HIKE
10     DOG
8     HIKE
0      DOG
10    HIKE
2      DOG
0     HIKE
5     HIKE
7     HIKE
7      DOG
1     HIKE
6     HIKE
9      DOG
4      DOG
1      DOG
Name: Label, dtype: object
Prediction

['HIKE' 'HIKE' 'DOG' 'DOG' 'DOG' 'DOG' 'DOG']

The confusion matrix is:
[[4 0]
 [1 2]]
1. feature 61 (0.697073)
feature name:  hike
2. feature 68 (0.302927)
feature name:  increase

Actual for DataFrame:  3 

4     HIKE
0     HIKE
3     HIKE
6      DOG
1     HIKE
6     HIKE
7     HIKE
3      DOG
2      DOG
1      DOG
0      DOG
8      DOG
5     HIKE
10    HIKE
5      DOG
Name: Label, dtype: object
Prediction

['DOG' 'DOG' 'HIKE' 'DOG' 'DOG' 'DOG' 'HIKE']

The confusion matrix is:
[[4 0]
 [1 2]]
1. feature 38 (1.000000)
feature name:  dog</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Actual for DataFrame:  4 

10    HIKE
7      DOG
4      DOG
5     HIKE
3     HIKE
4     HIKE
0      DOG
5      DOG
3      DOG
0     HIKE
9      DOG
6      DOG
7     HIKE
Name: Label, dtype: object
Prediction

['DOG' 'HIKE' 'DOG' 'HIKE' 'DOG' 'HIKE' 'HIKE' 'DOG' 'DOG']

The confusion matrix is:
[[4 0]
 [1 4]]
1. feature 38 (1.000000)
feature name:  dog</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Python-DecisionTrees_files/figure-html/cell-36-output-4.png" width="540" height="389"></p>
</div>
</div>
<section id="confusion-matrix-visual-code-quickly-updated" class="level2">
<h2 class="anchored" data-anchor-id="confusion-matrix-visual-code-quickly-updated">Confusion Matrix Visual Code (quickly updated)</h2>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt     </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co">##########################################################</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, ConfusionMatrixDisplay</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(Test4Labels, DT_pred, labels<span class="op">=</span>MyDT.classes_)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm,display_labels<span class="op">=</span>MyDT.classes_)                         </span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>disp.plot()</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Python-DecisionTrees_files/figure-html/cell-37-output-1.png" width="523" height="434"></p>
</div>
</div>
</section>
<section id="visualize-decision-trees-plotting-paired-surfaces" class="level2">
<h2 class="anchored" data-anchor-id="visualize-decision-trees-plotting-paired-surfaces">Visualize Decision Trees plotting paired surfaces</h2>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, plot_tree</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>f1<span class="op">=</span>TrainDF1.columns.get_loc(<span class="st">"dog"</span>) </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>f2<span class="op">=</span>TrainDF1.columns.get_loc(<span class="st">"hike"</span>) </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>f3<span class="op">=</span>TrainDF1.columns.get_loc(<span class="st">"workout"</span>) </span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>f4<span class="op">=</span>TrainDF1.columns.get_loc(<span class="st">"happi"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>n_classes <span class="op">=</span><span class="dv">2</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>plot_colors <span class="op">=</span> <span class="st">"ryb"</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>plot_step <span class="op">=</span> <span class="fl">0.02</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pairidx, pair <span class="kw">in</span> <span class="bu">enumerate</span>([[f1, f2], [f1, f3], [f1, f4],</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>                                [f2,f3], [f3, f4]]):</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(TrainDF1.iloc[:,pair])</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> TrainDF1.iloc[:, pair]</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Because we are plotting, using our GOD and HIKE labels will not work</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">## we need to change them to 0 and 1</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> Train1Labels</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(y)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    oldy<span class="op">=</span>y</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(type(y))</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>y.replace(<span class="st">"DOG"</span>, <span class="dv">1</span>)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>y.replace(<span class="st">"HIKE"</span>, <span class="dv">0</span>)</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(y)</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>    DT <span class="op">=</span> DecisionTreeClassifier().fit(X, y)</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the decision boundary</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, pairidx <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>    x_min, x_max <span class="op">=</span> X.iloc[:, <span class="dv">0</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="dv">1</span>, X.iloc[:, <span class="dv">0</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x_min)</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>    y_min, y_max <span class="op">=</span> X.iloc[:, <span class="dv">1</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="dv">1</span>, X.iloc[:, <span class="dv">1</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>    xx, yy <span class="op">=</span> np.meshgrid(np.arange(x_min, x_max,plot_step),</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>                         np.arange(y_min, y_max,plot_step))</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(yy)</span></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout(h_pad<span class="op">=</span><span class="fl">0.5</span>, w_pad<span class="op">=</span><span class="fl">0.5</span>, pad<span class="op">=</span><span class="fl">2.5</span>)</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>    Z <span class="op">=</span> DT.predict(np.c_[xx.ravel(), yy.ravel()])</span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>    Z <span class="op">=</span> Z.reshape(xx.shape)</span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(Z)</span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>    cs <span class="op">=</span> plt.contourf(xx, yy, Z, cmap<span class="op">=</span>plt.cm.RdYlBu)</span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>    plt.scatter(X.iloc[:, <span class="dv">0</span>], X.iloc[:, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">30</span>, label<span class="op">=</span>oldy,edgecolor<span class="op">=</span><span class="st">'black'</span>, </span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#c=color, s=15)</span></span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#label=y[i],</span></span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a>                    cmap<span class="op">=</span>plt.cm.RdYlBu)</span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a><span class="co">###---------------------------end for loop ----------------------------------</span></span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.suptitle("Decision surface of a decision tree using paired features")</span></span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.legend(loc='lower right', borderpad=0, handletextpad=0)</span></span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.axis("tight")</span></span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.figure()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>8     DOG
6    HIKE
7    HIKE
8    HIKE
6     DOG
7     DOG
4     DOG
3     DOG
5     DOG
9    HIKE
0    HIKE
1     DOG
9     DOG
1    HIKE
5    HIKE
Name: Label, dtype: object
8    1
6    0
7    0
8    0
6    1
7    1
4    1
3    1
5    1
9    0
0    0
1    1
9    1
1    0
5    0
Name: Label, dtype: int64
-1
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
8     DOG
6    HIKE
7    HIKE
8    HIKE
6     DOG
7     DOG
4     DOG
3     DOG
5     DOG
9    HIKE
0    HIKE
1     DOG
9     DOG
1    HIKE
5    HIKE
Name: Label, dtype: object
8    1
6    0
7    0
8    0
6    1
7    1
4    1
3    1
5    1
9    0
0    0
1    1
9    1
1    0
5    0
Name: Label, dtype: int64
-1
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
8     DOG
6    HIKE
7    HIKE
8    HIKE
6     DOG
7     DOG
4     DOG
3     DOG
5     DOG
9    HIKE
0    HIKE
1     DOG
9     DOG
1    HIKE
5    HIKE
Name: Label, dtype: object
8    1
6    0
7    0
8    0
6    1
7    1
4    1
3    1
5    1
9    0
0    0
1    1
9    1
1    0
5    0
Name: Label, dtype: int64
-1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\rokka\AppData\Local\r-miniconda\lib\site-packages\sklearn\base.py:420: UserWarning: X does not have valid feature names, but DecisionTreeClassifier was fitted with feature names
  warnings.warn(
C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\3125387409.py:42: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  plt.scatter(X.iloc[:, 0], X.iloc[:, 1], s=30, label=oldy,edgecolor='black',
C:\Users\rokka\AppData\Local\r-miniconda\lib\site-packages\sklearn\base.py:420: UserWarning: X does not have valid feature names, but DecisionTreeClassifier was fitted with feature names
  warnings.warn(
C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\3125387409.py:42: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  plt.scatter(X.iloc[:, 0], X.iloc[:, 1], s=30, label=oldy,edgecolor='black',
C:\Users\rokka\AppData\Local\r-miniconda\lib\site-packages\sklearn\base.py:420: UserWarning: X does not have valid feature names, but DecisionTreeClassifier was fitted with feature names
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
8     DOG
6    HIKE
7    HIKE
8    HIKE
6     DOG
7     DOG
4     DOG
3     DOG
5     DOG
9    HIKE
0    HIKE
1     DOG
9     DOG
1    HIKE
5    HIKE
Name: Label, dtype: object
8    1
6    0
7    0
8    0
6    1
7    1
4    1
3    1
5    1
9    0
0    0
1    1
9    1
1    0
5    0
Name: Label, dtype: int64
-1
[[1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
8     DOG
6    HIKE
7    HIKE
8    HIKE
6     DOG
7     DOG
4     DOG
3     DOG
5     DOG
9    HIKE
0    HIKE
1     DOG
9     DOG
1    HIKE
5    HIKE
Name: Label, dtype: object
8    1
6    0
7    0
8    0
6    1
7    1
4    1
3    1
5    1
9    0
0    0
1    1
9    1
1    0
5    0
Name: Label, dtype: int64
-1.0
[[1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\3125387409.py:42: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  plt.scatter(X.iloc[:, 0], X.iloc[:, 1], s=30, label=oldy,edgecolor='black',
C:\Users\rokka\AppData\Local\r-miniconda\lib\site-packages\sklearn\base.py:420: UserWarning: X does not have valid feature names, but DecisionTreeClassifier was fitted with feature names
  warnings.warn(
C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\3125387409.py:42: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  plt.scatter(X.iloc[:, 0], X.iloc[:, 1], s=30, label=oldy,edgecolor='black',
C:\Users\rokka\AppData\Local\r-miniconda\lib\site-packages\sklearn\base.py:420: UserWarning: X does not have valid feature names, but DecisionTreeClassifier was fitted with feature names
  warnings.warn(
C:\Users\rokka\AppData\Local\Temp\ipykernel_21436\3125387409.py:42: UserWarning: No data for colormapping provided via 'c'. Parameters 'cmap' will be ignored
  plt.scatter(X.iloc[:, 0], X.iloc[:, 1], s=30, label=oldy,edgecolor='black',</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Python-DecisionTrees_files/figure-html/cell-39-output-5.png" width="625" height="432"></p>
</div>
</div>
</section>
</section>
<section id="random-forest-for-text-data" class="level1">
<h1>Random Forest for Text Data</h1>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>RF <span class="op">=</span> RandomForestClassifier()</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>RF.fit(TrainDF1, Train1Labels)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>RF_pred<span class="op">=</span>RF.predict(TestDF1)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>bn_matrix_RF_text <span class="op">=</span> confusion_matrix(Test1Labels, RF_pred)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The confusion matrix is:"</span>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bn_matrix_RF_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The confusion matrix is:
[[3 0]
 [2 2]]</code></pre>
</div>
</div>
<section id="vis-rf" class="level2">
<h2 class="anchored" data-anchor-id="vis-rf">VIS RF</h2>
<section id="feature-names" class="level3">
<h3 class="anchored" data-anchor-id="feature-names">FEATURE NAMES</h3>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>FeaturesT<span class="op">=</span>TrainDF1.columns</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Targets=StudentTestLabels_Num</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>figT, axesT <span class="op">=</span> plt.subplots(nrows <span class="op">=</span> <span class="dv">1</span>,ncols <span class="op">=</span> <span class="dv">1</span>,figsize <span class="op">=</span> (<span class="dv">4</span>,<span class="dv">4</span>), dpi<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>tree.plot_tree(RF.estimators_[<span class="dv">0</span>],</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>               feature_names <span class="op">=</span> FeaturesT, </span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>               <span class="co">#class_names=Targets,</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>               filled <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>[Text(0.6666666666666666, 0.875, 'tell &lt;= 0.5\ngini = 0.444\nsamples = 9\nvalue = [10, 5]'),
 Text(0.5, 0.625, 'provid &lt;= 0.5\ngini = 0.165\nsamples = 7\nvalue = [10, 1]'),
 Text(0.3333333333333333, 0.375, 'lot &lt;= 0.5\ngini = 0.219\nsamples = 6\nvalue = [7, 1]'),
 Text(0.16666666666666666, 0.125, 'gini = 0.0\nsamples = 5\nvalue = [7, 0]'),
 Text(0.5, 0.125, 'gini = 0.0\nsamples = 1\nvalue = [0, 1]'),
 Text(0.6666666666666666, 0.375, 'gini = 0.0\nsamples = 1\nvalue = [3, 0]'),
 Text(0.8333333333333334, 0.625, 'gini = 0.0\nsamples = 2\nvalue = [0, 4]')]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Python-DecisionTrees_files/figure-html/cell-41-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>figT.savefig(<span class="st">'RF_Tree_Text'</span>)  <span class="co">## creates png</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="view-estimator-trees-in-rf" class="level5">
<h5 class="anchored" data-anchor-id="view-estimator-trees-in-rf">View estimator Trees in RF</h5>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>figT2, axesT2 <span class="op">=</span> plt.subplots(nrows <span class="op">=</span> <span class="dv">1</span>,ncols <span class="op">=</span> <span class="dv">5</span>,figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">2</span>), dpi<span class="op">=</span><span class="dv">900</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">5</span>):</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    tree.plot_tree(RF.estimators_[index],</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>                   feature_names <span class="op">=</span> FeaturesT, </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                   filled <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                   ax <span class="op">=</span> axesT2[index])</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>    axesT2[index].set_title(<span class="st">'Estimator: '</span> <span class="op">+</span> <span class="bu">str</span>(index), fontsize <span class="op">=</span> <span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Python-DecisionTrees_files/figure-html/cell-43-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Save it</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>figT2.savefig(<span class="st">'FIVEtrees_RF.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="feature-importance-in-rf" class="level2">
<h2 class="anchored" data-anchor-id="feature-importance-in-rf">Feature importance in RF</h2>
<p>Recall that FeaturesT are the columns names - the words in this case.</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>FeatureImpRF<span class="op">=</span>RF.feature_importances_   </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>indicesRF <span class="op">=</span> np.argsort(FeatureImpRF)[::<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="print-out-the-important-features" class="level3">
<h3 class="anchored" data-anchor-id="print-out-the-important-features">print out the important features</h3>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f2 <span class="kw">in</span> <span class="bu">range</span>(TrainDF1.shape[<span class="dv">1</span>]):   <span class="co">##TrainDF1.shape[1] is number of columns</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> FeatureImpRF[indicesRF[f2]] <span class="op">&gt;=</span> <span class="fl">0.01</span>:</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="sc">%d</span><span class="st">. feature </span><span class="sc">%d</span><span class="st"> (</span><span class="sc">%.2f</span><span class="st">)"</span> <span class="op">%</span> (f2 <span class="op">+</span> <span class="dv">1</span>, indicesRF[f2], FeatureImpRF[indicesRF[f2]]))</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> (<span class="st">"feature name: "</span>, FeaturesT[indicesRF[f2]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1. feature 60 (0.17)
feature name:  hike
2. feature 38 (0.13)
feature name:  dog
3. feature 161 (0.04)
feature name:  gear
4. feature 195 (0.03)
feature name:  safe
5. feature 212 (0.03)
feature name:  trail
6. feature 186 (0.03)
feature name:  plan
7. feature 168 (0.02)
feature name:  includ
8. feature 209 (0.02)
feature name:  tell
9. feature 134 (0.02)
feature name:  beauti
10. feature 178 (0.02)
feature name:  method
11. feature 52 (0.01)
feature name:  fun
12. feature 92 (0.01)
feature name:  pet
13. feature 220 (0.01)
feature name:  wild
14. feature 77 (0.01)
feature name:  lot
15. feature 8 (0.01)
feature name:  attent
16. feature 45 (0.01)
feature name:  exercis
17. feature 199 (0.01)
feature name:  singl
18. feature 146 (0.01)
feature name:  concern
19. feature 142 (0.01)
feature name:  chang</code></pre>
</div>
</div>
</section>
<section id="plot-the-top-10-features" class="level3">
<h3 class="anchored" data-anchor-id="plot-the-top-10-features">PLOT THE TOP 10 FEATURES</h3>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>top_ten_arg <span class="op">=</span> indicesRF[:<span class="dv">10</span>]</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print(top_ten_arg)</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Feature Importances Dog and Hike'</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>plt.barh(<span class="bu">range</span>(<span class="bu">len</span>(top_ten_arg)), FeatureImpRF[top_ten_arg], color<span class="op">=</span><span class="st">'b'</span>, align<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>plt.yticks(<span class="bu">range</span>(<span class="bu">len</span>(top_ten_arg)), [FeaturesT[i] <span class="cf">for</span> i <span class="kw">in</span> top_ten_arg])</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Relative Importance'</span>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Python-DecisionTrees_files/figure-html/cell-47-output-1.png" width="601" height="449"></p>
</div>
</div>
</section>
</section>
</section>
<section id="nn" class="level1">
<h1>NN</h1>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neural_network <span class="im">import</span> MLPClassifier</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>MyNN <span class="op">=</span> MLPClassifier(solver<span class="op">=</span><span class="st">'lbfgs'</span>, </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#solver='adam',</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#solver='sgd',</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>                     alpha<span class="op">=</span><span class="dv">1</span>,  </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>                   hidden_layer_sizes<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">2</span>), random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>MyNN.fit(TrainDF1, Train1Labels)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>NNPrediction <span class="op">=</span> MyNN.predict(TestDF1)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"confusion matrix for NN</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>NN_matrix <span class="op">=</span> confusion_matrix(Test1Labels, NNPrediction)</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(NN_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>confusion matrix for NN

[[3 0]
 [4 0]]</code></pre>
</div>
</div>
</section>
<section id="svm" class="level1">
<h1>SVM</h1>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#from sklearn.svm import LinearSVC</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>SVM_Model<span class="op">=</span>LinearSVC(C<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>SVM_Model.fit(TrainDF1, Train1Labels)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co">#print("SVM prediction:\n", SVM_Model.predict(TestDF1))</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="co">#print("Actual:")</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="co">#print(Test1Labels)</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>SVM_matrix <span class="op">=</span> confusion_matrix(Test1Labels, SVM_Model.predict(TestDF1))</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The confusion matrix is:"</span>)</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(SVM_matrix)</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The confusion matrix is:
[[3 0]
 [0 4]]


</code></pre>
</div>
</div>
<p>SVMs do not run on qualitative data.</p>
<p>ALWAYS remove the Labels from the Test and Train data</p>
<p>Here is what we have from above:</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">## TrainDF_nolabels, TrainLabels</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co">### TestDF, TestLabels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rather than creating copies of everything</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">### !!!!!!!!!!!!!!!!!</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co">##  You can set the variables: TRAIN, TRAIN_Labels</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co">##                            </span><span class="al">TEST</span><span class="co"> and TEST_Labels</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co">## to whatever you wish</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co">######################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>TRAIN<span class="op">=</span> TrainDF1   <span class="co">## As noted above - this can also be TrainDF2, etc.</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TRAIN)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>TRAIN_Labels<span class="op">=</span> Train1Labels</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TRAIN_Labels)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>TEST<span class="op">=</span> TestDF1</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>TEST_Labels<span class="op">=</span> Test1Labels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   activ  add  adult  allow  alon  anim  anxieti  appreci  attent  bacteri  \
8      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
6      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
7      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
8      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
6      0  0.0    0.0      1     0   0.0      0.0      0.0     0.0      0.0   
7      0  0.0    0.0      0     0   0.0      0.0      0.0     1.0      0.0   
4      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
3      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
5      1  0.0    1.0      0     0   1.0      1.0      0.0     0.0      0.0   
9      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   
0      0  0.0    0.0      0     1   0.0      0.0      0.0     0.0      0.0   
1      0  1.0    0.0      0     1   0.0      0.0      0.0     1.0      0.0   
9      0  0.0    0.0      0     0   0.0      0.0      1.0     0.0      0.0   
1      0  0.0    0.0      0     1   0.0      0.0      0.0     0.0      0.0   
5      0  0.0    0.0      0     0   0.0      0.0      0.0     0.0      0.0   

   ...  usual  vari  veri  water  weather  weight  wild  wildlif  winter  \
8  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
6  ...    0.0   0.0   0.0    0.0      0.0     1.0   0.0      0.0     0.0   
7  ...    0.0   0.0   0.0    0.0      0.0     0.0   1.0      0.0     0.0   
8  ...    0.0   0.0   0.0    1.0      0.0     0.0   0.0      0.0     0.0   
6  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
7  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
4  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
3  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
5  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
9  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     3.0   
0  ...    0.0   0.0   1.0    0.0      0.0     0.0   0.0      0.0     4.0   
1  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
9  ...    0.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   
1  ...    0.0   0.0   0.0    0.0      1.0     0.0   0.0      1.0     0.0   
5  ...    1.0   0.0   0.0    0.0      0.0     0.0   0.0      0.0     0.0   

   workout  
8      0.0  
6      1.0  
7      0.0  
8      0.0  
6      0.0  
7      0.0  
4      0.0  
3      0.0  
5      0.0  
9      0.0  
0      0.0  
1      0.0  
9      0.0  
1      0.0  
5      0.0  

[15 rows x 224 columns]
8     DOG
6    HIKE
7    HIKE
8    HIKE
6     DOG
7     DOG
4     DOG
3     DOG
5     DOG
9    HIKE
0    HIKE
1     DOG
9     DOG
1    HIKE
5    HIKE
Name: Label, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>SVM_Model1<span class="op">=</span>LinearSVC(C<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>SVM_Model1.fit(TRAIN, TRAIN_Labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearSVC(C=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">LinearSVC</label><div class="sk-toggleable__content"><pre>LinearSVC(C=1)</pre></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print("SVM prediction:\n", SVM_Model1.predict(</span><span class="al">TEST</span><span class="co">))</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print("Actual:")</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(TEST_Labels)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>SVM_matrix <span class="op">=</span> confusion_matrix(TEST_Labels, SVM_Model1.predict(TEST))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The confusion matrix is:"</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(SVM_matrix)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The confusion matrix is:
[[3 0]
 [0 4]]


</code></pre>
</div>
</div>
<p>#other kernels ## RBF</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>SVM_Model2<span class="op">=</span>sklearn.svm.SVC(C<span class="op">=</span><span class="dv">1</span>, kernel<span class="op">=</span><span class="st">'rbf'</span>, </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>                           verbose<span class="op">=</span><span class="va">True</span>, gamma<span class="op">=</span><span class="st">"auto"</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>SVM_Model2.fit(TRAIN, TRAIN_Labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[LibSVM]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="55">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SVC(C=1, gamma='auto', verbose=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked=""><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC(C=1, gamma='auto', verbose=True)</pre></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print("SVM prediction:\n", SVM_Model2.predict(</span><span class="al">TEST</span><span class="co">))</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print("Actual:")</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(TEST_Labels)</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RBF  :</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>SVM_matrix2 <span class="op">=</span> confusion_matrix(TEST_Labels, SVM_Model2.predict(TEST))</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The confusion matrix is:"</span>)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(SVM_matrix2)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RBF  :


The confusion matrix is:
[[3 0]
 [1 3]]


</code></pre>
</div>
</div>
<section id="poly" class="level2">
<h2 class="anchored" data-anchor-id="poly">POLY</h2>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>SVM_Model3<span class="op">=</span>sklearn.svm.SVC(C<span class="op">=</span><span class="dv">100</span>, kernel<span class="op">=</span><span class="st">'poly'</span>,degree<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>                           gamma<span class="op">=</span><span class="st">"auto"</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(SVM_Model3)</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>SVM_Model3.fit(TRAIN, TRAIN_Labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[LibSVM]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="57">
<style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SVC(C=100, gamma='auto', kernel='poly', verbose=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" checked=""><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC(C=100, gamma='auto', kernel='poly', verbose=True)</pre></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print("SVM prediction:\n", SVM_Model3.predict(</span><span class="al">TEST</span><span class="co">))</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="co">#print("Actual:")</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(TEST_Labels)</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"POLY Degree 2:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>SVM_matrix3 <span class="op">=</span> confusion_matrix(TEST_Labels, SVM_Model3.predict(TEST))</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The confusion matrix is:"</span>)</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(SVM_matrix3)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>POLY Degree 2:


The confusion matrix is:
[[3 0]
 [3 1]]


</code></pre>
</div>
</div>
</section>
</section>
<section id="visualizing-the-top-features" class="level1">
<h1>Visualizing the top features</h1>
<p>Then Visualizing the margin with the top 2 in 2D</p>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Credit: https://medium.com/@aneesha/visualising-top-features-in-linear-svm-with-scikit-learn-and-matplotlib-3454ab18a14d</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Define a function to visualize the TOP words (variables)</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_coefficients(MODEL<span class="op">=</span>SVM_Model, COLNAMES<span class="op">=</span>TrainDF1.columns, top_features<span class="op">=</span><span class="dv">10</span>):</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Model if SVM MUST be SVC, RE: SVM_Model=LinearSVC(C=10)</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    coef <span class="op">=</span> MODEL.coef_.ravel()</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    top_positive_coefficients <span class="op">=</span> np.argsort(coef,axis<span class="op">=</span><span class="dv">0</span>)[<span class="op">-</span>top_features:]</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(top_positive_coefficients)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    top_negative_coefficients <span class="op">=</span> np.argsort(coef,axis<span class="op">=</span><span class="dv">0</span>)[:top_features]</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(top_negative_coefficients)</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    top_coefficients <span class="op">=</span> np.hstack([top_negative_coefficients, top_positive_coefficients])</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create plot</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    colors <span class="op">=</span> [<span class="st">"red"</span> <span class="cf">if</span> c <span class="op">&lt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">"blue"</span> <span class="cf">for</span> c <span class="kw">in</span> coef[top_coefficients]]</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    plt.bar(  x<span class="op">=</span>  np.arange(<span class="dv">2</span> <span class="op">*</span> top_features)  , height<span class="op">=</span>coef[top_coefficients], width<span class="op">=</span><span class="fl">.5</span>,  color<span class="op">=</span>colors)</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>    feature_names <span class="op">=</span> np.array(COLNAMES)</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>    plt.xticks(np.arange(<span class="dv">0</span>, (<span class="dv">2</span><span class="op">*</span>top_features)), feature_names[top_coefficients], rotation<span class="op">=</span><span class="dv">60</span>, ha<span class="op">=</span><span class="st">"right"</span>)</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>plot_coefficients()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[223 186 195 147 182 132 161 212 148  60]
[38 92 86 23 45 16 94 35 96 37]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Python-DecisionTrees_files/figure-html/cell-60-output-2.png" width="1185" height="460"></p>
</div>
</div>
<p>Using the top 2 features from above let’s look at the margin of the SVM</p>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([TRAIN[<span class="st">"dog"</span>], TRAIN[<span class="st">"hike"</span>]])</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> X.transpose()</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[2 0]
 [0 2]
 [0 5]
 [0 4]
 [3 0]
 [6 0]
 [2 0]
 [4 0]
 [1 0]
 [0 6]
 [0 6]
 [6 0]
 [5 0]
 [0 5]
 [0 4]]</code></pre>
</div>
</div>
<section id="the-classes-of-the-training-data" class="level2">
<h2 class="anchored" data-anchor-id="the-classes-of-the-training-data">The classes of the training data</h2>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> TRAIN_Labels</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelBinarizer</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> preprocessing.LabelBinarizer()</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>lb.fit_transform(y)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array(y)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y.ravel()  <span class="co">## to make it the right 1D array type</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>8     DOG
6    HIKE
7    HIKE
8    HIKE
6     DOG
7     DOG
4     DOG
3     DOG
5     DOG
9    HIKE
0    HIKE
1     DOG
9     DOG
1    HIKE
5    HIKE
Name: Label, dtype: object
[0 1 1 1 0 0 0 0 0 1 1 0 0 1 1]</code></pre>
</div>
</div>
<p>Here - we need to make y into 0 or 1 so it will plot</p>
<section id="train-1" class="level3">
<h3 class="anchored" data-anchor-id="train-1">TRAIN</h3>
<p>Define the model with SVC</p>
<p>Fit SVM with training data</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SVC(C<span class="op">=</span><span class="dv">1</span>, kernel<span class="op">=</span><span class="st">"linear"</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>clf.fit(X, y) </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>margin <span class="op">=</span> <span class="dv">2</span> <span class="op">/</span> np.sqrt(np.<span class="bu">sum</span>(clf.coef_ <span class="op">**</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>get the separating hyperplane</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The weights vector w</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> clf.coef_[<span class="dv">0</span>]</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print("The weight vector ", w)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The slope of the SVM sep line</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="op">-</span>w[<span class="dv">0</span>] <span class="op">/</span> w[<span class="dv">1</span>]</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print("The slope of the SVM sep line is ", a)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a variable xx that are values between 4 and 8</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>xx <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="equation-of-sep-line-in-2d" class="level1">
<h1>Equation of sep line in 2D</h1>
<p>$ x_1 = - - ()(x_0)$ - Note that <code>clf.intercept_[0]</code> is “b” - Note that <code>a  = -w0/w1</code> and <code>xx</code> are a bunch of x values</p>
<p>This is the y values for the main sep line</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> a <span class="op">*</span> xx <span class="op">-</span> (clf.intercept_[<span class="dv">0</span>]) <span class="op">/</span> w[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These plot the two parellel margin lines plot the parallel lines to the separating hyperplane that pass through the support vectors and note the <code>margin = 2 / np.sqrt(np.sum(clf.coef_ ** 2))</code></p>
<p>translate the location of the center sep line by adding or subtracting a fraaction of the margin</p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>yy_down <span class="op">=</span> yy <span class="op">+</span> <span class="fl">.5</span><span class="op">*</span>margin</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>yy_up <span class="op">=</span> yy <span class="op">-</span> <span class="fl">.5</span><span class="op">*</span>margin</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>plot the line, the points, and the nearest vectors to the plane</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.figure(fignum, figsize=(4, 3))</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>plt.clf()</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>plt.plot(xx, yy, <span class="st">'r-'</span>)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>plt.plot(xx, yy_down, <span class="st">'k--'</span>)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>plt.plot(xx, yy_up, <span class="st">'k--'</span>)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>plt.scatter(clf.support_vectors_[:, <span class="dv">0</span>], clf.support_vectors_[:, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>                facecolors<span class="op">=</span><span class="st">'none'</span>, zorder<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="co"># cmap is the color map</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>plt.scatter(X[:, <span class="dv">0</span>], X[:, <span class="dv">1</span>], c<span class="op">=</span>y, zorder<span class="op">=</span><span class="dv">5</span>, cmap<span class="op">=</span>plt.cm.Paired)</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'tight'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>(-0.5, 10.5, -0.7298373876248843, 7.229837387624884)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Python-DecisionTrees_files/figure-html/cell-69-output-2.png" width="558" height="411"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>