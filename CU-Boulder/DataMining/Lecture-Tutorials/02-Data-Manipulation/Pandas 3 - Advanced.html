<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Advanced Pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Pandas 3 - Advanced_files/libs/clipboard/clipboard.min.js"></script>
<script src="Pandas 3 - Advanced_files/libs/quarto-html/quarto.js"></script>
<script src="Pandas 3 - Advanced_files/libs/quarto-html/popper.min.js"></script>
<script src="Pandas 3 - Advanced_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Pandas 3 - Advanced_files/libs/quarto-html/anchor.min.js"></script>
<link href="Pandas 3 - Advanced_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Pandas 3 - Advanced_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Pandas 3 - Advanced_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Pandas 3 - Advanced_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Pandas 3 - Advanced_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup-the-environment" id="toc-setup-the-environment" class="nav-link active" data-scroll-target="#setup-the-environment">Setup the environment</a></li>
  <li><a href="#load-the-data" id="toc-load-the-data" class="nav-link" data-scroll-target="#load-the-data">Load the data</a></li>
  <li><a href="#make-a-sample" id="toc-make-a-sample" class="nav-link" data-scroll-target="#make-a-sample">Make a Sample</a></li>
  <li><a href="#examine-the-sample" id="toc-examine-the-sample" class="nav-link" data-scroll-target="#examine-the-sample">Examine the Sample</a></li>
  <li><a href="#unique" id="toc-unique" class="nav-link" data-scroll-target="#unique">Unique</a></li>
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering">Filtering</a></li>
  <li><a href="#aggregation" id="toc-aggregation" class="nav-link" data-scroll-target="#aggregation">Aggregation</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Advanced Pandas</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>We have learned basic operations with Series and DataFrame. Here are some advanced handy skills you must know as a data scientist.</p>
<section id="setup-the-environment" class="level2">
<h2 class="anchored" data-anchor-id="setup-the-environment">Setup the environment</h2>
<div class="cell" data-cell_id="e7845d82085c44a5bffe6a7389652c1a" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:13}" data-deepnote_cell_type="code" data-execution_millis="1287" data-execution_start="1674709266062" data-source_hash="35374e32" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-the-data" class="level2">
<h2 class="anchored" data-anchor-id="load-the-data">Load the data</h2>
<div class="cell" data-cell_id="d6ad33ee82bd4b049389888526d05fee" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:25}" data-deepnote_cell_type="code" data-execution_millis="74" data-execution_start="1674709267353" data-source_hash="97eb8337" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"/work/superstore.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-cell_id="9df401095a9144148c5416edb2f56cc0" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:31}" data-deepnote_cell_type="code" data-execution_millis="58" data-execution_start="1674709267478" data-source_hash="f30f989a" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Row ID</th>
      <th>Order ID</th>
      <th>Order Date</th>
      <th>Ship Date</th>
      <th>Ship Mode</th>
      <th>Customer ID</th>
      <th>Customer Name</th>
      <th>Segment</th>
      <th>Country</th>
      <th>City</th>
      <th>...</th>
      <th>Postal Code</th>
      <th>Region</th>
      <th>Product ID</th>
      <th>Category</th>
      <th>Sub-Category</th>
      <th>Product Name</th>
      <th>Sales</th>
      <th>Quantity</th>
      <th>Discount</th>
      <th>Profit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>CA-2016-152156</td>
      <td>11/8/16</td>
      <td>11/11/16</td>
      <td>Second Class</td>
      <td>CG-12520</td>
      <td>Claire Gute</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Henderson</td>
      <td>...</td>
      <td>42420</td>
      <td>South</td>
      <td>FUR-BO-10001798</td>
      <td>Furniture</td>
      <td>Bookcases</td>
      <td>Bush Somerset Collection Bookcase</td>
      <td>261.9600</td>
      <td>2</td>
      <td>0.00</td>
      <td>41.9136</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>CA-2016-152156</td>
      <td>11/8/16</td>
      <td>11/11/16</td>
      <td>Second Class</td>
      <td>CG-12520</td>
      <td>Claire Gute</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Henderson</td>
      <td>...</td>
      <td>42420</td>
      <td>South</td>
      <td>FUR-CH-10000454</td>
      <td>Furniture</td>
      <td>Chairs</td>
      <td>Hon Deluxe Fabric Upholstered Stacking Chairs,...</td>
      <td>731.9400</td>
      <td>3</td>
      <td>0.00</td>
      <td>219.5820</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>CA-2016-138688</td>
      <td>6/12/16</td>
      <td>6/16/16</td>
      <td>Second Class</td>
      <td>DV-13045</td>
      <td>Darrin Van Huff</td>
      <td>Corporate</td>
      <td>United States</td>
      <td>Los Angeles</td>
      <td>...</td>
      <td>90036</td>
      <td>West</td>
      <td>OFF-LA-10000240</td>
      <td>Office Supplies</td>
      <td>Labels</td>
      <td>Self-Adhesive Address Labels for Typewriters b...</td>
      <td>14.6200</td>
      <td>2</td>
      <td>0.00</td>
      <td>6.8714</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>US-2015-108966</td>
      <td>10/11/15</td>
      <td>10/18/15</td>
      <td>Standard Class</td>
      <td>SO-20335</td>
      <td>Sean O'Donnell</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Fort Lauderdale</td>
      <td>...</td>
      <td>33311</td>
      <td>South</td>
      <td>FUR-TA-10000577</td>
      <td>Furniture</td>
      <td>Tables</td>
      <td>Bretford CR4500 Series Slim Rectangular Table</td>
      <td>957.5775</td>
      <td>5</td>
      <td>0.45</td>
      <td>-383.0310</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>US-2015-108966</td>
      <td>10/11/15</td>
      <td>10/18/15</td>
      <td>Standard Class</td>
      <td>SO-20335</td>
      <td>Sean O'Donnell</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Fort Lauderdale</td>
      <td>...</td>
      <td>33311</td>
      <td>South</td>
      <td>OFF-ST-10000760</td>
      <td>Office Supplies</td>
      <td>Storage</td>
      <td>Eldon Fold 'N Roll Cart System</td>
      <td>22.3680</td>
      <td>2</td>
      <td>0.20</td>
      <td>2.5164</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>CA-2014-115812</td>
      <td>6/9/14</td>
      <td>6/14/14</td>
      <td>Standard Class</td>
      <td>BH-11710</td>
      <td>Brosina Hoffman</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Los Angeles</td>
      <td>...</td>
      <td>90032</td>
      <td>West</td>
      <td>FUR-FU-10001487</td>
      <td>Furniture</td>
      <td>Furnishings</td>
      <td>Eldon Expressions Wood and Plastic Desk Access...</td>
      <td>48.8600</td>
      <td>7</td>
      <td>0.00</td>
      <td>14.1694</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>CA-2014-115812</td>
      <td>6/9/14</td>
      <td>6/14/14</td>
      <td>Standard Class</td>
      <td>BH-11710</td>
      <td>Brosina Hoffman</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Los Angeles</td>
      <td>...</td>
      <td>90032</td>
      <td>West</td>
      <td>OFF-AR-10002833</td>
      <td>Office Supplies</td>
      <td>Art</td>
      <td>Newell 322</td>
      <td>7.2800</td>
      <td>4</td>
      <td>0.00</td>
      <td>1.9656</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>CA-2014-115812</td>
      <td>6/9/14</td>
      <td>6/14/14</td>
      <td>Standard Class</td>
      <td>BH-11710</td>
      <td>Brosina Hoffman</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Los Angeles</td>
      <td>...</td>
      <td>90032</td>
      <td>West</td>
      <td>TEC-PH-10002275</td>
      <td>Technology</td>
      <td>Phones</td>
      <td>Mitel 5320 IP Phone VoIP phone</td>
      <td>907.1520</td>
      <td>6</td>
      <td>0.20</td>
      <td>90.7152</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>CA-2014-115812</td>
      <td>6/9/14</td>
      <td>6/14/14</td>
      <td>Standard Class</td>
      <td>BH-11710</td>
      <td>Brosina Hoffman</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Los Angeles</td>
      <td>...</td>
      <td>90032</td>
      <td>West</td>
      <td>OFF-BI-10003910</td>
      <td>Office Supplies</td>
      <td>Binders</td>
      <td>DXL Angle-View Binders with Locking Rings by S...</td>
      <td>18.5040</td>
      <td>3</td>
      <td>0.20</td>
      <td>5.7825</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>CA-2014-115812</td>
      <td>6/9/14</td>
      <td>6/14/14</td>
      <td>Standard Class</td>
      <td>BH-11710</td>
      <td>Brosina Hoffman</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Los Angeles</td>
      <td>...</td>
      <td>90032</td>
      <td>West</td>
      <td>OFF-AP-10002892</td>
      <td>Office Supplies</td>
      <td>Appliances</td>
      <td>Belkin F5C206VTEL 6 Outlet Surge</td>
      <td>114.9000</td>
      <td>5</td>
      <td>0.00</td>
      <td>34.4700</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell" data-cell_id="44b044482a434f338529825b20da5b78" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:37}" data-deepnote_cell_type="code" data-execution_start="1674709267578" data-source_hash="534f2a87" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df.drop(<span class="st">'Row ID'</span>,axis<span class="op">=</span><span class="dv">1</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-cell_id="065d6e29f7cc42e8a4e2e14eb0d5e609" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:43}" data-deepnote_cell_type="code" data-execution_millis="8" data-execution_start="1674709267621" data-source_hash="c085b6ba" data-tags="[]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Order ID</th>
      <th>Order Date</th>
      <th>Ship Date</th>
      <th>Ship Mode</th>
      <th>Customer ID</th>
      <th>Customer Name</th>
      <th>Segment</th>
      <th>Country</th>
      <th>City</th>
      <th>State</th>
      <th>Postal Code</th>
      <th>Region</th>
      <th>Product ID</th>
      <th>Category</th>
      <th>Sub-Category</th>
      <th>Product Name</th>
      <th>Sales</th>
      <th>Quantity</th>
      <th>Discount</th>
      <th>Profit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA-2016-152156</td>
      <td>11/8/16</td>
      <td>11/11/16</td>
      <td>Second Class</td>
      <td>CG-12520</td>
      <td>Claire Gute</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Henderson</td>
      <td>Kentucky</td>
      <td>42420</td>
      <td>South</td>
      <td>FUR-BO-10001798</td>
      <td>Furniture</td>
      <td>Bookcases</td>
      <td>Bush Somerset Collection Bookcase</td>
      <td>261.9600</td>
      <td>2</td>
      <td>0.00</td>
      <td>41.9136</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CA-2016-152156</td>
      <td>11/8/16</td>
      <td>11/11/16</td>
      <td>Second Class</td>
      <td>CG-12520</td>
      <td>Claire Gute</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Henderson</td>
      <td>Kentucky</td>
      <td>42420</td>
      <td>South</td>
      <td>FUR-CH-10000454</td>
      <td>Furniture</td>
      <td>Chairs</td>
      <td>Hon Deluxe Fabric Upholstered Stacking Chairs,...</td>
      <td>731.9400</td>
      <td>3</td>
      <td>0.00</td>
      <td>219.5820</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CA-2016-138688</td>
      <td>6/12/16</td>
      <td>6/16/16</td>
      <td>Second Class</td>
      <td>DV-13045</td>
      <td>Darrin Van Huff</td>
      <td>Corporate</td>
      <td>United States</td>
      <td>Los Angeles</td>
      <td>California</td>
      <td>90036</td>
      <td>West</td>
      <td>OFF-LA-10000240</td>
      <td>Office Supplies</td>
      <td>Labels</td>
      <td>Self-Adhesive Address Labels for Typewriters b...</td>
      <td>14.6200</td>
      <td>2</td>
      <td>0.00</td>
      <td>6.8714</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US-2015-108966</td>
      <td>10/11/15</td>
      <td>10/18/15</td>
      <td>Standard Class</td>
      <td>SO-20335</td>
      <td>Sean O'Donnell</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Fort Lauderdale</td>
      <td>Florida</td>
      <td>33311</td>
      <td>South</td>
      <td>FUR-TA-10000577</td>
      <td>Furniture</td>
      <td>Tables</td>
      <td>Bretford CR4500 Series Slim Rectangular Table</td>
      <td>957.5775</td>
      <td>5</td>
      <td>0.45</td>
      <td>-383.0310</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US-2015-108966</td>
      <td>10/11/15</td>
      <td>10/18/15</td>
      <td>Standard Class</td>
      <td>SO-20335</td>
      <td>Sean O'Donnell</td>
      <td>Consumer</td>
      <td>United States</td>
      <td>Fort Lauderdale</td>
      <td>Florida</td>
      <td>33311</td>
      <td>South</td>
      <td>OFF-ST-10000760</td>
      <td>Office Supplies</td>
      <td>Storage</td>
      <td>Eldon Fold 'N Roll Cart System</td>
      <td>22.3680</td>
      <td>2</td>
      <td>0.20</td>
      <td>2.5164</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-cell_id="c6a220b368e6413eaac4b5bada0f1067" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:49}" data-deepnote_cell_type="code" data-execution_millis="2" data-execution_start="1674709267633" data-source_hash="14f60b8f" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>(9994, 20)</code></pre>
</div>
</div>
</section>
<section id="make-a-sample" class="level2">
<h2 class="anchored" data-anchor-id="make-a-sample">Make a Sample</h2>
<div class="cell" data-cell_id="02308c6a2bc149a9bfb22f604983305d" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:61}" data-deepnote_cell_type="code" data-execution_millis="5" data-execution_start="1674709267656" data-source_hash="5fa38d5b" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_subset <span class="op">=</span> df.loc[[i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>,<span class="dv">10</span>)],[<span class="st">'Customer ID'</span>,<span class="st">'Customer Name'</span>,<span class="st">'City'</span>,<span class="st">'Postal Code'</span>,<span class="st">'Sales'</span>]]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df_subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Customer ID</th>
      <th>Customer Name</th>
      <th>City</th>
      <th>Postal Code</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>BH-11710</td>
      <td>Brosina Hoffman</td>
      <td>Los Angeles</td>
      <td>90032</td>
      <td>48.860</td>
    </tr>
    <tr>
      <th>6</th>
      <td>BH-11710</td>
      <td>Brosina Hoffman</td>
      <td>Los Angeles</td>
      <td>90032</td>
      <td>7.280</td>
    </tr>
    <tr>
      <th>7</th>
      <td>BH-11710</td>
      <td>Brosina Hoffman</td>
      <td>Los Angeles</td>
      <td>90032</td>
      <td>907.152</td>
    </tr>
    <tr>
      <th>8</th>
      <td>BH-11710</td>
      <td>Brosina Hoffman</td>
      <td>Los Angeles</td>
      <td>90032</td>
      <td>18.504</td>
    </tr>
    <tr>
      <th>9</th>
      <td>BH-11710</td>
      <td>Brosina Hoffman</td>
      <td>Los Angeles</td>
      <td>90032</td>
      <td>114.900</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="examine-the-sample" class="level2">
<h2 class="anchored" data-anchor-id="examine-the-sample">Examine the Sample</h2>
<div class="cell" data-cell_id="8f1f8a5dd6cf45e2bdf71cc499d8cdff" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:73}" data-deepnote_cell_type="code" data-execution_start="1674709267706" data-source_hash="f78c83b7" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_subset <span class="op">=</span> df.loc[[i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>,<span class="dv">200</span>)],[<span class="st">'Sales'</span>,<span class="st">'Profit'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-cell_id="6c58df2c78f44e54bdd6db5b1200d7d9" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:79}" data-deepnote_cell_type="code" data-execution_millis="45" data-execution_start="1674709267706" data-source_hash="bfedc4f0" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_subset.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Sales</th>
      <th>Profit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>100.000000</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>262.957220</td>
      <td>0.347574</td>
    </tr>
    <tr>
      <th>std</th>
      <td>858.983762</td>
      <td>170.744869</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.788000</td>
      <td>-1359.992000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>21.327000</td>
      <td>1.635900</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>66.960000</td>
      <td>9.653600</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>177.095000</td>
      <td>23.458800</td>
    </tr>
    <tr>
      <th>max</th>
      <td>8159.952000</td>
      <td>585.552000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-cell_id="c9504e98d2a0490f89e14fd544dd33e4" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:85}" data-deepnote_cell_type="code" data-execution_millis="393" data-execution_start="1674709267750" data-source_hash="c7cbc450" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_subset.plot.box()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Boxplot of sales and profit"</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>,<span class="dv">500</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Pandas%203%20-%20Advanced_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="unique" class="level2">
<h2 class="anchored" data-anchor-id="unique">Unique</h2>
<div class="cell" data-cell_id="fba91ee948e641b198147777b13e3c7a" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:97}" data-deepnote_cell_type="code" data-execution_millis="5" data-execution_start="1674709268144" data-source_hash="d110d2b4" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'State'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>array(['Kentucky', 'California', 'Florida', 'North Carolina',
       'Washington', 'Texas', 'Wisconsin', 'Utah', 'Nebraska',
       'Pennsylvania', 'Illinois', 'Minnesota', 'Michigan', 'Delaware',
       'Indiana', 'New York', 'Arizona', 'Virginia', 'Tennessee',
       'Alabama', 'South Carolina', 'Oregon', 'Colorado', 'Iowa', 'Ohio',
       'Missouri', 'Oklahoma', 'New Mexico', 'Louisiana', 'Connecticut',
       'New Jersey', 'Massachusetts', 'Georgia', 'Nevada', 'Rhode Island',
       'Mississippi', 'Arkansas', 'Montana', 'New Hampshire', 'Maryland',
       'District of Columbia', 'Kansas', 'Vermont', 'Maine',
       'South Dakota', 'Idaho', 'North Dakota', 'Wyoming',
       'West Virginia'], dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-cell_id="c8e19ff143874ff5b28a2222a637644b" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:103}" data-deepnote_cell_type="code" data-execution_millis="17" data-execution_start="1674709268155" data-source_hash="1bfd082" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'State'</span>].nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>49</code></pre>
</div>
</div>
<div class="cell" data-cell_id="433bbc9d5bb54d148a0a2491401742eb" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:109}" data-deepnote_cell_type="code" data-execution_millis="7" data-execution_start="1674709268168" data-source_hash="91ceb546" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Country'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array(['United States'], dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-cell_id="9ed94f551d2d416fab3a7aca26fde962" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:115}" data-deepnote_cell_type="code" data-execution_millis="5" data-execution_start="1674709268174" data-source_hash="7fc8513" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df.drop(<span class="st">'Country'</span>,axis<span class="op">=</span><span class="dv">1</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filtering" class="level2">
<h2 class="anchored" data-anchor-id="filtering">Filtering</h2>
<div class="cell" data-cell_id="6d02b12b31074b29b2537fa0bc8ade89" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:127}" data-deepnote_cell_type="code" data-execution_millis="34" data-execution_start="1674709268242" data-source_hash="4dd7b572" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_subset <span class="op">=</span> df.loc[[i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span> (<span class="dv">10</span>)],[<span class="st">'Ship Mode'</span>,<span class="st">'State'</span>,<span class="st">'Sales'</span>]]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Ship Mode</th>
      <th>State</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Second Class</td>
      <td>Kentucky</td>
      <td>261.9600</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Second Class</td>
      <td>Kentucky</td>
      <td>731.9400</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Second Class</td>
      <td>California</td>
      <td>14.6200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Standard Class</td>
      <td>Florida</td>
      <td>957.5775</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Standard Class</td>
      <td>Florida</td>
      <td>22.3680</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Standard Class</td>
      <td>California</td>
      <td>48.8600</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Standard Class</td>
      <td>California</td>
      <td>7.2800</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Standard Class</td>
      <td>California</td>
      <td>907.1520</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Standard Class</td>
      <td>California</td>
      <td>18.5040</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Standard Class</td>
      <td>California</td>
      <td>114.9000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-cell_id="70f3a1eed4584577a4220e42c631ec46" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:133}" data-deepnote_cell_type="code" data-execution_millis="12" data-execution_start="1674709268272" data-source_hash="8a477550" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_subset[<span class="st">'Sales'</span>]<span class="op">&gt;</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>0     True
1     True
2    False
3     True
4    False
5    False
6    False
7     True
8    False
9     True
Name: Sales, dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-cell_id="02bb78e891824ed48c27099ac931439e" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:139}" data-deepnote_cell_type="code" data-execution_start="1674709268273" data-source_hash="9adf10d2" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_subset_significantsale <span class="op">=</span> df_subset[df_subset[<span class="st">'Sales'</span>]<span class="op">&gt;</span><span class="dv">100</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-cell_id="7174e1438ee946a694d1fd67137743e6" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:145}" data-deepnote_cell_type="code" data-execution_millis="13" data-execution_start="1674709268322" data-source_hash="9c3aa5e8" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df_subset[(df_subset[<span class="st">'State'</span>]<span class="op">!=</span><span class="st">'California'</span>) <span class="op">&amp;</span> (df_subset[<span class="st">'Sales'</span>]<span class="op">&gt;</span><span class="dv">100</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Ship Mode</th>
      <th>State</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Second Class</td>
      <td>Kentucky</td>
      <td>261.9600</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Second Class</td>
      <td>Kentucky</td>
      <td>731.9400</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Standard Class</td>
      <td>Florida</td>
      <td>957.5775</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="aggregation" class="level2">
<h2 class="anchored" data-anchor-id="aggregation">Aggregation</h2>
<div class="cell" data-cell_id="4f934a9084b74b9e91bb494b069ea1c2" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:157}" data-deepnote_cell_type="code" data-execution_millis="19" data-execution_start="1674709268344" data-source_hash="4dd7b572" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_subset <span class="op">=</span> df.loc[[i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span> (<span class="dv">10</span>)],[<span class="st">'Ship Mode'</span>,<span class="st">'State'</span>,<span class="st">'Sales'</span>]]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df_subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Ship Mode</th>
      <th>State</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Second Class</td>
      <td>Kentucky</td>
      <td>261.9600</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Second Class</td>
      <td>Kentucky</td>
      <td>731.9400</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Second Class</td>
      <td>California</td>
      <td>14.6200</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Standard Class</td>
      <td>Florida</td>
      <td>957.5775</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Standard Class</td>
      <td>Florida</td>
      <td>22.3680</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Standard Class</td>
      <td>California</td>
      <td>48.8600</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Standard Class</td>
      <td>California</td>
      <td>7.2800</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Standard Class</td>
      <td>California</td>
      <td>907.1520</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Standard Class</td>
      <td>California</td>
      <td>18.5040</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Standard Class</td>
      <td>California</td>
      <td>114.9000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-cell_id="a3f37b95a2564abaa9f028e5abb1706c" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:163}" data-deepnote_cell_type="code" data-execution_millis="1" data-execution_start="1674709268410" data-source_hash="a6de4503" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>byState <span class="op">=</span> df_subset.groupby(<span class="st">'State'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-cell_id="5e16c64575a94975b9a98ef3f448f455" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:169}" data-deepnote_cell_type="code" data-execution_millis="2" data-execution_start="1674709268411" data-source_hash="c7dda76e" data-execution_count="21">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>byState</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f5fbef988e0&gt;</code></pre>
</div>
</div>
<div class="cell" data-cell_id="e8fca1e69cf042a69ccb417dcc656e76" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:175}" data-deepnote_cell_type="code" data-execution_millis="47" data-execution_start="1674709268411" data-source_hash="b054b8db" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Grouping by 'State' column and listing mean sales</span><span class="ch">\n</span><span class="st">"</span>,<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>, sep<span class="op">=</span><span class="st">''</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(byState.mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Grouping by 'State' column and listing mean sales
--------------------------------------------------
                 Sales
State                 
California  185.219333
Florida     489.972750
Kentucky    496.950000</code></pre>
</div>
</div>
<div class="cell" data-cell_id="f14eee4691a74704b3d52dcdd171398b" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:181}" data-deepnote_cell_type="code" data-execution_millis="3" data-execution_start="1674709268455" data-source_hash="83b8934b" data-execution_count="23">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Grouping by 'State' column and listing total sum of sales</span><span class="ch">\n</span><span class="st">"</span>,<span class="st">'-'</span><span class="op">*</span><span class="dv">50</span>, sep<span class="op">=</span><span class="st">''</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(byState.<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Grouping by 'State' column and listing total sum of sales
--------------------------------------------------
                Sales
State                
California  1111.3160
Florida      979.9455
Kentucky     993.9000</code></pre>
</div>
</div>
<div class="cell" data-cell_id="12de3deb6a294fff9d45198807f0b485" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:187}" data-deepnote_cell_type="code" data-execution_millis="44" data-execution_start="1674709268455" data-source_hash="c74c9da2" data-execution_count="24">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.DataFrame(df_subset.groupby(<span class="st">'State'</span>).describe().loc[<span class="st">'California'</span>]).transpose())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Sales                                                              
           count        mean         std   min     25%     50%    75%      max
California   6.0  185.219333  355.889307  7.28  15.591  33.682  98.39  907.152</code></pre>
</div>
</div>
<div class="cell" data-cell_id="5b0617d83e0e48179fd6ab3311bfd187" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:193}" data-deepnote_cell_type="code" data-execution_millis="82" data-execution_start="1674709268498" data-source_hash="2cc9c152" data-execution_count="25">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df_subset.groupby(<span class="st">'Ship Mode'</span>).describe().loc[[<span class="st">'Second Class'</span>,<span class="st">'Standard Class'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">Sales</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>Ship Mode</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Second Class</th>
      <td>3.0</td>
      <td>336.173333</td>
      <td>364.373037</td>
      <td>14.62</td>
      <td>138.290</td>
      <td>261.96</td>
      <td>496.950</td>
      <td>731.9400</td>
    </tr>
    <tr>
      <th>Standard Class</th>
      <td>7.0</td>
      <td>296.663071</td>
      <td>435.947552</td>
      <td>7.28</td>
      <td>20.436</td>
      <td>48.86</td>
      <td>511.026</td>
      <td>957.5775</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-cell_id="07e2a1a654c149f091470ab5cf5b4b7c" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:199}" data-deepnote_cell_type="code" data-execution_millis="26" data-execution_start="1674709268624" data-source_hash="d74cd0da" data-execution_count="26">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(byState.describe().loc[<span class="st">'California'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>California</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="8" valign="top">Sales</th>
      <th>count</th>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>185.219333</td>
    </tr>
    <tr>
      <th>std</th>
      <td>355.889307</td>
    </tr>
    <tr>
      <th>min</th>
      <td>7.280000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>15.591000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>33.682000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>98.390000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>907.152000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-cell_id="9845b0a5d49045e5bd9d3c11207644de" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:205}" data-deepnote_cell_type="code" data-execution_millis="9" data-execution_start="1674709268653" data-source_hash="26757a00" data-execution_count="27">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>byStateCity<span class="op">=</span>df.groupby([<span class="st">'State'</span>,<span class="st">'City'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-cell_id="e0a16039066947ac8a4b05184fc4aa7b" data-deepnote_app_coordinates="{&quot;h&quot;:5,&quot;w&quot;:12,&quot;x&quot;:0,&quot;y&quot;:211}" data-deepnote_cell_type="code" data-execution_millis="8761" data-execution_start="1674709268664" data-source_hash="ff8eff3a" data-execution_count="28">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>byStateCity.describe()[<span class="st">'Sales'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>State</th>
      <th>City</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Alabama</th>
      <th>Auburn</th>
      <td>6.0</td>
      <td>294.471667</td>
      <td>361.914543</td>
      <td>3.760</td>
      <td>8.8050</td>
      <td>182.030</td>
      <td>456.4075</td>
      <td>900.080</td>
    </tr>
    <tr>
      <th>Decatur</th>
      <td>13.0</td>
      <td>259.601538</td>
      <td>385.660903</td>
      <td>14.940</td>
      <td>23.9200</td>
      <td>44.950</td>
      <td>239.9200</td>
      <td>1215.920</td>
    </tr>
    <tr>
      <th>Florence</th>
      <td>5.0</td>
      <td>399.470000</td>
      <td>796.488863</td>
      <td>4.980</td>
      <td>7.2700</td>
      <td>12.480</td>
      <td>152.7600</td>
      <td>1819.860</td>
    </tr>
    <tr>
      <th>Hoover</th>
      <td>4.0</td>
      <td>131.462500</td>
      <td>230.646923</td>
      <td>7.160</td>
      <td>13.3925</td>
      <td>20.725</td>
      <td>138.7950</td>
      <td>477.240</td>
    </tr>
    <tr>
      <th>Huntsville</th>
      <td>10.0</td>
      <td>248.437000</td>
      <td>419.576667</td>
      <td>3.620</td>
      <td>26.8700</td>
      <td>81.920</td>
      <td>171.8075</td>
      <td>1319.960</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Wisconsin</th>
      <th>Superior</th>
      <td>9.0</td>
      <td>144.414444</td>
      <td>213.394065</td>
      <td>5.560</td>
      <td>17.1200</td>
      <td>47.400</td>
      <td>125.9900</td>
      <td>629.100</td>
    </tr>
    <tr>
      <th>Waukesha</th>
      <td>1.0</td>
      <td>54.500000</td>
      <td>NaN</td>
      <td>54.500</td>
      <td>54.5000</td>
      <td>54.500</td>
      <td>54.5000</td>
      <td>54.500</td>
    </tr>
    <tr>
      <th>Wausau</th>
      <td>4.0</td>
      <td>79.370000</td>
      <td>111.450605</td>
      <td>12.390</td>
      <td>20.0325</td>
      <td>29.605</td>
      <td>88.9425</td>
      <td>245.880</td>
    </tr>
    <tr>
      <th>West Allis</th>
      <td>2.0</td>
      <td>125.240000</td>
      <td>165.067007</td>
      <td>8.520</td>
      <td>66.8800</td>
      <td>125.240</td>
      <td>183.6000</td>
      <td>241.960</td>
    </tr>
    <tr>
      <th>Wyoming</th>
      <th>Cheyenne</th>
      <td>1.0</td>
      <td>1603.136000</td>
      <td>NaN</td>
      <td>1603.136</td>
      <td>1603.1360</td>
      <td>1603.136</td>
      <td>1603.1360</td>
      <td>1603.136</td>
    </tr>
  </tbody>
</table>
<p>604 rows × 8 columns</p>
</div>
</div>
</div>
<p><a style="text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;" href="https://deepnote.com?utm_source=created-in-deepnote-cell&amp;projectId=dfff8ba7-aef1-4bba-91c9-7743c312b252" target="_blank"> <img alt="Created in deepnote.com" style="display:inline;max-height:16px;margin:0px;margin-right:7.5px;" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+">  Created in <span style="font-weight:600;margin-left:4px;">Deepnote</span></a></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>