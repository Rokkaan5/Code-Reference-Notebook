<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jasmine Kobayashi">

<title>Generalized Linear Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="STAT-5010-Unit6-Code_files/libs/clipboard/clipboard.min.js"></script>
<script src="STAT-5010-Unit6-Code_files/libs/quarto-html/quarto.js"></script>
<script src="STAT-5010-Unit6-Code_files/libs/quarto-html/popper.min.js"></script>
<script src="STAT-5010-Unit6-Code_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="STAT-5010-Unit6-Code_files/libs/quarto-html/anchor.min.js"></script>
<link href="STAT-5010-Unit6-Code_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="STAT-5010-Unit6-Code_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="STAT-5010-Unit6-Code_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="STAT-5010-Unit6-Code_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="STAT-5010-Unit6-Code_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#problem-1" id="toc-problem-1" class="nav-link active" data-scroll-target="#problem-1">Problem #1</a>
  <ul class="collapse">
  <li><a href="#a-construct-a-new-variable-called-prop-which-is-the-proportion-of-damaged-o-rings.-plot-prop-against-temperature.-what-do-you-notice-about-this-plot" id="toc-a-construct-a-new-variable-called-prop-which-is-the-proportion-of-damaged-o-rings.-plot-prop-against-temperature.-what-do-you-notice-about-this-plot" class="nav-link" data-scroll-target="#a-construct-a-new-variable-called-prop-which-is-the-proportion-of-damaged-o-rings.-plot-prop-against-temperature.-what-do-you-notice-about-this-plot">(a) Construct a new variable called prop, which is the proportion of damaged ‘O’ rings. Plot prop against temperature. What do you notice about this plot?</a></li>
  <li><a href="#b-use-the-glm-function-for-fitting-the-logit-model-logistic-regression." id="toc-b-use-the-glm-function-for-fitting-the-logit-model-logistic-regression." class="nav-link" data-scroll-target="#b-use-the-glm-function-for-fitting-the-logit-model-logistic-regression.">(b) Use the <code>glm()</code> function for fitting the logit model (logistic regression).</a></li>
  <li><a href="#c-plot-the-data-again-with-the-logit-model." id="toc-c-plot-the-data-again-with-the-logit-model." class="nav-link" data-scroll-target="#c-plot-the-data-again-with-the-logit-model.">(c) Plot the data again with the logit model.</a></li>
  <li><a href="#d-now-lets-check-the-interpretation-of-widehatbeta_1.-create-a-new-temperature-value-of-45-and-46-degrees.-calculuate-the-odds-of-failure-at-45-and-46-degrees.-what-is-the-ratio-of-these-two-odds" id="toc-d-now-lets-check-the-interpretation-of-widehatbeta_1.-create-a-new-temperature-value-of-45-and-46-degrees.-calculuate-the-odds-of-failure-at-45-and-46-degrees.-what-is-the-ratio-of-these-two-odds" class="nav-link" data-scroll-target="#d-now-lets-check-the-interpretation-of-widehatbeta_1.-create-a-new-temperature-value-of-45-and-46-degrees.-calculuate-the-odds-of-failure-at-45-and-46-degrees.-what-is-the-ratio-of-these-two-odds">(d) Now let’s check the interpretation of <span class="math inline">\(\widehat{\beta}_1\)</span>. Create a new temperature value of 45 and 46 degrees. Calculuate the odds of failure at 45 and 46 degrees. What is the ratio of these two odds?</a></li>
  <li><a href="#e-compute-confidence-intervals-for-the-model-parameters-by-hand." id="toc-e-compute-confidence-intervals-for-the-model-parameters-by-hand." class="nav-link" data-scroll-target="#e-compute-confidence-intervals-for-the-model-parameters-by-hand.">(e) Compute confidence intervals for the model parameters “by hand”.</a></li>
  <li><a href="#f-now-compute-them-using-confintglmod." id="toc-f-now-compute-them-using-confintglmod." class="nav-link" data-scroll-target="#f-now-compute-them-using-confintglmod.">(f) Now compute them using confint(glmod).</a></li>
  <li><a href="#g-predict-the-probability-of-faulire-at-temp-45-degrees." id="toc-g-predict-the-probability-of-faulire-at-temp-45-degrees." class="nav-link" data-scroll-target="#g-predict-the-probability-of-faulire-at-temp-45-degrees.">(g) Predict the probability of faulire at Temp = 45 degrees.</a></li>
  </ul></li>
  <li><a href="#problem-2" id="toc-problem-2" class="nav-link" data-scroll-target="#problem-2">Problem #2</a>
  <ul class="collapse">
  <li><a href="#a-perform-logistic-regression-treating-admit-as-the-response.-be-sure-to-treat-rank-as-a-categorical-variable." id="toc-a-perform-logistic-regression-treating-admit-as-the-response.-be-sure-to-treat-rank-as-a-categorical-variable." class="nav-link" data-scroll-target="#a-perform-logistic-regression-treating-admit-as-the-response.-be-sure-to-treat-rank-as-a-categorical-variable.">(a) Perform logistic regression treating <code>admit</code> as the response. Be sure to treat <code>rank</code> as a categorical variable.</a></li>
  <li><a href="#b-construct-a-reduced-model-without-the-rank-variable.-conduct-the-likelihood-ratio-test-to-decide-whether-the-reduced-model-is-sufficient.-you-can-do-this-using-anova-or-lrtest." id="toc-b-construct-a-reduced-model-without-the-rank-variable.-conduct-the-likelihood-ratio-test-to-decide-whether-the-reduced-model-is-sufficient.-you-can-do-this-using-anova-or-lrtest." class="nav-link" data-scroll-target="#b-construct-a-reduced-model-without-the-rank-variable.-conduct-the-likelihood-ratio-test-to-decide-whether-the-reduced-model-is-sufficient.-you-can-do-this-using-anova-or-lrtest.">(b) Construct a reduced model without the <code>rank</code> variable. Conduct the likelihood ratio test to decide whether the reduced model is sufficient. You can do this using <code>anova()</code> or <code>lrtest()</code>.</a></li>
  </ul></li>
  <li><a href="#problem-3" id="toc-problem-3" class="nav-link" data-scroll-target="#problem-3">Problem #3</a>
  <ul class="collapse">
  <li><a href="#a-remove-the-endemics-variable-from-the-dataframe-and-fit-a-linear-model-with-species-as-the-response-and-all-other-variables-as-predictors.-run-some-diagnostics-and-explain-why-this-model-is-not-the-best-fit." id="toc-a-remove-the-endemics-variable-from-the-dataframe-and-fit-a-linear-model-with-species-as-the-response-and-all-other-variables-as-predictors.-run-some-diagnostics-and-explain-why-this-model-is-not-the-best-fit." class="nav-link" data-scroll-target="#a-remove-the-endemics-variable-from-the-dataframe-and-fit-a-linear-model-with-species-as-the-response-and-all-other-variables-as-predictors.-run-some-diagnostics-and-explain-why-this-model-is-not-the-best-fit.">(a) Remove the Endemics variable from the dataframe, and fit a linear model with Species as the response and all other variables as predictors. Run some diagnostics and explain why this model is not the best fit.</a></li>
  <li><a href="#b-recall-that-a-square-root-transformation-of-the-response-might-be-helpful-when-the-nonconstant-variance-assumption-is-violated.-try-this-transformation." id="toc-b-recall-that-a-square-root-transformation-of-the-response-might-be-helpful-when-the-nonconstant-variance-assumption-is-violated.-try-this-transformation." class="nav-link" data-scroll-target="#b-recall-that-a-square-root-transformation-of-the-response-might-be-helpful-when-the-nonconstant-variance-assumption-is-violated.-try-this-transformation.">(b) Recall that a square root transformation of the response might be helpful when the nonconstant variance assumption is violated. Try this transformation.</a></li>
  <li><a href="#c-one-issue-with-a-transformation-is-that-it-makes-interpretation-less-natural.-lets-try-a-poisson-regression-with-no-transformation-on-the-repsonse." id="toc-c-one-issue-with-a-transformation-is-that-it-makes-interpretation-less-natural.-lets-try-a-poisson-regression-with-no-transformation-on-the-repsonse." class="nav-link" data-scroll-target="#c-one-issue-with-a-transformation-is-that-it-makes-interpretation-less-natural.-lets-try-a-poisson-regression-with-no-transformation-on-the-repsonse.">(c) One issue with a transformation is that it makes interpretation less natural. Let’s try a Poisson regression (with no transformation on the repsonse).</a></li>
  <li><a href="#d-interpret-the-parameter-associated-with-nearest." id="toc-d-interpret-the-parameter-associated-with-nearest." class="nav-link" data-scroll-target="#d-interpret-the-parameter-associated-with-nearest.">(d) Interpret the parameter associated with Nearest.</a></li>
  <li><a href="#e-calculate-the-deviance-for-poisson-regression.-does-this-value-show-up-in-the-summary-also-check-the-goodness-of-fit-of-this-model-using-pearsons-chi2-statistic.-what-do-you-conclude-about-the-fit" id="toc-e-calculate-the-deviance-for-poisson-regression.-does-this-value-show-up-in-the-summary-also-check-the-goodness-of-fit-of-this-model-using-pearsons-chi2-statistic.-what-do-you-conclude-about-the-fit" class="nav-link" data-scroll-target="#e-calculate-the-deviance-for-poisson-regression.-does-this-value-show-up-in-the-summary-also-check-the-goodness-of-fit-of-this-model-using-pearsons-chi2-statistic.-what-do-you-conclude-about-the-fit">(e) Calculate the deviance for Poisson regression. Does this value show up in the summary? Also, check the goodness of fit of this model using Pearson’s <span class="math inline">\(\chi^2\)</span> statistic. What do you conclude about the fit?</a></li>
  </ul></li>
  <li><a href="#problem-4-optional" id="toc-problem-4-optional" class="nav-link" data-scroll-target="#problem-4-optional">Problem #4 (Optional)</a></li>
  <li><a href="#problem-5" id="toc-problem-5" class="nav-link" data-scroll-target="#problem-5">Problem #5</a>
  <ul class="collapse">
  <li><a href="#a-fit-a-poisson-model-with-an-offset-for-population-and-then-estiamte-the-dispersion-parameter." id="toc-a-fit-a-poisson-model-with-an-offset-for-population-and-then-estiamte-the-dispersion-parameter." class="nav-link" data-scroll-target="#a-fit-a-poisson-model-with-an-offset-for-population-and-then-estiamte-the-dispersion-parameter.">(a) Fit a Poisson model, with an offset for population, and then estiamte the dispersion parameter.</a>
  <ul class="collapse">
  <li><a href="#b-fit-a-reduced-model-without-the-city-variable.-test-to-see-if-city-is-needed." id="toc-b-fit-a-reduced-model-without-the-city-variable.-test-to-see-if-city-is-needed." class="nav-link" data-scroll-target="#b-fit-a-reduced-model-without-the-city-variable.-test-to-see-if-city-is-needed.">(b) Fit a reduced model without the city variable. Test to see if city is needed.</a></li>
  <li><a href="#c-look-at-some-plots-to-diagnose-problems-with-the-model." id="toc-c-look-at-some-plots-to-diagnose-problems-with-the-model." class="nav-link" data-scroll-target="#c-look-at-some-plots-to-diagnose-problems-with-the-model.">(c) Look at some plots to diagnose problems with the model.</a></li>
  <li><a href="#d-use-the-reduced-model-to-predict-the-rate-of-cancer-at-age-40-54-and-pop-1000-i.e.-cancer-per-1000-people.-then-use-the-full-model-to-predict-the-rate-of-cancer-at-at-age-40-54-and-pop-1000-in-the-city-of-kolding.-do-the-predictions-differ-very-much" id="toc-d-use-the-reduced-model-to-predict-the-rate-of-cancer-at-age-40-54-and-pop-1000-i.e.-cancer-per-1000-people.-then-use-the-full-model-to-predict-the-rate-of-cancer-at-at-age-40-54-and-pop-1000-in-the-city-of-kolding.-do-the-predictions-differ-very-much" class="nav-link" data-scroll-target="#d-use-the-reduced-model-to-predict-the-rate-of-cancer-at-age-40-54-and-pop-1000-i.e.-cancer-per-1000-people.-then-use-the-full-model-to-predict-the-rate-of-cancer-at-at-age-40-54-and-pop-1000-in-the-city-of-kolding.-do-the-predictions-differ-very-much">(d) Use the reduced model to predict the rate of cancer at age = “40-54” and pop = 1000 (i.e., cancer per 1000 people). Then, use the full model to predict the rate of cancer at at age = “40-54” and pop = 1000 in the city of Kolding. Do the predictions differ very much?</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Generalized Linear Models</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jasmine Kobayashi </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>The goal of this assignment is to analyze data using generalized linear models.</p>
<section id="problem-1" class="level1">
<h1>Problem #1</h1>
<p>In January 1986, the space shuttle Challenger exploded shortly after launch. An investigation was launched into the cause of the crash and attention focused on the rubber O-ring seals in the rocket boosters. At lower temperatures, rubber becomes more brittle and is a less effective sealant. At the time of the launch, the temperature was 31°F. Could the failure of the O-rings have been predicted? In the 23 previous shuttle missions for which data exists, some evidence of damage due to blow by and erosion was recorded on some O-rings. Each shuttle had two boosters, each with three O-rings. For each mission, we know the number of O-rings out of six showing some damage and the launch temperature.</p>
<p>The ‘orings’ is a data frame with 23 observations on the following 2 variables.</p>
<ol type="1">
<li>temp: Ambient temperature (Fahrenheit) at launch time</li>
<li>damage: Number of damaged ‘O’ rings (out of a total of 6)</li>
</ol>
<section id="a-construct-a-new-variable-called-prop-which-is-the-proportion-of-damaged-o-rings.-plot-prop-against-temperature.-what-do-you-notice-about-this-plot" class="level2">
<h2 class="anchored" data-anchor-id="a-construct-a-new-variable-called-prop-which-is-the-proportion-of-damaged-o-rings.-plot-prop-against-temperature.-what-do-you-notice-about-this-plot">(a) Construct a new variable called prop, which is the proportion of damaged ‘O’ rings. Plot prop against temperature. What do you notice about this plot?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(aod) #wald.test</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(lmtest) #lrtest (likelihood ratio test--same as anova)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>orings <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="fu">url</span>(<span class="fu">paste0</span>(<span class="st">"https://raw.githubusercontent.com/bzaharatos/"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"-Statistical-Modeling-for-Data-Science-Applications/"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"master/Generalized%20Linear%20Models%20and%20Nonparametric%20Regression/"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Datasets/orings.txt"</span>)), <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(orings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  temp damage
1   53      5
2   57      1
3   58      1
4   63      1
5   66      0
6   67      0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>orings<span class="sc">$</span>prop <span class="ot">=</span> orings<span class="sc">$</span>damage<span class="sc">/</span><span class="dv">6</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(orings, <span class="fu">plot</span>(temp, prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="STAT-5010-Unit6-Code_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="b-use-the-glm-function-for-fitting-the-logit-model-logistic-regression." class="level2">
<h2 class="anchored" data-anchor-id="b-use-the-glm-function-for-fitting-the-logit-model-logistic-regression.">(b) Use the <code>glm()</code> function for fitting the logit model (logistic regression).</h2>
<p>Note: The first argument will be the model: <code>response ~ predictors</code>. For binomial response data, we need two pieces of information about the response values: <code>y</code> and <code>n</code>. Thus for binomial families, the response can be specified as a two-column matrix with the columns giving the numbers of successes and failures. You’ll also need to specify the <code>family</code> argument, and the <code>data</code> argument. Use ?glm to specify these arguments.</p>
<p>First, just note that a standard linear model isn’t a great idea…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#first, just note that a standard linear model isn't a great idea...</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>lmod <span class="ot">=</span> <span class="fu">lm</span>(prop <span class="sc">~</span> temp, orings) <span class="co">#Use SLR...</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(orings, <span class="fu">plot</span>(temp, prop))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lmod) <span class="co">#fit...bad idea</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="STAT-5010-Unit6-Code_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = prop ~ temp, data = orings)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.13786 -0.10345 -0.02369  0.06601  0.48345 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.21429    0.29993   4.049 0.000578 ***
temp        -0.01631    0.00429  -3.801 0.001043 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.142 on 21 degrees of freedom
Multiple R-squared:  0.4076,    Adjusted R-squared:  0.3794 
F-statistic: 14.45 on 1 and 21 DF,  p-value: 0.001043</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>glmod <span class="ot">=</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(orings<span class="sc">$</span>damage,<span class="dv">6</span><span class="sc">-</span>orings<span class="sc">$</span>damage) <span class="sc">~</span> temp, <span class="at">data =</span> orings, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> binomial)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cbind(orings$damage, 6 - orings$damage) ~ temp, 
    family = binomial, data = orings)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 11.66299    3.29626   3.538 0.000403 ***
temp        -0.21623    0.05318  -4.066 4.78e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 38.898  on 22  degrees of freedom
Residual deviance: 16.912  on 21  degrees of freedom
AIC: 33.675

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>phat <span class="ot">=</span> <span class="fu">predict</span>(glmod, <span class="at">type =</span> <span class="st">"response"</span>); <span class="co">#phat</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fu">with</span>(orings, (damage<span class="sc">/</span><span class="dv">6</span> <span class="sc">-</span> phat)<span class="sc">/</span><span class="fu">sqrt</span>((phat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>phat))<span class="sc">/</span><span class="dv">6</span>)) <span class="co">#Pearson Residuals</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">resid</span>(glmod, <span class="at">type =</span> <span class="st">"deviance"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.9529 -0.7345 -0.4393 -0.1661 -0.2079  1.9565 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.89727 -0.56606 -0.31188  0.07184 -0.14717  3.77106 </code></pre>
</div>
</div>
</section>
<section id="c-plot-the-data-again-with-the-logit-model." class="level2">
<h2 class="anchored" data-anchor-id="c-plot-the-data-again-with-the-logit-model.">(c) Plot the data again with the logit model.</h2>
<p>You’ll need the inverse of the logit function: <span class="math display">\[\text{logit}(\eta) = \frac{e^\eta}{1 + e^\eta}.\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(orings<span class="sc">$</span>temp,orings<span class="sc">$</span>prop, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">85</span>), </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">"Temp"</span>,<span class="at">ylab =</span> <span class="st">"Prob of Damage"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">85</span>,<span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">=</span> <span class="fl">11.66299</span> <span class="sc">-</span> <span class="fl">0.21623</span><span class="sc">*</span>x</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>ilogit <span class="ot">=</span> <span class="fu">exp</span>(eta)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(eta))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, ilogit,<span class="at">col =</span> <span class="st">"grey"</span>) <span class="co">#ilogit is the inverse logit transform</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="STAT-5010-Unit6-Code_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="d-now-lets-check-the-interpretation-of-widehatbeta_1.-create-a-new-temperature-value-of-45-and-46-degrees.-calculuate-the-odds-of-failure-at-45-and-46-degrees.-what-is-the-ratio-of-these-two-odds" class="level2">
<h2 class="anchored" data-anchor-id="d-now-lets-check-the-interpretation-of-widehatbeta_1.-create-a-new-temperature-value-of-45-and-46-degrees.-calculuate-the-odds-of-failure-at-45-and-46-degrees.-what-is-the-ratio-of-these-two-odds">(d) Now let’s check the interpretation of <span class="math inline">\(\widehat{\beta}_1\)</span>. Create a new temperature value of 45 and 46 degrees. Calculuate the odds of failure at 45 and 46 degrees. What is the ratio of these two odds?</h2>
<p>Note that in general, the odds ratio is equal to:</p>
<p><span class="math display">\[\begin{align*}
\frac{o_{x+1}}{o_{x}} &amp;= \frac{e^{\beta_0 + \beta_1(x+1)}}{e^{\beta_0 + \beta_1x}} = \frac{e^{\beta_0 + \beta_1x + \beta_1(1)}}{e^{\beta_0 + \beta_1 x}} = \frac{e^{\beta_0 + \beta_1 x}e^{\beta_1}}{e^{\beta_0 + \beta_1x}} = e^{\beta_1}.
\end{align*}\]</span></p>
<p>Thus, an estimate of the odds ratio is <span class="math inline">\(\displaystyle\frac{\widehat{o}_{46}}{\widehat o_{45}} = e^{\widehat\beta_1}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">temp =</span> <span class="dv">45</span>)  <span class="co">#chooses a value of temp </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>logodds1 <span class="ot">=</span> (<span class="fu">coef</span>(glmod)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(glmod)[<span class="dv">2</span>]<span class="sc">*</span>newdata) <span class="co">#log odds of failure at temp = 45</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>odds1 <span class="ot">=</span> <span class="fu">exp</span>(logodds1) <span class="co">#calculuate the odds...</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>newdata2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">temp =</span> <span class="dv">46</span>) <span class="co">#add 1... </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>logodds2 <span class="ot">=</span>(<span class="fu">coef</span>(glmod)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(glmod)[<span class="dv">2</span>]<span class="sc">*</span>newdata2) <span class="co">#log odds of failure at temp = 46</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>odds2 <span class="ot">=</span> <span class="fu">exp</span>(logodds2) <span class="co">#calculuate the odds...</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#check interpretation...</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>odds2<span class="sc">/</span>odds1 <span class="co">#should equal exp(coef(glmod)[2]) #</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       temp
1 0.8055471</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(glmod)[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     temp 
0.8055471 </code></pre>
</div>
</div>
</section>
<section id="e-compute-confidence-intervals-for-the-model-parameters-by-hand." class="level2">
<h2 class="anchored" data-anchor-id="e-compute-confidence-intervals-for-the-model-parameters-by-hand.">(e) Compute confidence intervals for the model parameters “by hand”.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>beta0CI <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">coef</span>(glmod)[<span class="dv">1</span>] <span class="sc">-</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fl">3.29626</span>, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">coef</span>(glmod)[<span class="dv">1</span>] <span class="sc">+</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fl">3.29626</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>beta1CI <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">coef</span>(glmod)[<span class="dv">2</span>] <span class="sc">-</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fl">0.05318</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">coef</span>(glmod)[<span class="dv">2</span>] <span class="sc">+</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span> <span class="fl">0.05318</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>beta0CI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) (Intercept) 
   5.202439   18.123541 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>beta1CI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      temp       temp 
-0.3204645 -0.1120028 </code></pre>
</div>
</div>
</section>
<section id="f-now-compute-them-using-confintglmod." class="level2">
<h2 class="anchored" data-anchor-id="f-now-compute-them-using-confintglmod.">(f) Now compute them using confint(glmod).</h2>
<p>Notice that these intervals are slightly different; they are based on the profile likelihood and do not assume asymptotic normality. They are more accurate for small sample sizes. Profile likelihood confidence intervals don’t assume normality of the estimator and appear to perform better for small samples sizes than Wald CIs (above). They are, nonetheless, still based on an asymptotic approximation – the asymptotic chi-square distribution of the log likelihood ratio test statistic. (for more info: http://www.math.umt.edu/patterson/ProfileLikelihoodCI.pdf)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(glmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %    97.5 %
(Intercept)  5.575195 18.737598
temp        -0.332657 -0.120179</code></pre>
</div>
</div>
</section>
<section id="g-predict-the-probability-of-faulire-at-temp-45-degrees." class="level2">
<h2 class="anchored" data-anchor-id="g-predict-the-probability-of-faulire-at-temp-45-degrees.">(g) Predict the probability of faulire at Temp = 45 degrees.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">predict.glm</span>(glmod, newdata, <span class="at">se =</span> T, <span class="at">type =</span> <span class="st">"response"</span>) </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>pred<span class="sc">$</span>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.8735231 </code></pre>
</div>
</div>
</section>
</section>
<section id="problem-2" class="level1">
<h1>Problem #2</h1>
<p>A researcher is interested in how variables, such as gre (Graduate Record Exam scores), gpa (grade point average) and prestige of the undergraduate institution (rank), effect admission into graduate school. The response variable, admit/don’t admit, is a binary variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>admission <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"https://stats.idre.ucla.edu/stat/data/binary.csv"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(admission)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  admit gre  gpa rank
1     0 380 3.61    3
2     1 660 3.67    3
3     1 800 4.00    1
4     1 640 3.19    4
5     0 520 2.93    4
6     1 760 3.00    2</code></pre>
</div>
</div>
<section id="a-perform-logistic-regression-treating-admit-as-the-response.-be-sure-to-treat-rank-as-a-categorical-variable." class="level2">
<h2 class="anchored" data-anchor-id="a-perform-logistic-regression-treating-admit-as-the-response.-be-sure-to-treat-rank-as-a-categorical-variable.">(a) Perform logistic regression treating <code>admit</code> as the response. Be sure to treat <code>rank</code> as a categorical variable.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>admission<span class="sc">$</span>rank <span class="ot">=</span> <span class="fu">as.factor</span>(admission<span class="sc">$</span>rank)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>admission.glm <span class="ot">=</span> <span class="fu">glm</span>(admit <span class="sc">~</span> gre <span class="sc">+</span> gpa <span class="sc">+</span> rank, <span class="at">data =</span> admission, <span class="at">family =</span> binomial)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(admission.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = admit ~ gre + gpa + rank, family = binomial, data = admission)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -3.989979   1.139951  -3.500 0.000465 ***
gre          0.002264   0.001094   2.070 0.038465 *  
gpa          0.804038   0.331819   2.423 0.015388 *  
rank2       -0.675443   0.316490  -2.134 0.032829 *  
rank3       -1.340204   0.345306  -3.881 0.000104 ***
rank4       -1.551464   0.417832  -3.713 0.000205 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 499.98  on 399  degrees of freedom
Residual deviance: 458.52  on 394  degrees of freedom
AIC: 470.52

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint.default</span>(admission.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    2.5 %       97.5 %
(Intercept) -6.2242418514 -1.755716295
gre          0.0001202298  0.004408622
gpa          0.1536836760  1.454391423
rank2       -1.2957512650 -0.055134591
rank3       -2.0169920597 -0.663415773
rank4       -2.3703986294 -0.732528724</code></pre>
</div>
</div>
</section>
<section id="b-construct-a-reduced-model-without-the-rank-variable.-conduct-the-likelihood-ratio-test-to-decide-whether-the-reduced-model-is-sufficient.-you-can-do-this-using-anova-or-lrtest." class="level2">
<h2 class="anchored" data-anchor-id="b-construct-a-reduced-model-without-the-rank-variable.-conduct-the-likelihood-ratio-test-to-decide-whether-the-reduced-model-is-sufficient.-you-can-do-this-using-anova-or-lrtest.">(b) Construct a reduced model without the <code>rank</code> variable. Conduct the likelihood ratio test to decide whether the reduced model is sufficient. You can do this using <code>anova()</code> or <code>lrtest()</code>.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>admission.red.glm <span class="ot">=</span> <span class="fu">glm</span>(admit <span class="sc">~</span> gre <span class="sc">+</span> gpa, <span class="at">data =</span> admission, <span class="at">family =</span> binomial)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(admission.red.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = admit ~ gre + gpa, family = binomial, data = admission)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -4.949378   1.075093  -4.604 4.15e-06 ***
gre          0.002691   0.001057   2.544   0.0109 *  
gpa          0.754687   0.319586   2.361   0.0182 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 499.98  on 399  degrees of freedom
Residual deviance: 480.34  on 397  degrees of freedom
AIC: 486.34

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(admission.red.glm, admission.glm, <span class="at">test =</span> <span class="st">"Chisq"</span>) <span class="co">#Likelihood ratio test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: admit ~ gre + gpa
Model 2: admit ~ gre + gpa + rank
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1       397     480.34                          
2       394     458.52  3   21.826 7.088e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>YOUR ANSWER HERE</p>
</section>
</section>
<section id="problem-3" class="level1">
<h1>Problem #3</h1>
<p>For each 30 Galapagos islands, we have a count of the number of plant species found on each island and the number that are endemic to that island. We also have five geographic variables for each island.</p>
<ol type="1">
<li>Species: the number of plant species found on the island</li>
<li>Endemics: the number of endemic species</li>
<li>Area: the area of the island (km<span class="math inline">\(^2\)</span>)</li>
<li>Elevation: the highest elevation of the island (m)</li>
<li>Nearest: the distance from the nearest island (km)</li>
<li>Scruz: the distance from Santa Cruz island (km)</li>
<li>Adjacent: the area of the adjacent island (square km)</li>
</ol>
<section id="a-remove-the-endemics-variable-from-the-dataframe-and-fit-a-linear-model-with-species-as-the-response-and-all-other-variables-as-predictors.-run-some-diagnostics-and-explain-why-this-model-is-not-the-best-fit." class="level2">
<h2 class="anchored" data-anchor-id="a-remove-the-endemics-variable-from-the-dataframe-and-fit-a-linear-model-with-species-as-the-response-and-all-other-variables-as-predictors.-run-some-diagnostics-and-explain-why-this-model-is-not-the-best-fit.">(a) Remove the Endemics variable from the dataframe, and fit a linear model with Species as the response and all other variables as predictors. Run some diagnostics and explain why this model is not the best fit.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>gala <span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">"https://www.colorado.edu/amath/sites/default/files/attached-files/gala.txt"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>gala <span class="ot">=</span> gala[,<span class="sc">-</span><span class="dv">2</span>]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gala)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Species  Area Elevation Nearest Scruz Adjacent
Baltra            58 25.09       346     0.6   0.6     1.84
Bartolome         31  1.24       109     0.6  26.3   572.33
Caldwell           3  0.21       114     2.8  58.7     0.78
Champion          25  0.10        46     1.9  47.4     0.18
Coamano            2  0.05        77     1.9   1.9   903.82
Daphne.Major      18  0.34       119     8.0   8.0     1.84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(gala)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30  6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>lmod <span class="ot">=</span> <span class="fu">lm</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> gala)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Species ~ ., data = gala)

Residuals:
     Min       1Q   Median       3Q      Max 
-111.679  -34.898   -7.862   33.460  182.584 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.068221  19.154198   0.369 0.715351    
Area        -0.023938   0.022422  -1.068 0.296318    
Elevation    0.319465   0.053663   5.953 3.82e-06 ***
Nearest      0.009144   1.054136   0.009 0.993151    
Scruz       -0.240524   0.215402  -1.117 0.275208    
Adjacent    -0.074805   0.017700  -4.226 0.000297 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 60.98 on 24 degrees of freedom
Multiple R-squared:  0.7658,    Adjusted R-squared:  0.7171 
F-statistic:  15.7 on 5 and 24 DF,  p-value: 6.838e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="STAT-5010-Unit6-Code_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">fitted</span>(lmod), <span class="at">y =</span> <span class="fu">stdres</span>(lmod))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="STAT-5010-Unit6-Code_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="b-recall-that-a-square-root-transformation-of-the-response-might-be-helpful-when-the-nonconstant-variance-assumption-is-violated.-try-this-transformation." class="level2">
<h2 class="anchored" data-anchor-id="b-recall-that-a-square-root-transformation-of-the-response-might-be-helpful-when-the-nonconstant-variance-assumption-is-violated.-try-this-transformation.">(b) Recall that a square root transformation of the response might be helpful when the nonconstant variance assumption is violated. Try this transformation.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>lmod2 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">sqrt</span>(Species) <span class="sc">~</span> ., <span class="at">data =</span> gala)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sqrt(Species) ~ ., data = gala)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5572 -1.4969 -0.3031  1.3527  5.2110 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.3919243  0.8712678   3.893 0.000690 ***
Area        -0.0019718  0.0010199  -1.933 0.065080 .  
Elevation    0.0164784  0.0024410   6.751 5.55e-07 ***
Nearest      0.0249326  0.0479495   0.520 0.607844    
Scruz       -0.0134826  0.0097980  -1.376 0.181509    
Adjacent    -0.0033669  0.0008051  -4.182 0.000333 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.774 on 24 degrees of freedom
Multiple R-squared:  0.7827,    Adjusted R-squared:  0.7374 
F-statistic: 17.29 on 5 and 24 DF,  p-value: 2.874e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(2,2)); plot(lmod2)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">fitted</span>(lmod2), <span class="at">y =</span> <span class="fu">stdres</span>(lmod2))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="STAT-5010-Unit6-Code_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="c-one-issue-with-a-transformation-is-that-it-makes-interpretation-less-natural.-lets-try-a-poisson-regression-with-no-transformation-on-the-repsonse." class="level2">
<h2 class="anchored" data-anchor-id="c-one-issue-with-a-transformation-is-that-it-makes-interpretation-less-natural.-lets-try-a-poisson-regression-with-no-transformation-on-the-repsonse.">(c) One issue with a transformation is that it makes interpretation less natural. Let’s try a Poisson regression (with no transformation on the repsonse).</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>glmod <span class="ot">=</span> <span class="fu">glm</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> gala, <span class="at">family =</span> poisson)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Species ~ ., family = poisson, data = gala)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.155e+00  5.175e-02  60.963  &lt; 2e-16 ***
Area        -5.799e-04  2.627e-05 -22.074  &lt; 2e-16 ***
Elevation    3.541e-03  8.741e-05  40.507  &lt; 2e-16 ***
Nearest      8.826e-03  1.821e-03   4.846 1.26e-06 ***
Scruz       -5.709e-03  6.256e-04  -9.126  &lt; 2e-16 ***
Adjacent    -6.630e-04  2.933e-05 -22.608  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 3510.73  on 29  degrees of freedom
Residual deviance:  716.85  on 24  degrees of freedom
AIC: 889.68

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(2,2)); plot(glmod)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">predict</span>(glmod, <span class="at">type =</span> <span class="st">"link"</span>), <span class="at">y =</span> <span class="fu">stdres</span>(glmod))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="STAT-5010-Unit6-Code_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="d-interpret-the-parameter-associated-with-nearest." class="level2">
<h2 class="anchored" data-anchor-id="d-interpret-the-parameter-associated-with-nearest.">(d) Interpret the parameter associated with Nearest.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fl">8.826e-03</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.008865</code></pre>
</div>
</div>
<p>YOUR ANSWER HERE</p>
</section>
<section id="e-calculate-the-deviance-for-poisson-regression.-does-this-value-show-up-in-the-summary-also-check-the-goodness-of-fit-of-this-model-using-pearsons-chi2-statistic.-what-do-you-conclude-about-the-fit" class="level2">
<h2 class="anchored" data-anchor-id="e-calculate-the-deviance-for-poisson-regression.-does-this-value-show-up-in-the-summary-also-check-the-goodness-of-fit-of-this-model-using-pearsons-chi2-statistic.-what-do-you-conclude-about-the-fit">(e) Calculate the deviance for Poisson regression. Does this value show up in the summary? Also, check the goodness of fit of this model using Pearson’s <span class="math inline">\(\chi^2\)</span> statistic. What do you conclude about the fit?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>d_res <span class="ot">=</span> <span class="fu">with</span>(gala, <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(Species<span class="sc">*</span><span class="fu">log</span>(<span class="fu">fitted</span>(glmod)<span class="sc">/</span>Species)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                 <span class="sc">-</span> (Species <span class="sc">-</span> <span class="fu">fitted</span>(glmod))))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>d_res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 716.8458</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>chisq <span class="ot">=</span> <span class="fu">with</span>(gala, <span class="fu">sum</span>((Species <span class="sc">-</span> <span class="fu">fitted</span>(glmod))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">fitted</span>(glmod)))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>chisq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 761.9792</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(chisq, <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>YOUR ANSWER HERE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co">#checking whether dropping nearest is reasonable...</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>glmodred <span class="ot">=</span> <span class="fu">glm</span>(Species <span class="sc">~</span> .<span class="sc">-</span>Nearest, <span class="at">data =</span> gala, <span class="at">family =</span> poisson)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(glmodred, glmod, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: Species ~ (Area + Elevation + Nearest + Scruz + Adjacent) - Nearest
Model 2: Species ~ Area + Elevation + Nearest + Scruz + Adjacent
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1        25     739.41                          
2        24     716.85  1   22.565 2.031e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
</section>
<section id="problem-4-optional" class="level1">
<h1>Problem #4 (Optional)</h1>
<p>Research another type of GLM (beyond binomial and Poisson), find a dataset that is reasonably modeled by that GLM, and model it. Does the model fit well?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#YOUR CODE HERE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="problem-5" class="level1">
<h1>Problem #5</h1>
<p>The following data is on lung cancer incidence in four Danish cities 1968-1971. This data set contains counts of incident lung cancer cases and population size in four neighbouring Danish cities by age group.</p>
<p>Because we have an exposure (population), we should include an offset term.</p>
<section id="a-fit-a-poisson-model-with-an-offset-for-population-and-then-estiamte-the-dispersion-parameter." class="level2">
<h2 class="anchored" data-anchor-id="a-fit-a-poisson-model-with-an-offset-for-population-and-then-estiamte-the-dispersion-parameter.">(a) Fit a Poisson model, with an offset for population, and then estiamte the dispersion parameter.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISwR)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(eba1977)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>cancer <span class="ot">=</span> eba1977</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cancer, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         city   age  pop cases
1  Fredericia 40-54 3059    11
2     Horsens 40-54 2879    13
3     Kolding 40-54 3142     4
4       Vejle 40-54 2520     5
5  Fredericia 55-59  800    11
6     Horsens 55-59 1083     6
7     Kolding 55-59 1050     8
8       Vejle 55-59  878     7
9  Fredericia 60-64  710    11
10    Horsens 60-64  923    15</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>glmodrate <span class="ot">=</span> <span class="fu">glm</span>(cases <span class="sc">~</span> age <span class="sc">+</span> city <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(pop)), <span class="at">data =</span> cancer, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glmodrate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cases ~ age + city + offset(log(pop)), family = poisson(link = "log"), 
    data = cancer)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -5.6321     0.2003 -28.125  &lt; 2e-16 ***
age55-59      1.1010     0.2483   4.434 9.23e-06 ***
age60-64      1.5186     0.2316   6.556 5.53e-11 ***
age65-69      1.7677     0.2294   7.704 1.31e-14 ***
age70-74      1.8569     0.2353   7.891 3.00e-15 ***
age75+        1.4197     0.2503   5.672 1.41e-08 ***
cityHorsens  -0.3301     0.1815  -1.818   0.0690 .  
cityKolding  -0.3715     0.1878  -1.978   0.0479 *  
cityVejle    -0.2723     0.1879  -1.450   0.1472    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 129.908  on 23  degrees of freedom
Residual deviance:  23.447  on 15  degrees of freedom
AIC: 137.84

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">resid</span>(glmodrate, <span class="at">type =</span> <span class="st">"pearson"</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>glmodrate<span class="sc">$</span>df.res; </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>dp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.504109</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glmodrate, <span class="at">dispersion =</span> dp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = cases ~ age + city + offset(log(pop)), family = poisson(link = "log"), 
    data = cancer)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -5.6321     0.2456 -22.932  &lt; 2e-16 ***
age55-59      1.1010     0.3045   3.616 0.000299 ***
age60-64      1.5186     0.2841   5.346 9.01e-08 ***
age65-69      1.7677     0.2814   6.282 3.34e-10 ***
age70-74      1.8569     0.2886   6.434 1.24e-10 ***
age75+        1.4197     0.3069   4.625 3.74e-06 ***
cityHorsens  -0.3301     0.2226  -1.483 0.138140    
cityKolding  -0.3715     0.2303  -1.613 0.106721    
cityVejle    -0.2723     0.2304  -1.182 0.237206    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1.504109)

    Null deviance: 129.908  on 23  degrees of freedom
Residual deviance:  23.447  on 15  degrees of freedom
AIC: 137.84

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<section id="b-fit-a-reduced-model-without-the-city-variable.-test-to-see-if-city-is-needed." class="level3">
<h3 class="anchored" data-anchor-id="b-fit-a-reduced-model-without-the-city-variable.-test-to-see-if-city-is-needed.">(b) Fit a reduced model without the city variable. Test to see if city is needed.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>glmodratered <span class="ot">=</span> <span class="fu">glm</span>(cases <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(pop)), <span class="at">data =</span> cancer, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(glmodratered, glmodrate, <span class="at">test =</span> <span class="st">"Chisq"</span>) <span class="co">#city not necessary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: cases ~ age + offset(log(pop))
Model 2: cases ~ age + city + offset(log(pop))
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1        18     28.306                     
2        15     23.448  3    4.859   0.1824</code></pre>
</div>
</div>
</section>
<section id="c-look-at-some-plots-to-diagnose-problems-with-the-model." class="level3">
<h3 class="anchored" data-anchor-id="c-look-at-some-plots-to-diagnose-problems-with-the-model.">(c) Look at some plots to diagnose problems with the model.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)); <span class="fu">plot</span>(glmodratered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="STAT-5010-Unit6-Code_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="d-use-the-reduced-model-to-predict-the-rate-of-cancer-at-age-40-54-and-pop-1000-i.e.-cancer-per-1000-people.-then-use-the-full-model-to-predict-the-rate-of-cancer-at-at-age-40-54-and-pop-1000-in-the-city-of-kolding.-do-the-predictions-differ-very-much" class="level3">
<h3 class="anchored" data-anchor-id="d-use-the-reduced-model-to-predict-the-rate-of-cancer-at-age-40-54-and-pop-1000-i.e.-cancer-per-1000-people.-then-use-the-full-model-to-predict-the-rate-of-cancer-at-at-age-40-54-and-pop-1000-in-the-city-of-kolding.-do-the-predictions-differ-very-much">(d) Use the reduced model to predict the rate of cancer at age = “40-54” and pop = 1000 (i.e., cancer per 1000 people). Then, use the full model to predict the rate of cancer at at age = “40-54” and pop = 1000 in the city of Kolding. Do the predictions differ very much?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>newdataRed <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="st">"40-54"</span>, <span class="at">pop =</span> <span class="dv">1000</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>predRed <span class="ot">=</span> <span class="fu">predict</span>(glmodratered, newdataRed, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>predRed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
2.844828 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>newdataFull <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">city =</span> <span class="st">"Kolding"</span>, <span class="at">age =</span> <span class="st">"40-54"</span>, <span class="at">pop =</span> <span class="dv">1000</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>predFull <span class="ot">=</span> <span class="fu">predict</span>(glmodrate, newdataFull, <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(predFull)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
2.469818 </code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>