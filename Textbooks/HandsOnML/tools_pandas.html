<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tools - pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="tools_pandas_files/libs/clipboard/clipboard.min.js"></script>
<script src="tools_pandas_files/libs/quarto-html/quarto.js"></script>
<script src="tools_pandas_files/libs/quarto-html/popper.min.js"></script>
<script src="tools_pandas_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tools_pandas_files/libs/quarto-html/anchor.min.js"></script>
<link href="tools_pandas_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tools_pandas_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tools_pandas_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tools_pandas_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tools_pandas_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#series-objects" id="toc-series-objects" class="nav-link" data-scroll-target="#series-objects"><code>Series</code> objects</a>
  <ul class="collapse">
  <li><a href="#creating-a-series" id="toc-creating-a-series" class="nav-link" data-scroll-target="#creating-a-series">Creating a <code>Series</code></a></li>
  <li><a href="#similar-to-a-1d-ndarray" id="toc-similar-to-a-1d-ndarray" class="nav-link" data-scroll-target="#similar-to-a-1d-ndarray">Similar to a 1D <code>ndarray</code></a></li>
  <li><a href="#index-labels" id="toc-index-labels" class="nav-link" data-scroll-target="#index-labels">Index labels</a></li>
  <li><a href="#init-from-dict" id="toc-init-from-dict" class="nav-link" data-scroll-target="#init-from-dict">Init from <code>dict</code></a></li>
  <li><a href="#automatic-alignment" id="toc-automatic-alignment" class="nav-link" data-scroll-target="#automatic-alignment">Automatic alignment</a></li>
  <li><a href="#init-with-a-scalar" id="toc-init-with-a-scalar" class="nav-link" data-scroll-target="#init-with-a-scalar">Init with a scalar</a></li>
  <li><a href="#series-name" id="toc-series-name" class="nav-link" data-scroll-target="#series-name"><code>Series</code> name</a></li>
  <li><a href="#plotting-a-series" id="toc-plotting-a-series" class="nav-link" data-scroll-target="#plotting-a-series">Plotting a <code>Series</code></a></li>
  </ul></li>
  <li><a href="#handling-time" id="toc-handling-time" class="nav-link" data-scroll-target="#handling-time">Handling time</a>
  <ul class="collapse">
  <li><a href="#time-range" id="toc-time-range" class="nav-link" data-scroll-target="#time-range">Time range</a></li>
  <li><a href="#resampling" id="toc-resampling" class="nav-link" data-scroll-target="#resampling">Resampling</a></li>
  <li><a href="#upsampling-and-interpolation" id="toc-upsampling-and-interpolation" class="nav-link" data-scroll-target="#upsampling-and-interpolation">Upsampling and interpolation</a></li>
  <li><a href="#timezones" id="toc-timezones" class="nav-link" data-scroll-target="#timezones">Timezones</a></li>
  <li><a href="#periods" id="toc-periods" class="nav-link" data-scroll-target="#periods">Periods</a></li>
  </ul></li>
  <li><a href="#dataframe-objects" id="toc-dataframe-objects" class="nav-link" data-scroll-target="#dataframe-objects"><code>DataFrame</code> objects</a>
  <ul class="collapse">
  <li><a href="#creating-a-dataframe" id="toc-creating-a-dataframe" class="nav-link" data-scroll-target="#creating-a-dataframe">Creating a <code>DataFrame</code></a></li>
  <li><a href="#multi-indexing" id="toc-multi-indexing" class="nav-link" data-scroll-target="#multi-indexing">Multi-indexing</a></li>
  <li><a href="#dropping-a-level" id="toc-dropping-a-level" class="nav-link" data-scroll-target="#dropping-a-level">Dropping a level</a></li>
  <li><a href="#transposing" id="toc-transposing" class="nav-link" data-scroll-target="#transposing">Transposing</a></li>
  <li><a href="#stacking-and-unstacking-levels" id="toc-stacking-and-unstacking-levels" class="nav-link" data-scroll-target="#stacking-and-unstacking-levels">Stacking and unstacking levels</a></li>
  <li><a href="#most-methods-return-modified-copies" id="toc-most-methods-return-modified-copies" class="nav-link" data-scroll-target="#most-methods-return-modified-copies">Most methods return modified copies</a></li>
  <li><a href="#accessing-rows" id="toc-accessing-rows" class="nav-link" data-scroll-target="#accessing-rows">Accessing rows</a></li>
  <li><a href="#adding-and-removing-columns" id="toc-adding-and-removing-columns" class="nav-link" data-scroll-target="#adding-and-removing-columns">Adding and removing columns</a></li>
  <li><a href="#assigning-new-columns" id="toc-assigning-new-columns" class="nav-link" data-scroll-target="#assigning-new-columns">Assigning new columns</a></li>
  <li><a href="#evaluating-an-expression" id="toc-evaluating-an-expression" class="nav-link" data-scroll-target="#evaluating-an-expression">Evaluating an expression</a></li>
  <li><a href="#querying-a-dataframe" id="toc-querying-a-dataframe" class="nav-link" data-scroll-target="#querying-a-dataframe">Querying a <code>DataFrame</code></a></li>
  <li><a href="#sorting-a-dataframe" id="toc-sorting-a-dataframe" class="nav-link" data-scroll-target="#sorting-a-dataframe">Sorting a <code>DataFrame</code></a></li>
  <li><a href="#plotting-a-dataframe" id="toc-plotting-a-dataframe" class="nav-link" data-scroll-target="#plotting-a-dataframe">Plotting a <code>DataFrame</code></a></li>
  <li><a href="#operations-on-dataframes" id="toc-operations-on-dataframes" class="nav-link" data-scroll-target="#operations-on-dataframes">Operations on <code>DataFrame</code>s</a></li>
  <li><a href="#automatic-alignment-1" id="toc-automatic-alignment-1" class="nav-link" data-scroll-target="#automatic-alignment-1">Automatic alignment</a></li>
  <li><a href="#handling-missing-data" id="toc-handling-missing-data" class="nav-link" data-scroll-target="#handling-missing-data">Handling missing data</a></li>
  <li><a href="#aggregating-with-groupby" id="toc-aggregating-with-groupby" class="nav-link" data-scroll-target="#aggregating-with-groupby">Aggregating with <code>groupby</code></a></li>
  <li><a href="#pivot-tables" id="toc-pivot-tables" class="nav-link" data-scroll-target="#pivot-tables">Pivot tables</a></li>
  <li><a href="#overview-functions" id="toc-overview-functions" class="nav-link" data-scroll-target="#overview-functions">Overview functions</a></li>
  </ul></li>
  <li><a href="#saving-loading" id="toc-saving-loading" class="nav-link" data-scroll-target="#saving-loading">Saving &amp; loading</a>
  <ul class="collapse">
  <li><a href="#saving" id="toc-saving" class="nav-link" data-scroll-target="#saving">Saving</a></li>
  <li><a href="#loading" id="toc-loading" class="nav-link" data-scroll-target="#loading">Loading</a></li>
  </ul></li>
  <li><a href="#combining-dataframes" id="toc-combining-dataframes" class="nav-link" data-scroll-target="#combining-dataframes">Combining <code>DataFrame</code>s</a>
  <ul class="collapse">
  <li><a href="#sql-like-joins" id="toc-sql-like-joins" class="nav-link" data-scroll-target="#sql-like-joins">SQL-like joins</a></li>
  <li><a href="#concatenation" id="toc-concatenation" class="nav-link" data-scroll-target="#concatenation">Concatenation</a></li>
  </ul></li>
  <li><a href="#categories" id="toc-categories" class="nav-link" data-scroll-target="#categories">Categories</a></li>
  <li><a href="#what-next" id="toc-what-next" class="nav-link" data-scroll-target="#what-next">What next?</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tools - pandas</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><em>The <code>pandas</code> library provides high-performance, easy-to-use data structures and data analysis tools. The main data structure is the <code>DataFrame</code>, which you can think of as an in-memory 2D table (like a spreadsheet, with column names and row labels). Many features available in Excel are available programmatically, such as creating pivot tables, computing columns based on other columns, plotting graphs, etc. You can also group rows by column value, or join tables much like in SQL. Pandas is also great at handling time series.</em></p>
<p>Prerequisites: * NumPy – if you are not familiar with NumPy, we recommend that you go through the <a href="tools_numpy.ipynb">NumPy tutorial</a> now.</p>
<section id="setup" class="level1">
<h1>Setup</h1>
<p>First, let’s import <code>pandas</code>. People usually import it as <code>pd</code>:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="series-objects" class="level1">
<h1><code>Series</code> objects</h1>
<p>The <code>pandas</code> library contains these useful data structures: * <code>Series</code> objects, that we will discuss now. A <code>Series</code> object is 1D array, similar to a column in a spreadsheet (with a column name and row labels). * <code>DataFrame</code> objects. This is a 2D table, similar to a spreadsheet (with column names and row labels). * <code>Panel</code> objects. You can see a <code>Panel</code> as a dictionary of <code>DataFrame</code>s. These are less used, so we will not discuss them here.</p>
<section id="creating-a-series" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-series">Creating a <code>Series</code></h2>
<p>Let’s start by creating our first <code>Series</code> object!</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="dv">2</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>])</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>0    2
1   -1
2    3
3    5
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="similar-to-a-1d-ndarray" class="level2">
<h2 class="anchored" data-anchor-id="similar-to-a-1d-ndarray">Similar to a 1D <code>ndarray</code></h2>
<p><code>Series</code> objects behave much like one-dimensional NumPy <code>ndarray</code>s, and you can often pass them as parameters to NumPy functions:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>np.exp(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>0      7.389056
1      0.367879
2     20.085537
3    148.413159
dtype: float64</code></pre>
</div>
</div>
<p>Arithmetic operations on <code>Series</code> are also possible, and they apply <em>elementwise</em>, just like for <code>ndarray</code>s:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">+</span> [<span class="dv">1000</span>,<span class="dv">2000</span>,<span class="dv">3000</span>,<span class="dv">4000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0    1002
1    1999
2    3003
3    4005
dtype: int64</code></pre>
</div>
</div>
<p>Similar to NumPy, if you add a single number to a <code>Series</code>, that number is added to all items in the <code>Series</code>. This is called * broadcasting*:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">+</span> <span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>0    1002
1     999
2    1003
3    1005
dtype: int64</code></pre>
</div>
</div>
<p>The same is true for all binary operations such as <code>*</code> or <code>/</code>, and even conditional operations:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">&lt;</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>0    False
1     True
2    False
3    False
dtype: bool</code></pre>
</div>
</div>
</section>
<section id="index-labels" class="level2">
<h2 class="anchored" data-anchor-id="index-labels">Index labels</h2>
<p>Each item in a <code>Series</code> object has a unique identifier called the <em>index label</em>. By default, it is simply the rank of the item in the <code>Series</code> (starting at <code>0</code>) but you can also set the index labels manually:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> pd.Series([<span class="dv">68</span>, <span class="dv">83</span>, <span class="dv">112</span>, <span class="dv">68</span>], index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>, <span class="st">"charles"</span>, <span class="st">"darwin"</span>])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>s2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>alice       68
bob         83
charles    112
darwin      68
dtype: int64</code></pre>
</div>
</div>
<p>You can then use the <code>Series</code> just like a <code>dict</code>:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>s2[<span class="st">"bob"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>83</code></pre>
</div>
</div>
<p>You can still access the items by integer location, like in a regular array:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>s2[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>83</code></pre>
</div>
</div>
<p>To make it clear when you are accessing by label or by integer location, it is recommended to always use the <code>loc</code> attribute when accessing by label, and the <code>iloc</code> attribute when accessing by integer location:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>s2.loc[<span class="st">"bob"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>83</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>s2.iloc[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>83</code></pre>
</div>
</div>
<p>Slicing a <code>Series</code> also slices the index labels:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>s2.iloc[<span class="dv">1</span>:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>bob         83
charles    112
dtype: int64</code></pre>
</div>
</div>
<p>This can lead to unexpected results when using the default numeric labels, so be careful:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>surprise <span class="op">=</span> pd.Series([<span class="dv">1000</span>, <span class="dv">1001</span>, <span class="dv">1002</span>, <span class="dv">1003</span>])</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>surprise</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>0    1000
1    1001
2    1002
3    1003
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>surprise_slice <span class="op">=</span> surprise[<span class="dv">2</span>:]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>surprise_slice</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>2    1002
3    1003
dtype: int64</code></pre>
</div>
</div>
<p>Oh look! The first element has index label <code>2</code>. The element with index label <code>0</code> is absent from the slice:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    surprise_slice[<span class="dv">0</span>]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">KeyError</span> <span class="im">as</span> e:</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Key error:"</span>, e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key error: 0</code></pre>
</div>
</div>
<p>But remember that you can access elements by integer location using the <code>iloc</code> attribute. This illustrates another reason why it’s always better to use <code>loc</code> and <code>iloc</code> to access <code>Series</code> objects:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>surprise_slice.iloc[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>1002</code></pre>
</div>
</div>
</section>
<section id="init-from-dict" class="level2">
<h2 class="anchored" data-anchor-id="init-from-dict">Init from <code>dict</code></h2>
<p>You can create a <code>Series</code> object from a <code>dict</code>. The keys will be used as index labels:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> {<span class="st">"alice"</span>: <span class="dv">68</span>, <span class="st">"bob"</span>: <span class="dv">83</span>, <span class="st">"colin"</span>: <span class="dv">86</span>, <span class="st">"darwin"</span>: <span class="dv">68</span>}</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>s3 <span class="op">=</span> pd.Series(weights)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>s3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>alice     68
bob       83
colin     86
darwin    68
dtype: int64</code></pre>
</div>
</div>
<p>You can control which elements you want to include in the <code>Series</code> and in what order by explicitly specifying the desired <code>index</code>:</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>s4 <span class="op">=</span> pd.Series(weights, index <span class="op">=</span> [<span class="st">"colin"</span>, <span class="st">"alice"</span>])</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>s4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>colin    86
alice    68
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="automatic-alignment" class="level2">
<h2 class="anchored" data-anchor-id="automatic-alignment">Automatic alignment</h2>
<p>When an operation involves multiple <code>Series</code> objects, <code>pandas</code> automatically aligns items by matching index labels.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(s2.keys())</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(s3.keys())</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">+</span> s3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['alice', 'bob', 'charles', 'darwin'], dtype='object')
Index(['alice', 'bob', 'colin', 'darwin'], dtype='object')</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>alice      136.0
bob        166.0
charles      NaN
colin        NaN
darwin     136.0
dtype: float64</code></pre>
</div>
</div>
<p>The resulting <code>Series</code> contains the union of index labels from <code>s2</code> and <code>s3</code>. Since <code>"colin"</code> is missing from <code>s2</code> and <code>"charles"</code> is missing from <code>s3</code>, these items have a <code>NaN</code> result value. (ie. Not-a-Number means <em>missing</em>).</p>
<p>Automatic alignment is very handy when working with data that may come from various sources with varying structure and missing items. But if you forget to set the right index labels, you can have surprising results:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>s5 <span class="op">=</span> pd.Series([<span class="dv">1000</span>,<span class="dv">1000</span>,<span class="dv">1000</span>,<span class="dv">1000</span>])</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"s2 ="</span>, s2.values)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"s5 ="</span>, s5.values)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">+</span> s5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>s2 = [ 68  83 112  68]
s5 = [1000 1000 1000 1000]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>alice     NaN
bob       NaN
charles   NaN
darwin    NaN
0         NaN
1         NaN
2         NaN
3         NaN
dtype: float64</code></pre>
</div>
</div>
<p>Pandas could not align the <code>Series</code>, since their labels do not match at all, hence the full <code>NaN</code> result.</p>
</section>
<section id="init-with-a-scalar" class="level2">
<h2 class="anchored" data-anchor-id="init-with-a-scalar">Init with a scalar</h2>
<p>You can also initialize a <code>Series</code> object using a scalar and a list of index labels: all items will be set to the scalar.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>meaning <span class="op">=</span> pd.Series(<span class="dv">42</span>, [<span class="st">"life"</span>, <span class="st">"universe"</span>, <span class="st">"everything"</span>])</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>meaning</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>life          42
universe      42
everything    42
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="series-name" class="level2">
<h2 class="anchored" data-anchor-id="series-name"><code>Series</code> name</h2>
<p>A <code>Series</code> can have a <code>name</code>:</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>s6 <span class="op">=</span> pd.Series([<span class="dv">83</span>, <span class="dv">68</span>], index<span class="op">=</span>[<span class="st">"bob"</span>, <span class="st">"alice"</span>], name<span class="op">=</span><span class="st">"weights"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>s6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>bob      83
alice    68
Name: weights, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="plotting-a-series" class="level2">
<h2 class="anchored" data-anchor-id="plotting-a-series">Plotting a <code>Series</code></h2>
<p>Pandas makes it easy to plot <code>Series</code> data using matplotlib (for more details on matplotlib, check out the <a href="tools_matplotlib.ipynb">matplotlib tutorial</a>). Just import matplotlib and call the <code>plot()</code> method:</p>
<div class="cell" data-scrolled="true" data-execution_count="23">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>temperatures <span class="op">=</span> [<span class="fl">4.4</span>,<span class="fl">5.1</span>,<span class="fl">6.1</span>,<span class="fl">6.2</span>,<span class="fl">6.1</span>,<span class="fl">6.1</span>,<span class="fl">5.7</span>,<span class="fl">5.2</span>,<span class="fl">4.7</span>,<span class="fl">4.1</span>,<span class="fl">3.9</span>,<span class="fl">3.5</span>]</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>s7 <span class="op">=</span> pd.Series(temperatures, name<span class="op">=</span><span class="st">"Temperature"</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>s7.plot()</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="tools_pandas_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>There are <em>many</em> options for plotting your data. It is not necessary to list them all here: if you need a particular type of plot (histograms, pie charts, etc.), just look for it in the excellent <a href="http://pandas.pydata.org/pandas-docs/stable/visualization.html">Visualization</a> section of pandas’ documentation, and look at the example code.</p>
</section>
</section>
<section id="handling-time" class="level1">
<h1>Handling time</h1>
<p>Many datasets have timestamps, and pandas is awesome at manipulating such data: * it can represent periods (such as 2016Q3) and frequencies (such as “monthly”), * it can convert periods to actual timestamps, and <em>vice versa</em>, * it can resample data and aggregate values any way you like, * it can handle timezones.</p>
<section id="time-range" class="level2">
<h2 class="anchored" data-anchor-id="time-range">Time range</h2>
<p>Let’s start by creating a time series using <code>pd.date_range()</code>. This returns a <code>DatetimeIndex</code> containing one datetime per hour for 12 hours starting on October 29th 2016 at 5:30pm.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> pd.date_range(<span class="st">'2016/10/29 5:30pm'</span>, periods<span class="op">=</span><span class="dv">12</span>, freq<span class="op">=</span><span class="st">'H'</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>dates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>DatetimeIndex(['2016-10-29 17:30:00', '2016-10-29 18:30:00',
               '2016-10-29 19:30:00', '2016-10-29 20:30:00',
               '2016-10-29 21:30:00', '2016-10-29 22:30:00',
               '2016-10-29 23:30:00', '2016-10-30 00:30:00',
               '2016-10-30 01:30:00', '2016-10-30 02:30:00',
               '2016-10-30 03:30:00', '2016-10-30 04:30:00'],
              dtype='datetime64[ns]', freq='H')</code></pre>
</div>
</div>
<p>This <code>DatetimeIndex</code> may be used as an index in a <code>Series</code>:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>temp_series <span class="op">=</span> pd.Series(temperatures, dates)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>temp_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>2016-10-29 17:30:00    4.4
2016-10-29 18:30:00    5.1
2016-10-29 19:30:00    6.1
2016-10-29 20:30:00    6.2
2016-10-29 21:30:00    6.1
2016-10-29 22:30:00    6.1
2016-10-29 23:30:00    5.7
2016-10-30 00:30:00    5.2
2016-10-30 01:30:00    4.7
2016-10-30 02:30:00    4.1
2016-10-30 03:30:00    3.9
2016-10-30 04:30:00    3.5
Freq: H, dtype: float64</code></pre>
</div>
</div>
<p>Let’s plot this series:</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>temp_series.plot(kind<span class="op">=</span><span class="st">"bar"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="tools_pandas_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="resampling" class="level2">
<h2 class="anchored" data-anchor-id="resampling">Resampling</h2>
<p>Pandas lets us resample a time series very simply. Just call the <code>resample()</code> method and specify a new frequency:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>temp_series_freq_2H <span class="op">=</span> temp_series.resample(<span class="st">"2H"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>temp_series_freq_2H</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>DatetimeIndexResampler [freq=&lt;2 * Hours&gt;, axis=0, closed=left, label=left, convention=start, base=0]</code></pre>
</div>
</div>
<p>The resampling operation is actually a deferred operation, which is why we did not get a <code>Series</code> object, but a <code>DatetimeIndexResampler</code> object instead. To actually perform the resampling operation, we can simply call the <code>mean()</code> method: Pandas will compute the mean of every pair of consecutive hours:</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>temp_series_freq_2H <span class="op">=</span> temp_series_freq_2H.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s plot the result:</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>temp_series_freq_2H.plot(kind<span class="op">=</span><span class="st">"bar"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="tools_pandas_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Note how the values have automatically been aggregated into 2-hour periods. If we look at the 6-8pm period, for example, we had a value of <code>5.1</code> at 6:30pm, and <code>6.1</code> at 7:30pm. After resampling, we just have one value of <code>5.6</code>, which is the mean of <code>5.1</code> and <code>6.1</code>. Rather than computing the mean, we could have used any other aggregation function, for example we can decide to keep the minimum value of each period:</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>temp_series_freq_2H <span class="op">=</span> temp_series.resample(<span class="st">"2H"</span>).<span class="bu">min</span>()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>temp_series_freq_2H</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>2016-10-29 16:00:00    4.4
2016-10-29 18:00:00    5.1
2016-10-29 20:00:00    6.1
2016-10-29 22:00:00    5.7
2016-10-30 00:00:00    4.7
2016-10-30 02:00:00    3.9
2016-10-30 04:00:00    3.5
Freq: 2H, dtype: float64</code></pre>
</div>
</div>
<p>Or, equivalently, we could use the <code>apply()</code> method instead:</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>temp_series_freq_2H <span class="op">=</span> temp_series.resample(<span class="st">"2H"</span>).<span class="bu">apply</span>(np.<span class="bu">min</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>temp_series_freq_2H</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>2016-10-29 16:00:00    4.4
2016-10-29 18:00:00    5.1
2016-10-29 20:00:00    6.1
2016-10-29 22:00:00    5.7
2016-10-30 00:00:00    4.7
2016-10-30 02:00:00    3.9
2016-10-30 04:00:00    3.5
Freq: 2H, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="upsampling-and-interpolation" class="level2">
<h2 class="anchored" data-anchor-id="upsampling-and-interpolation">Upsampling and interpolation</h2>
<p>This was an example of downsampling. We can also upsample (ie. increase the frequency), but this creates holes in our data:</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>temp_series_freq_15min <span class="op">=</span> temp_series.resample(<span class="st">"15Min"</span>).mean()</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>temp_series_freq_15min.head(n<span class="op">=</span><span class="dv">10</span>) <span class="co"># `head` displays the top n values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>2016-10-29 17:30:00    4.4
2016-10-29 17:45:00    NaN
2016-10-29 18:00:00    NaN
2016-10-29 18:15:00    NaN
2016-10-29 18:30:00    5.1
2016-10-29 18:45:00    NaN
2016-10-29 19:00:00    NaN
2016-10-29 19:15:00    NaN
2016-10-29 19:30:00    6.1
2016-10-29 19:45:00    NaN
Freq: 15T, dtype: float64</code></pre>
</div>
</div>
<p>One solution is to fill the gaps by interpolating. We just call the <code>interpolate()</code> method. The default is to use linear interpolation, but we can also select another method, such as cubic interpolation:</p>
<div class="cell" data-scrolled="true" data-execution_count="33">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>temp_series_freq_15min <span class="op">=</span> temp_series.resample(<span class="st">"15Min"</span>).interpolate(method<span class="op">=</span><span class="st">"cubic"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>temp_series_freq_15min.head(n<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>2016-10-29 17:30:00    4.400000
2016-10-29 17:45:00    4.452911
2016-10-29 18:00:00    4.605113
2016-10-29 18:15:00    4.829758
2016-10-29 18:30:00    5.100000
2016-10-29 18:45:00    5.388992
2016-10-29 19:00:00    5.669887
2016-10-29 19:15:00    5.915839
2016-10-29 19:30:00    6.100000
2016-10-29 19:45:00    6.203621
Freq: 15T, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>temp_series.plot(label<span class="op">=</span><span class="st">"Period: 1 hour"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>temp_series_freq_15min.plot(label<span class="op">=</span><span class="st">"Period: 15 minutes"</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="tools_pandas_files/figure-html/cell-35-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="timezones" class="level2">
<h2 class="anchored" data-anchor-id="timezones">Timezones</h2>
<p>By default datetimes are <em>naive</em>: they are not aware of timezones, so 2016-10-30 02:30 might mean October 30th 2016 at 2:30am in Paris or in New York. We can make datetimes timezone <em>aware</em> by calling the <code>tz_localize()</code> method:</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>temp_series_ny <span class="op">=</span> temp_series.tz_localize(<span class="st">"America/New_York"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>temp_series_ny</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>2016-10-29 17:30:00-04:00    4.4
2016-10-29 18:30:00-04:00    5.1
2016-10-29 19:30:00-04:00    6.1
2016-10-29 20:30:00-04:00    6.2
2016-10-29 21:30:00-04:00    6.1
2016-10-29 22:30:00-04:00    6.1
2016-10-29 23:30:00-04:00    5.7
2016-10-30 00:30:00-04:00    5.2
2016-10-30 01:30:00-04:00    4.7
2016-10-30 02:30:00-04:00    4.1
2016-10-30 03:30:00-04:00    3.9
2016-10-30 04:30:00-04:00    3.5
Freq: H, dtype: float64</code></pre>
</div>
</div>
<p>Note that <code>-04:00</code> is now appended to all the datetimes. This means that these datetimes refer to <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time">UTC</a> - 4 hours.</p>
<p>We can convert these datetimes to Paris time like this:</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>temp_series_paris <span class="op">=</span> temp_series_ny.tz_convert(<span class="st">"Europe/Paris"</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>temp_series_paris</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>2016-10-29 23:30:00+02:00    4.4
2016-10-30 00:30:00+02:00    5.1
2016-10-30 01:30:00+02:00    6.1
2016-10-30 02:30:00+02:00    6.2
2016-10-30 02:30:00+01:00    6.1
2016-10-30 03:30:00+01:00    6.1
2016-10-30 04:30:00+01:00    5.7
2016-10-30 05:30:00+01:00    5.2
2016-10-30 06:30:00+01:00    4.7
2016-10-30 07:30:00+01:00    4.1
2016-10-30 08:30:00+01:00    3.9
2016-10-30 09:30:00+01:00    3.5
Freq: H, dtype: float64</code></pre>
</div>
</div>
<p>You may have noticed that the UTC offset changes from <code>+02:00</code> to <code>+01:00</code>: this is because France switches to winter time at 3am that particular night (time goes back to 2am). Notice that 2:30am occurs twice! Let’s go back to a naive representation (if you log some data hourly using local time, without storing the timezone, you might get something like this):</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>temp_series_paris_naive <span class="op">=</span> temp_series_paris.tz_localize(<span class="va">None</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>temp_series_paris_naive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>2016-10-29 23:30:00    4.4
2016-10-30 00:30:00    5.1
2016-10-30 01:30:00    6.1
2016-10-30 02:30:00    6.2
2016-10-30 02:30:00    6.1
2016-10-30 03:30:00    6.1
2016-10-30 04:30:00    5.7
2016-10-30 05:30:00    5.2
2016-10-30 06:30:00    4.7
2016-10-30 07:30:00    4.1
2016-10-30 08:30:00    3.9
2016-10-30 09:30:00    3.5
Freq: H, dtype: float64</code></pre>
</div>
</div>
<p>Now <code>02:30</code> is really ambiguous. If we try to localize these naive datetimes to the Paris timezone, we get an error:</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    temp_series_paris_naive.tz_localize(<span class="st">"Europe/Paris"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="bu">type</span>(e))</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pytz.exceptions.AmbiguousTimeError'&gt;
Cannot infer dst time from Timestamp('2016-10-30 02:30:00'), try using the 'ambiguous' argument</code></pre>
</div>
</div>
<p>Fortunately using the <code>ambiguous</code> argument we can tell pandas to infer the right DST (Daylight Saving Time) based on the order of the ambiguous timestamps:</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>temp_series_paris_naive.tz_localize(<span class="st">"Europe/Paris"</span>, ambiguous<span class="op">=</span><span class="st">"infer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>2016-10-29 23:30:00+02:00    4.4
2016-10-30 00:30:00+02:00    5.1
2016-10-30 01:30:00+02:00    6.1
2016-10-30 02:30:00+02:00    6.2
2016-10-30 02:30:00+01:00    6.1
2016-10-30 03:30:00+01:00    6.1
2016-10-30 04:30:00+01:00    5.7
2016-10-30 05:30:00+01:00    5.2
2016-10-30 06:30:00+01:00    4.7
2016-10-30 07:30:00+01:00    4.1
2016-10-30 08:30:00+01:00    3.9
2016-10-30 09:30:00+01:00    3.5
Freq: H, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="periods" class="level2">
<h2 class="anchored" data-anchor-id="periods">Periods</h2>
<p>The <code>pd.period_range()</code> function returns a <code>PeriodIndex</code> instead of a <code>DatetimeIndex</code>. For example, let’s get all quarters in 2016 and 2017:</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>quarters <span class="op">=</span> pd.period_range(<span class="st">'2016Q1'</span>, periods<span class="op">=</span><span class="dv">8</span>, freq<span class="op">=</span><span class="st">'Q'</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>quarters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>PeriodIndex(['2016Q1', '2016Q2', '2016Q3', '2016Q4', '2017Q1', '2017Q2',
             '2017Q3', '2017Q4'],
            dtype='period[Q-DEC]', freq='Q-DEC')</code></pre>
</div>
</div>
<p>Adding a number <code>N</code> to a <code>PeriodIndex</code> shifts the periods by <code>N</code> times the <code>PeriodIndex</code>’s frequency:</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>quarters <span class="op">+</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>PeriodIndex(['2016Q4', '2017Q1', '2017Q2', '2017Q3', '2017Q4', '2018Q1',
             '2018Q2', '2018Q3'],
            dtype='period[Q-DEC]', freq='Q-DEC')</code></pre>
</div>
</div>
<p>The <code>asfreq()</code> method lets us change the frequency of the <code>PeriodIndex</code>. All periods are lengthened or shortened accordingly. For example, let’s convert all the quarterly periods to monthly periods (zooming in):</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>quarters.asfreq(<span class="st">"M"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>PeriodIndex(['2016-03', '2016-06', '2016-09', '2016-12', '2017-03', '2017-06',
             '2017-09', '2017-12'],
            dtype='period[M]', freq='M')</code></pre>
</div>
</div>
<p>By default, the <code>asfreq</code> zooms on the end of each period. We can tell it to zoom on the start of each period instead:</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>quarters.asfreq(<span class="st">"M"</span>, how<span class="op">=</span><span class="st">"start"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>PeriodIndex(['2016-01', '2016-04', '2016-07', '2016-10', '2017-01', '2017-04',
             '2017-07', '2017-10'],
            dtype='period[M]', freq='M')</code></pre>
</div>
</div>
<p>And we can zoom out:</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>quarters.asfreq(<span class="st">"A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>PeriodIndex(['2016', '2016', '2016', '2016', '2017', '2017', '2017', '2017'], dtype='period[A-DEC]', freq='A-DEC')</code></pre>
</div>
</div>
<p>Of course we can create a <code>Series</code> with a <code>PeriodIndex</code>:</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>quarterly_revenue <span class="op">=</span> pd.Series([<span class="dv">300</span>, <span class="dv">320</span>, <span class="dv">290</span>, <span class="dv">390</span>, <span class="dv">320</span>, <span class="dv">360</span>, <span class="dv">310</span>, <span class="dv">410</span>], index <span class="op">=</span> quarters)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>quarterly_revenue</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>2016Q1    300
2016Q2    320
2016Q3    290
2016Q4    390
2017Q1    320
2017Q2    360
2017Q3    310
2017Q4    410
Freq: Q-DEC, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>quarterly_revenue.plot(kind<span class="op">=</span><span class="st">"line"</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="tools_pandas_files/figure-html/cell-47-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>We can convert periods to timestamps by calling <code>to_timestamp</code>. By default this will give us the first day of each period, but by setting <code>how</code> and <code>freq</code>, we can get the last hour of each period:</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>last_hours <span class="op">=</span> quarterly_revenue.to_timestamp(how<span class="op">=</span><span class="st">"end"</span>, freq<span class="op">=</span><span class="st">"H"</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>last_hours</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>2016-03-31 23:00:00    300
2016-06-30 23:00:00    320
2016-09-30 23:00:00    290
2016-12-31 23:00:00    390
2017-03-31 23:00:00    320
2017-06-30 23:00:00    360
2017-09-30 23:00:00    310
2017-12-31 23:00:00    410
Freq: Q-DEC, dtype: int64</code></pre>
</div>
</div>
<p>And back to periods by calling <code>to_period</code>:</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>last_hours.to_period()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>2016Q1    300
2016Q2    320
2016Q3    290
2016Q4    390
2017Q1    320
2017Q2    360
2017Q3    310
2017Q4    410
Freq: Q-DEC, dtype: int64</code></pre>
</div>
</div>
<p>Pandas also provides many other time-related functions that we recommend you check out in the <a href="http://pandas.pydata.org/pandas-docs/stable/timeseries.html">documentation</a>. To whet your appetite, here is one way to get the last business day of each month in 2016, at 9am:</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>months_2016 <span class="op">=</span> pd.period_range(<span class="st">"2016"</span>, periods<span class="op">=</span><span class="dv">12</span>, freq<span class="op">=</span><span class="st">"M"</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>one_day_after_last_days <span class="op">=</span> months_2016.asfreq(<span class="st">"D"</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>last_bdays <span class="op">=</span> one_day_after_last_days.to_timestamp() <span class="op">-</span> pd.tseries.offsets.BDay()</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>last_bdays.to_period(<span class="st">"H"</span>) <span class="op">+</span> <span class="dv">9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>PeriodIndex(['2016-01-29 09:00', '2016-02-29 09:00', '2016-03-31 09:00',
             '2016-04-29 09:00', '2016-05-31 09:00', '2016-06-30 09:00',
             '2016-07-29 09:00', '2016-08-31 09:00', '2016-09-30 09:00',
             '2016-10-31 09:00', '2016-11-30 09:00', '2016-12-30 09:00'],
            dtype='period[H]', freq='H')</code></pre>
</div>
</div>
</section>
</section>
<section id="dataframe-objects" class="level1">
<h1><code>DataFrame</code> objects</h1>
<p>A DataFrame object represents a spreadsheet, with cell values, column names and row index labels. You can define expressions to compute columns based on other columns, create pivot-tables, group rows, draw graphs, etc. You can see <code>DataFrame</code>s as dictionaries of <code>Series</code>.</p>
<section id="creating-a-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-dataframe">Creating a <code>DataFrame</code></h2>
<p>You can create a DataFrame by passing a dictionary of <code>Series</code> objects:</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>people_dict <span class="op">=</span> {</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"weight"</span>: pd.Series([<span class="dv">68</span>, <span class="dv">83</span>, <span class="dv">112</span>], index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>, <span class="st">"charles"</span>]),</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"birthyear"</span>: pd.Series([<span class="dv">1984</span>, <span class="dv">1985</span>, <span class="dv">1992</span>], index<span class="op">=</span>[<span class="st">"bob"</span>, <span class="st">"alice"</span>, <span class="st">"charles"</span>], name<span class="op">=</span><span class="st">"year"</span>),</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"children"</span>: pd.Series([<span class="dv">0</span>, <span class="dv">3</span>], index<span class="op">=</span>[<span class="st">"charles"</span>, <span class="st">"bob"</span>]),</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hobby"</span>: pd.Series([<span class="st">"Biking"</span>, <span class="st">"Dancing"</span>], index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>]),</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>people <span class="op">=</span> pd.DataFrame(people_dict)</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>birthyear</th>
      <th>children</th>
      <th>hobby</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>1985</td>
      <td>NaN</td>
      <td>Biking</td>
      <td>68</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>1984</td>
      <td>3.0</td>
      <td>Dancing</td>
      <td>83</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>1992</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>112</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>A few things to note: * the <code>Series</code> were automatically aligned based on their index, * missing values are represented as <code>NaN</code>, * <code>Series</code> names are ignored (the name <code>"year"</code> was dropped), * <code>DataFrame</code>s are displayed nicely in Jupyter notebooks, woohoo!</p>
<p>You can access columns pretty much as you would expect. They are returned as <code>Series</code> objects:</p>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>people[<span class="st">"birthyear"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>alice      1985
bob        1984
charles    1992
Name: birthyear, dtype: int64</code></pre>
</div>
</div>
<p>You can also get multiple columns at once:</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>people[[<span class="st">"birthyear"</span>, <span class="st">"hobby"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>birthyear</th>
      <th>hobby</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>1985</td>
      <td>Biking</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>1984</td>
      <td>Dancing</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>1992</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>If you pass a list of columns and/or index row labels to the <code>DataFrame</code> constructor, it will guarantee that these columns and/or rows will exist, in that order, and no other column/row will exist. For example:</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>        people_dict,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span>[<span class="st">"birthyear"</span>, <span class="st">"weight"</span>, <span class="st">"height"</span>],</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span>[<span class="st">"bob"</span>, <span class="st">"alice"</span>, <span class="st">"eugene"</span>]</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>d2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>birthyear</th>
      <th>weight</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bob</th>
      <td>1984.0</td>
      <td>83.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>alice</th>
      <td>1985.0</td>
      <td>68.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>eugene</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Another convenient way to create a <code>DataFrame</code> is to pass all the values to the constructor as an <code>ndarray</code>, or a list of lists, and specify the column names and row index labels separately:</p>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> [</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">1985</span>, np.nan, <span class="st">"Biking"</span>,   <span class="dv">68</span>],</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">1984</span>, <span class="dv">3</span>,      <span class="st">"Dancing"</span>,  <span class="dv">83</span>],</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">1992</span>, <span class="dv">0</span>,      np.nan,    <span class="dv">112</span>]</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>         ]</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>        values,</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span>[<span class="st">"birthyear"</span>, <span class="st">"children"</span>, <span class="st">"hobby"</span>, <span class="st">"weight"</span>],</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>, <span class="st">"charles"</span>]</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>d3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>birthyear</th>
      <th>children</th>
      <th>hobby</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>1985</td>
      <td>NaN</td>
      <td>Biking</td>
      <td>68</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>1984</td>
      <td>3.0</td>
      <td>Dancing</td>
      <td>83</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>1992</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>112</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>To specify missing values, you can either use <code>np.nan</code> or NumPy’s masked arrays:</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>masked_array <span class="op">=</span> np.ma.asarray(values, dtype<span class="op">=</span>np.<span class="bu">object</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>masked_array[(<span class="dv">0</span>, <span class="dv">2</span>), (<span class="dv">1</span>, <span class="dv">2</span>)] <span class="op">=</span> np.ma.masked</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>        masked_array,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span>[<span class="st">"birthyear"</span>, <span class="st">"children"</span>, <span class="st">"hobby"</span>, <span class="st">"weight"</span>],</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>, <span class="st">"charles"</span>]</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>d3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>birthyear</th>
      <th>children</th>
      <th>hobby</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>1985</td>
      <td>NaN</td>
      <td>Biking</td>
      <td>68</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>1984</td>
      <td>3</td>
      <td>Dancing</td>
      <td>83</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>1992</td>
      <td>0</td>
      <td>NaN</td>
      <td>112</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Instead of an <code>ndarray</code>, you can also pass a <code>DataFrame</code> object:</p>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>d4 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>         d3,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>         columns<span class="op">=</span>[<span class="st">"hobby"</span>, <span class="st">"children"</span>],</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>         index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>]</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>d4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>children</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>It is also possible to create a <code>DataFrame</code> with a dictionary (or list) of dictionaries (or list):</p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>people <span class="op">=</span> pd.DataFrame({</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"birthyear"</span>: {<span class="st">"alice"</span>:<span class="dv">1985</span>, <span class="st">"bob"</span>: <span class="dv">1984</span>, <span class="st">"charles"</span>: <span class="dv">1992</span>},</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hobby"</span>: {<span class="st">"alice"</span>:<span class="st">"Biking"</span>, <span class="st">"bob"</span>: <span class="st">"Dancing"</span>},</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"weight"</span>: {<span class="st">"alice"</span>:<span class="dv">68</span>, <span class="st">"bob"</span>: <span class="dv">83</span>, <span class="st">"charles"</span>: <span class="dv">112</span>},</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"children"</span>: {<span class="st">"bob"</span>: <span class="dv">3</span>, <span class="st">"charles"</span>: <span class="dv">0</span>}</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>birthyear</th>
      <th>children</th>
      <th>hobby</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>1985</td>
      <td>NaN</td>
      <td>Biking</td>
      <td>68</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>1984</td>
      <td>3.0</td>
      <td>Dancing</td>
      <td>83</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>1992</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>112</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="multi-indexing" class="level2">
<h2 class="anchored" data-anchor-id="multi-indexing">Multi-indexing</h2>
<p>If all columns are tuples of the same size, then they are understood as a multi-index. The same goes for row index labels. For example:</p>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>d5 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"public"</span>, <span class="st">"birthyear"</span>):</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>        {(<span class="st">"Paris"</span>,<span class="st">"alice"</span>):<span class="dv">1985</span>, (<span class="st">"Paris"</span>,<span class="st">"bob"</span>): <span class="dv">1984</span>, (<span class="st">"London"</span>,<span class="st">"charles"</span>): <span class="dv">1992</span>},</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"public"</span>, <span class="st">"hobby"</span>):</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>        {(<span class="st">"Paris"</span>,<span class="st">"alice"</span>):<span class="st">"Biking"</span>, (<span class="st">"Paris"</span>,<span class="st">"bob"</span>): <span class="st">"Dancing"</span>},</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"private"</span>, <span class="st">"weight"</span>):</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>        {(<span class="st">"Paris"</span>,<span class="st">"alice"</span>):<span class="dv">68</span>, (<span class="st">"Paris"</span>,<span class="st">"bob"</span>): <span class="dv">83</span>, (<span class="st">"London"</span>,<span class="st">"charles"</span>): <span class="dv">112</span>},</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"private"</span>, <span class="st">"children"</span>):</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>        {(<span class="st">"Paris"</span>, <span class="st">"alice"</span>):np.nan, (<span class="st">"Paris"</span>,<span class="st">"bob"</span>): <span class="dv">3</span>, (<span class="st">"London"</span>,<span class="st">"charles"</span>): <span class="dv">0</span>}</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>d5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">private</th>
      <th colspan="2" halign="left">public</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>children</th>
      <th>weight</th>
      <th>birthyear</th>
      <th>hobby</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>London</th>
      <th>charles</th>
      <td>0.0</td>
      <td>112</td>
      <td>1992</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Paris</th>
      <th>alice</th>
      <td>NaN</td>
      <td>68</td>
      <td>1985</td>
      <td>Biking</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>3.0</td>
      <td>83</td>
      <td>1984</td>
      <td>Dancing</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>You can now get a <code>DataFrame</code> containing all the <code>"public"</code> columns very simply:</p>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>d5[<span class="st">"public"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>birthyear</th>
      <th>hobby</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>London</th>
      <th>charles</th>
      <td>1992</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Paris</th>
      <th>alice</th>
      <td>1985</td>
      <td>Biking</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>1984</td>
      <td>Dancing</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>d5[<span class="st">"public"</span>, <span class="st">"hobby"</span>]  <span class="co"># Same result as d5["public"]["hobby"]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>London  charles        NaN
Paris   alice       Biking
        bob        Dancing
Name: (public, hobby), dtype: object</code></pre>
</div>
</div>
</section>
<section id="dropping-a-level" class="level2">
<h2 class="anchored" data-anchor-id="dropping-a-level">Dropping a level</h2>
<p>Let’s look at <code>d5</code> again:</p>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>d5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">private</th>
      <th colspan="2" halign="left">public</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>children</th>
      <th>weight</th>
      <th>birthyear</th>
      <th>hobby</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>London</th>
      <th>charles</th>
      <td>0.0</td>
      <td>112</td>
      <td>1992</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Paris</th>
      <th>alice</th>
      <td>NaN</td>
      <td>68</td>
      <td>1985</td>
      <td>Biking</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>3.0</td>
      <td>83</td>
      <td>1984</td>
      <td>Dancing</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>There are two levels of columns, and two levels of indices. We can drop a column level by calling <code>droplevel()</code> (the same goes for indices):</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>d5.columns <span class="op">=</span> d5.columns.droplevel(level <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>d5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>children</th>
      <th>weight</th>
      <th>birthyear</th>
      <th>hobby</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>London</th>
      <th>charles</th>
      <td>0.0</td>
      <td>112</td>
      <td>1992</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Paris</th>
      <th>alice</th>
      <td>NaN</td>
      <td>68</td>
      <td>1985</td>
      <td>Biking</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>3.0</td>
      <td>83</td>
      <td>1984</td>
      <td>Dancing</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="transposing" class="level2">
<h2 class="anchored" data-anchor-id="transposing">Transposing</h2>
<p>You can swap columns and indices using the <code>T</code> attribute:</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>d6 <span class="op">=</span> d5.T</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>d6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>London</th>
      <th colspan="2" halign="left">Paris</th>
    </tr>
    <tr>
      <th></th>
      <th>charles</th>
      <th>alice</th>
      <th>bob</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>children</th>
      <td>0</td>
      <td>NaN</td>
      <td>3</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>112</td>
      <td>68</td>
      <td>83</td>
    </tr>
    <tr>
      <th>birthyear</th>
      <td>1992</td>
      <td>1985</td>
      <td>1984</td>
    </tr>
    <tr>
      <th>hobby</th>
      <td>NaN</td>
      <td>Biking</td>
      <td>Dancing</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="stacking-and-unstacking-levels" class="level2">
<h2 class="anchored" data-anchor-id="stacking-and-unstacking-levels">Stacking and unstacking levels</h2>
<p>Calling the <code>stack()</code> method will push the lowest column level after the lowest index:</p>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>d7 <span class="op">=</span> d6.stack()</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>d7</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>London</th>
      <th>Paris</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">children</th>
      <th>bob</th>
      <td>NaN</td>
      <td>3</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">weight</th>
      <th>alice</th>
      <td>NaN</td>
      <td>68</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>NaN</td>
      <td>83</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>112</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">birthyear</th>
      <th>alice</th>
      <td>NaN</td>
      <td>1985</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>NaN</td>
      <td>1984</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>1992</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">hobby</th>
      <th>alice</th>
      <td>NaN</td>
      <td>Biking</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>NaN</td>
      <td>Dancing</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Note that many <code>NaN</code> values appeared. This makes sense because many new combinations did not exist before (eg. there was no <code>bob</code> in <code>London</code>).</p>
<p>Calling <code>unstack()</code> will do the reverse, once again creating many <code>NaN</code> values.</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>d8 <span class="op">=</span> d7.unstack()</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>d8</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">London</th>
      <th colspan="3" halign="left">Paris</th>
    </tr>
    <tr>
      <th></th>
      <th>alice</th>
      <th>bob</th>
      <th>charles</th>
      <th>alice</th>
      <th>bob</th>
      <th>charles</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>children</th>
      <td>None</td>
      <td>NaN</td>
      <td>0</td>
      <td>None</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>112</td>
      <td>68</td>
      <td>83</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>birthyear</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1992</td>
      <td>1985</td>
      <td>1984</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>hobby</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>Biking</td>
      <td>Dancing</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>If we call <code>unstack</code> again, we end up with a <code>Series</code> object:</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>d9 <span class="op">=</span> d8.unstack()</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>d9</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>London  alice    children        None
                 weight           NaN
                 birthyear        NaN
                 hobby            NaN
        bob      children         NaN
                 weight           NaN
                 birthyear        NaN
                 hobby            NaN
        charles  children           0
                 weight           112
                 birthyear       1992
                 hobby           None
Paris   alice    children        None
                 weight            68
                 birthyear       1985
                 hobby         Biking
        bob      children           3
                 weight            83
                 birthyear       1984
                 hobby        Dancing
        charles  children         NaN
                 weight           NaN
                 birthyear        NaN
                 hobby           None
dtype: object</code></pre>
</div>
</div>
<p>The <code>stack()</code> and <code>unstack()</code> methods let you select the <code>level</code> to stack/unstack. You can even stack/unstack multiple levels at once:</p>
<div class="cell" data-scrolled="true" data-execution_count="67">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>d10 <span class="op">=</span> d9.unstack(level <span class="op">=</span> (<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>d10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">London</th>
      <th colspan="3" halign="left">Paris</th>
    </tr>
    <tr>
      <th></th>
      <th>alice</th>
      <th>bob</th>
      <th>charles</th>
      <th>alice</th>
      <th>bob</th>
      <th>charles</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>children</th>
      <td>None</td>
      <td>NaN</td>
      <td>0</td>
      <td>None</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>112</td>
      <td>68</td>
      <td>83</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>birthyear</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1992</td>
      <td>1985</td>
      <td>1984</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>hobby</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>Biking</td>
      <td>Dancing</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="most-methods-return-modified-copies" class="level2">
<h2 class="anchored" data-anchor-id="most-methods-return-modified-copies">Most methods return modified copies</h2>
<p>As you may have noticed, the <code>stack()</code> and <code>unstack()</code> methods do not modify the object they apply to. Instead, they work on a copy and return that copy. This is true of most methods in pandas.</p>
</section>
<section id="accessing-rows" class="level2">
<h2 class="anchored" data-anchor-id="accessing-rows">Accessing rows</h2>
<p>Let’s go back to the <code>people</code> <code>DataFrame</code>:</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>birthyear</th>
      <th>children</th>
      <th>hobby</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>1985</td>
      <td>NaN</td>
      <td>Biking</td>
      <td>68</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>1984</td>
      <td>3.0</td>
      <td>Dancing</td>
      <td>83</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>1992</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>112</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The <code>loc</code> attribute lets you access rows instead of columns. The result is a <code>Series</code> object in which the <code>DataFrame</code>’s column names are mapped to row index labels:</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>people.loc[<span class="st">"charles"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>birthyear    1992
children        0
hobby         NaN
weight        112
Name: charles, dtype: object</code></pre>
</div>
</div>
<p>You can also access rows by integer location using the <code>iloc</code> attribute:</p>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>people.iloc[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>birthyear    1992
children        0
hobby         NaN
weight        112
Name: charles, dtype: object</code></pre>
</div>
</div>
<p>You can also get a slice of rows, and this returns a <code>DataFrame</code> object:</p>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>people.iloc[<span class="dv">1</span>:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>birthyear</th>
      <th>children</th>
      <th>hobby</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bob</th>
      <td>1984</td>
      <td>3.0</td>
      <td>Dancing</td>
      <td>83</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>1992</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>112</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Finally, you can pass a boolean array to get the matching rows:</p>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>people[np.array([<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>birthyear</th>
      <th>children</th>
      <th>hobby</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>1985</td>
      <td>NaN</td>
      <td>Biking</td>
      <td>68</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>1992</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>112</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>This is most useful when combined with boolean expressions:</p>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>people[people[<span class="st">"birthyear"</span>] <span class="op">&lt;</span> <span class="dv">1990</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>birthyear</th>
      <th>children</th>
      <th>hobby</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>1985</td>
      <td>NaN</td>
      <td>Biking</td>
      <td>68</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>1984</td>
      <td>3.0</td>
      <td>Dancing</td>
      <td>83</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="adding-and-removing-columns" class="level2">
<h2 class="anchored" data-anchor-id="adding-and-removing-columns">Adding and removing columns</h2>
<p>You can generally treat <code>DataFrame</code> objects like dictionaries of <code>Series</code>, so the following work fine:</p>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>birthyear</th>
      <th>children</th>
      <th>hobby</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>1985</td>
      <td>NaN</td>
      <td>Biking</td>
      <td>68</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>1984</td>
      <td>3.0</td>
      <td>Dancing</td>
      <td>83</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>1992</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>112</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>people[<span class="st">"age"</span>] <span class="op">=</span> <span class="dv">2018</span> <span class="op">-</span> people[<span class="st">"birthyear"</span>]  <span class="co"># adds a new column "age"</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>people[<span class="st">"over 30"</span>] <span class="op">=</span> people[<span class="st">"age"</span>] <span class="op">&gt;</span> <span class="dv">30</span>      <span class="co"># adds another column "over 30"</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>birthyears <span class="op">=</span> people.pop(<span class="st">"birthyear"</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> people[<span class="st">"children"</span>]</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>weight</th>
      <th>age</th>
      <th>over 30</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>68</td>
      <td>33</td>
      <td>True</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>83</td>
      <td>34</td>
      <td>True</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>112</td>
      <td>26</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>birthyears</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>alice      1985
bob        1984
charles    1992
Name: birthyear, dtype: int64</code></pre>
</div>
</div>
<p>When you add a new colum, it must have the same number of rows. Missing rows are filled with NaN, and extra rows are ignored:</p>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>people[<span class="st">"pets"</span>] <span class="op">=</span> pd.Series({<span class="st">"bob"</span>: <span class="dv">0</span>, <span class="st">"charles"</span>: <span class="dv">5</span>, <span class="st">"eugene"</span>:<span class="dv">1</span>})  <span class="co"># alice is missing, eugene is ignored</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>weight</th>
      <th>age</th>
      <th>over 30</th>
      <th>pets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>68</td>
      <td>33</td>
      <td>True</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>83</td>
      <td>34</td>
      <td>True</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>112</td>
      <td>26</td>
      <td>False</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>When adding a new column, it is added at the end (on the right) by default. You can also insert a column anywhere else using the <code>insert()</code> method:</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>people.insert(<span class="dv">1</span>, <span class="st">"height"</span>, [<span class="dv">172</span>, <span class="dv">181</span>, <span class="dv">185</span>])</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>height</th>
      <th>weight</th>
      <th>age</th>
      <th>over 30</th>
      <th>pets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>172</td>
      <td>68</td>
      <td>33</td>
      <td>True</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>181</td>
      <td>83</td>
      <td>34</td>
      <td>True</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>185</td>
      <td>112</td>
      <td>26</td>
      <td>False</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="assigning-new-columns" class="level2">
<h2 class="anchored" data-anchor-id="assigning-new-columns">Assigning new columns</h2>
<p>You can also create new columns by calling the <code>assign()</code> method. Note that this returns a new <code>DataFrame</code> object, the original is not modified:</p>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>people.assign(</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    body_mass_index <span class="op">=</span> people[<span class="st">"weight"</span>] <span class="op">/</span> (people[<span class="st">"height"</span>] <span class="op">/</span> <span class="dv">100</span>) <span class="op">**</span> <span class="dv">2</span>,</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    has_pets <span class="op">=</span> people[<span class="st">"pets"</span>] <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>height</th>
      <th>weight</th>
      <th>age</th>
      <th>over 30</th>
      <th>pets</th>
      <th>body_mass_index</th>
      <th>has_pets</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>172</td>
      <td>68</td>
      <td>33</td>
      <td>True</td>
      <td>NaN</td>
      <td>22.985398</td>
      <td>False</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>181</td>
      <td>83</td>
      <td>34</td>
      <td>True</td>
      <td>0.0</td>
      <td>25.335002</td>
      <td>False</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>185</td>
      <td>112</td>
      <td>26</td>
      <td>False</td>
      <td>5.0</td>
      <td>32.724617</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Note that you cannot access columns created within the same assignment:</p>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>    people.assign(</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>        body_mass_index <span class="op">=</span> people[<span class="st">"weight"</span>] <span class="op">/</span> (people[<span class="st">"height"</span>] <span class="op">/</span> <span class="dv">100</span>) <span class="op">**</span> <span class="dv">2</span>,</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>        overweight <span class="op">=</span> people[<span class="st">"body_mass_index"</span>] <span class="op">&gt;</span> <span class="dv">25</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">KeyError</span> <span class="im">as</span> e:</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Key error:"</span>, e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key error: 'body_mass_index'</code></pre>
</div>
</div>
<p>The solution is to split this assignment in two consecutive assignments:</p>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>d6 <span class="op">=</span> people.assign(body_mass_index <span class="op">=</span> people[<span class="st">"weight"</span>] <span class="op">/</span> (people[<span class="st">"height"</span>] <span class="op">/</span> <span class="dv">100</span>) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>d6.assign(overweight <span class="op">=</span> d6[<span class="st">"body_mass_index"</span>] <span class="op">&gt;</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>height</th>
      <th>weight</th>
      <th>age</th>
      <th>over 30</th>
      <th>pets</th>
      <th>body_mass_index</th>
      <th>overweight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>172</td>
      <td>68</td>
      <td>33</td>
      <td>True</td>
      <td>NaN</td>
      <td>22.985398</td>
      <td>False</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>181</td>
      <td>83</td>
      <td>34</td>
      <td>True</td>
      <td>0.0</td>
      <td>25.335002</td>
      <td>True</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>185</td>
      <td>112</td>
      <td>26</td>
      <td>False</td>
      <td>5.0</td>
      <td>32.724617</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Having to create a temporary variable <code>d6</code> is not very convenient. You may want to just chain the assigment calls, but it does not work because the <code>people</code> object is not actually modified by the first assignment:</p>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    (people</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>         .assign(body_mass_index <span class="op">=</span> people[<span class="st">"weight"</span>] <span class="op">/</span> (people[<span class="st">"height"</span>] <span class="op">/</span> <span class="dv">100</span>) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>         .assign(overweight <span class="op">=</span> people[<span class="st">"body_mass_index"</span>] <span class="op">&gt;</span> <span class="dv">25</span>)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">KeyError</span> <span class="im">as</span> e:</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Key error:"</span>, e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key error: 'body_mass_index'</code></pre>
</div>
</div>
<p>But fear not, there is a simple solution. You can pass a function to the <code>assign()</code> method (typically a <code>lambda</code> function), and this function will be called with the <code>DataFrame</code> as a parameter:</p>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>(people</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>     .assign(body_mass_index <span class="op">=</span> <span class="kw">lambda</span> df: df[<span class="st">"weight"</span>] <span class="op">/</span> (df[<span class="st">"height"</span>] <span class="op">/</span> <span class="dv">100</span>) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>     .assign(overweight <span class="op">=</span> <span class="kw">lambda</span> df: df[<span class="st">"body_mass_index"</span>] <span class="op">&gt;</span> <span class="dv">25</span>)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>height</th>
      <th>weight</th>
      <th>age</th>
      <th>over 30</th>
      <th>pets</th>
      <th>body_mass_index</th>
      <th>overweight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>172</td>
      <td>68</td>
      <td>33</td>
      <td>True</td>
      <td>NaN</td>
      <td>22.985398</td>
      <td>False</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>181</td>
      <td>83</td>
      <td>34</td>
      <td>True</td>
      <td>0.0</td>
      <td>25.335002</td>
      <td>True</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>185</td>
      <td>112</td>
      <td>26</td>
      <td>False</td>
      <td>5.0</td>
      <td>32.724617</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Problem solved!</p>
</section>
<section id="evaluating-an-expression" class="level2">
<h2 class="anchored" data-anchor-id="evaluating-an-expression">Evaluating an expression</h2>
<p>A great feature supported by pandas is expression evaluation. This relies on the <code>numexpr</code> library which must be installed.</p>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>people.<span class="bu">eval</span>(<span class="st">"weight / (height/100) ** 2 &gt; 25"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>alice      False
bob         True
charles     True
dtype: bool</code></pre>
</div>
</div>
<p>Assignment expressions are also supported. Let’s set <code>inplace=True</code> to directly modify the <code>DataFrame</code> rather than getting a modified copy:</p>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>people.<span class="bu">eval</span>(<span class="st">"body_mass_index = weight / (height/100) ** 2"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>height</th>
      <th>weight</th>
      <th>age</th>
      <th>over 30</th>
      <th>pets</th>
      <th>body_mass_index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>172</td>
      <td>68</td>
      <td>33</td>
      <td>True</td>
      <td>NaN</td>
      <td>22.985398</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>181</td>
      <td>83</td>
      <td>34</td>
      <td>True</td>
      <td>0.0</td>
      <td>25.335002</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>185</td>
      <td>112</td>
      <td>26</td>
      <td>False</td>
      <td>5.0</td>
      <td>32.724617</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>You can use a local or global variable in an expression by prefixing it with <code>'@'</code>:</p>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>overweight_threshold <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>people.<span class="bu">eval</span>(<span class="st">"overweight = body_mass_index &gt; @overweight_threshold"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>height</th>
      <th>weight</th>
      <th>age</th>
      <th>over 30</th>
      <th>pets</th>
      <th>body_mass_index</th>
      <th>overweight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>172</td>
      <td>68</td>
      <td>33</td>
      <td>True</td>
      <td>NaN</td>
      <td>22.985398</td>
      <td>False</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>181</td>
      <td>83</td>
      <td>34</td>
      <td>True</td>
      <td>0.0</td>
      <td>25.335002</td>
      <td>False</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>185</td>
      <td>112</td>
      <td>26</td>
      <td>False</td>
      <td>5.0</td>
      <td>32.724617</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="querying-a-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="querying-a-dataframe">Querying a <code>DataFrame</code></h2>
<p>The <code>query()</code> method lets you filter a <code>DataFrame</code> based on a query expression:</p>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>people.query(<span class="st">"age &gt; 30 and pets == 0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>height</th>
      <th>weight</th>
      <th>age</th>
      <th>over 30</th>
      <th>pets</th>
      <th>body_mass_index</th>
      <th>overweight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>181</td>
      <td>83</td>
      <td>34</td>
      <td>True</td>
      <td>0.0</td>
      <td>25.335002</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="sorting-a-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="sorting-a-dataframe">Sorting a <code>DataFrame</code></h2>
<p>You can sort a <code>DataFrame</code> by calling its <code>sort_index</code> method. By default it sorts the rows by their index label, in ascending order, but let’s reverse the order:</p>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>people.sort_index(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>height</th>
      <th>weight</th>
      <th>age</th>
      <th>over 30</th>
      <th>pets</th>
      <th>body_mass_index</th>
      <th>overweight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>185</td>
      <td>112</td>
      <td>26</td>
      <td>False</td>
      <td>5.0</td>
      <td>32.724617</td>
      <td>True</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>181</td>
      <td>83</td>
      <td>34</td>
      <td>True</td>
      <td>0.0</td>
      <td>25.335002</td>
      <td>False</td>
    </tr>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>172</td>
      <td>68</td>
      <td>33</td>
      <td>True</td>
      <td>NaN</td>
      <td>22.985398</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Note that <code>sort_index</code> returned a sorted <em>copy</em> of the <code>DataFrame</code>. To modify <code>people</code> directly, we can set the <code>inplace</code> argument to <code>True</code>. Also, we can sort the columns instead of the rows by setting <code>axis=1</code>:</p>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>people.sort_index(axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>age</th>
      <th>body_mass_index</th>
      <th>height</th>
      <th>hobby</th>
      <th>over 30</th>
      <th>overweight</th>
      <th>pets</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>33</td>
      <td>22.985398</td>
      <td>172</td>
      <td>Biking</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>68</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>34</td>
      <td>25.335002</td>
      <td>181</td>
      <td>Dancing</td>
      <td>True</td>
      <td>False</td>
      <td>0.0</td>
      <td>83</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>26</td>
      <td>32.724617</td>
      <td>185</td>
      <td>NaN</td>
      <td>False</td>
      <td>True</td>
      <td>5.0</td>
      <td>112</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>To sort the <code>DataFrame</code> by the values instead of the labels, we can use <code>sort_values</code> and specify the column to sort by:</p>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>people.sort_values(by<span class="op">=</span><span class="st">"age"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>age</th>
      <th>body_mass_index</th>
      <th>height</th>
      <th>hobby</th>
      <th>over 30</th>
      <th>overweight</th>
      <th>pets</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>charles</th>
      <td>26</td>
      <td>32.724617</td>
      <td>185</td>
      <td>NaN</td>
      <td>False</td>
      <td>True</td>
      <td>5.0</td>
      <td>112</td>
    </tr>
    <tr>
      <th>alice</th>
      <td>33</td>
      <td>22.985398</td>
      <td>172</td>
      <td>Biking</td>
      <td>True</td>
      <td>False</td>
      <td>NaN</td>
      <td>68</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>34</td>
      <td>25.335002</td>
      <td>181</td>
      <td>Dancing</td>
      <td>True</td>
      <td>False</td>
      <td>0.0</td>
      <td>83</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="plotting-a-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="plotting-a-dataframe">Plotting a <code>DataFrame</code></h2>
<p>Just like for <code>Series</code>, pandas makes it easy to draw nice graphs based on a <code>DataFrame</code>.</p>
<p>For example, it is trivial to create a line plot from a <code>DataFrame</code>’s data by calling its <code>plot</code> method:</p>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>people.plot(kind <span class="op">=</span> <span class="st">"line"</span>, x <span class="op">=</span> <span class="st">"body_mass_index"</span>, y <span class="op">=</span> [<span class="st">"height"</span>, <span class="st">"weight"</span>])</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="tools_pandas_files/figure-html/cell-92-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>You can pass extra arguments supported by matplotlib’s functions. For example, we can create scatterplot and pass it a list of sizes using the <code>s</code> argument of matplotlib’s <code>scatter()</code> function:</p>
<div class="cell" data-scrolled="true" data-execution_count="92">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>people.plot(kind <span class="op">=</span> <span class="st">"scatter"</span>, x <span class="op">=</span> <span class="st">"height"</span>, y <span class="op">=</span> <span class="st">"weight"</span>, s<span class="op">=</span>[<span class="dv">40</span>, <span class="dv">120</span>, <span class="dv">200</span>])</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="tools_pandas_files/figure-html/cell-93-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Again, there are way too many options to list here: the best option is to scroll through the <a href="http://pandas.pydata.org/pandas-docs/stable/visualization.html">Visualization</a> page in pandas’ documentation, find the plot you are interested in and look at the example code.</p>
</section>
<section id="operations-on-dataframes" class="level2">
<h2 class="anchored" data-anchor-id="operations-on-dataframes">Operations on <code>DataFrame</code>s</h2>
<p>Although <code>DataFrame</code>s do not try to mimick NumPy arrays, there are a few similarities. Let’s create a <code>DataFrame</code> to demonstrate this:</p>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>grades_array <span class="op">=</span> np.array([[<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">9</span>],[<span class="dv">10</span>,<span class="dv">9</span>,<span class="dv">9</span>],[<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">2</span>], [<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">10</span>]])</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>grades <span class="op">=</span> pd.DataFrame(grades_array, columns<span class="op">=</span>[<span class="st">"sep"</span>, <span class="st">"oct"</span>, <span class="st">"nov"</span>], index<span class="op">=</span>[<span class="st">"alice"</span>,<span class="st">"bob"</span>,<span class="st">"charles"</span>,<span class="st">"darwin"</span>])</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>8</td>
      <td>8</td>
      <td>9</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>10</td>
      <td>9</td>
      <td>9</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>4</td>
      <td>8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>9</td>
      <td>10</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>You can apply NumPy mathematical functions on a <code>DataFrame</code>: the function is applied to all values:</p>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>np.sqrt(grades)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>2.828427</td>
      <td>2.828427</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>3.162278</td>
      <td>3.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>2.000000</td>
      <td>2.828427</td>
      <td>1.414214</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>3.000000</td>
      <td>3.162278</td>
      <td>3.162278</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Similarly, adding a single value to a <code>DataFrame</code> will add that value to all elements in the <code>DataFrame</code>. This is called <em>broadcasting</em>:</p>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>grades <span class="op">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>9</td>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>11</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>5</td>
      <td>9</td>
      <td>3</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>10</td>
      <td>11</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Of course, the same is true for all other binary operations, including arithmetic (<code>*</code>,<code>/</code>,<code>**</code>…) and conditional (<code>&gt;</code>, <code>==</code>…) operations:</p>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>grades <span class="op">&gt;=</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Aggregation operations, such as computing the <code>max</code>, the <code>sum</code> or the <code>mean</code> of a <code>DataFrame</code>, apply to each column, and you get back a <code>Series</code> object:</p>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>grades.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>sep    7.75
oct    8.75
nov    7.50
dtype: float64</code></pre>
</div>
</div>
<p>The <code>all</code> method is also an aggregation operation: it checks whether all values are <code>True</code> or not. Let’s see during which months all students got a grade greater than <code>5</code>:</p>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>(grades <span class="op">&gt;</span> <span class="dv">5</span>).<span class="bu">all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>sep    False
oct     True
nov    False
dtype: bool</code></pre>
</div>
</div>
<p>Most of these functions take an optional <code>axis</code> parameter which lets you specify along which axis of the <code>DataFrame</code> you want the operation executed. The default is <code>axis=0</code>, meaning that the operation is executed vertically (on each column). You can set <code>axis=1</code> to execute the operation horizontally (on each row). For example, let’s find out which students had all grades greater than <code>5</code>:</p>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>(grades <span class="op">&gt;</span> <span class="dv">5</span>).<span class="bu">all</span>(axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>alice       True
bob         True
charles    False
darwin      True
dtype: bool</code></pre>
</div>
</div>
<p>The <code>any</code> method returns <code>True</code> if any value is True. Let’s see who got at least one grade 10:</p>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>(grades <span class="op">==</span> <span class="dv">10</span>).<span class="bu">any</span>(axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>alice      False
bob         True
charles    False
darwin      True
dtype: bool</code></pre>
</div>
</div>
<p>If you add a <code>Series</code> object to a <code>DataFrame</code> (or execute any other binary operation), pandas attempts to broadcast the operation to all <em>rows</em> in the <code>DataFrame</code>. This only works if the <code>Series</code> has the same size as the <code>DataFrame</code>s rows. For example, let’s subtract the <code>mean</code> of the <code>DataFrame</code> (a <code>Series</code> object) from the <code>DataFrame</code>:</p>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>grades <span class="op">-</span> grades.mean()  <span class="co"># equivalent to: grades - [7.75, 8.75, 7.50]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>0.25</td>
      <td>-0.75</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>2.25</td>
      <td>0.25</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>-3.75</td>
      <td>-0.75</td>
      <td>-5.5</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>1.25</td>
      <td>1.25</td>
      <td>2.5</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We subtracted <code>7.75</code> from all September grades, <code>8.75</code> from October grades and <code>7.50</code> from November grades. It is equivalent to subtracting this <code>DataFrame</code>:</p>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame([[<span class="fl">7.75</span>, <span class="fl">8.75</span>, <span class="fl">7.50</span>]]<span class="op">*</span><span class="dv">4</span>, index<span class="op">=</span>grades.index, columns<span class="op">=</span>grades.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>7.75</td>
      <td>8.75</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>7.75</td>
      <td>8.75</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>7.75</td>
      <td>8.75</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>7.75</td>
      <td>8.75</td>
      <td>7.5</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>If you want to subtract the global mean from every grade, here is one way to do it:</p>
<div class="cell" data-scrolled="true" data-execution_count="103">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>grades <span class="op">-</span> grades.values.mean() <span class="co"># subtracts the global mean (8.00) from all grades</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>-4.0</td>
      <td>0.0</td>
      <td>-6.0</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="automatic-alignment-1" class="level2">
<h2 class="anchored" data-anchor-id="automatic-alignment-1">Automatic alignment</h2>
<p>Similar to <code>Series</code>, when operating on multiple <code>DataFrame</code>s, pandas automatically aligns them by row index label, but also by column names. Let’s create a <code>DataFrame</code> with bonus points for each person from October to December:</p>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>bonus_array <span class="op">=</span> np.array([[<span class="dv">0</span>,np.nan,<span class="dv">2</span>],[np.nan,<span class="dv">1</span>,<span class="dv">0</span>],[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">0</span>]])</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>bonus_points <span class="op">=</span> pd.DataFrame(bonus_array, columns<span class="op">=</span>[<span class="st">"oct"</span>, <span class="st">"nov"</span>, <span class="st">"dec"</span>], index<span class="op">=</span>[<span class="st">"bob"</span>,<span class="st">"colin"</span>, <span class="st">"darwin"</span>, <span class="st">"charles"</span>])</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>bonus_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>oct</th>
      <th>nov</th>
      <th>dec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bob</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>colin</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="105">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>grades <span class="op">+</span> bonus_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>dec</th>
      <th>nov</th>
      <th>oct</th>
      <th>sep</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>colin</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>NaN</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Looks like the addition worked in some cases but way too many elements are now empty. That’s because when aligning the <code>DataFrame</code>s, some columns and rows were only present on one side, and thus they were considered missing on the other side (<code>NaN</code>). Then adding <code>NaN</code> to a number results in <code>NaN</code>, hence the result.</p>
</section>
<section id="handling-missing-data" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data">Handling missing data</h2>
<p>Dealing with missing data is a frequent task when working with real life data. Pandas offers a few tools to handle missing data.</p>
<p>Let’s try to fix the problem above. For example, we can decide that missing data should result in a zero, instead of <code>NaN</code>. We can replace all <code>NaN</code> values by a any value using the <code>fillna()</code> method:</p>
<div class="cell" data-scrolled="true" data-execution_count="106">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>(grades <span class="op">+</span> bonus_points).fillna(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>dec</th>
      <th>nov</th>
      <th>oct</th>
      <th>sep</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>0.0</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>colin</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>0.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>It’s a bit unfair that we’re setting grades to zero in September, though. Perhaps we should decide that missing grades are missing grades, but missing bonus points should be replaced by zeros:</p>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>fixed_bonus_points <span class="op">=</span> bonus_points.fillna(<span class="dv">0</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>fixed_bonus_points.insert(<span class="dv">0</span>, <span class="st">"sep"</span>, <span class="dv">0</span>)</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>fixed_bonus_points.loc[<span class="st">"alice"</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>grades <span class="op">+</span> fixed_bonus_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>dec</th>
      <th>nov</th>
      <th>oct</th>
      <th>sep</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>NaN</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>NaN</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>colin</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>NaN</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>That’s much better: although we made up some data, we have not been too unfair.</p>
<p>Another way to handle missing data is to interpolate. Let’s look at the <code>bonus_points</code> <code>DataFrame</code> again:</p>
<div class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>bonus_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>oct</th>
      <th>nov</th>
      <th>dec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bob</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>colin</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now let’s call the <code>interpolate</code> method. By default, it interpolates vertically (<code>axis=0</code>), so let’s tell it to interpolate horizontally (<code>axis=1</code>).</p>
<div class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>bonus_points.interpolate(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>oct</th>
      <th>nov</th>
      <th>dec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bob</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>colin</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Bob had 0 bonus points in October, and 2 in December. When we interpolate for November, we get the mean: 1 bonus point. Colin had 1 bonus point in November, but we do not know how many bonus points he had in September, so we cannot interpolate, this is why there is still a missing value in October after interpolation. To fix this, we can set the September bonus points to 0 before interpolation.</p>
<div class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>better_bonus_points <span class="op">=</span> bonus_points.copy()</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>better_bonus_points.insert(<span class="dv">0</span>, <span class="st">"sep"</span>, <span class="dv">0</span>)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>better_bonus_points.loc[<span class="st">"alice"</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>better_bonus_points <span class="op">=</span> better_bonus_points.interpolate(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>better_bonus_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
      <th>dec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bob</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>colin</th>
      <td>0.0</td>
      <td>0.5</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>0.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>alice</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Great, now we have reasonable bonus points everywhere. Let’s find out the final grades:</p>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>grades <span class="op">+</span> better_bonus_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>dec</th>
      <th>nov</th>
      <th>oct</th>
      <th>sep</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>NaN</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>NaN</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>11.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>colin</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>NaN</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>It is slightly annoying that the September column ends up on the right. This is because the <code>DataFrame</code>s we are adding do not have the exact same columns (the <code>grades</code> <code>DataFrame</code> is missing the <code>"dec"</code> column), so to make things predictable, pandas orders the final columns alphabetically. To fix this, we can simply add the missing column before adding:</p>
<div class="cell" data-scrolled="true" data-execution_count="112">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>grades[<span class="st">"dec"</span>] <span class="op">=</span> np.nan</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>final_grades <span class="op">=</span> grades <span class="op">+</span> better_bonus_points</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>final_grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
      <th>dec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>8.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>10.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>4.0</td>
      <td>11.0</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>colin</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>There’s not much we can do about December and Colin: it’s bad enough that we are making up bonus points, but we can’t reasonably make up grades (well I guess some teachers probably do). So let’s call the <code>dropna()</code> method to get rid of rows that are full of <code>NaN</code>s:</p>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>final_grades_clean <span class="op">=</span> final_grades.dropna(how<span class="op">=</span><span class="st">"all"</span>)</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>final_grades_clean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
      <th>dec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>8.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>10.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>4.0</td>
      <td>11.0</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now let’s remove columns that are full of <code>NaN</code>s by setting the <code>axis</code> argument to <code>1</code>:</p>
<div class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>final_grades_clean <span class="op">=</span> final_grades_clean.dropna(axis<span class="op">=</span><span class="dv">1</span>, how<span class="op">=</span><span class="st">"all"</span>)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>final_grades_clean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>8.0</td>
      <td>8.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>10.0</td>
      <td>9.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>4.0</td>
      <td>11.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="aggregating-with-groupby" class="level2">
<h2 class="anchored" data-anchor-id="aggregating-with-groupby">Aggregating with <code>groupby</code></h2>
<p>Similar to the SQL language, pandas allows grouping your data into groups to run calculations over each group.</p>
<p>First, let’s add some extra data about each person so we can group them, and let’s go back to the <code>final_grades</code> <code>DataFrame</code> so we can see how <code>NaN</code> values are handled:</p>
<div class="cell" data-scrolled="true" data-execution_count="115">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>final_grades[<span class="st">"hobby"</span>] <span class="op">=</span> [<span class="st">"Biking"</span>, <span class="st">"Dancing"</span>, np.nan, <span class="st">"Dancing"</span>, <span class="st">"Biking"</span>]</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>final_grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
      <th>dec</th>
      <th>hobby</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>8.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>Biking</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>10.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>Dancing</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>4.0</td>
      <td>11.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>colin</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Dancing</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>Biking</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now let’s group data in this <code>DataFrame</code> by hobby:</p>
<div class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>grouped_grades <span class="op">=</span> final_grades.groupby(<span class="st">"hobby"</span>)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>grouped_grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>&lt;pandas.core.groupby.DataFrameGroupBy object at 0x10b680e10&gt;</code></pre>
</div>
</div>
<p>We are ready to compute the average grade per hobby:</p>
<div class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>grouped_grades.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
      <th>dec</th>
    </tr>
    <tr>
      <th>hobby</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Biking</th>
      <td>8.5</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Dancing</th>
      <td>10.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>That was easy! Note that the <code>NaN</code> values have simply been skipped when computing the means.</p>
</section>
<section id="pivot-tables" class="level2">
<h2 class="anchored" data-anchor-id="pivot-tables">Pivot tables</h2>
<p>Pandas supports spreadsheet-like <a href="https://en.wikipedia.org/wiki/Pivot_table">pivot tables</a> that allow quick data summarization. To illustrate this, let’s create a simple <code>DataFrame</code>:</p>
<div class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>bonus_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="118">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>oct</th>
      <th>nov</th>
      <th>dec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bob</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>colin</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>more_grades <span class="op">=</span> final_grades_clean.stack().reset_index()</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>more_grades.columns <span class="op">=</span> [<span class="st">"name"</span>, <span class="st">"month"</span>, <span class="st">"grade"</span>]</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>more_grades[<span class="st">"bonus"</span>] <span class="op">=</span> [np.nan, np.nan, np.nan, <span class="dv">0</span>, np.nan, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>more_grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>name</th>
      <th>month</th>
      <th>grade</th>
      <th>bonus</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>alice</td>
      <td>sep</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>alice</td>
      <td>oct</td>
      <td>8.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>alice</td>
      <td>nov</td>
      <td>9.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bob</td>
      <td>sep</td>
      <td>10.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bob</td>
      <td>oct</td>
      <td>9.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bob</td>
      <td>nov</td>
      <td>10.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>charles</td>
      <td>sep</td>
      <td>4.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>charles</td>
      <td>oct</td>
      <td>11.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>charles</td>
      <td>nov</td>
      <td>5.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>darwin</td>
      <td>sep</td>
      <td>9.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>darwin</td>
      <td>oct</td>
      <td>10.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>darwin</td>
      <td>nov</td>
      <td>11.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now we can call the <code>pd.pivot_table()</code> function for this <code>DataFrame</code>, asking to group by the <code>name</code> column. By default, <code>pivot_table()</code> computes the mean of each numeric column:</p>
<div class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>pd.pivot_table(more_grades, index<span class="op">=</span><span class="st">"name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>bonus</th>
      <th>grade</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>NaN</td>
      <td>8.333333</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>1.000000</td>
      <td>9.666667</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>2.000000</td>
      <td>6.666667</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>0.333333</td>
      <td>10.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We can change the aggregation function by setting the <code>aggfunc</code> argument, and we can also specify the list of columns whose values will be aggregated:</p>
<div class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>pd.pivot_table(more_grades, index<span class="op">=</span><span class="st">"name"</span>, values<span class="op">=</span>[<span class="st">"grade"</span>,<span class="st">"bonus"</span>], aggfunc<span class="op">=</span>np.<span class="bu">max</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>bonus</th>
      <th>grade</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>NaN</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>2.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>3.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>1.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We can also specify the <code>columns</code> to aggregate over horizontally, and request the grand totals for each row and column by setting <code>margins=True</code>:</p>
<div class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>pd.pivot_table(more_grades, index<span class="op">=</span><span class="st">"name"</span>, values<span class="op">=</span><span class="st">"grade"</span>, columns<span class="op">=</span><span class="st">"month"</span>, margins<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>month</th>
      <th>nov</th>
      <th>oct</th>
      <th>sep</th>
      <th>All</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>9.00</td>
      <td>8.0</td>
      <td>8.00</td>
      <td>8.333333</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>10.00</td>
      <td>9.0</td>
      <td>10.00</td>
      <td>9.666667</td>
    </tr>
    <tr>
      <th>charles</th>
      <td>5.00</td>
      <td>11.0</td>
      <td>4.00</td>
      <td>6.666667</td>
    </tr>
    <tr>
      <th>darwin</th>
      <td>11.00</td>
      <td>10.0</td>
      <td>9.00</td>
      <td>10.000000</td>
    </tr>
    <tr>
      <th>All</th>
      <td>8.75</td>
      <td>9.5</td>
      <td>7.75</td>
      <td>8.666667</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Finally, we can specify multiple index or column names, and pandas will create multi-level indices:</p>
<div class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>pd.pivot_table(more_grades, index<span class="op">=</span>(<span class="st">"name"</span>, <span class="st">"month"</span>), margins<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="123">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>bonus</th>
      <th>grade</th>
    </tr>
    <tr>
      <th>name</th>
      <th>month</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">alice</th>
      <th>nov</th>
      <td>NaN</td>
      <td>9.00</td>
    </tr>
    <tr>
      <th>oct</th>
      <td>NaN</td>
      <td>8.00</td>
    </tr>
    <tr>
      <th>sep</th>
      <td>NaN</td>
      <td>8.00</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">bob</th>
      <th>nov</th>
      <td>2.000</td>
      <td>10.00</td>
    </tr>
    <tr>
      <th>oct</th>
      <td>NaN</td>
      <td>9.00</td>
    </tr>
    <tr>
      <th>sep</th>
      <td>0.000</td>
      <td>10.00</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">charles</th>
      <th>nov</th>
      <td>0.000</td>
      <td>5.00</td>
    </tr>
    <tr>
      <th>oct</th>
      <td>3.000</td>
      <td>11.00</td>
    </tr>
    <tr>
      <th>sep</th>
      <td>3.000</td>
      <td>4.00</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">darwin</th>
      <th>nov</th>
      <td>0.000</td>
      <td>11.00</td>
    </tr>
    <tr>
      <th>oct</th>
      <td>1.000</td>
      <td>10.00</td>
    </tr>
    <tr>
      <th>sep</th>
      <td>0.000</td>
      <td>9.00</td>
    </tr>
    <tr>
      <th>All</th>
      <th></th>
      <td>1.125</td>
      <td>8.75</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="overview-functions" class="level2">
<h2 class="anchored" data-anchor-id="overview-functions">Overview functions</h2>
<p>When dealing with large <code>DataFrames</code>, it is useful to get a quick overview of its content. Pandas offers a few functions for this. First, let’s create a large <code>DataFrame</code> with a mix of numeric values, missing values and text values. Notice how Jupyter displays only the corners of the <code>DataFrame</code>:</p>
<div class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>much_data <span class="op">=</span> np.fromfunction(<span class="kw">lambda</span> x,y: (x<span class="op">+</span>y<span class="op">*</span>y)<span class="op">%</span><span class="dv">17</span><span class="op">*</span><span class="dv">11</span>, (<span class="dv">10000</span>, <span class="dv">26</span>))</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>large_df <span class="op">=</span> pd.DataFrame(much_data, columns<span class="op">=</span><span class="bu">list</span>(<span class="st">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>))</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>large_df[large_df <span class="op">%</span> <span class="dv">16</span> <span class="op">==</span> <span class="dv">0</span>] <span class="op">=</span> np.nan</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>large_df.insert(<span class="dv">3</span>,<span class="st">"some_text"</span>, <span class="st">"Blabla"</span>)</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>large_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>some_text</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>...</th>
      <th>Q</th>
      <th>R</th>
      <th>S</th>
      <th>T</th>
      <th>U</th>
      <th>V</th>
      <th>W</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>11.0</td>
      <td>44.0</td>
      <td>Blabla</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>22.0</td>
      <td>165.0</td>
      <td>143.0</td>
      <td>...</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>44.0</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>22.0</td>
      <td>165.0</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.0</td>
      <td>22.0</td>
      <td>55.0</td>
      <td>Blabla</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>99.0</td>
      <td>33.0</td>
      <td>NaN</td>
      <td>154.0</td>
      <td>...</td>
      <td>22.0</td>
      <td>11.0</td>
      <td>22.0</td>
      <td>55.0</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>99.0</td>
      <td>33.0</td>
      <td>NaN</td>
      <td>154.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>Blabla</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
      <td>...</td>
      <td>33.0</td>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>Blabla</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>44.0</td>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>44.0</td>
      <td>55.0</td>
      <td>88.0</td>
      <td>Blabla</td>
      <td>143.0</td>
      <td>33.0</td>
      <td>132.0</td>
      <td>66.0</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>55.0</td>
      <td>44.0</td>
      <td>55.0</td>
      <td>88.0</td>
      <td>143.0</td>
      <td>33.0</td>
      <td>132.0</td>
      <td>66.0</td>
      <td>22.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>55.0</td>
      <td>66.0</td>
      <td>99.0</td>
      <td>Blabla</td>
      <td>154.0</td>
      <td>44.0</td>
      <td>143.0</td>
      <td>77.0</td>
      <td>33.0</td>
      <td>11.0</td>
      <td>...</td>
      <td>66.0</td>
      <td>55.0</td>
      <td>66.0</td>
      <td>99.0</td>
      <td>154.0</td>
      <td>44.0</td>
      <td>143.0</td>
      <td>77.0</td>
      <td>33.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>66.0</td>
      <td>77.0</td>
      <td>110.0</td>
      <td>Blabla</td>
      <td>165.0</td>
      <td>55.0</td>
      <td>154.0</td>
      <td>88.0</td>
      <td>44.0</td>
      <td>22.0</td>
      <td>...</td>
      <td>77.0</td>
      <td>66.0</td>
      <td>77.0</td>
      <td>110.0</td>
      <td>165.0</td>
      <td>55.0</td>
      <td>154.0</td>
      <td>88.0</td>
      <td>44.0</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>77.0</td>
      <td>88.0</td>
      <td>121.0</td>
      <td>Blabla</td>
      <td>NaN</td>
      <td>66.0</td>
      <td>165.0</td>
      <td>99.0</td>
      <td>55.0</td>
      <td>33.0</td>
      <td>...</td>
      <td>88.0</td>
      <td>77.0</td>
      <td>88.0</td>
      <td>121.0</td>
      <td>NaN</td>
      <td>66.0</td>
      <td>165.0</td>
      <td>99.0</td>
      <td>55.0</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>88.0</td>
      <td>99.0</td>
      <td>132.0</td>
      <td>Blabla</td>
      <td>NaN</td>
      <td>77.0</td>
      <td>NaN</td>
      <td>110.0</td>
      <td>66.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>99.0</td>
      <td>88.0</td>
      <td>99.0</td>
      <td>132.0</td>
      <td>NaN</td>
      <td>77.0</td>
      <td>NaN</td>
      <td>110.0</td>
      <td>66.0</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>99.0</td>
      <td>110.0</td>
      <td>143.0</td>
      <td>Blabla</td>
      <td>11.0</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>121.0</td>
      <td>77.0</td>
      <td>55.0</td>
      <td>...</td>
      <td>110.0</td>
      <td>99.0</td>
      <td>110.0</td>
      <td>143.0</td>
      <td>11.0</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>121.0</td>
      <td>77.0</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>110.0</td>
      <td>121.0</td>
      <td>154.0</td>
      <td>Blabla</td>
      <td>22.0</td>
      <td>99.0</td>
      <td>11.0</td>
      <td>132.0</td>
      <td>88.0</td>
      <td>66.0</td>
      <td>...</td>
      <td>121.0</td>
      <td>110.0</td>
      <td>121.0</td>
      <td>154.0</td>
      <td>22.0</td>
      <td>99.0</td>
      <td>11.0</td>
      <td>132.0</td>
      <td>88.0</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>121.0</td>
      <td>132.0</td>
      <td>165.0</td>
      <td>Blabla</td>
      <td>33.0</td>
      <td>110.0</td>
      <td>22.0</td>
      <td>143.0</td>
      <td>99.0</td>
      <td>77.0</td>
      <td>...</td>
      <td>132.0</td>
      <td>121.0</td>
      <td>132.0</td>
      <td>165.0</td>
      <td>33.0</td>
      <td>110.0</td>
      <td>22.0</td>
      <td>143.0</td>
      <td>99.0</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>132.0</td>
      <td>143.0</td>
      <td>NaN</td>
      <td>Blabla</td>
      <td>44.0</td>
      <td>121.0</td>
      <td>33.0</td>
      <td>154.0</td>
      <td>110.0</td>
      <td>88.0</td>
      <td>...</td>
      <td>143.0</td>
      <td>132.0</td>
      <td>143.0</td>
      <td>NaN</td>
      <td>44.0</td>
      <td>121.0</td>
      <td>33.0</td>
      <td>154.0</td>
      <td>110.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>143.0</td>
      <td>154.0</td>
      <td>NaN</td>
      <td>Blabla</td>
      <td>55.0</td>
      <td>132.0</td>
      <td>44.0</td>
      <td>165.0</td>
      <td>121.0</td>
      <td>99.0</td>
      <td>...</td>
      <td>154.0</td>
      <td>143.0</td>
      <td>154.0</td>
      <td>NaN</td>
      <td>55.0</td>
      <td>132.0</td>
      <td>44.0</td>
      <td>165.0</td>
      <td>121.0</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>154.0</td>
      <td>165.0</td>
      <td>11.0</td>
      <td>Blabla</td>
      <td>66.0</td>
      <td>143.0</td>
      <td>55.0</td>
      <td>NaN</td>
      <td>132.0</td>
      <td>110.0</td>
      <td>...</td>
      <td>165.0</td>
      <td>154.0</td>
      <td>165.0</td>
      <td>11.0</td>
      <td>66.0</td>
      <td>143.0</td>
      <td>55.0</td>
      <td>NaN</td>
      <td>132.0</td>
      <td>110.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>165.0</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>Blabla</td>
      <td>77.0</td>
      <td>154.0</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>143.0</td>
      <td>121.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>165.0</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>77.0</td>
      <td>154.0</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>143.0</td>
      <td>121.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>Blabla</td>
      <td>88.0</td>
      <td>165.0</td>
      <td>77.0</td>
      <td>11.0</td>
      <td>154.0</td>
      <td>132.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>88.0</td>
      <td>165.0</td>
      <td>77.0</td>
      <td>11.0</td>
      <td>154.0</td>
      <td>132.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>NaN</td>
      <td>11.0</td>
      <td>44.0</td>
      <td>Blabla</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>22.0</td>
      <td>165.0</td>
      <td>143.0</td>
      <td>...</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>44.0</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>22.0</td>
      <td>165.0</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>11.0</td>
      <td>22.0</td>
      <td>55.0</td>
      <td>Blabla</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>99.0</td>
      <td>33.0</td>
      <td>NaN</td>
      <td>154.0</td>
      <td>...</td>
      <td>22.0</td>
      <td>11.0</td>
      <td>22.0</td>
      <td>55.0</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>99.0</td>
      <td>33.0</td>
      <td>NaN</td>
      <td>154.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>Blabla</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
      <td>...</td>
      <td>33.0</td>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>Blabla</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>44.0</td>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21</th>
      <td>44.0</td>
      <td>55.0</td>
      <td>88.0</td>
      <td>Blabla</td>
      <td>143.0</td>
      <td>33.0</td>
      <td>132.0</td>
      <td>66.0</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>55.0</td>
      <td>44.0</td>
      <td>55.0</td>
      <td>88.0</td>
      <td>143.0</td>
      <td>33.0</td>
      <td>132.0</td>
      <td>66.0</td>
      <td>22.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>55.0</td>
      <td>66.0</td>
      <td>99.0</td>
      <td>Blabla</td>
      <td>154.0</td>
      <td>44.0</td>
      <td>143.0</td>
      <td>77.0</td>
      <td>33.0</td>
      <td>11.0</td>
      <td>...</td>
      <td>66.0</td>
      <td>55.0</td>
      <td>66.0</td>
      <td>99.0</td>
      <td>154.0</td>
      <td>44.0</td>
      <td>143.0</td>
      <td>77.0</td>
      <td>33.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>66.0</td>
      <td>77.0</td>
      <td>110.0</td>
      <td>Blabla</td>
      <td>165.0</td>
      <td>55.0</td>
      <td>154.0</td>
      <td>88.0</td>
      <td>44.0</td>
      <td>22.0</td>
      <td>...</td>
      <td>77.0</td>
      <td>66.0</td>
      <td>77.0</td>
      <td>110.0</td>
      <td>165.0</td>
      <td>55.0</td>
      <td>154.0</td>
      <td>88.0</td>
      <td>44.0</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>77.0</td>
      <td>88.0</td>
      <td>121.0</td>
      <td>Blabla</td>
      <td>NaN</td>
      <td>66.0</td>
      <td>165.0</td>
      <td>99.0</td>
      <td>55.0</td>
      <td>33.0</td>
      <td>...</td>
      <td>88.0</td>
      <td>77.0</td>
      <td>88.0</td>
      <td>121.0</td>
      <td>NaN</td>
      <td>66.0</td>
      <td>165.0</td>
      <td>99.0</td>
      <td>55.0</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>88.0</td>
      <td>99.0</td>
      <td>132.0</td>
      <td>Blabla</td>
      <td>NaN</td>
      <td>77.0</td>
      <td>NaN</td>
      <td>110.0</td>
      <td>66.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>99.0</td>
      <td>88.0</td>
      <td>99.0</td>
      <td>132.0</td>
      <td>NaN</td>
      <td>77.0</td>
      <td>NaN</td>
      <td>110.0</td>
      <td>66.0</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>99.0</td>
      <td>110.0</td>
      <td>143.0</td>
      <td>Blabla</td>
      <td>11.0</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>121.0</td>
      <td>77.0</td>
      <td>55.0</td>
      <td>...</td>
      <td>110.0</td>
      <td>99.0</td>
      <td>110.0</td>
      <td>143.0</td>
      <td>11.0</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>121.0</td>
      <td>77.0</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>110.0</td>
      <td>121.0</td>
      <td>154.0</td>
      <td>Blabla</td>
      <td>22.0</td>
      <td>99.0</td>
      <td>11.0</td>
      <td>132.0</td>
      <td>88.0</td>
      <td>66.0</td>
      <td>...</td>
      <td>121.0</td>
      <td>110.0</td>
      <td>121.0</td>
      <td>154.0</td>
      <td>22.0</td>
      <td>99.0</td>
      <td>11.0</td>
      <td>132.0</td>
      <td>88.0</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>121.0</td>
      <td>132.0</td>
      <td>165.0</td>
      <td>Blabla</td>
      <td>33.0</td>
      <td>110.0</td>
      <td>22.0</td>
      <td>143.0</td>
      <td>99.0</td>
      <td>77.0</td>
      <td>...</td>
      <td>132.0</td>
      <td>121.0</td>
      <td>132.0</td>
      <td>165.0</td>
      <td>33.0</td>
      <td>110.0</td>
      <td>22.0</td>
      <td>143.0</td>
      <td>99.0</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>132.0</td>
      <td>143.0</td>
      <td>NaN</td>
      <td>Blabla</td>
      <td>44.0</td>
      <td>121.0</td>
      <td>33.0</td>
      <td>154.0</td>
      <td>110.0</td>
      <td>88.0</td>
      <td>...</td>
      <td>143.0</td>
      <td>132.0</td>
      <td>143.0</td>
      <td>NaN</td>
      <td>44.0</td>
      <td>121.0</td>
      <td>33.0</td>
      <td>154.0</td>
      <td>110.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9970</th>
      <td>88.0</td>
      <td>99.0</td>
      <td>132.0</td>
      <td>Blabla</td>
      <td>NaN</td>
      <td>77.0</td>
      <td>NaN</td>
      <td>110.0</td>
      <td>66.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>99.0</td>
      <td>88.0</td>
      <td>99.0</td>
      <td>132.0</td>
      <td>NaN</td>
      <td>77.0</td>
      <td>NaN</td>
      <td>110.0</td>
      <td>66.0</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>9971</th>
      <td>99.0</td>
      <td>110.0</td>
      <td>143.0</td>
      <td>Blabla</td>
      <td>11.0</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>121.0</td>
      <td>77.0</td>
      <td>55.0</td>
      <td>...</td>
      <td>110.0</td>
      <td>99.0</td>
      <td>110.0</td>
      <td>143.0</td>
      <td>11.0</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>121.0</td>
      <td>77.0</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>9972</th>
      <td>110.0</td>
      <td>121.0</td>
      <td>154.0</td>
      <td>Blabla</td>
      <td>22.0</td>
      <td>99.0</td>
      <td>11.0</td>
      <td>132.0</td>
      <td>88.0</td>
      <td>66.0</td>
      <td>...</td>
      <td>121.0</td>
      <td>110.0</td>
      <td>121.0</td>
      <td>154.0</td>
      <td>22.0</td>
      <td>99.0</td>
      <td>11.0</td>
      <td>132.0</td>
      <td>88.0</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>9973</th>
      <td>121.0</td>
      <td>132.0</td>
      <td>165.0</td>
      <td>Blabla</td>
      <td>33.0</td>
      <td>110.0</td>
      <td>22.0</td>
      <td>143.0</td>
      <td>99.0</td>
      <td>77.0</td>
      <td>...</td>
      <td>132.0</td>
      <td>121.0</td>
      <td>132.0</td>
      <td>165.0</td>
      <td>33.0</td>
      <td>110.0</td>
      <td>22.0</td>
      <td>143.0</td>
      <td>99.0</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>9974</th>
      <td>132.0</td>
      <td>143.0</td>
      <td>NaN</td>
      <td>Blabla</td>
      <td>44.0</td>
      <td>121.0</td>
      <td>33.0</td>
      <td>154.0</td>
      <td>110.0</td>
      <td>88.0</td>
      <td>...</td>
      <td>143.0</td>
      <td>132.0</td>
      <td>143.0</td>
      <td>NaN</td>
      <td>44.0</td>
      <td>121.0</td>
      <td>33.0</td>
      <td>154.0</td>
      <td>110.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>9975</th>
      <td>143.0</td>
      <td>154.0</td>
      <td>NaN</td>
      <td>Blabla</td>
      <td>55.0</td>
      <td>132.0</td>
      <td>44.0</td>
      <td>165.0</td>
      <td>121.0</td>
      <td>99.0</td>
      <td>...</td>
      <td>154.0</td>
      <td>143.0</td>
      <td>154.0</td>
      <td>NaN</td>
      <td>55.0</td>
      <td>132.0</td>
      <td>44.0</td>
      <td>165.0</td>
      <td>121.0</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>9976</th>
      <td>154.0</td>
      <td>165.0</td>
      <td>11.0</td>
      <td>Blabla</td>
      <td>66.0</td>
      <td>143.0</td>
      <td>55.0</td>
      <td>NaN</td>
      <td>132.0</td>
      <td>110.0</td>
      <td>...</td>
      <td>165.0</td>
      <td>154.0</td>
      <td>165.0</td>
      <td>11.0</td>
      <td>66.0</td>
      <td>143.0</td>
      <td>55.0</td>
      <td>NaN</td>
      <td>132.0</td>
      <td>110.0</td>
    </tr>
    <tr>
      <th>9977</th>
      <td>165.0</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>Blabla</td>
      <td>77.0</td>
      <td>154.0</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>143.0</td>
      <td>121.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>165.0</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>77.0</td>
      <td>154.0</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>143.0</td>
      <td>121.0</td>
    </tr>
    <tr>
      <th>9978</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>Blabla</td>
      <td>88.0</td>
      <td>165.0</td>
      <td>77.0</td>
      <td>11.0</td>
      <td>154.0</td>
      <td>132.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>88.0</td>
      <td>165.0</td>
      <td>77.0</td>
      <td>11.0</td>
      <td>154.0</td>
      <td>132.0</td>
    </tr>
    <tr>
      <th>9979</th>
      <td>NaN</td>
      <td>11.0</td>
      <td>44.0</td>
      <td>Blabla</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>22.0</td>
      <td>165.0</td>
      <td>143.0</td>
      <td>...</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>44.0</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>22.0</td>
      <td>165.0</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>9980</th>
      <td>11.0</td>
      <td>22.0</td>
      <td>55.0</td>
      <td>Blabla</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>99.0</td>
      <td>33.0</td>
      <td>NaN</td>
      <td>154.0</td>
      <td>...</td>
      <td>22.0</td>
      <td>11.0</td>
      <td>22.0</td>
      <td>55.0</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>99.0</td>
      <td>33.0</td>
      <td>NaN</td>
      <td>154.0</td>
    </tr>
    <tr>
      <th>9981</th>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>Blabla</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
      <td>...</td>
      <td>33.0</td>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>9982</th>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>Blabla</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>44.0</td>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9983</th>
      <td>44.0</td>
      <td>55.0</td>
      <td>88.0</td>
      <td>Blabla</td>
      <td>143.0</td>
      <td>33.0</td>
      <td>132.0</td>
      <td>66.0</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>55.0</td>
      <td>44.0</td>
      <td>55.0</td>
      <td>88.0</td>
      <td>143.0</td>
      <td>33.0</td>
      <td>132.0</td>
      <td>66.0</td>
      <td>22.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9984</th>
      <td>55.0</td>
      <td>66.0</td>
      <td>99.0</td>
      <td>Blabla</td>
      <td>154.0</td>
      <td>44.0</td>
      <td>143.0</td>
      <td>77.0</td>
      <td>33.0</td>
      <td>11.0</td>
      <td>...</td>
      <td>66.0</td>
      <td>55.0</td>
      <td>66.0</td>
      <td>99.0</td>
      <td>154.0</td>
      <td>44.0</td>
      <td>143.0</td>
      <td>77.0</td>
      <td>33.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>9985</th>
      <td>66.0</td>
      <td>77.0</td>
      <td>110.0</td>
      <td>Blabla</td>
      <td>165.0</td>
      <td>55.0</td>
      <td>154.0</td>
      <td>88.0</td>
      <td>44.0</td>
      <td>22.0</td>
      <td>...</td>
      <td>77.0</td>
      <td>66.0</td>
      <td>77.0</td>
      <td>110.0</td>
      <td>165.0</td>
      <td>55.0</td>
      <td>154.0</td>
      <td>88.0</td>
      <td>44.0</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>9986</th>
      <td>77.0</td>
      <td>88.0</td>
      <td>121.0</td>
      <td>Blabla</td>
      <td>NaN</td>
      <td>66.0</td>
      <td>165.0</td>
      <td>99.0</td>
      <td>55.0</td>
      <td>33.0</td>
      <td>...</td>
      <td>88.0</td>
      <td>77.0</td>
      <td>88.0</td>
      <td>121.0</td>
      <td>NaN</td>
      <td>66.0</td>
      <td>165.0</td>
      <td>99.0</td>
      <td>55.0</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>9987</th>
      <td>88.0</td>
      <td>99.0</td>
      <td>132.0</td>
      <td>Blabla</td>
      <td>NaN</td>
      <td>77.0</td>
      <td>NaN</td>
      <td>110.0</td>
      <td>66.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>99.0</td>
      <td>88.0</td>
      <td>99.0</td>
      <td>132.0</td>
      <td>NaN</td>
      <td>77.0</td>
      <td>NaN</td>
      <td>110.0</td>
      <td>66.0</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>9988</th>
      <td>99.0</td>
      <td>110.0</td>
      <td>143.0</td>
      <td>Blabla</td>
      <td>11.0</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>121.0</td>
      <td>77.0</td>
      <td>55.0</td>
      <td>...</td>
      <td>110.0</td>
      <td>99.0</td>
      <td>110.0</td>
      <td>143.0</td>
      <td>11.0</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>121.0</td>
      <td>77.0</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>9989</th>
      <td>110.0</td>
      <td>121.0</td>
      <td>154.0</td>
      <td>Blabla</td>
      <td>22.0</td>
      <td>99.0</td>
      <td>11.0</td>
      <td>132.0</td>
      <td>88.0</td>
      <td>66.0</td>
      <td>...</td>
      <td>121.0</td>
      <td>110.0</td>
      <td>121.0</td>
      <td>154.0</td>
      <td>22.0</td>
      <td>99.0</td>
      <td>11.0</td>
      <td>132.0</td>
      <td>88.0</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>9990</th>
      <td>121.0</td>
      <td>132.0</td>
      <td>165.0</td>
      <td>Blabla</td>
      <td>33.0</td>
      <td>110.0</td>
      <td>22.0</td>
      <td>143.0</td>
      <td>99.0</td>
      <td>77.0</td>
      <td>...</td>
      <td>132.0</td>
      <td>121.0</td>
      <td>132.0</td>
      <td>165.0</td>
      <td>33.0</td>
      <td>110.0</td>
      <td>22.0</td>
      <td>143.0</td>
      <td>99.0</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>9991</th>
      <td>132.0</td>
      <td>143.0</td>
      <td>NaN</td>
      <td>Blabla</td>
      <td>44.0</td>
      <td>121.0</td>
      <td>33.0</td>
      <td>154.0</td>
      <td>110.0</td>
      <td>88.0</td>
      <td>...</td>
      <td>143.0</td>
      <td>132.0</td>
      <td>143.0</td>
      <td>NaN</td>
      <td>44.0</td>
      <td>121.0</td>
      <td>33.0</td>
      <td>154.0</td>
      <td>110.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>9992</th>
      <td>143.0</td>
      <td>154.0</td>
      <td>NaN</td>
      <td>Blabla</td>
      <td>55.0</td>
      <td>132.0</td>
      <td>44.0</td>
      <td>165.0</td>
      <td>121.0</td>
      <td>99.0</td>
      <td>...</td>
      <td>154.0</td>
      <td>143.0</td>
      <td>154.0</td>
      <td>NaN</td>
      <td>55.0</td>
      <td>132.0</td>
      <td>44.0</td>
      <td>165.0</td>
      <td>121.0</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>9993</th>
      <td>154.0</td>
      <td>165.0</td>
      <td>11.0</td>
      <td>Blabla</td>
      <td>66.0</td>
      <td>143.0</td>
      <td>55.0</td>
      <td>NaN</td>
      <td>132.0</td>
      <td>110.0</td>
      <td>...</td>
      <td>165.0</td>
      <td>154.0</td>
      <td>165.0</td>
      <td>11.0</td>
      <td>66.0</td>
      <td>143.0</td>
      <td>55.0</td>
      <td>NaN</td>
      <td>132.0</td>
      <td>110.0</td>
    </tr>
    <tr>
      <th>9994</th>
      <td>165.0</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>Blabla</td>
      <td>77.0</td>
      <td>154.0</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>143.0</td>
      <td>121.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>165.0</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>77.0</td>
      <td>154.0</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>143.0</td>
      <td>121.0</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>Blabla</td>
      <td>88.0</td>
      <td>165.0</td>
      <td>77.0</td>
      <td>11.0</td>
      <td>154.0</td>
      <td>132.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>88.0</td>
      <td>165.0</td>
      <td>77.0</td>
      <td>11.0</td>
      <td>154.0</td>
      <td>132.0</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>NaN</td>
      <td>11.0</td>
      <td>44.0</td>
      <td>Blabla</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>22.0</td>
      <td>165.0</td>
      <td>143.0</td>
      <td>...</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>44.0</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>22.0</td>
      <td>165.0</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>11.0</td>
      <td>22.0</td>
      <td>55.0</td>
      <td>Blabla</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>99.0</td>
      <td>33.0</td>
      <td>NaN</td>
      <td>154.0</td>
      <td>...</td>
      <td>22.0</td>
      <td>11.0</td>
      <td>22.0</td>
      <td>55.0</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>99.0</td>
      <td>33.0</td>
      <td>NaN</td>
      <td>154.0</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>Blabla</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
      <td>...</td>
      <td>33.0</td>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>Blabla</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>44.0</td>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 27 columns</p>
</div>
</div>
</div>
<p>The <code>head()</code> method returns the top 5 rows:</p>
<div class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>large_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>some_text</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>...</th>
      <th>Q</th>
      <th>R</th>
      <th>S</th>
      <th>T</th>
      <th>U</th>
      <th>V</th>
      <th>W</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>11.0</td>
      <td>44.0</td>
      <td>Blabla</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>22.0</td>
      <td>165.0</td>
      <td>143.0</td>
      <td>...</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>44.0</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>88.0</td>
      <td>22.0</td>
      <td>165.0</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.0</td>
      <td>22.0</td>
      <td>55.0</td>
      <td>Blabla</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>99.0</td>
      <td>33.0</td>
      <td>NaN</td>
      <td>154.0</td>
      <td>...</td>
      <td>22.0</td>
      <td>11.0</td>
      <td>22.0</td>
      <td>55.0</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>99.0</td>
      <td>33.0</td>
      <td>NaN</td>
      <td>154.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>Blabla</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
      <td>...</td>
      <td>33.0</td>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>Blabla</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>44.0</td>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>44.0</td>
      <td>55.0</td>
      <td>88.0</td>
      <td>Blabla</td>
      <td>143.0</td>
      <td>33.0</td>
      <td>132.0</td>
      <td>66.0</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>55.0</td>
      <td>44.0</td>
      <td>55.0</td>
      <td>88.0</td>
      <td>143.0</td>
      <td>33.0</td>
      <td>132.0</td>
      <td>66.0</td>
      <td>22.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div>
</div>
</div>
<p>Of course there’s also a <code>tail()</code> function to view the bottom 5 rows. You can pass the number of rows you want:</p>
<div class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>large_df.tail(n<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>some_text</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>...</th>
      <th>Q</th>
      <th>R</th>
      <th>S</th>
      <th>T</th>
      <th>U</th>
      <th>V</th>
      <th>W</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9998</th>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>Blabla</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
      <td>...</td>
      <td>33.0</td>
      <td>22.0</td>
      <td>33.0</td>
      <td>66.0</td>
      <td>121.0</td>
      <td>11.0</td>
      <td>110.0</td>
      <td>44.0</td>
      <td>NaN</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>Blabla</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>44.0</td>
      <td>33.0</td>
      <td>44.0</td>
      <td>77.0</td>
      <td>132.0</td>
      <td>22.0</td>
      <td>121.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 27 columns</p>
</div>
</div>
</div>
<p>The <code>info()</code> method prints out a summary of each columns contents:</p>
<div class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>large_df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 10000 entries, 0 to 9999
Data columns (total 27 columns):
A            8823 non-null float64
B            8824 non-null float64
C            8824 non-null float64
some_text    10000 non-null object
D            8824 non-null float64
E            8822 non-null float64
F            8824 non-null float64
G            8824 non-null float64
H            8822 non-null float64
I            8823 non-null float64
J            8823 non-null float64
K            8822 non-null float64
L            8824 non-null float64
M            8824 non-null float64
N            8822 non-null float64
O            8824 non-null float64
P            8824 non-null float64
Q            8824 non-null float64
R            8823 non-null float64
S            8824 non-null float64
T            8824 non-null float64
U            8824 non-null float64
V            8822 non-null float64
W            8824 non-null float64
X            8824 non-null float64
Y            8822 non-null float64
Z            8823 non-null float64
dtypes: float64(26), object(1)
memory usage: 2.1+ MB</code></pre>
</div>
</div>
<p>Finally, the <code>describe()</code> method gives a nice overview of the main aggregated values over each column: * <code>count</code>: number of non-null (not NaN) values * <code>mean</code>: mean of non-null values * <code>std</code>: <a href="https://en.wikipedia.org/wiki/Standard_deviation">standard deviation</a> of non-null values * <code>min</code>: minimum of non-null values * <code>25%</code>, <code>50%</code>, <code>75%</code>: 25th, 50th and 75th <a href="https://en.wikipedia.org/wiki/Percentile">percentile</a> of non-null values * <code>max</code>: maximum of non-null values</p>
<div class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>large_df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
      <th>...</th>
      <th>Q</th>
      <th>R</th>
      <th>S</th>
      <th>T</th>
      <th>U</th>
      <th>V</th>
      <th>W</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8823.000000</td>
      <td>8824.000000</td>
      <td>8824.000000</td>
      <td>8824.000000</td>
      <td>8822.000000</td>
      <td>8824.000000</td>
      <td>8824.000000</td>
      <td>8822.000000</td>
      <td>8823.000000</td>
      <td>8823.000000</td>
      <td>...</td>
      <td>8824.000000</td>
      <td>8823.000000</td>
      <td>8824.000000</td>
      <td>8824.000000</td>
      <td>8824.000000</td>
      <td>8822.000000</td>
      <td>8824.000000</td>
      <td>8824.000000</td>
      <td>8822.000000</td>
      <td>8823.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>87.977559</td>
      <td>87.972575</td>
      <td>87.987534</td>
      <td>88.012466</td>
      <td>87.983791</td>
      <td>88.007480</td>
      <td>87.977561</td>
      <td>88.000000</td>
      <td>88.022441</td>
      <td>88.022441</td>
      <td>...</td>
      <td>87.972575</td>
      <td>87.977559</td>
      <td>87.972575</td>
      <td>87.987534</td>
      <td>88.012466</td>
      <td>87.983791</td>
      <td>88.007480</td>
      <td>87.977561</td>
      <td>88.000000</td>
      <td>88.022441</td>
    </tr>
    <tr>
      <th>std</th>
      <td>47.535911</td>
      <td>47.535523</td>
      <td>47.521679</td>
      <td>47.521679</td>
      <td>47.535001</td>
      <td>47.519371</td>
      <td>47.529755</td>
      <td>47.536879</td>
      <td>47.535911</td>
      <td>47.535911</td>
      <td>...</td>
      <td>47.535523</td>
      <td>47.535911</td>
      <td>47.535523</td>
      <td>47.521679</td>
      <td>47.521679</td>
      <td>47.535001</td>
      <td>47.519371</td>
      <td>47.529755</td>
      <td>47.536879</td>
      <td>47.535911</td>
    </tr>
    <tr>
      <th>min</th>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>...</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
      <td>11.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>...</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
      <td>44.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>...</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
      <td>88.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>...</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
      <td>132.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>...</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
      <td>165.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 26 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="saving-loading" class="level1">
<h1>Saving &amp; loading</h1>
<p>Pandas can save <code>DataFrame</code>s to various backends, including file formats such as CSV, Excel, JSON, HTML and HDF5, or to a SQL database. Let’s create a <code>DataFrame</code> to demonstrate this:</p>
<div class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>my_df <span class="op">=</span> pd.DataFrame(</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">"Biking"</span>, <span class="fl">68.5</span>, <span class="dv">1985</span>, np.nan], [<span class="st">"Dancing"</span>, <span class="fl">83.1</span>, <span class="dv">1984</span>, <span class="dv">3</span>]], </span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">"hobby"</span>,<span class="st">"weight"</span>,<span class="st">"birthyear"</span>,<span class="st">"children"</span>],</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>]</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>my_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="129">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>weight</th>
      <th>birthyear</th>
      <th>children</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>68.5</td>
      <td>1985</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>83.1</td>
      <td>1984</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="saving" class="level2">
<h2 class="anchored" data-anchor-id="saving">Saving</h2>
<p>Let’s save it to CSV, HTML and JSON:</p>
<div class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>my_df.to_csv(<span class="st">"my_df.csv"</span>)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>my_df.to_html(<span class="st">"my_df.html"</span>)</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>my_df.to_json(<span class="st">"my_df.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Done! Let’s take a peek at what was saved:</p>
<div class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> filename <span class="kw">in</span> (<span class="st">"my_df.csv"</span>, <span class="st">"my_df.html"</span>, <span class="st">"my_df.json"</span>):</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"#"</span>, filename)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">"rt"</span>) <span class="im">as</span> f:</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(f.read())</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># my_df.csv
,hobby,weight,birthyear,children
alice,Biking,68.5,1985,
bob,Dancing,83.1,1984,3.0


# my_df.html
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;hobby&lt;/th&gt;
      &lt;th&gt;weight&lt;/th&gt;
      &lt;th&gt;birthyear&lt;/th&gt;
      &lt;th&gt;children&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;alice&lt;/th&gt;
      &lt;td&gt;Biking&lt;/td&gt;
      &lt;td&gt;68.5&lt;/td&gt;
      &lt;td&gt;1985&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;bob&lt;/th&gt;
      &lt;td&gt;Dancing&lt;/td&gt;
      &lt;td&gt;83.1&lt;/td&gt;
      &lt;td&gt;1984&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

# my_df.json
{"hobby":{"alice":"Biking","bob":"Dancing"},"weight":{"alice":68.5,"bob":83.1},"birthyear":{"alice":1985,"bob":1984},"children":{"alice":null,"bob":3.0}}
</code></pre>
</div>
</div>
<p>Note that the index is saved as the first column (with no name) in a CSV file, as <code>&lt;th&gt;</code> tags in HTML and as keys in JSON.</p>
<p>Saving to other formats works very similarly, but some formats require extra libraries to be installed. For example, saving to Excel requires the openpyxl library:</p>
<div class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>    my_df.to_excel(<span class="st">"my_df.xlsx"</span>, sheet_name<span class="op">=</span><span class="st">'People'</span>)</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ImportError</span> <span class="im">as</span> e:</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>No module named 'openpyxl'</code></pre>
</div>
</div>
</section>
<section id="loading" class="level2">
<h2 class="anchored" data-anchor-id="loading">Loading</h2>
<p>Now let’s load our CSV file back into a <code>DataFrame</code>:</p>
<div class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>my_df_loaded <span class="op">=</span> pd.read_csv(<span class="st">"my_df.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>my_df_loaded</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="133">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>hobby</th>
      <th>weight</th>
      <th>birthyear</th>
      <th>children</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alice</th>
      <td>Biking</td>
      <td>68.5</td>
      <td>1985</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>bob</th>
      <td>Dancing</td>
      <td>83.1</td>
      <td>1984</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>As you might guess, there are similar <code>read_json</code>, <code>read_html</code>, <code>read_excel</code> functions as well. We can also read data straight from the Internet. For example, let’s load the top 1,000 U.S. cities from github:</p>
<div class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>us_cities <span class="op">=</span> <span class="va">None</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>    csv_url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/plotly/datasets/master/us-cities-top-1k.csv"</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>    us_cities <span class="op">=</span> pd.read_csv(csv_url, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>    us_cities <span class="op">=</span> us_cities.head()</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">IOError</span> <span class="im">as</span> e:</span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>us_cities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State</th>
      <th>Population</th>
      <th>lat</th>
      <th>lon</th>
    </tr>
    <tr>
      <th>City</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Marysville</th>
      <td>Washington</td>
      <td>63269</td>
      <td>48.051764</td>
      <td>-122.177082</td>
    </tr>
    <tr>
      <th>Perris</th>
      <td>California</td>
      <td>72326</td>
      <td>33.782519</td>
      <td>-117.228648</td>
    </tr>
    <tr>
      <th>Cleveland</th>
      <td>Ohio</td>
      <td>390113</td>
      <td>41.499320</td>
      <td>-81.694361</td>
    </tr>
    <tr>
      <th>Worcester</th>
      <td>Massachusetts</td>
      <td>182544</td>
      <td>42.262593</td>
      <td>-71.802293</td>
    </tr>
    <tr>
      <th>Columbia</th>
      <td>South Carolina</td>
      <td>133358</td>
      <td>34.000710</td>
      <td>-81.034814</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>There are more options available, in particular regarding datetime format. Check out the <a href="http://pandas.pydata.org/pandas-docs/stable/io.html">documentation</a> for more details.</p>
</section>
</section>
<section id="combining-dataframes" class="level1">
<h1>Combining <code>DataFrame</code>s</h1>
<section id="sql-like-joins" class="level2">
<h2 class="anchored" data-anchor-id="sql-like-joins">SQL-like joins</h2>
<p>One powerful feature of pandas is it’s ability to perform SQL-like joins on <code>DataFrame</code>s. Various types of joins are supported: inner joins, left/right outer joins and full joins. To illustrate this, let’s start by creating a couple simple <code>DataFrame</code>s:</p>
<div class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>city_loc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"CA"</span>, <span class="st">"San Francisco"</span>, <span class="fl">37.781334</span>, <span class="op">-</span><span class="fl">122.416728</span>],</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"NY"</span>, <span class="st">"New York"</span>, <span class="fl">40.705649</span>, <span class="op">-</span><span class="fl">74.008344</span>],</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"FL"</span>, <span class="st">"Miami"</span>, <span class="fl">25.791100</span>, <span class="op">-</span><span class="fl">80.320733</span>],</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"OH"</span>, <span class="st">"Cleveland"</span>, <span class="fl">41.473508</span>, <span class="op">-</span><span class="fl">81.739791</span>],</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"UT"</span>, <span class="st">"Salt Lake City"</span>, <span class="fl">40.755851</span>, <span class="op">-</span><span class="fl">111.896657</span>]</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>    ], columns<span class="op">=</span>[<span class="st">"state"</span>, <span class="st">"city"</span>, <span class="st">"lat"</span>, <span class="st">"lng"</span>])</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>city_loc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>state</th>
      <th>city</th>
      <th>lat</th>
      <th>lng</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA</td>
      <td>San Francisco</td>
      <td>37.781334</td>
      <td>-122.416728</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NY</td>
      <td>New York</td>
      <td>40.705649</td>
      <td>-74.008344</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL</td>
      <td>Miami</td>
      <td>25.791100</td>
      <td>-80.320733</td>
    </tr>
    <tr>
      <th>3</th>
      <td>OH</td>
      <td>Cleveland</td>
      <td>41.473508</td>
      <td>-81.739791</td>
    </tr>
    <tr>
      <th>4</th>
      <td>UT</td>
      <td>Salt Lake City</td>
      <td>40.755851</td>
      <td>-111.896657</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>city_pop <span class="op">=</span> pd.DataFrame(</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">808976</span>, <span class="st">"San Francisco"</span>, <span class="st">"California"</span>],</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">8363710</span>, <span class="st">"New York"</span>, <span class="st">"New-York"</span>],</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">413201</span>, <span class="st">"Miami"</span>, <span class="st">"Florida"</span>],</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">2242193</span>, <span class="st">"Houston"</span>, <span class="st">"Texas"</span>]</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>    ], index<span class="op">=</span>[<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>], columns<span class="op">=</span>[<span class="st">"population"</span>, <span class="st">"city"</span>, <span class="st">"state"</span>])</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>city_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="136">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>population</th>
      <th>city</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>808976</td>
      <td>San Francisco</td>
      <td>California</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8363710</td>
      <td>New York</td>
      <td>New-York</td>
    </tr>
    <tr>
      <th>5</th>
      <td>413201</td>
      <td>Miami</td>
      <td>Florida</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2242193</td>
      <td>Houston</td>
      <td>Texas</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now let’s join these <code>DataFrame</code>s using the <code>merge()</code> function:</p>
<div class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>pd.merge(left<span class="op">=</span>city_loc, right<span class="op">=</span>city_pop, on<span class="op">=</span><span class="st">"city"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>state_x</th>
      <th>city</th>
      <th>lat</th>
      <th>lng</th>
      <th>population</th>
      <th>state_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA</td>
      <td>San Francisco</td>
      <td>37.781334</td>
      <td>-122.416728</td>
      <td>808976</td>
      <td>California</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NY</td>
      <td>New York</td>
      <td>40.705649</td>
      <td>-74.008344</td>
      <td>8363710</td>
      <td>New-York</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL</td>
      <td>Miami</td>
      <td>25.791100</td>
      <td>-80.320733</td>
      <td>413201</td>
      <td>Florida</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Note that both <code>DataFrame</code>s have a column named <code>state</code>, so in the result they got renamed to <code>state_x</code> and <code>state_y</code>.</p>
<p>Also, note that Cleveland, Salt Lake City and Houston were dropped because they don’t exist in <em>both</em> <code>DataFrame</code>s. This is the equivalent of a SQL <code>INNER JOIN</code>. If you want a <code>FULL OUTER JOIN</code>, where no city gets dropped and <code>NaN</code> values are added, you must specify <code>how="outer"</code>:</p>
<div class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>all_cities <span class="op">=</span> pd.merge(left<span class="op">=</span>city_loc, right<span class="op">=</span>city_pop, on<span class="op">=</span><span class="st">"city"</span>, how<span class="op">=</span><span class="st">"outer"</span>)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>all_cities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>state_x</th>
      <th>city</th>
      <th>lat</th>
      <th>lng</th>
      <th>population</th>
      <th>state_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA</td>
      <td>San Francisco</td>
      <td>37.781334</td>
      <td>-122.416728</td>
      <td>808976.0</td>
      <td>California</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NY</td>
      <td>New York</td>
      <td>40.705649</td>
      <td>-74.008344</td>
      <td>8363710.0</td>
      <td>New-York</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL</td>
      <td>Miami</td>
      <td>25.791100</td>
      <td>-80.320733</td>
      <td>413201.0</td>
      <td>Florida</td>
    </tr>
    <tr>
      <th>3</th>
      <td>OH</td>
      <td>Cleveland</td>
      <td>41.473508</td>
      <td>-81.739791</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>UT</td>
      <td>Salt Lake City</td>
      <td>40.755851</td>
      <td>-111.896657</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>Houston</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2242193.0</td>
      <td>Texas</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Of course <code>LEFT OUTER JOIN</code> is also available by setting <code>how="left"</code>: only the cities present in the left <code>DataFrame</code> end up in the result. Similarly, with <code>how="right"</code> only cities in the right <code>DataFrame</code> appear in the result. For example:</p>
<div class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>pd.merge(left<span class="op">=</span>city_loc, right<span class="op">=</span>city_pop, on<span class="op">=</span><span class="st">"city"</span>, how<span class="op">=</span><span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="139">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>state_x</th>
      <th>city</th>
      <th>lat</th>
      <th>lng</th>
      <th>population</th>
      <th>state_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA</td>
      <td>San Francisco</td>
      <td>37.781334</td>
      <td>-122.416728</td>
      <td>808976</td>
      <td>California</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NY</td>
      <td>New York</td>
      <td>40.705649</td>
      <td>-74.008344</td>
      <td>8363710</td>
      <td>New-York</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL</td>
      <td>Miami</td>
      <td>25.791100</td>
      <td>-80.320733</td>
      <td>413201</td>
      <td>Florida</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>Houston</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2242193</td>
      <td>Texas</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>If the key to join on is actually in one (or both) <code>DataFrame</code>’s index, you must use <code>left_index=True</code> and/or <code>right_index=True</code>. If the key column names differ, you must use <code>left_on</code> and <code>right_on</code>. For example:</p>
<div class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>city_pop2 <span class="op">=</span> city_pop.copy()</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>city_pop2.columns <span class="op">=</span> [<span class="st">"population"</span>, <span class="st">"name"</span>, <span class="st">"state"</span>]</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>pd.merge(left<span class="op">=</span>city_loc, right<span class="op">=</span>city_pop2, left_on<span class="op">=</span><span class="st">"city"</span>, right_on<span class="op">=</span><span class="st">"name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>state_x</th>
      <th>city</th>
      <th>lat</th>
      <th>lng</th>
      <th>population</th>
      <th>name</th>
      <th>state_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA</td>
      <td>San Francisco</td>
      <td>37.781334</td>
      <td>-122.416728</td>
      <td>808976</td>
      <td>San Francisco</td>
      <td>California</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NY</td>
      <td>New York</td>
      <td>40.705649</td>
      <td>-74.008344</td>
      <td>8363710</td>
      <td>New York</td>
      <td>New-York</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL</td>
      <td>Miami</td>
      <td>25.791100</td>
      <td>-80.320733</td>
      <td>413201</td>
      <td>Miami</td>
      <td>Florida</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="concatenation" class="level2">
<h2 class="anchored" data-anchor-id="concatenation">Concatenation</h2>
<p>Rather than joining <code>DataFrame</code>s, we may just want to concatenate them. That’s what <code>concat()</code> is for:</p>
<div class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>result_concat <span class="op">=</span> pd.concat([city_loc, city_pop])</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>result_concat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city</th>
      <th>lat</th>
      <th>lng</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>San Francisco</td>
      <td>37.781334</td>
      <td>-122.416728</td>
      <td>NaN</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>40.705649</td>
      <td>-74.008344</td>
      <td>NaN</td>
      <td>NY</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Miami</td>
      <td>25.791100</td>
      <td>-80.320733</td>
      <td>NaN</td>
      <td>FL</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cleveland</td>
      <td>41.473508</td>
      <td>-81.739791</td>
      <td>NaN</td>
      <td>OH</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Salt Lake City</td>
      <td>40.755851</td>
      <td>-111.896657</td>
      <td>NaN</td>
      <td>UT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>San Francisco</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>808976.0</td>
      <td>California</td>
    </tr>
    <tr>
      <th>4</th>
      <td>New York</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8363710.0</td>
      <td>New-York</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Miami</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>413201.0</td>
      <td>Florida</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Houston</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2242193.0</td>
      <td>Texas</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Note that this operation aligned the data horizontally (by columns) but not vertically (by rows). In this example, we end up with multiple rows having the same index (eg. 3). Pandas handles this rather gracefully:</p>
<div class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>result_concat.loc[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city</th>
      <th>lat</th>
      <th>lng</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Cleveland</td>
      <td>41.473508</td>
      <td>-81.739791</td>
      <td>NaN</td>
      <td>OH</td>
    </tr>
    <tr>
      <th>3</th>
      <td>San Francisco</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>808976.0</td>
      <td>California</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Or you can tell pandas to just ignore the index:</p>
<div class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>pd.concat([city_loc, city_pop], ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city</th>
      <th>lat</th>
      <th>lng</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>San Francisco</td>
      <td>37.781334</td>
      <td>-122.416728</td>
      <td>NaN</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>40.705649</td>
      <td>-74.008344</td>
      <td>NaN</td>
      <td>NY</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Miami</td>
      <td>25.791100</td>
      <td>-80.320733</td>
      <td>NaN</td>
      <td>FL</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cleveland</td>
      <td>41.473508</td>
      <td>-81.739791</td>
      <td>NaN</td>
      <td>OH</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Salt Lake City</td>
      <td>40.755851</td>
      <td>-111.896657</td>
      <td>NaN</td>
      <td>UT</td>
    </tr>
    <tr>
      <th>5</th>
      <td>San Francisco</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>808976.0</td>
      <td>California</td>
    </tr>
    <tr>
      <th>6</th>
      <td>New York</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8363710.0</td>
      <td>New-York</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Miami</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>413201.0</td>
      <td>Florida</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Houston</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2242193.0</td>
      <td>Texas</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Notice that when a column does not exist in a <code>DataFrame</code>, it acts as if it was filled with <code>NaN</code> values. If we set <code>join="inner"</code>, then only columns that exist in <em>both</em> <code>DataFrame</code>s are returned:</p>
<div class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>pd.concat([city_loc, city_pop], join<span class="op">=</span><span class="st">"inner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>state</th>
      <th>city</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA</td>
      <td>San Francisco</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NY</td>
      <td>New York</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL</td>
      <td>Miami</td>
    </tr>
    <tr>
      <th>3</th>
      <td>OH</td>
      <td>Cleveland</td>
    </tr>
    <tr>
      <th>4</th>
      <td>UT</td>
      <td>Salt Lake City</td>
    </tr>
    <tr>
      <th>3</th>
      <td>California</td>
      <td>San Francisco</td>
    </tr>
    <tr>
      <th>4</th>
      <td>New-York</td>
      <td>New York</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Florida</td>
      <td>Miami</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Texas</td>
      <td>Houston</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>You can concatenate <code>DataFrame</code>s horizontally instead of vertically by setting <code>axis=1</code>:</p>
<div class="cell" data-scrolled="true" data-execution_count="145">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>pd.concat([city_loc, city_pop], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="145">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>state</th>
      <th>city</th>
      <th>lat</th>
      <th>lng</th>
      <th>population</th>
      <th>city</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA</td>
      <td>San Francisco</td>
      <td>37.781334</td>
      <td>-122.416728</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NY</td>
      <td>New York</td>
      <td>40.705649</td>
      <td>-74.008344</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL</td>
      <td>Miami</td>
      <td>25.791100</td>
      <td>-80.320733</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>OH</td>
      <td>Cleveland</td>
      <td>41.473508</td>
      <td>-81.739791</td>
      <td>808976.0</td>
      <td>San Francisco</td>
      <td>California</td>
    </tr>
    <tr>
      <th>4</th>
      <td>UT</td>
      <td>Salt Lake City</td>
      <td>40.755851</td>
      <td>-111.896657</td>
      <td>8363710.0</td>
      <td>New York</td>
      <td>New-York</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>413201.0</td>
      <td>Miami</td>
      <td>Florida</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2242193.0</td>
      <td>Houston</td>
      <td>Texas</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>In this case it really does not make much sense because the indices do not align well (eg. Cleveland and San Francisco end up on the same row, because they shared the index label <code>3</code>). So let’s reindex the <code>DataFrame</code>s by city name before concatenating:</p>
<div class="cell" data-scrolled="true" data-execution_count="146">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>pd.concat([city_loc.set_index(<span class="st">"city"</span>), city_pop.set_index(<span class="st">"city"</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="146">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>state</th>
      <th>lat</th>
      <th>lng</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Cleveland</th>
      <td>OH</td>
      <td>41.473508</td>
      <td>-81.739791</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Houston</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2242193.0</td>
      <td>Texas</td>
    </tr>
    <tr>
      <th>Miami</th>
      <td>FL</td>
      <td>25.791100</td>
      <td>-80.320733</td>
      <td>413201.0</td>
      <td>Florida</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>NY</td>
      <td>40.705649</td>
      <td>-74.008344</td>
      <td>8363710.0</td>
      <td>New-York</td>
    </tr>
    <tr>
      <th>Salt Lake City</th>
      <td>UT</td>
      <td>40.755851</td>
      <td>-111.896657</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>San Francisco</th>
      <td>CA</td>
      <td>37.781334</td>
      <td>-122.416728</td>
      <td>808976.0</td>
      <td>California</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>This looks a lot like a <code>FULL OUTER JOIN</code>, except that the <code>state</code> columns were not renamed to <code>state_x</code> and <code>state_y</code>, and the <code>city</code> column is now the index.</p>
<p>The <code>append()</code> method is a useful shorthand for concatenating <code>DataFrame</code>s vertically:</p>
<div class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>city_loc.append(city_pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city</th>
      <th>lat</th>
      <th>lng</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>San Francisco</td>
      <td>37.781334</td>
      <td>-122.416728</td>
      <td>NaN</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>40.705649</td>
      <td>-74.008344</td>
      <td>NaN</td>
      <td>NY</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Miami</td>
      <td>25.791100</td>
      <td>-80.320733</td>
      <td>NaN</td>
      <td>FL</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cleveland</td>
      <td>41.473508</td>
      <td>-81.739791</td>
      <td>NaN</td>
      <td>OH</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Salt Lake City</td>
      <td>40.755851</td>
      <td>-111.896657</td>
      <td>NaN</td>
      <td>UT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>San Francisco</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>808976.0</td>
      <td>California</td>
    </tr>
    <tr>
      <th>4</th>
      <td>New York</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8363710.0</td>
      <td>New-York</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Miami</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>413201.0</td>
      <td>Florida</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Houston</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2242193.0</td>
      <td>Texas</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>As always in pandas, the <code>append()</code> method does <em>not</em> actually modify <code>city_loc</code>: it works on a copy and returns the modified copy.</p>
</section>
</section>
<section id="categories" class="level1">
<h1>Categories</h1>
<p>It is quite frequent to have values that represent categories, for example <code>1</code> for female and <code>2</code> for male, or <code>"A"</code> for Good, <code>"B"</code> for Average, <code>"C"</code> for Bad. These categorical values can be hard to read and cumbersome to handle, but fortunately pandas makes it easy. To illustrate this, let’s take the <code>city_pop</code> <code>DataFrame</code> we created earlier, and add a column that represents a category:</p>
<div class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>city_eco <span class="op">=</span> city_pop.copy()</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>city_eco[<span class="st">"eco_code"</span>] <span class="op">=</span> [<span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">34</span>, <span class="dv">20</span>]</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>city_eco</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="148">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>population</th>
      <th>city</th>
      <th>state</th>
      <th>eco_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>808976</td>
      <td>San Francisco</td>
      <td>California</td>
      <td>17</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8363710</td>
      <td>New York</td>
      <td>New-York</td>
      <td>17</td>
    </tr>
    <tr>
      <th>5</th>
      <td>413201</td>
      <td>Miami</td>
      <td>Florida</td>
      <td>34</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2242193</td>
      <td>Houston</td>
      <td>Texas</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Right now the <code>eco_code</code> column is full of apparently meaningless codes. Let’s fix that. First, we will create a new categorical column based on the <code>eco_code</code>s:</p>
<div class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>city_eco[<span class="st">"economy"</span>] <span class="op">=</span> city_eco[<span class="st">"eco_code"</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>city_eco[<span class="st">"economy"</span>].cat.categories</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">
<pre><code>Int64Index([17, 20, 34], dtype='int64')</code></pre>
</div>
</div>
<p>Now we can give each category a meaningful name:</p>
<div class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>city_eco[<span class="st">"economy"</span>].cat.categories <span class="op">=</span> [<span class="st">"Finance"</span>, <span class="st">"Energy"</span>, <span class="st">"Tourism"</span>]</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>city_eco</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>population</th>
      <th>city</th>
      <th>state</th>
      <th>eco_code</th>
      <th>economy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>808976</td>
      <td>San Francisco</td>
      <td>California</td>
      <td>17</td>
      <td>Finance</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8363710</td>
      <td>New York</td>
      <td>New-York</td>
      <td>17</td>
      <td>Finance</td>
    </tr>
    <tr>
      <th>5</th>
      <td>413201</td>
      <td>Miami</td>
      <td>Florida</td>
      <td>34</td>
      <td>Tourism</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2242193</td>
      <td>Houston</td>
      <td>Texas</td>
      <td>20</td>
      <td>Energy</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Note that categorical values are sorted according to their categorical order, <em>not</em> their alphabetical order:</p>
<div class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>city_eco.sort_values(by<span class="op">=</span><span class="st">"economy"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="151">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>population</th>
      <th>city</th>
      <th>state</th>
      <th>eco_code</th>
      <th>economy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>413201</td>
      <td>Miami</td>
      <td>Florida</td>
      <td>34</td>
      <td>Tourism</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2242193</td>
      <td>Houston</td>
      <td>Texas</td>
      <td>20</td>
      <td>Energy</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8363710</td>
      <td>New York</td>
      <td>New-York</td>
      <td>17</td>
      <td>Finance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>808976</td>
      <td>San Francisco</td>
      <td>California</td>
      <td>17</td>
      <td>Finance</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="what-next" class="level1">
<h1>What next?</h1>
<p>As you probably noticed by now, pandas is quite a large library with <em>many</em> features. Although we went through the most important features, there is still a lot to discover. Probably the best way to learn more is to get your hands dirty with some real-life data. It is also a good idea to go through pandas’ excellent <a href="http://pandas.pydata.org/pandas-docs/stable/index.html">documentation</a>, in particular the <a href="http://pandas.pydata.org/pandas-docs/stable/cookbook.html">Cookbook</a>.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>