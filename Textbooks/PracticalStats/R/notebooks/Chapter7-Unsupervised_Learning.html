<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 7 - Unsupervised Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Chapter7-Unsupervised_Learning_files/libs/clipboard/clipboard.min.js"></script>
<script src="Chapter7-Unsupervised_Learning_files/libs/quarto-html/quarto.js"></script>
<script src="Chapter7-Unsupervised_Learning_files/libs/quarto-html/popper.min.js"></script>
<script src="Chapter7-Unsupervised_Learning_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Chapter7-Unsupervised_Learning_files/libs/quarto-html/anchor.min.js"></script>
<link href="Chapter7-Unsupervised_Learning_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Chapter7-Unsupervised_Learning_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Chapter7-Unsupervised_Learning_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Chapter7-Unsupervised_Learning_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Chapter7-Unsupervised_Learning_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#practical-statistics-for-data-scientists-r" id="toc-practical-statistics-for-data-scientists-r" class="nav-link active" data-scroll-target="#practical-statistics-for-data-scientists-r">Practical Statistics for Data Scientists (R)</a></li>
  <li><a href="#principal-components-analysis" id="toc-principal-components-analysis" class="nav-link" data-scroll-target="#principal-components-analysis">Principal Components Analysis</a>
  <ul class="collapse">
  <li><a href="#a-simple-example" id="toc-a-simple-example" class="nav-link" data-scroll-target="#a-simple-example">A simple example</a></li>
  <li><a href="#interpreting-principal-components" id="toc-interpreting-principal-components" class="nav-link" data-scroll-target="#interpreting-principal-components">Interpreting principal components</a></li>
  <li><a href="#correspondence-analysis" id="toc-correspondence-analysis" class="nav-link" data-scroll-target="#correspondence-analysis">Correspondence analysis</a></li>
  </ul></li>
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering">K-Means Clustering</a>
  <ul class="collapse">
  <li><a href="#a-simple-example-1" id="toc-a-simple-example-1" class="nav-link" data-scroll-target="#a-simple-example-1">A Simple Example</a></li>
  <li><a href="#k-means-algorithm" id="toc-k-means-algorithm" class="nav-link" data-scroll-target="#k-means-algorithm">K-Means Algorithm</a></li>
  <li><a href="#interpreting-the-clusters" id="toc-interpreting-the-clusters" class="nav-link" data-scroll-target="#interpreting-the-clusters">Interpreting the Clusters</a></li>
  <li><a href="#selecting-the-number-of-clusters" id="toc-selecting-the-number-of-clusters" class="nav-link" data-scroll-target="#selecting-the-number-of-clusters">Selecting the Number of Clusters</a></li>
  </ul></li>
  <li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering">Hierarchical Clustering</a>
  <ul class="collapse">
  <li><a href="#a-simple-example-2" id="toc-a-simple-example-2" class="nav-link" data-scroll-target="#a-simple-example-2">A Simple Example</a></li>
  <li><a href="#the-dendrogram" id="toc-the-dendrogram" class="nav-link" data-scroll-target="#the-dendrogram">The Dendrogram</a></li>
  <li><a href="#measures-of-dissimilarity" id="toc-measures-of-dissimilarity" class="nav-link" data-scroll-target="#measures-of-dissimilarity">Measures of Dissimilarity</a></li>
  </ul></li>
  <li><a href="#model-based-clustering" id="toc-model-based-clustering" class="nav-link" data-scroll-target="#model-based-clustering">Model based clustering</a>
  <ul class="collapse">
  <li><a href="#multivariate-normal-distribution" id="toc-multivariate-normal-distribution" class="nav-link" data-scroll-target="#multivariate-normal-distribution">Multivariate Normal Distribution</a></li>
  <li><a href="#mixtures-of-normals" id="toc-mixtures-of-normals" class="nav-link" data-scroll-target="#mixtures-of-normals">Mixtures of Normals</a></li>
  <li><a href="#selecting-the-number-of-clusters-1" id="toc-selecting-the-number-of-clusters-1" class="nav-link" data-scroll-target="#selecting-the-number-of-clusters-1">Selecting the number of clusters</a></li>
  </ul></li>
  <li><a href="#scaling-and-categorical-variables" id="toc-scaling-and-categorical-variables" class="nav-link" data-scroll-target="#scaling-and-categorical-variables">Scaling and Categorical Variables</a>
  <ul class="collapse">
  <li><a href="#scaling-the-variables" id="toc-scaling-the-variables" class="nav-link" data-scroll-target="#scaling-the-variables">Scaling the Variables</a></li>
  <li><a href="#dominant-variables" id="toc-dominant-variables" class="nav-link" data-scroll-target="#dominant-variables">Dominant Variables</a></li>
  <li><a href="#categorical-data-and-gowers-distance" id="toc-categorical-data-and-gowers-distance" class="nav-link" data-scroll-target="#categorical-data-and-gowers-distance">Categorical Data and Gower’s Distance</a></li>
  <li><a href="#problems-with-clustering-mixed-data" id="toc-problems-with-clustering-mixed-data" class="nav-link" data-scroll-target="#problems-with-clustering-mixed-data">Problems with Clustering Mixed Data</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 7 - Unsupervised Learning</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="practical-statistics-for-data-scientists-r" class="level1">
<h1>Practical Statistics for Data Scientists (R)</h1>
<blockquote class="blockquote">
<ol start="3" type="a">
<li>2019 Peter C. Bruce, Andrew Bruce, Peter Gedeck</li>
</ol>
</blockquote>
<p>Import required R packages.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:17:50.884442Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:17:50.881403Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:17:51.500537Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:17:51.498878Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclust)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning message:
“package ‘dplyr’ was built under R version 4.1.2”

Attaching package: ‘dplyr’


The following objects are masked from ‘package:stats’:

    filter, lag


The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union


Warning message:
“package ‘tidyr’ was built under R version 4.1.2”

Attaching package: ‘lubridate’


The following objects are masked from ‘package:base’:

    date, intersect, setdiff, union



Attaching package: ‘ellipse’


The following object is masked from ‘package:graphics’:

    pairs


Package 'mclust' version 5.4.9
Type 'citation("mclust")' for citing this R package in publications.

Warning message:
“package ‘cluster’ was built under R version 4.1.2”</code></pre>
</div>
</div>
<p>Define paths to data sets. If you don’t keep your data in the same directory as the code, adapt the path names.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:17:51.536597Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:17:51.505119Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:00.777797Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:00.776383Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>PSDS_PATH <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">dirname</span>(<span class="fu">dirname</span>(<span class="fu">getwd</span>())))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>sp500_px <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(PSDS_PATH, <span class="st">'data'</span>, <span class="st">'sp500_data.csv.gz'</span>), <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>sp500_sym <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(PSDS_PATH, <span class="st">'data'</span>, <span class="st">'sp500_sectors.csv'</span>), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>loan_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(PSDS_PATH, <span class="st">'data'</span>, <span class="st">'loan_data.csv.gz'</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>loan_data<span class="sc">$</span>outcome <span class="ot">&lt;-</span> <span class="fu">ordered</span>(loan_data<span class="sc">$</span>outcome, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'paid off'</span>, <span class="st">'default'</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>housetasks <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(PSDS_PATH, <span class="st">'data'</span>, <span class="st">'housetasks.csv'</span>), <span class="at">row.names=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="principal-components-analysis" class="level1">
<h1>Principal Components Analysis</h1>
<section id="a-simple-example" class="level2">
<h2 class="anchored" data-anchor-id="a-simple-example">A simple example</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:00.781873Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:00.780794Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:00.798346Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:00.797065Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>oil_px <span class="ot">&lt;-</span> sp500_px[, <span class="fu">c</span>(<span class="st">'CVX'</span>, <span class="st">'XOM'</span>)]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">princomp</span>(oil_px)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>loadings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Loadings:
    Comp.1 Comp.2
CVX  0.747  0.665
XOM  0.665 -0.747

               Comp.1 Comp.2
SS loadings       1.0    1.0
Proportion Var    0.5    0.5
Cumulative Var    0.5    1.0</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:00.802653Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:00.801588Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:01.241252Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:01.240032Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> pca<span class="sc">$</span>loadings</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>oil_px, <span class="fu">aes</span>(<span class="at">x=</span>CVX, <span class="at">y=</span>XOM)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">46</span>)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">type=</span><span class="st">'norm'</span>, <span class="at">level=</span>.<span class="dv">99</span>, <span class="at">color=</span><span class="st">'grey25'</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> loadings[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span>loadings[<span class="dv">1</span>,<span class="dv">1</span>], <span class="at">color=</span><span class="st">'grey25'</span>, <span class="at">linetype=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> loadings[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span>loadings[<span class="dv">1</span>,<span class="dv">2</span>],  <span class="at">color=</span><span class="st">'grey25'</span>, <span class="at">linetype=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="interpreting-principal-components" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-principal-components">Interpreting principal components</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:01.246750Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:01.245429Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:01.344731Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:01.343369Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>syms <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">'AAPL'</span>, <span class="st">'MSFT'</span>, <span class="st">'CSCO'</span>, <span class="st">'INTC'</span>, <span class="st">'CVX'</span>, <span class="st">'XOM'</span>, <span class="st">'SLB'</span>, <span class="st">'COP'</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">'JPM'</span>, <span class="st">'WFC'</span>, <span class="st">'USB'</span>, <span class="st">'AXP'</span>, <span class="st">'WMT'</span>, <span class="st">'TGT'</span>, <span class="st">'HD'</span>, <span class="st">'COST'</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>top_sp <span class="ot">&lt;-</span> sp500_px[<span class="fu">row.names</span>(sp500_px)<span class="sc">&gt;=</span><span class="st">'2011-01-01'</span>, syms]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>sp_pca <span class="ot">&lt;-</span> <span class="fu">princomp</span>(top_sp)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>)<span class="sc">+</span>.<span class="dv">1</span>, <span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(sp_pca, <span class="at">main=</span><span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:01.348605Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:01.347513Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:01.370420Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:01.368609Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> sp_pca<span class="sc">$</span>loadings[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(loadings)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>loadings<span class="sc">$</span>Symbol <span class="ot">&lt;-</span> <span class="fu">row.names</span>(loadings)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">gather</span>(loadings, <span class="st">'Component'</span>, <span class="st">'Weight'</span>, <span class="sc">-</span>Symbol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:01.374960Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:01.373624Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:01.760563Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:01.759139Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>loadings<span class="sc">$</span>Color <span class="ot">=</span> loadings<span class="sc">$</span>Weight <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(loadings, <span class="fu">aes</span>(<span class="at">x=</span>Symbol, <span class="at">y=</span>Weight, <span class="at">fill=</span>Color)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position=</span><span class="st">'identity'</span>, <span class="at">width=</span>.<span class="dv">75</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Component <span class="sc">~</span> ., <span class="at">scales=</span><span class="st">'free_y'</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Component Loading'</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>, <span class="at">vjust=</span><span class="fl">0.5</span>))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="correspondence-analysis" class="level2">
<h2 class="anchored" data-anchor-id="correspondence-analysis">Correspondence analysis</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:01.764439Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:01.763324Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:01.833162Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:01.831867Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ca_analysis <span class="ot">&lt;-</span> <span class="fu">ca</span>(housetasks)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ca_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-9-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:01.837196Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:01.835996Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:01.910455Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:01.908964Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggrepel)) {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">'ggrepel'</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(ggrepel)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggrepel
</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:01.914816Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:01.913357Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:01.938121Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:01.936372Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ca_analysis<span class="sc">$</span>sv <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ca_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>0.542889284864476</li><li>0.445002761161224</li><li>0.127048433329533</li></ol>
</div>
<div class="cell-output cell-output-display">
<pre><code>
Principal inertias (eigenvalues):

 dim    value      %   cum%   scree plot               
 1      0.542889  48.7  48.7  ************             
 2      0.445003  39.9  88.6  **********               
 3      0.127048  11.4 100.0  ***                      
        -------- -----                                 
 Total: 1.114940 100.0                                 


Rows:
     name   mass  qlt  inr    k=1 cor ctr    k=2 cor ctr  
1  | Lndr |  101  925  120 | -992 740 183 | -495 185  56 |
2  | Mn_m |   88  974   81 | -876 742 124 | -490 232  47 |
3  | Dnnr |   62  930   34 | -693 777  55 | -308 154  13 |
4  | Brkf |   80  905   37 | -509 505  38 | -453 400  37 |
5  | Tdyn |   70  975   22 | -394 440  20 |  434 535  30 |
6  | Dshs |   65  764   18 | -189 118   4 |  442 646  28 |
7  | Shpp |   69  811   13 | -118  64   2 |  403 748  25 |
8  | Offc |   55  119   48 |  227  53   5 | -254  66   8 |
9  | Drvn |   80  767   91 |  742 432  81 | -653 335  76 |
10 | Fnnc |   65  997   27 |  271 161   9 |  618 837  56 |
11 | Insr |   80  885   52 |  647 576  61 |  474 309  40 |
12 | Rprs |   95  933  281 | 1529 707 407 | -864 226 159 |
13 | Hldy |   92  992  176 |  252  30  11 | 1435 962 425 |

Columns:
    name   mass  qlt  inr    k=1 cor ctr    k=2 cor ctr  
1 | Wife |  344  954  270 | -838 802 445 | -365 152 103 |
2 | Altr |  146  110  106 |  -62   5   1 | -292 105  28 |
3 | Hsbn |  218  980  342 | 1161 772 542 | -602 208 178 |
4 | Jntl |  292  998  282 |  149  21  12 | 1027 977 691 |</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:01.942258Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:01.941145Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:02.420871Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:02.418579Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>contrib <span class="ot">=</span> ca_analysis<span class="sc">$</span>sv <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>contrib <span class="ot">=</span> contrib <span class="sc">/</span> <span class="fu">sum</span>(contrib)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>colcoord <span class="ot">=</span> <span class="fu">as.data.frame</span>(ca_analysis<span class="sc">$</span>colcoord)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>rowcoord <span class="ot">=</span> <span class="fu">as.data.frame</span>(ca_analysis<span class="sc">$</span>rowcoord)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">=</span> <span class="fu">rbind</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(rowcoord, <span class="at">type=</span><span class="st">'rowcoord'</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(colcoord, <span class="at">type=</span><span class="st">'columns'</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(coords) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'_'</span>, <span class="st">' '</span>, <span class="fu">row.names</span>(coords))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(coords, <span class="fu">aes</span>(<span class="at">x=</span>Dim1, <span class="at">y=</span>Dim2, <span class="at">color=</span>type, <span class="at">label=</span><span class="fu">rownames</span>(coords), <span class="at">shape=</span>type)) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">'dotted'</span>, <span class="at">color=</span><span class="st">'#444444'</span>) <span class="sc">+</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">'dotted'</span>, <span class="at">color=</span><span class="st">'#444444'</span>) <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>() <span class="sc">+</span> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">sprintf</span>(<span class="st">'Dimension 1 (%.1f%%)'</span>, <span class="dv">100</span> <span class="sc">*</span> contrib[<span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">sprintf</span>(<span class="st">'Dimension 2 (%.1f%%)'</span>, <span class="dv">100</span> <span class="sc">*</span> contrib[<span class="dv">2</span>])) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'blue'</span>, <span class="st">'red'</span>)) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="k-means-clustering" class="level1">
<h1>K-Means Clustering</h1>
<section id="a-simple-example-1" class="level2">
<h2 class="anchored" data-anchor-id="a-simple-example-1">A Simple Example</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:02.425218Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:02.424115Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:02.450626Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:02.449283Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1010103</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> sp500_px[<span class="fu">row.names</span>(sp500_px)<span class="sc">&gt;=</span><span class="st">'2011-01-01'</span>, <span class="fu">c</span>(<span class="st">'XOM'</span>, <span class="st">'CVX'</span>)]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df, <span class="at">centers=</span><span class="dv">4</span>, <span class="at">nstart=</span><span class="dv">1</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(km<span class="sc">$</span>cluster)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 6 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">XOM</th>
<th data-quarto-table-cell-role="th" scope="col">CVX</th>
<th data-quarto-table-cell-role="th" scope="col">cluster</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">2011-01-03</td>
<td>0.73680496</td>
<td>0.2406809</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">2011-01-04</td>
<td>0.16866845</td>
<td>-0.5845157</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">2011-01-05</td>
<td>0.02663055</td>
<td>0.4469854</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">2011-01-06</td>
<td>0.24855834</td>
<td>-0.9197513</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">2011-01-07</td>
<td>0.33732892</td>
<td>0.1805111</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">2011-01-10</td>
<td>0.00000000</td>
<td>-0.4641675</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:02.455101Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:02.453973Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:02.471597Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:02.470286Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cluster=</span><span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), km<span class="sc">$</span>centers)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 4 × 3</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">cluster</th>
<th data-quarto-table-cell-role="th" scope="col">XOM</th>
<th data-quarto-table-cell-role="th" scope="col">CVX</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1</td>
<td>1</td>
<td>0.2315403</td>
<td>0.3169645</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">2</td>
<td>2</td>
<td>0.9270317</td>
<td>1.3464117</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">3</td>
<td>3</td>
<td>-1.1439800</td>
<td>-1.7502975</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">4</td>
<td>4</td>
<td>-0.3287416</td>
<td>-0.5734695</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:02.475671Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:02.474644Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:02.748203Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:02.746947Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x=</span>XOM, <span class="at">y=</span>CVX, <span class="at">color=</span>cluster, <span class="at">shape=</span>cluster)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">aes</span>(<span class="at">size=</span><span class="dv">1</span>))) <span class="sc">+</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>centers,  <span class="fu">aes</span>(<span class="at">x=</span>XOM, <span class="at">y=</span>CVX), <span class="at">size=</span><span class="dv">2</span>, <span class="at">stroke=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">'black'</span>)  <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="k-means-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="k-means-algorithm">K-Means Algorithm</h2>
<p>The <em>scikit-learn</em> algorithm is repeated 10 times by default (<code>n_init</code>), <code>max_iter</code> is used to control the number of iterations.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:02.754078Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:02.752976Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:02.792793Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:02.791275Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>syms <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">'AAPL'</span>, <span class="st">'MSFT'</span>, <span class="st">'CSCO'</span>, <span class="st">'INTC'</span>, <span class="st">'CVX'</span>, <span class="st">'XOM'</span>, <span class="st">'SLB'</span>, <span class="st">'COP'</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">'JPM'</span>, <span class="st">'WFC'</span>, <span class="st">'USB'</span>, <span class="st">'AXP'</span>, <span class="st">'WMT'</span>, <span class="st">'TGT'</span>, <span class="st">'HD'</span>, <span class="st">'COST'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> sp500_px[<span class="fu">row.names</span>(sp500_px) <span class="sc">&gt;=</span> <span class="st">'2011-01-01'</span>, syms]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10010</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df, <span class="at">centers=</span><span class="dv">5</span>, <span class="at">nstart=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpreting-the-clusters" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-clusters">Interpreting the Clusters</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:02.797104Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:02.796053Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:02.807223Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:02.805941Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>288</li><li>266</li><li>285</li><li>106</li><li>186</li></ol>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:02.811213Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:02.810156Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:03.130929Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:03.129691Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>centers <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(km<span class="sc">$</span>centers))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(centers) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">'Cluster'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>centers<span class="sc">$</span>Symbol <span class="ot">&lt;-</span> <span class="fu">row.names</span>(centers)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>centers <span class="ot">&lt;-</span> <span class="fu">gather</span>(centers, <span class="st">'Cluster'</span>, <span class="st">'Mean'</span>, <span class="sc">-</span>Symbol)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>centers<span class="sc">$</span>Color <span class="ot">=</span> centers<span class="sc">$</span>Mean <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(centers, <span class="fu">aes</span>(<span class="at">x=</span>Symbol, <span class="at">y=</span>Mean, <span class="at">fill=</span>Color)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position=</span><span class="st">'identity'</span>, <span class="at">width=</span>.<span class="dv">75</span>) <span class="sc">+</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Cluster <span class="sc">~</span> ., <span class="at">scales=</span><span class="st">'free_y'</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="st">'none'</span>)  <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Component Loading'</span>) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>, <span class="at">vjust=</span><span class="fl">0.5</span>))</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="selecting-the-number-of-clusters" class="level2">
<h2 class="anchored" data-anchor-id="selecting-the-number-of-clusters">Selecting the Number of Clusters</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:03.135262Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:03.134228Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:05.308335Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:05.307099Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pct_var <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pct_var =</span> <span class="dv">0</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">num_clusters=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>totalss <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df, <span class="at">centers=</span><span class="dv">14</span>, <span class="at">nstart=</span><span class="dv">50</span>, <span class="at">iter.max=</span><span class="dv">100</span>)<span class="sc">$</span>totss</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>) {</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  kmCluster <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df, <span class="at">centers=</span>i, <span class="at">nstart=</span><span class="dv">50</span>, <span class="at">iter.max =</span> <span class="dv">100</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  pct_var[i<span class="dv">-1</span>, <span class="st">'pct_var'</span>] <span class="ot">&lt;-</span> kmCluster<span class="sc">$</span>betweenss <span class="sc">/</span> totalss</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pct_var, <span class="fu">aes</span>(<span class="at">x=</span>num_clusters, <span class="at">y=</span>pct_var)) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">'% Variance Explained'</span>, <span class="at">x=</span><span class="st">'Number of Clusters'</span>) <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">14</span>, <span class="at">by=</span><span class="dv">2</span>))   <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="hierarchical-clustering" class="level1">
<h1>Hierarchical Clustering</h1>
<section id="a-simple-example-2" class="level2">
<h2 class="anchored" data-anchor-id="a-simple-example-2">A Simple Example</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:05.312645Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:05.311566Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:05.327305Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:05.325940Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>syms1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'GOOGL'</span>, <span class="st">'AMZN'</span>, <span class="st">'AAPL'</span>, <span class="st">'MSFT'</span>, <span class="st">'CSCO'</span>, <span class="st">'INTC'</span>, <span class="st">'CVX'</span>, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">'XOM'</span>, <span class="st">'SLB'</span>, <span class="st">'COP'</span>, <span class="st">'JPM'</span>, <span class="st">'WFC'</span>, <span class="st">'USB'</span>, <span class="st">'AXP'</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">'WMT'</span>, <span class="st">'TGT'</span>, <span class="st">'HD'</span>, <span class="st">'COST'</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> sp500_px[<span class="fu">row.names</span>(sp500_px) <span class="sc">&gt;=</span> <span class="st">'2011-01-01'</span>, syms1]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">t</span>(df))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>hcl <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-dendrogram" class="level2">
<h2 class="anchored" data-anchor-id="the-dendrogram">The Dendrogram</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:05.331643Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:05.330589Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:05.370640Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:05.369381Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hcl, <span class="at">ylab=</span><span class="st">'distance'</span>, <span class="at">xlab=</span><span class="st">''</span>, <span class="at">sub=</span><span class="st">''</span>, <span class="at">main=</span><span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:05.374976Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:05.373877Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:05.385524Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:05.384297Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(hcl, <span class="at">k=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>GOOGL</dt><dd>1</dd><dt>AMZN</dt><dd>2</dd><dt>AAPL</dt><dd>3</dd><dt>MSFT</dt><dd>3</dd><dt>CSCO</dt><dd>3</dd><dt>INTC</dt><dd>3</dd><dt>CVX</dt><dd>4</dd><dt>XOM</dt><dd>4</dd><dt>SLB</dt><dd>4</dd><dt>COP</dt><dd>4</dd><dt>JPM</dt><dd>3</dd><dt>WFC</dt><dd>3</dd><dt>USB</dt><dd>3</dd><dt>AXP</dt><dd>3</dd><dt>WMT</dt><dd>3</dd><dt>TGT</dt><dd>3</dd><dt>HD</dt><dd>3</dd><dt>COST</dt><dd>3</dd></dl>
</div>
</div>
</section>
<section id="measures-of-dissimilarity" class="level2">
<h2 class="anchored" data-anchor-id="measures-of-dissimilarity">Measures of Dissimilarity</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:05.390465Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:05.389317Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:06.045442Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:06.044186Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>cluster_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, method)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">dist</span>(df)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  hcl <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d, <span class="at">method=</span>method)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  tree <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hcl, <span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(tree)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>method <span class="ot">&lt;-</span> method</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>df0 <span class="ot">&lt;-</span> sp500_px[<span class="fu">row.names</span>(sp500_px) <span class="sc">&gt;=</span> <span class="st">'2011-01-01'</span>, <span class="fu">c</span>(<span class="st">'XOM'</span>, <span class="st">'CVX'</span>)]</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">cluster_fun</span>(df0, <span class="at">method=</span><span class="st">'single'</span>),</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster_fun</span>(df0, <span class="at">method=</span><span class="st">'average'</span>),</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster_fun</span>(df0, <span class="at">method=</span><span class="st">'complete'</span>),</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cluster_fun</span>(df0, <span class="at">method=</span><span class="st">'ward.D'</span>))</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>method <span class="ot">&lt;-</span> <span class="fu">ordered</span>(df<span class="sc">$</span>method, <span class="fu">c</span>(<span class="st">'single'</span>, <span class="st">'average'</span>, <span class="st">'complete'</span>, <span class="st">'ward.D'</span>))</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x=</span>XOM, <span class="at">y=</span>CVX, <span class="at">color=</span>cluster, <span class="at">shape=</span>cluster)) <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">aes</span>(<span class="at">size=</span><span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> method) <span class="sc">+</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-based-clustering" class="level1">
<h1>Model based clustering</h1>
<section id="multivariate-normal-distribution" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-normal-distribution">Multivariate Normal Distribution</h2>
<blockquote class="blockquote">
<p>Define a colormap that corresponds to the probability levels</p>
</blockquote>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:06.051479Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:06.050410Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:06.317329Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:06.315997Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">75</span>, .<span class="dv">95</span>, .<span class="dv">99</span>) <span class="do">## or whatever you want</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(prob) <span class="ot">&lt;-</span> prob <span class="do">## to get id column in result</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> prob){</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,  <span class="fu">ellipse</span>(<span class="at">x=</span>sigma, <span class="at">centre=</span>mu, <span class="at">level=</span>p))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, <span class="at">prob=</span><span class="fu">factor</span>(<span class="fu">rep</span>(prob, <span class="fu">rep</span>(<span class="dv">100</span>, <span class="fu">length</span>(prob)))))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Prob'</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Figure 7-9: Multivariate normal ellipses</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>dfmu <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>mu[<span class="dv">1</span>], <span class="at">Y=</span>mu[<span class="dv">2</span>])</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(X, Y)) <span class="sc">+</span> </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Prob)) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>dfmu, <span class="fu">aes</span>(X, Y), <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="mixtures-of-normals" class="level2">
<h2 class="anchored" data-anchor-id="mixtures-of-normals">Mixtures of Normals</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:06.321632Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:06.320569Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:13.410014Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:13.408707Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> sp500_px[<span class="fu">row.names</span>(sp500_px)<span class="sc">&gt;=</span><span class="st">'2011-01-01'</span>, <span class="fu">c</span>(<span class="st">'XOM'</span>, <span class="st">'CVX'</span>)]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>mcl <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(df)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mcl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>---------------------------------------------------- 
Gaussian finite mixture model fitted by EM algorithm 
---------------------------------------------------- 

Mclust VEE (ellipsoidal, equal shape and orientation) model with 2 components: 

 log-likelihood    n df       BIC       ICL
      -2255.125 1131  9 -4573.528 -5075.657

Clustering table:
  1   2 
168 963 </code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:13.414360Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:13.413221Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:13.689010Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:13.687665Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">predict</span>(mcl)<span class="sc">$</span>classification)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x=</span>XOM, <span class="at">y=</span>CVX, <span class="at">color=</span>cluster, <span class="at">shape=</span>cluster)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">aes</span>(<span class="at">size=</span><span class="dv">2</span>))) </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:13.694179Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:13.692991Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:13.723104Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:13.721714Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mcl, <span class="at">parameters=</span><span class="cn">TRUE</span>)<span class="sc">$</span>mean</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mcl, <span class="at">parameters=</span><span class="cn">TRUE</span>)<span class="sc">$</span>variance[,,<span class="dv">1</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mcl, <span class="at">parameters=</span><span class="cn">TRUE</span>)<span class="sc">$</span>variance[,,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A matrix: 2 × 2 of type dbl</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">XOM</td>
<td>-0.04362218</td>
<td>0.05792282</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">CVX</td>
<td>-0.21109525</td>
<td>0.07375447</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A matrix: 2 × 2 of type dbl</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">XOM</th>
<th data-quarto-table-cell-role="th" scope="col">CVX</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">XOM</td>
<td>1.044671</td>
<td>1.065190</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">CVX</td>
<td>1.065190</td>
<td>1.912748</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A matrix: 2 × 2 of type dbl</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">XOM</th>
<th data-quarto-table-cell-role="th" scope="col">CVX</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">XOM</td>
<td>0.2998935</td>
<td>0.3057838</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">CVX</td>
<td>0.3057838</td>
<td>0.5490920</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="selecting-the-number-of-clusters-1" class="level2">
<h2 class="anchored" data-anchor-id="selecting-the-number-of-clusters-1">Selecting the number of clusters</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:13.727661Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:13.726524Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:13.800821Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:13.799325Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mcl, <span class="at">what=</span><span class="st">'BIC'</span>, <span class="at">ask=</span><span class="cn">FALSE</span>, <span class="at">cex=</span>.<span class="dv">75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-28-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="scaling-and-categorical-variables" class="level1">
<h1>Scaling and Categorical Variables</h1>
<section id="scaling-the-variables" class="level2">
<h2 class="anchored" data-anchor-id="scaling-the-variables">Scaling the Variables</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:13.805804Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:13.804623Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:14.128337Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:14.127219Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="28">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>defaults <span class="ot">&lt;-</span> loan_data[loan_data<span class="sc">$</span>outcome<span class="sc">==</span><span class="st">'default'</span>,]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> defaults[, <span class="fu">c</span>(<span class="st">'loan_amnt'</span>, <span class="st">'annual_inc'</span>, <span class="st">'revol_bal'</span>, <span class="st">'open_acc'</span>, <span class="st">'dti'</span>, <span class="st">'revol_util'</span>)]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df, <span class="at">centers=</span><span class="dv">4</span>, <span class="at">nstart=</span><span class="dv">10</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">size=</span>km<span class="sc">$</span>size, km<span class="sc">$</span>centers) </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(centers, <span class="at">digits=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   size loan_amnt annual_inc revol_bal open_acc   dti revol_util
1    52  22570.19  489783.40  85161.35    13.33  6.91      59.65
2 13819  10577.04   42380.98  10245.27     9.58 17.71      58.09
3  1221  21797.26  164503.32  38652.54    12.61 13.53      63.65
4  7579  18247.71   83069.61  19587.30    11.66 16.79      62.26</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:14.132277Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:14.131125Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:14.518532Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:14.517163Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="29">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df0 <span class="ot">&lt;-</span> <span class="fu">scale</span>(df)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>km0 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df0, <span class="at">centers=</span><span class="dv">4</span>, <span class="at">nstart=</span><span class="dv">10</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>centers0 <span class="ot">&lt;-</span> <span class="fu">scale</span>(km0<span class="sc">$</span>centers, <span class="at">center=</span><span class="cn">FALSE</span>, <span class="at">scale=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">attr</span>(df0, <span class="st">'scaled:scale'</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>centers0 <span class="ot">&lt;-</span> <span class="fu">scale</span>(centers0, <span class="at">center=</span><span class="sc">-</span><span class="fu">attr</span>(df0, <span class="st">'scaled:center'</span>), <span class="at">scale=</span><span class="cn">FALSE</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>centers0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">size=</span>km0<span class="sc">$</span>size, centers0) </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(centers0, <span class="at">digits=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  size loan_amnt annual_inc revol_bal open_acc   dti revol_util
1 7352  10469.87   51123.20  11525.60     7.48 15.79      77.73
2 6299  13363.49   55586.54  16363.84    14.24 24.22      59.59
3 3713  25892.73  116197.49  32803.62    12.41 16.22      66.15
4 5307  10356.29   53539.85   6037.84     8.68 11.30      30.72</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:14.522671Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:14.521579Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:14.794046Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:14.792723Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="30">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df, <span class="at">centers=</span><span class="dv">4</span>, <span class="at">nstart=</span><span class="dv">10</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">size=</span>km<span class="sc">$</span>size, km<span class="sc">$</span>centers) </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(centers, <span class="at">digits=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 4 × 7</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">size</th>
<th data-quarto-table-cell-role="th" scope="col">loan_amnt</th>
<th data-quarto-table-cell-role="th" scope="col">annual_inc</th>
<th data-quarto-table-cell-role="th" scope="col">revol_bal</th>
<th data-quarto-table-cell-role="th" scope="col">open_acc</th>
<th data-quarto-table-cell-role="th" scope="col">dti</th>
<th data-quarto-table-cell-role="th" scope="col">revol_util</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1</td>
<td>13902</td>
<td>10606.48</td>
<td>42500.30</td>
<td>10280.52</td>
<td>9.59</td>
<td>17.71</td>
<td>58.11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">2</td>
<td>1192</td>
<td>21856.38</td>
<td>165473.54</td>
<td>38935.88</td>
<td>12.61</td>
<td>13.48</td>
<td>63.67</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">3</td>
<td>52</td>
<td>22570.19</td>
<td>489783.40</td>
<td>85161.35</td>
<td>13.33</td>
<td>6.91</td>
<td>59.65</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">4</td>
<td>7525</td>
<td>18282.25</td>
<td>83458.11</td>
<td>19653.82</td>
<td>11.66</td>
<td>16.77</td>
<td>62.27</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="dominant-variables" class="level2">
<h2 class="anchored" data-anchor-id="dominant-variables">Dominant Variables</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:14.797742Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:14.796767Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:14.849012Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:14.847744Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="31">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>syms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'GOOGL'</span>, <span class="st">'AMZN'</span>, <span class="st">'AAPL'</span>, <span class="st">'MSFT'</span>, <span class="st">'CSCO'</span>, <span class="st">'INTC'</span>, <span class="st">'CVX'</span>, <span class="st">'XOM'</span>, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">'SLB'</span>, <span class="st">'COP'</span>, <span class="st">'JPM'</span>, <span class="st">'WFC'</span>, <span class="st">'USB'</span>, <span class="st">'AXP'</span>, <span class="st">'WMT'</span>, <span class="st">'TGT'</span>, <span class="st">'HD'</span>, <span class="st">'COST'</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>top_15 <span class="ot">&lt;-</span> sp500_px[<span class="fu">row.names</span>(sp500_px)<span class="sc">&gt;=</span><span class="st">'2011-01-01'</span>, syms]</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>sp_pca1 <span class="ot">&lt;-</span> <span class="fu">princomp</span>(top_15)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(sp_pca1, <span class="at">main=</span><span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:14.853915Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:14.852799Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:14.872942Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:14.871690Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(sp_pca1<span class="sc">$</span>loadings[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A matrix: 18 × 2 of type dbl</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">Comp.1</th>
<th data-quarto-table-cell-role="th" scope="col">Comp.2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">GOOGL</td>
<td>0.781</td>
<td>0.609</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">AMZN</td>
<td>0.593</td>
<td>-0.792</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">AAPL</td>
<td>0.078</td>
<td>0.004</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">MSFT</td>
<td>0.029</td>
<td>0.002</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">CSCO</td>
<td>0.017</td>
<td>-0.001</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">INTC</td>
<td>0.020</td>
<td>-0.001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">CVX</td>
<td>0.068</td>
<td>-0.021</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">XOM</td>
<td>0.053</td>
<td>-0.005</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">SLB</td>
<td>0.079</td>
<td>-0.013</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">COP</td>
<td>0.044</td>
<td>-0.016</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">JPM</td>
<td>0.043</td>
<td>0.001</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">WFC</td>
<td>0.034</td>
<td>-0.001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">USB</td>
<td>0.026</td>
<td>0.003</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">AXP</td>
<td>0.063</td>
<td>-0.006</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">WMT</td>
<td>0.026</td>
<td>-0.001</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">TGT</td>
<td>0.036</td>
<td>-0.010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">HD</td>
<td>0.051</td>
<td>-0.019</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">COST</td>
<td>0.061</td>
<td>-0.019</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="categorical-data-and-gowers-distance" class="level2">
<h2 class="anchored" data-anchor-id="categorical-data-and-gowers-distance">Categorical Data and Gower’s Distance</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:14.876759Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:14.875749Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:14.899184Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:14.897817Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="33">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> loan_data[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">c</span>(<span class="st">'dti'</span>, <span class="st">'payment_inc_ratio'</span>, <span class="st">'home_'</span>, <span class="st">'purpose_'</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">home_=</span><span class="fu">as.factor</span>(home_), <span class="at">purpose_=</span><span class="fu">as.factor</span>(purpose_))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 5 × 4</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">dti</th>
<th data-quarto-table-cell-role="th" scope="col">payment_inc_ratio</th>
<th data-quarto-table-cell-role="th" scope="col">home_</th>
<th data-quarto-table-cell-role="th" scope="col">purpose_</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1</td>
<td>1.00</td>
<td>2.39320</td>
<td>RENT</td>
<td>major_purchase</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">2</td>
<td>5.55</td>
<td>4.57170</td>
<td>OWN</td>
<td>small_business</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">3</td>
<td>18.08</td>
<td>9.71600</td>
<td>RENT</td>
<td>other</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">4</td>
<td>10.08</td>
<td>12.21520</td>
<td>RENT</td>
<td>debt_consolidation</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">5</td>
<td>7.06</td>
<td>3.90888</td>
<td>RENT</td>
<td>other</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:14.903634Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:14.902526Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:14.914760Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:14.913549Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="34">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">daisy</span>(x, <span class="at">metric=</span><span class="st">'gower'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Dissimilarities :
          1         2         3         4
2 0.6220479                              
3 0.6863877 0.8143398                    
4 0.6329040 0.7608561 0.4307083          
5 0.3772789 0.5389727 0.3091088 0.5056250

Metric :  mixed ;  Types = I, I, N, N 
Number of objects : 5</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:14.918907Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:14.917863Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:15.107983Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:15.106652Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="35">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">301</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> loan_data[<span class="fu">sample</span>(<span class="fu">nrow</span>(loan_data), <span class="dv">250</span>),</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">'dti'</span>, <span class="st">'payment_inc_ratio'</span>, <span class="st">'home_'</span>, <span class="st">'purpose_'</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">home_=</span><span class="fu">as.factor</span>(home_), <span class="at">purpose_=</span><span class="fu">as.factor</span>(purpose_))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">daisy</span>(df, <span class="at">metric=</span><span class="st">'gower'</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>hcl <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>dnd <span class="ot">&lt;-</span> <span class="fu">as.dendrogram</span>(hcl)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dnd, <span class="at">leaflab=</span><span class="st">'none'</span>, <span class="at">ylab=</span><span class="st">'distance'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Chapter7-Unsupervised_Learning_files/figure-html/cell-36-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:15.111991Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:15.110861Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:15.130744Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:15.129433Z&quot;}" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="36">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dnd_cut <span class="ot">&lt;-</span> <span class="fu">cut</span>(dnd, <span class="at">h=</span>.<span class="dv">5</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">labels</span>(dnd_cut<span class="sc">$</span>lower[[<span class="dv">4</span>]]),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 7 × 4</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">dti</th>
<th data-quarto-table-cell-role="th" scope="col">payment_inc_ratio</th>
<th data-quarto-table-cell-role="th" scope="col">home_</th>
<th data-quarto-table-cell-role="th" scope="col">purpose_</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">17286</td>
<td>19.79</td>
<td>16.55380</td>
<td>MORTGAGE</td>
<td>other</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">21988</td>
<td>10.36</td>
<td>14.34780</td>
<td>MORTGAGE</td>
<td>other</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">24706</td>
<td>5.59</td>
<td>3.83713</td>
<td>MORTGAGE</td>
<td>other</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">26082</td>
<td>1.18</td>
<td>2.94380</td>
<td>MORTGAGE</td>
<td>other</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">9840</td>
<td>26.12</td>
<td>4.90231</td>
<td>MORTGAGE</td>
<td>other</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">37913</td>
<td>19.78</td>
<td>5.24341</td>
<td>MORTGAGE</td>
<td>other</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">31884</td>
<td>19.65</td>
<td>5.16189</td>
<td>MORTGAGE</td>
<td>other</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="problems-with-clustering-mixed-data" class="level2">
<h2 class="anchored" data-anchor-id="problems-with-clustering-mixed-data">Problems with Clustering Mixed Data</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-26T20:18:15.134989Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-26T20:18:15.133911Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-26T20:18:15.322315Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-26T20:18:15.321022Z&quot;}" data-scrolled="true" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="37">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> dti <span class="sc">+</span> payment_inc_ratio <span class="sc">+</span> home_ <span class="sc">+</span> pub_rec_zero, <span class="at">data=</span>defaults)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>df0 <span class="ot">&lt;-</span> <span class="fu">scale</span>(df)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>km0 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df0, <span class="at">centers=</span><span class="dv">4</span>, <span class="at">nstart=</span><span class="dv">10</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>centers0 <span class="ot">&lt;-</span> <span class="fu">scale</span>(km0<span class="sc">$</span>centers, <span class="at">center=</span><span class="cn">FALSE</span>, <span class="at">scale=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">attr</span>(df0, <span class="st">'scaled:scale'</span>))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">scale</span>(centers0, <span class="at">center=</span><span class="sc">-</span><span class="fu">attr</span>(df0, <span class="st">'scaled:center'</span>), <span class="at">scale=</span><span class="cn">FALSE</span>), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A matrix: 4 × 6 of type dbl</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th" scope="col">dti</th>
<th data-quarto-table-cell-role="th" scope="col">payment_inc_ratio</th>
<th data-quarto-table-cell-role="th" scope="col">home_MORTGAGE</th>
<th data-quarto-table-cell-role="th" scope="col">home_OWN</th>
<th data-quarto-table-cell-role="th" scope="col">home_RENT</th>
<th data-quarto-table-cell-role="th" scope="col">pub_rec_zero</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">1</td>
<td>16.99</td>
<td>9.11</td>
<td>0.00</td>
<td>0</td>
<td>1.00</td>
<td>1.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">2</td>
<td>17.20</td>
<td>9.27</td>
<td>0.00</td>
<td>1</td>
<td>0.00</td>
<td>0.92</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th" scope="row">3</td>
<td>17.46</td>
<td>8.42</td>
<td>1.00</td>
<td>0</td>
<td>0.00</td>
<td>1.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th" scope="row">4</td>
<td>16.50</td>
<td>8.06</td>
<td>0.52</td>
<td>0</td>
<td>0.48</td>
<td>0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>