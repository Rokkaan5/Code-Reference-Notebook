<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prof.&nbsp;Ami Gates">

<title>Clustering-Example1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="clust-ex1-mkdn_files/libs/clipboard/clipboard.min.js"></script>
<script src="clust-ex1-mkdn_files/libs/quarto-html/quarto.js"></script>
<script src="clust-ex1-mkdn_files/libs/quarto-html/popper.min.js"></script>
<script src="clust-ex1-mkdn_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="clust-ex1-mkdn_files/libs/quarto-html/anchor.min.js"></script>
<link href="clust-ex1-mkdn_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="clust-ex1-mkdn_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="clust-ex1-mkdn_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="clust-ex1-mkdn_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="clust-ex1-mkdn_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Clustering-Example1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Prof.&nbsp;Ami Gates </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="comprehensive-clustering-tutorial" class="level1">
<h1>Comprehensive Clustering Tutorial</h1>
<p>Corpus - Text - Small Corpus - Text - Novels</p>
<p>Record - 3D - Small</p>
<p>k means, hclust, and Vis</p>
<p>Elbow, Silhouette</p>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">DATA</h2>
<p>The pretend and general datasets can be found <a href="https://drive.google.com/drive/folders/1n6RyoS18HfzP-AwHJYSNDOu6YkqcoIw7?usp=sharing">here</a></p>
<p>You MAY NEED TO MAKE CHANGES - formats always matter</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)  <span class="do">## for dist</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/dist</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## There are many clustering libraries</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("NbClust")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NbClust)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclust)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(amap)  <span class="do">## for using Kmeans (notice the cap K)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra) <span class="do">## for cluster vis, silhouette, etc.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("stylo")</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stylo)  <span class="do">## for dist.cosine</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("philentropy")</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(philentropy)  <span class="do">## for distance() which offers 46 metrics</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="do">## https://cran.r-project.org/web/packages/philentropy/vignettes/Distances.html</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SnowballC)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caTools)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(textstem)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm) <span class="do">## to read in corpus (text data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Always start small and easy. Let’s start with the smallest and easiest dataset.</p>
<p>This is a record dataset with only 3 variables. It is labeled data - so we will NEED TO REMOVE the label before clustering.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## I will set my working dir to point to the data on MY </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="do">## computer :) You will need to update this.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at C:/Users/rokka/GH-repos/GitHubPages/Coding-References</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="fu">here</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Record_3D_DF_all<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"ClusterSmall3DDataset.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Record_3D_DF<span class="ot">&lt;-</span>Record_3D_DF_all  <span class="do">## make a copy</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Look, clean, prep</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Record_3D_DF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Label Height Weight Age
1 BBallPlayer     84    250  17
2   NonPlayer     72    200  16
3   NonPlayer     70    210  15
4 BBallPlayer     86    278  18
5   NonPlayer     74    190  15
6 BBallPlayer     80    245  16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Record_3D_DF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   10 obs. of  4 variables:
 $ Label : chr  "BBallPlayer" "NonPlayer" "NonPlayer" "BBallPlayer" ...
 $ Height: int  84 72 70 86 74 80 79 71 69 82
 $ Weight: int  250 200 210 278 190 245 267 187 211 289
 $ Age   : int  17 16 15 18 15 16 19 15 14 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Save the label</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>(Label_3D <span class="ot">&lt;-</span> Record_3D_DF<span class="sc">$</span>Label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "BBallPlayer" "NonPlayer"   "NonPlayer"   "BBallPlayer" "NonPlayer"  
 [6] "BBallPlayer" "BBallPlayer" "NonPlayer"   "NonPlayer"   "BBallPlayer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Remove the label from the dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">## remove column 1</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Record_3D_DF <span class="ot">&lt;-</span> Record_3D_DF[ ,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>) ]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Record_3D_DF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Height Weight Age
1     84    250  17
2     72    200  16
3     70    210  15
4     86    278  18
5     74    190  15
6     80    245  16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Look at the pairwise distances between the vectors (rows, points in 3D)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>(Dist1<span class="ot">&lt;-</span> <span class="fu">dist</span>(Record_3D_DF, <span class="at">method =</span> <span class="st">"minkowski"</span>, <span class="at">p=</span><span class="dv">1</span>)) <span class="do">##Manhattan</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     1   2   3   4   5   6   7   8   9
2   63                                
3   56  13                            
4   31  94  87                        
5   72  13  24 103                    
6   10  53  46  41  62                
7   24  77  70  19  86  26            
8   78  15  24 109   6  68  92        
9   57  16   3  88  27  47  71  27    
10  41 100  93  16 109  47  27 115  94</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(Dist2<span class="ot">&lt;-</span> <span class="fu">dist</span>(Record_3D_DF, <span class="at">method =</span> <span class="st">"minkowski"</span>, <span class="at">p=</span><span class="dv">2</span>)) <span class="co">#Euclidean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            1          2          3          4          5          6          7
2   51.429563                                                                  
3   42.426407  10.246951                                                       
4   28.089144  79.271685  69.921384                                            
5   60.860496  10.246951  20.396078  88.865066                                 
6    6.480741  45.705580  36.414283  33.600595  55.335341                      
7   17.832555  67.431447  57.844619  13.076697  77.265775  22.226111           
8   64.358372  13.076697  23.021729  92.276758   4.242641  58.702640  80.498447
9   41.892720  11.575837   1.732051  69.238717  21.610183  35.791060  57.105166
10  39.051248  89.565618  79.931220  11.747340  99.342841  44.056782  22.293497
            8          9
2                       
3                       
4                       
5                       
6                       
7                       
8                       
9   24.103942           
10 102.610916  79.132800</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(DistE<span class="ot">&lt;-</span> <span class="fu">dist</span>(Record_3D_DF, <span class="at">method =</span> <span class="st">"euclidean"</span>)) <span class="co">#same as p = 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            1          2          3          4          5          6          7
2   51.429563                                                                  
3   42.426407  10.246951                                                       
4   28.089144  79.271685  69.921384                                            
5   60.860496  10.246951  20.396078  88.865066                                 
6    6.480741  45.705580  36.414283  33.600595  55.335341                      
7   17.832555  67.431447  57.844619  13.076697  77.265775  22.226111           
8   64.358372  13.076697  23.021729  92.276758   4.242641  58.702640  80.498447
9   41.892720  11.575837   1.732051  69.238717  21.610183  35.791060  57.105166
10  39.051248  89.565618  79.931220  11.747340  99.342841  44.056782  22.293497
            8          9
2                       
3                       
4                       
5                       
6                       
7                       
8                       
9   24.103942           
10 102.610916  79.132800</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## test to see that rescale does what you think it should --</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="do">##v=c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="do">##rescale(v)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a normalized version of Record_3D_DF</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>(Record_3D_DF_Norm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">apply</span>(Record_3D_DF[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> ], <span class="dv">2</span>, <span class="do">##2 for col</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="cf">function</span>(x) (x <span class="sc">-</span> <span class="fu">min</span>(x))<span class="sc">/</span>(<span class="fu">max</span>(x)<span class="sc">-</span><span class="fu">min</span>(x)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Height     Weight Age
1  0.88235294 0.61764706 0.6
2  0.17647059 0.12745098 0.4
3  0.05882353 0.22549020 0.2
4  1.00000000 0.89215686 0.8
5  0.29411765 0.02941176 0.2
6  0.64705882 0.56862745 0.4
7  0.58823529 0.78431373 1.0
8  0.11764706 0.00000000 0.2
9  0.00000000 0.23529412 0.0
10 0.76470588 1.00000000 0.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Look at scaled distances</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>(Dist_norm<span class="ot">&lt;-</span> <span class="fu">dist</span>(Record_3D_DF_Norm, <span class="at">method =</span> <span class="st">"minkowski"</span>, <span class="at">p=</span><span class="dv">2</span>)) <span class="co">#Euclidean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           1         2         3         4         5         6         7
2  0.8823617                                                            
3  0.9959858 0.2518978                                                  
4  0.3594391 1.1928855 1.3000991                                        
5  0.9230610 0.2518978 0.3062843 1.2659380                              
6  0.3126759 0.6450504 0.7097633 0.6238900 0.6747748                    
7  0.5237203 0.9803157 1.1102074 0.4702981 1.1385878 0.6402974          
8  1.0612554 0.2443439 0.2330366 1.3908597 0.1789048 0.8022556 1.2151548
9  1.1334639 0.4503021 0.2087015 1.4392598 0.4109656 0.8305397 1.2835277
10 0.4000433 1.0711501 1.1216663 0.3270986 1.1504324 0.4898195 0.4875063
           8         9
2                     
3                     
4                     
5                     
6                     
7                     
8                     
9  0.3304605          
10 1.2564574 1.2367498</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## You can use scale in R - I suggest you read about it first :)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="do">## (Record_3D_DF_scale&lt;-scale(Record_3D_DF))</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="do">## You can also try to code your own distance metric</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="lets-cluster" class="level1">
<h1>Let’s cluster!</h1>
<section id="nbclust-and-silhouettes" class="level2">
<h2 class="anchored" data-anchor-id="nbclust-and-silhouettes">NbClust and Silhouettes</h2>
<p><code>NbClust</code> helps to determine the number of clusters.</p>
<p>[https://cran.r-project.org/web/packages/NbClust/NbClust.pdf]</p>
<p>We can also use Silhouette</p>
<p>Learn more about NbClust and the options [https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;ved=2ahUKEwjo_5GujJTsAhXSwFkKHbIuAfkQFjACegQIBxAC&amp;url=https%3A%2F%2Fwww.jstatsoft.org%2Fv61%2Fi06%2Fpaper&amp;usg=AOvVaw3l5m5LhJgmgjj4a3mBrn6_]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>kmeans_3D_1<span class="ot">&lt;-</span>NbClust<span class="sc">::</span><span class="fu">NbClust</span>(Record_3D_DF_Norm, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">min.nc=</span><span class="dv">2</span>, <span class="at">max.nc=</span><span class="dv">5</span>, <span class="at">method=</span><span class="st">"kmeans"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/determine%20k%20(NbClust,%20silhouette)-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>*** : The Hubert index is a graphical method of determining the number of clusters.
                In the plot of Hubert index, we seek a significant knee that corresponds to a 
                significant increase of the value of the measure i.e the significant peak in Hubert
                index second differences plot. 
 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/determine%20k%20(NbClust,%20silhouette)-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>*** : The D index is a graphical method of determining the number of clusters. 
                In the plot of D index, we seek a significant knee (the significant peak in Dindex
                second differences plot) that corresponds to a significant increase of the value of
                the measure. 
 
******************************************************************* 
* Among all indices:                                                
* 12 proposed 2 as the best number of clusters 
* 4 proposed 3 as the best number of clusters 
* 3 proposed 4 as the best number of clusters 
* 4 proposed 5 as the best number of clusters 

                   ***** Conclusion *****                            
 
* According to the majority rule, the best number of clusters is  2 
 
 
******************************************************************* </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## How many clusters is best....let's SEE.........</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(kmeans_3D_1<span class="sc">$</span>Best.n[<span class="dv">1</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 0  2  3  4  5 
 2 12  4  3  4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(kmeans_3D_1<span class="sc">$</span>Best.n[<span class="dv">1</span>,]), </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Number of Clusters"</span>, <span class="at">ylab=</span><span class="st">""</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">"Number of Clusters"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Does Silhouette agree?</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(Record_3D_DF_Norm, <span class="at">method =</span> <span class="st">"silhouette"</span>, </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">FUN =</span> hcut, <span class="at">k.max =</span> <span class="dv">5</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="do">## OK!</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Two clusters (k = 2) is likely the best. </span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Silhouette Coefficient = (x-y)/ max(x,y)</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># y: mean in cluster</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># x: mean dist from nearest cluster</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co"># -1 means val in wrong cluster</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 means right cluster</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/determine%20k%20(NbClust,%20silhouette)-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="elbow-method-wss---within-sum-sq" class="level2">
<h2 class="anchored" data-anchor-id="elbow-method-wss---within-sum-sq">Elbow Method (WSS - within sum sq)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">############################# Elbow Methods ###################</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(Record_3D_DF_Norm), </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  kmeans, </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">k.max =</span> <span class="dv">5</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"wss"</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">diss =</span> <span class="fu">get_dist</span>(<span class="fu">as.matrix</span>(Record_3D_DF_Norm), <span class="at">method =</span> <span class="st">"manhattan"</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/Elbow%20method-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="k-means" class="level1">
<h1>k means</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>kmeans_3D_1_Result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Record_3D_DF, <span class="dv">2</span>, <span class="at">nstart=</span><span class="dv">25</span>)   </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="do">## I could have used the normalized data - which is better to use</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="do">## But - by using the non-norm data, the results make more visual</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="do">## sense - which also matters.</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(kmeans_3D_1_Result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 2 clusters of sizes 5, 5

Cluster means:
  Height Weight  Age
1   71.2  199.6 15.0
2   82.2  265.8 17.4

Clustering vector:
 [1] 2 1 1 2 1 2 2 1 1 2

Within cluster sum of squares by cluster:
[1]  506.0 1408.8
 (between_SS / total_SS =  85.5 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>kmeans_3D_1_Result<span class="sc">$</span>centers  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Height Weight  Age
1   71.2  199.6 15.0
2   82.2  265.8 17.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Record_3D_DF, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">by=</span><span class="fu">list</span>(<span class="at">cluster=</span>kmeans_3D_1_Result<span class="sc">$</span>cluster), mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  cluster Height Weight  Age
1       1   71.2  199.6 15.0
2       2   82.2  265.8 17.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compare to the labels</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Record_3D_DF_all<span class="sc">$</span>Label, kmeans_3D_1_Result<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             
              1 2
  BBallPlayer 0 5
  NonPlayer   5 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## This is a confusion matrix with 100% prediction (very rare :)</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(kmeans_3D_1_Result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Length Class  Mode   
cluster      10     -none- numeric
centers       6     -none- numeric
totss         1     -none- numeric
withinss      2     -none- numeric
tot.withinss  1     -none- numeric
betweenss     1     -none- numeric
size          2     -none- numeric
iter          1     -none- numeric
ifault        1     -none- numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## cluster  10  means that there are 10 points all placed</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="do">## into a cluster. In our case, 5 in one and 5 in the other.</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Centers: 6    The 6 means that each of the 2 centers is 3D</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="do">## This is NOT intuitive!!</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="do">## size:  2   for 2 clusters</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="do">## More about the other measures...</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="do">## https://www.datanovia.com/en/lessons/k-means-clustering-in-r-algorith-and-practical-examples/</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Place results in a table with the original data</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(Record_3D_DF_all, <span class="at">cluster =</span> kmeans_3D_1_Result<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Label Height Weight Age cluster
1  BBallPlayer     84    250  17       2
2    NonPlayer     72    200  16       1
3    NonPlayer     70    210  15       1
4  BBallPlayer     86    278  18       2
5    NonPlayer     74    190  15       1
6  BBallPlayer     80    245  16       2
7  BBallPlayer     79    267  19       2
8    NonPlayer     71    187  15       1
9    NonPlayer     69    211  14       1
10 BBallPlayer     82    289  17       2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## See each cluster</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>kmeans_3D_1_Result<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2 1 1 2 1 2 2 1 1 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## This is the size (the number of points in) each cluster</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster size</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>kmeans_3D_1_Result<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Here we have two clusters, each with 5 points (rows/vectors) </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualize the clusters</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(kmeans_3D_1_Result, Record_3D_DF, <span class="at">main=</span><span class="st">"Euclidean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/k%20means-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">##-------------------------------------------------</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="do">## There are other k means options in R</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Let's try amap  Kmeans</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Notice the "K" in Kmeans is cap...</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="do">## k = 2</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="do">##RE:</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="do">## https://rdrr.io/cran/amap/man/Kmeans.html</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="do">##-----------------------------------------------------</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>My_Kmeans_3D_2<span class="ot">&lt;-</span><span class="fu">Kmeans</span>(Record_3D_DF_Norm, <span class="at">centers=</span><span class="dv">2</span> ,<span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(My_Kmeans_3D_2, Record_3D_DF, <span class="at">main=</span><span class="st">"Spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/k%20means-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## k= 3</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>My_Kmeans_3D_3<span class="ot">&lt;-</span><span class="fu">Kmeans</span>(Record_3D_DF_Norm, <span class="at">centers=</span><span class="dv">3</span> ,<span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: empty cluster: try a better set of initial centers</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(My_Kmeans_3D_3, Record_3D_DF, <span class="at">main=</span><span class="st">"Spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/k%20means-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">## k = 2 with Euclidean</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>My_Kmeans_3D_E<span class="ot">&lt;-</span><span class="fu">Kmeans</span>(Record_3D_DF_Norm, <span class="at">centers=</span><span class="dv">2</span> ,<span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(My_Kmeans_3D_E, Record_3D_DF, <span class="at">main=</span><span class="st">"Euclidean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/k%20means-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## k = 3 with Euclidean</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>My_Kmeans_3D_E3<span class="ot">&lt;-</span><span class="fu">Kmeans</span>(Record_3D_DF_Norm, <span class="at">centers=</span><span class="dv">3</span> ,<span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(My_Kmeans_3D_E3, Record_3D_DF, <span class="at">main=</span><span class="st">"Euclidean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/k%20means-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="heat-maps" class="level3">
<h3 class="anchored" data-anchor-id="heat-maps">Heat maps</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Recall that we have Dist2..</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="do">##(Dist2&lt;- dist(Record_3D_DF, method = "minkowski", p=2)) #Euclidean</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dist</span>(Dist2, <span class="at">gradient =</span> <span class="fu">list</span>(<span class="at">low =</span> <span class="st">"#00AFBB"</span>, </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#FC4E07"</span>))<span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Euclidean Heatmap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compare to clusters...</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(Record_3D_DF_all, <span class="at">cluster =</span> kmeans_3D_1_Result<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Label Height Weight Age cluster
1  BBallPlayer     84    250  17       2
2    NonPlayer     72    200  16       1
3    NonPlayer     70    210  15       1
4  BBallPlayer     86    278  18       2
5    NonPlayer     74    190  15       1
6  BBallPlayer     80    245  16       2
7  BBallPlayer     79    267  19       2
8    NonPlayer     71    187  15       1
9    NonPlayer     69    211  14       1
10 BBallPlayer     82    289  17       2</code></pre>
</div>
</div>
</section>
</section>
<section id="hierarchical-clustering" class="level1">
<h1>Hierarchical Clustering</h1>
<p>Hierarchical clustering with Ward</p>
<p>[https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/hclust]</p>
<ul>
<li>“ward.D2” = Ward’s minimum variance method - however dissimilarities are <strong>squared</strong> before clustering.</li>
<li>“single” = Nearest neighbours method.</li>
<li>“complete” = distance between two clusters is defined as the maximum distance between an observation in one.</li>
</ul>
<p>For <code>hclust</code>, you need a distance matrix You can create any distance matrix you wish…</p>
<p>[https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/hclust]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example:</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>(Dist_norm_M2<span class="ot">&lt;-</span> <span class="fu">dist</span>(Record_3D_DF_Norm, <span class="at">method =</span> <span class="st">"minkowski"</span>, <span class="at">p=</span><span class="dv">2</span>)) <span class="co">#Euclidean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           1         2         3         4         5         6         7
2  0.8823617                                                            
3  0.9959858 0.2518978                                                  
4  0.3594391 1.1928855 1.3000991                                        
5  0.9230610 0.2518978 0.3062843 1.2659380                              
6  0.3126759 0.6450504 0.7097633 0.6238900 0.6747748                    
7  0.5237203 0.9803157 1.1102074 0.4702981 1.1385878 0.6402974          
8  1.0612554 0.2443439 0.2330366 1.3908597 0.1789048 0.8022556 1.2151548
9  1.1334639 0.4503021 0.2087015 1.4392598 0.4109656 0.8305397 1.2835277
10 0.4000433 1.0711501 1.1216663 0.3270986 1.1504324 0.4898195 0.4875063
           8         9
2                     
3                     
4                     
5                     
6                     
7                     
8                     
9  0.3304605          
10 1.2564574 1.2367498</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Now run hclust...you may use many methods - Ward, Ward.D2, complete, etc..</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="do">## see above</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>(HClust_Ward_Euc_N_3D <span class="ot">&lt;-</span> <span class="fu">hclust</span>(Dist_norm_M2, <span class="at">method =</span> <span class="st">"average"</span> ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
hclust(d = Dist_norm_M2, method = "average")

Cluster method   : average 
Distance         : minkowski 
Number of objects: 10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(HClust_Ward_Euc_N_3D, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">hang=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">main =</span> <span class="st">"Minkowski p=2 (Euclidean)"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(HClust_Ward_Euc_N_3D, <span class="at">k=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/hierarch%20clust%20ex1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Using Man with Ward.D2..............................</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>dist_C <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">dist</span>(Record_3D_DF_Norm, <span class="at">method=</span><span class="st">"manhattan"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>HClust_Ward_CosSim_N_3D <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_C, <span class="at">method=</span><span class="st">"ward.D2"</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(HClust_Ward_CosSim_N_3D, <span class="at">cex=</span>.<span class="dv">7</span>, <span class="at">hang=</span><span class="sc">-</span><span class="dv">30</span>,<span class="at">main =</span> <span class="st">"Manhattan"</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(HClust_Ward_CosSim_N_3D, <span class="at">k=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/hierarch%20clust%20ex1-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">## --------------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="testing---which-methods-to-use" class="level2">
<h2 class="anchored" data-anchor-id="testing---which-methods-to-use">TESTING - Which methods to use??</h2>
<p>Method with stronger clustering structures??</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(purrr)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("cluster")</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(cluster)</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(methods) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="do">####### ----&gt;  function to compute coefficient-------</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>MethodMeasures <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  cluster<span class="sc">::</span><span class="fu">agnes</span>(Record_3D_DF_Norm, <span class="at">method =</span> x)<span class="sc">$</span>ac</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="co"># The agnes() function will get the agglomerative coefficient (AC), </span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="co"># which measures the amount of clustering structure found.</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Get agglomerative coefficient for each linkage method</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>(purrr<span class="sc">::</span><span class="fu">map_dbl</span>(methods, MethodMeasures))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  average    single  complete      ward 
0.7358124 0.5706686 0.8058609 0.8771530 </code></pre>
</div>
</div>
<p>Looks like ward is best……………….</p>
<p>RE: [http://web.mit.edu/~r/current/arch/i386_linux26/lib/R/library/stats/html/hclust.html]</p>
</section>
</section>
<section id="clustering-text-data-from-a-corpus" class="level1">
<h1>Clustering Text Data from a Corpus</h1>
<p>Let’s start small first and use a small corpus so we can see and understand the results. Then, we will cluster novels to see if they cluster by writer…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tm)</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># #install.packages("tm")</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(stringr)</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(wordcloud)</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># library(SnowballC)</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co"># library(caTools)</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co"># library(dplyr)</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co"># library(textstem)  ## Needed for lemmatize_strings</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Next, load in the documents ( from the corpus)</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>SmallCorpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">DirSource</span>(<span class="st">"Corpus"</span>))  <span class="co">#JK Note: changed "SmallCorpus" to "Corpus"</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>(<span class="fu">getTransformations</span>()) <span class="do">## These work with library tm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "removeNumbers"     "removePunctuation" "removeWords"      
[4] "stemDocument"      "stripWhitespace"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>(ndocs<span class="ot">&lt;-</span><span class="fu">length</span>(SmallCorpus))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Do some clean-up.............</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>SmallCorpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(SmallCorpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>SmallCorpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(SmallCorpus, removePunctuation)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Remove all Stop Words</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>SmallCorpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(SmallCorpus, removeWords, <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="do">## You can also remove words that you do not want</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co">#MyStopWords &lt;- c("and","like", "very", "can", "I", "also", "lot")</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co">#SmallCorpus &lt;- tm_map(SmallCorpus, removeWords, MyStopWords)</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>SmallCorpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(SmallCorpus, lemmatize_strings)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="do">##-------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Convert to Document Term Matrix and TERM document matrix. Each has its own purpose.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## DOCUMENT Term Matrix  (Docs are rows)</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>SmallCorpus_DTM <span class="ot">&lt;-</span> <span class="fu">DocumentTermMatrix</span>(SmallCorpus,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">stopwords =</span> <span class="cn">TRUE</span>, <span class="do">## remove normal stopwords</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">wordLengths=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>), <span class="do">## get rid of words of len 2 or smaller or larger than 15</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">removePunctuation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">removeNumbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">tolower=</span><span class="cn">TRUE</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>                                        <span class="co">#stemming = TRUE,</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>                                      ))</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(SmallCorpus_DTM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;DocumentTermMatrix (documents: 13, terms: 67)&gt;&gt;
Non-/sparse entries: 122/749
Sparsity           : 86%
Maximal term length: 10
Weighting          : term frequency (tf)
Sample             :
               Terms
Docs            can chocolate coffee delicious dog fun good hike like mountain
  Choc3.txt       0         3      1         2   0   0    0    0    1        0
  Choc4.txt       0         4      0         0   0   0    4    0    1        0
  Choc5.txt       1         2      3         0   0   0    1    0    1        0
  Dog1.txt        3         0      0         0   4   1    1    0    1        0
  Dog2.txt        2         0      0         0   4   0    1    0    0        0
  Hike_dog.txt    1         0      0         0   2   0    0    4    0        0
  Hike_dog2.txt   0         0      0         0   2   0    4    3    0        0
  Hike2.txt       0         0      0         0   0   2    1    1    1        2
  Hike3.txt       0         0      0         0   0   2    2    2    1        2
  Hike4.txt       0         0      0         0   2   0    0    3    0        2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## TERM Document Matrix  (words are rows)</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>SmallCorpus_TERM_DM <span class="ot">&lt;-</span> <span class="fu">TermDocumentMatrix</span>(SmallCorpus,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">stopwords =</span> <span class="cn">TRUE</span>, <span class="do">## remove normal stopwords</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">wordLengths=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">10</span>), <span class="do">## get rid of words of len 2 or smaller or larger than 15</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">removePunctuation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">removeNumbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">tolower=</span><span class="cn">TRUE</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>                                            <span class="co">#stemming = TRUE,</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>                                          ))</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(SmallCorpus_TERM_DM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;TermDocumentMatrix (terms: 67, documents: 13)&gt;&gt;
Non-/sparse entries: 122/749
Sparsity           : 86%
Maximal term length: 10
Weighting          : term frequency (tf)
Sample             :
           Docs
Terms       Choc3.txt Choc4.txt Choc5.txt Dog1.txt Dog2.txt Hike_dog.txt
  can               0         0         1        3        2            1
  chocolate         3         4         2        0        0            0
  coffee            1         0         3        0        0            0
  delicious         2         0         0        0        0            0
  dog               0         0         0        4        4            2
  fun               0         0         0        1        0            0
  good              0         4         1        1        1            0
  hike              0         0         0        0        0            4
  like              1         1         1        1        0            0
  mountain          0         0         0        0        0            0
           Docs
Terms       Hike_dog2.txt Hike2.txt Hike3.txt Hike4.txt
  can                   0         0         0         0
  chocolate             0         0         0         0
  coffee                0         0         0         0
  delicious             0         0         0         0
  dog                   2         0         0         2
  fun                   0         2         2         0
  good                  4         1         2         0
  hike                  3         1         2         3
  like                  0         1         1         0
  mountain              0         2         2         2</code></pre>
</div>
</div>
<section id="formats-matter" class="level2">
<h2 class="anchored" data-anchor-id="formats-matter">Formats matter!</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">###-----------------------</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert to DF </span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="do">##------------------------</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">inspect</span>(SmallCorpus_DTM))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;DocumentTermMatrix (documents: 13, terms: 67)&gt;&gt;
Non-/sparse entries: 122/749
Sparsity           : 86%
Maximal term length: 10
Weighting          : term frequency (tf)
Sample             :
               Terms
Docs            can chocolate coffee delicious dog fun good hike like mountain
  Choc3.txt       0         3      1         2   0   0    0    0    1        0
  Choc4.txt       0         4      0         0   0   0    4    0    1        0
  Choc5.txt       1         2      3         0   0   0    1    0    1        0
  Dog1.txt        3         0      0         0   4   1    1    0    1        0
  Dog2.txt        2         0      0         0   4   0    1    0    0        0
  Hike_dog.txt    1         0      0         0   2   0    0    4    0        0
  Hike_dog2.txt   0         0      0         0   2   0    4    3    0        0
  Hike2.txt       0         0      0         0   0   2    1    1    1        2
  Hike3.txt       0         0      0         0   0   2    2    2    1        2
  Hike4.txt       0         0      0         0   2   0    0    3    0        2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>               Terms
Docs            can chocolate coffee delicious dog fun good hike like mountain
  Choc3.txt       0         3      1         2   0   0    0    0    1        0
  Choc4.txt       0         4      0         0   0   0    4    0    1        0
  Choc5.txt       1         2      3         0   0   0    1    0    1        0
  Dog1.txt        3         0      0         0   4   1    1    0    1        0
  Dog2.txt        2         0      0         0   4   0    1    0    0        0
  Hike_dog.txt    1         0      0         0   2   0    0    4    0        0
  Hike_dog2.txt   0         0      0         0   2   0    4    3    0        0
  Hike2.txt       0         0      0         0   0   2    1    1    1        2
  Hike3.txt       0         0      0         0   0   2    2    2    1        2
  Hike4.txt       0         0      0         0   2   0    0    3    0        2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>SmallCorpus_DF_DT <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(SmallCorpus_DTM))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>(<span class="fu">inspect</span>(SmallCorpus_TERM_DM))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;TermDocumentMatrix (terms: 67, documents: 13)&gt;&gt;
Non-/sparse entries: 122/749
Sparsity           : 86%
Maximal term length: 10
Weighting          : term frequency (tf)
Sample             :
           Docs
Terms       Choc3.txt Choc4.txt Choc5.txt Dog1.txt Dog2.txt Hike_dog.txt
  can               0         0         1        3        2            1
  chocolate         3         4         2        0        0            0
  coffee            1         0         3        0        0            0
  delicious         2         0         0        0        0            0
  dog               0         0         0        4        4            2
  fun               0         0         0        1        0            0
  good              0         4         1        1        1            0
  hike              0         0         0        0        0            4
  like              1         1         1        1        0            0
  mountain          0         0         0        0        0            0
           Docs
Terms       Hike_dog2.txt Hike2.txt Hike3.txt Hike4.txt
  can                   0         0         0         0
  chocolate             0         0         0         0
  coffee                0         0         0         0
  delicious             0         0         0         0
  dog                   2         0         0         2
  fun                   0         2         2         0
  good                  4         1         2         0
  hike                  3         1         2         3
  like                  0         1         1         0
  mountain              0         2         2         2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>           Docs
Terms       Choc3.txt Choc4.txt Choc5.txt Dog1.txt Dog2.txt Hike_dog.txt
  can               0         0         1        3        2            1
  chocolate         3         4         2        0        0            0
  coffee            1         0         3        0        0            0
  delicious         2         0         0        0        0            0
  dog               0         0         0        4        4            2
  fun               0         0         0        1        0            0
  good              0         4         1        1        1            0
  hike              0         0         0        0        0            4
  like              1         1         1        1        0            0
  mountain          0         0         0        0        0            0
           Docs
Terms       Hike_dog2.txt Hike2.txt Hike3.txt Hike4.txt
  can                   0         0         0         0
  chocolate             0         0         0         0
  coffee                0         0         0         0
  delicious             0         0         0         0
  dog                   2         0         0         2
  fun                   0         2         2         0
  good                  4         1         2         0
  hike                  3         1         2         3
  like                  0         1         1         0
  mountain              0         2         2         2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>SmallCorpus_DF_TermDoc <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(SmallCorpus_TERM_DM))</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="do">############ Data frames are useful in R</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>SmallCorpus_DF_DT<span class="sc">$</span>chocolate   <span class="do">## Num of times "chocolate" occurs in each of the 12 docs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 3 2 3 4 2 0 0 0 0 0 0 0 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="do">##--------------------</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="do">## COnvert to matrix </span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>SC_DTM_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(SmallCorpus_DTM)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>(SC_DTM_mat[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Terms
Docs            chocolate coffee day delicious eat great together healthy like
  Choc1.txt             3      1   1         2   1     0        0       0    0
  Choc2.txt             2      2   0         1   0     2        1       0    0
  Choc3.txt             3      1   0         2   0     0        0       2    1
  Choc4.txt             4      0   1         0   1     0        0       0    1
  Choc5.txt             2      3   0         0   1     0        1       0    1
  Dog1.txt              0      0   0         0   1     0        0       0    1
  Dog2.txt              0      0   0         0   0     0        0       0    0
  Hike_dog.txt          0      0   0         0   0     0        0       0    0
  Hike_dog2.txt         0      0   0         0   0     0        0       0    0
  Hike1.txt             0      0   0         0   0     0        0       0    0
  Hike2.txt             0      0   0         0   0     0        0       0    1
  Hike3.txt             0      0   0         0   0     0        0       0    1
               Terms
Docs            almond
  Choc1.txt          0
  Choc2.txt          0
  Choc3.txt          0
  Choc4.txt          3
  Choc5.txt          0
  Dog1.txt           0
  Dog2.txt           0
  Hike_dog.txt       0
  Hike_dog2.txt      0
  Hike1.txt          0
  Hike2.txt          0
  Hike3.txt          0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>SC_TERM_Doc_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(SmallCorpus_TERM_DM)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>(SC_TERM_Doc_mat[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Docs
Terms       Choc1.txt Choc2.txt Choc3.txt Choc4.txt Choc5.txt Dog1.txt Dog2.txt
  chocolate         3         2         3         4         2        0        0
  coffee            1         2         1         0         3        0        0
  day               1         0         0         1         0        0        0
  delicious         2         1         2         0         0        0        0
  eat               1         0         0         1         1        1        0
  great             0         2         0         0         0        0        0
  together          0         1         0         0         1        0        0
  healthy           0         0         2         0         0        0        0
  like              0         0         1         1         1        1        0
  almond            0         0         0         3         0        0        0
  also              0         0         0         1         0        0        1
  cake              0         0         0         1         1        0        0
           Docs
Terms       Hike_dog.txt Hike_dog2.txt Hike1.txt
  chocolate            0             0         0
  coffee               0             0         0
  day                  0             0         0
  delicious            0             0         0
  eat                  0             0         0
  great                0             0         0
  together             0             0         0
  healthy              0             0         0
  like                 0             0         0
  almond               0             0         0
  also                 0             0         0
  cake                 0             0         0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="do">## WORDCLOUD ##_---------------------------------------</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>word.freq <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rowSums</span>(SC_TERM_Doc_mat), <span class="at">decreasing =</span> T)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(<span class="at">words =</span> <span class="fu">names</span>(word.freq), <span class="at">freq =</span> word.freq<span class="sc">*</span><span class="dv">2</span>, <span class="at">min.freq =</span> <span class="dv">2</span>,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">random.order =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/converting%20formats-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Get Frequencies and sums</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>(SmallCorpusWordFreq <span class="ot">&lt;-</span> <span class="fu">colSums</span>(SC_DTM_mat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chocolate     coffee        day  delicious        eat      great   together 
        14          7          2          5          4          2          2 
   healthy       like     almond       also       cake       dark      every 
         2          6          3          4          2          1          1 
everything       good       make      yummy        can       milk        one 
         1         16          1          1          7          1          1 
       soy     danger        dog       fall        fun       help       jump 
         1          1         14          1          5          1          2 
      pick       poop    protect        run     stinky      thing       time 
         1          1          1          4          1          1          1 
       bed        cat      couch  different   fairness     feline       hide 
         1          3          1          1          1          1          1 
      home   intruder       just        lot       much       play   probably 
         1          1          1          3          1          1          1 
    rather      since        sit      sleep     unlike    usually       will 
         1          1          1          2          1          1          1 
      gear        get       hike       need   exercise       take      climb 
         5          1         15          1          2          2          2 
  colorado    iceland   mountain switerland 
         2          2          6          2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Order and sum..</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>(<span class="fu">head</span>(SmallCorpusWordFreq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>chocolate    coffee       day delicious       eat     great 
       14         7         2         5         4         2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">length</span>(SmallCorpusWordFreq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>ord <span class="ot">&lt;-</span> <span class="fu">order</span>(SmallCorpusWordFreq)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>(SmallCorpusWordFreq[<span class="fu">head</span>(ord)]) <span class="do">## least frequent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      dark      every everything       make      yummy       milk 
         1          1          1          1          1          1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>(SmallCorpusWordFreq[<span class="fu">tail</span>(ord)])  <span class="do">## most frequent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   coffee       can chocolate       dog      hike      good 
        7         7        14        14        15        16 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Row Sums</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>(Row_Sum_Per_doc <span class="ot">&lt;-</span> <span class="fu">rowSums</span>((SC_DTM_mat)))  <span class="do">## total words in each row (doc)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Choc1.txt     Choc2.txt     Choc3.txt     Choc4.txt     Choc5.txt 
            8             8             9            21            14 
     Dog1.txt      Dog2.txt  Hike_dog.txt Hike_dog2.txt     Hike1.txt 
           23            37            11            10             7 
    Hike2.txt     Hike3.txt     Hike4.txt 
           12            14            10 </code></pre>
</div>
</div>
<p>Create your own normalization function to divide the frequency of each word in each row by the sum of the words in that row.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>SC_DTM_mat_norm <span class="ot">&lt;-</span> <span class="fu">apply</span>(SC_DTM_mat, <span class="dv">1</span>, <span class="cf">function</span>(i) <span class="fu">round</span>(i<span class="sc">/</span><span class="fu">sum</span>(i),<span class="dv">2</span>))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>(SC_DTM_mat_norm[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Docs
Terms       Choc1.txt Choc2.txt Choc3.txt Choc4.txt Choc5.txt
  chocolate      0.38      0.25      0.33      0.19      0.14
  coffee         0.12      0.25      0.11      0.00      0.21
  day            0.12      0.00      0.00      0.05      0.00
  delicious      0.25      0.12      0.22      0.00      0.00
  eat            0.12      0.00      0.00      0.05      0.07
  great          0.00      0.25      0.00      0.00      0.00
  together       0.00      0.12      0.00      0.00      0.07
  healthy        0.00      0.00      0.22      0.00      0.00
  like           0.00      0.00      0.11      0.05      0.07
  almond         0.00      0.00      0.00      0.14      0.00
  also           0.00      0.00      0.00      0.05      0.00
  cake           0.00      0.00      0.00      0.05      0.07</code></pre>
</div>
</div>
</section>
</section>
<section id="clustering-text-docs" class="level1">
<h1>Clustering Text Docs</h1>
<section id="k-means-and-hclust" class="level2">
<h2 class="anchored" data-anchor-id="k-means-and-hclust">k means and hclust</h2>
<p>We have many formats of our data. - We have a normalized DTM: <code>SC_DTM_mat_norm</code> - We have data frames: <code>SmallCorpus_DF_DT</code> and <code>SmallCorpus_DF_TermDoc</code> - We have the Term Doc Matrix… <code>SC_TERM_Doc_mat</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="do">## k means - HOW MANY Clusters?</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(SmallCorpus_DF_DT, <span class="at">method =</span> <span class="st">"silhouette"</span>, </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">FUN =</span> hcut, <span class="at">k.max =</span> <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/det%20k-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="k-means.on-documents" class="level2">
<h2 class="anchored" data-anchor-id="k-means.on-documents">k means………….on documents…………</h2>
<p>transpose the matrix to look at similarity between documents</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>SC_DTM_mat_norm_t<span class="ot">&lt;-</span><span class="fu">t</span>(SC_DTM_mat_norm)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>kmeans_smallcorp_Result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(SC_DTM_mat_norm_t, <span class="dv">4</span>, <span class="at">nstart=</span><span class="dv">25</span>)   </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(kmeans_smallcorp_Result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 4 clusters of sizes 6, 2, 2, 3

Cluster means:
  chocolate coffee         day delicious        eat      great   together
1     0.055  0.035 0.008333333 0.0000000 0.02666667 0.00000000 0.01166667
2     0.000  0.000 0.000000000 0.0000000 0.00000000 0.00000000 0.00000000
3     0.000  0.000 0.000000000 0.0000000 0.00000000 0.00000000 0.00000000
4     0.320  0.160 0.040000000 0.1966667 0.04000000 0.08333333 0.04000000
     healthy       like     almond       also cake        dark       every
1 0.00000000 0.05166667 0.02333333 0.03833333 0.02 0.008333333 0.008333333
2 0.00000000 0.00000000 0.00000000 0.00000000 0.00 0.000000000 0.000000000
3 0.00000000 0.00000000 0.00000000 0.00000000 0.00 0.000000000 0.000000000
4 0.07333333 0.03666667 0.00000000 0.00000000 0.00 0.000000000 0.000000000
   everything       good        make       yummy        can       milk
1 0.008333333 0.09166667 0.008333333 0.008333333 0.04166667 0.01166667
2 0.000000000 0.00000000 0.000000000 0.000000000 0.04500000 0.00000000
3 0.000000000 0.34500000 0.000000000 0.000000000 0.00000000 0.00000000
4 0.000000000 0.00000000 0.000000000 0.000000000 0.00000000 0.00000000
         one        soy      danger        dog        fall        fun
1 0.01166667 0.01166667 0.006666667 0.04666667 0.006666667 0.05833333
2 0.00000000 0.00000000 0.000000000 0.19000000 0.000000000 0.00000000
3 0.00000000 0.00000000 0.000000000 0.10000000 0.000000000 0.00000000
4 0.00000000 0.00000000 0.000000000 0.00000000 0.000000000 0.00000000
         help       jump        pick        poop     protect        run
1 0.006666667 0.01166667 0.006666667 0.006666667 0.006666667 0.02333333
2 0.000000000 0.00000000 0.000000000 0.000000000 0.000000000 0.00000000
3 0.000000000 0.00000000 0.000000000 0.000000000 0.000000000 0.00000000
4 0.000000000 0.00000000 0.000000000 0.000000000 0.000000000 0.00000000
       stinky       thing        time   bed        cat couch different fairness
1 0.006666667 0.006666667 0.006666667 0.005 0.01333333 0.005     0.005    0.005
2 0.000000000 0.000000000 0.000000000 0.000 0.00000000 0.000     0.000    0.000
3 0.000000000 0.000000000 0.000000000 0.000 0.00000000 0.000     0.000    0.000
4 0.000000000 0.000000000 0.000000000 0.000 0.00000000 0.000     0.000    0.000
  feline  hide  home intruder  just        lot  much  play probably rather
1  0.005 0.005 0.005    0.005 0.005 0.01333333 0.005 0.005    0.005  0.005
2  0.000 0.000 0.000    0.000 0.000 0.00000000 0.000 0.000    0.000  0.000
3  0.000 0.000 0.000    0.000 0.000 0.00000000 0.000 0.000    0.000  0.000
4  0.000 0.000 0.000    0.000 0.000 0.00000000 0.000 0.000    0.000  0.000
  since   sit       sleep unlike usually  will gear   get       hike  need
1 0.005 0.005 0.008333333  0.005   0.005 0.005 0.00 0.000 0.03666667 0.000
2 0.000 0.000 0.000000000  0.000   0.000 0.000 0.19 0.045 0.33000000 0.045
3 0.000 0.000 0.000000000  0.000   0.000 0.000 0.05 0.000 0.29500000 0.000
4 0.000 0.000 0.000000000  0.000   0.000 0.000 0.00 0.000 0.00000000 0.000
  exercise take climb colorado iceland   mountain switerland
1    0.000 0.00 0.025    0.025   0.025 0.05166667      0.025
2    0.000 0.05 0.000    0.000   0.000 0.10000000      0.000
3    0.145 0.07 0.000    0.000   0.000 0.00000000      0.000
4    0.000 0.00 0.000    0.000   0.000 0.00000000      0.000

Clustering vector:
    Choc1.txt     Choc2.txt     Choc3.txt     Choc4.txt     Choc5.txt 
            4             4             4             1             1 
     Dog1.txt      Dog2.txt  Hike_dog.txt Hike_dog2.txt     Hike1.txt 
            1             1             2             3             3 
    Hike2.txt     Hike3.txt     Hike4.txt 
            1             1             2 

Within cluster sum of squares by cluster:
[1] 0.3578333 0.0393500 0.0829500 0.1408667
 (between_SS / total_SS =  61.7 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>kmeans_smallcorp_Result<span class="sc">$</span>centers  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  chocolate coffee         day delicious        eat      great   together
1     0.055  0.035 0.008333333 0.0000000 0.02666667 0.00000000 0.01166667
2     0.000  0.000 0.000000000 0.0000000 0.00000000 0.00000000 0.00000000
3     0.000  0.000 0.000000000 0.0000000 0.00000000 0.00000000 0.00000000
4     0.320  0.160 0.040000000 0.1966667 0.04000000 0.08333333 0.04000000
     healthy       like     almond       also cake        dark       every
1 0.00000000 0.05166667 0.02333333 0.03833333 0.02 0.008333333 0.008333333
2 0.00000000 0.00000000 0.00000000 0.00000000 0.00 0.000000000 0.000000000
3 0.00000000 0.00000000 0.00000000 0.00000000 0.00 0.000000000 0.000000000
4 0.07333333 0.03666667 0.00000000 0.00000000 0.00 0.000000000 0.000000000
   everything       good        make       yummy        can       milk
1 0.008333333 0.09166667 0.008333333 0.008333333 0.04166667 0.01166667
2 0.000000000 0.00000000 0.000000000 0.000000000 0.04500000 0.00000000
3 0.000000000 0.34500000 0.000000000 0.000000000 0.00000000 0.00000000
4 0.000000000 0.00000000 0.000000000 0.000000000 0.00000000 0.00000000
         one        soy      danger        dog        fall        fun
1 0.01166667 0.01166667 0.006666667 0.04666667 0.006666667 0.05833333
2 0.00000000 0.00000000 0.000000000 0.19000000 0.000000000 0.00000000
3 0.00000000 0.00000000 0.000000000 0.10000000 0.000000000 0.00000000
4 0.00000000 0.00000000 0.000000000 0.00000000 0.000000000 0.00000000
         help       jump        pick        poop     protect        run
1 0.006666667 0.01166667 0.006666667 0.006666667 0.006666667 0.02333333
2 0.000000000 0.00000000 0.000000000 0.000000000 0.000000000 0.00000000
3 0.000000000 0.00000000 0.000000000 0.000000000 0.000000000 0.00000000
4 0.000000000 0.00000000 0.000000000 0.000000000 0.000000000 0.00000000
       stinky       thing        time   bed        cat couch different fairness
1 0.006666667 0.006666667 0.006666667 0.005 0.01333333 0.005     0.005    0.005
2 0.000000000 0.000000000 0.000000000 0.000 0.00000000 0.000     0.000    0.000
3 0.000000000 0.000000000 0.000000000 0.000 0.00000000 0.000     0.000    0.000
4 0.000000000 0.000000000 0.000000000 0.000 0.00000000 0.000     0.000    0.000
  feline  hide  home intruder  just        lot  much  play probably rather
1  0.005 0.005 0.005    0.005 0.005 0.01333333 0.005 0.005    0.005  0.005
2  0.000 0.000 0.000    0.000 0.000 0.00000000 0.000 0.000    0.000  0.000
3  0.000 0.000 0.000    0.000 0.000 0.00000000 0.000 0.000    0.000  0.000
4  0.000 0.000 0.000    0.000 0.000 0.00000000 0.000 0.000    0.000  0.000
  since   sit       sleep unlike usually  will gear   get       hike  need
1 0.005 0.005 0.008333333  0.005   0.005 0.005 0.00 0.000 0.03666667 0.000
2 0.000 0.000 0.000000000  0.000   0.000 0.000 0.19 0.045 0.33000000 0.045
3 0.000 0.000 0.000000000  0.000   0.000 0.000 0.05 0.000 0.29500000 0.000
4 0.000 0.000 0.000000000  0.000   0.000 0.000 0.00 0.000 0.00000000 0.000
  exercise take climb colorado iceland   mountain switerland
1    0.000 0.00 0.025    0.025   0.025 0.05166667      0.025
2    0.000 0.05 0.000    0.000   0.000 0.10000000      0.000
3    0.145 0.07 0.000    0.000   0.000 0.00000000      0.000
4    0.000 0.00 0.000    0.000   0.000 0.00000000      0.000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Place results in a tbale with the original data</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(SmallCorpus_DF_DT, <span class="at">cluster =</span> kmeans_smallcorp_Result<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              chocolate coffee day delicious eat great together healthy like
Choc1.txt             3      1   1         2   1     0        0       0    0
Choc2.txt             2      2   0         1   0     2        1       0    0
Choc3.txt             3      1   0         2   0     0        0       2    1
Choc4.txt             4      0   1         0   1     0        0       0    1
Choc5.txt             2      3   0         0   1     0        1       0    1
Dog1.txt              0      0   0         0   1     0        0       0    1
Dog2.txt              0      0   0         0   0     0        0       0    0
Hike_dog.txt          0      0   0         0   0     0        0       0    0
Hike_dog2.txt         0      0   0         0   0     0        0       0    0
Hike1.txt             0      0   0         0   0     0        0       0    0
Hike2.txt             0      0   0         0   0     0        0       0    1
Hike3.txt             0      0   0         0   0     0        0       0    1
Hike4.txt             0      0   0         0   0     0        0       0    0
              almond also cake dark every everything good make yummy can milk
Choc1.txt          0    0    0    0     0          0    0    0     0   0    0
Choc2.txt          0    0    0    0     0          0    0    0     0   0    0
Choc3.txt          0    0    0    0     0          0    0    0     0   0    0
Choc4.txt          3    1    1    1     1          1    4    1     1   0    0
Choc5.txt          0    0    1    0     0          0    1    0     0   1    1
Dog1.txt           0    0    0    0     0          0    1    0     0   3    0
Dog2.txt           0    1    0    0     0          0    1    0     0   2    0
Hike_dog.txt       0    0    0    0     0          0    0    0     0   1    0
Hike_dog2.txt      0    0    0    0     0          0    4    0     0   0    0
Hike1.txt          0    0    0    0     0          0    2    0     0   0    0
Hike2.txt          0    1    0    0     0          0    1    0     0   0    0
Hike3.txt          0    1    0    0     0          0    2    0     0   0    0
Hike4.txt          0    0    0    0     0          0    0    0     0   0    0
              one soy danger dog fall fun help jump pick poop protect run
Choc1.txt       0   0      0   0    0   0    0    0    0    0       0   0
Choc2.txt       0   0      0   0    0   0    0    0    0    0       0   0
Choc3.txt       0   0      0   0    0   0    0    0    0    0       0   0
Choc4.txt       0   0      0   0    0   0    0    0    0    0       0   0
Choc5.txt       1   1      0   0    0   0    0    0    0    0       0   0
Dog1.txt        0   0      1   4    1   1    1    1    1    1       1   2
Dog2.txt        0   0      0   4    0   0    0    1    0    0       0   2
Hike_dog.txt    0   0      0   2    0   0    0    0    0    0       0   0
Hike_dog2.txt   0   0      0   2    0   0    0    0    0    0       0   0
Hike1.txt       0   0      0   0    0   0    0    0    0    0       0   0
Hike2.txt       0   0      0   0    0   2    0    0    0    0       0   0
Hike3.txt       0   0      0   0    0   2    0    0    0    0       0   0
Hike4.txt       0   0      0   2    0   0    0    0    0    0       0   0
              stinky thing time bed cat couch different fairness feline hide
Choc1.txt          0     0    0   0   0     0         0        0      0    0
Choc2.txt          0     0    0   0   0     0         0        0      0    0
Choc3.txt          0     0    0   0   0     0         0        0      0    0
Choc4.txt          0     0    0   0   0     0         0        0      0    0
Choc5.txt          0     0    0   0   0     0         0        0      0    0
Dog1.txt           1     1    1   0   0     0         0        0      0    0
Dog2.txt           0     0    0   1   3     1         1        1      1    1
Hike_dog.txt       0     0    0   0   0     0         0        0      0    0
Hike_dog2.txt      0     0    0   0   0     0         0        0      0    0
Hike1.txt          0     0    0   0   0     0         0        0      0    0
Hike2.txt          0     0    0   0   0     0         0        0      0    0
Hike3.txt          0     0    0   0   0     0         0        0      0    0
Hike4.txt          0     0    0   0   0     0         0        0      0    0
              home intruder just lot much play probably rather since sit sleep
Choc1.txt        0        0    0   0    0    0        0      0     0   0     0
Choc2.txt        0        0    0   0    0    0        0      0     0   0     0
Choc3.txt        0        0    0   0    0    0        0      0     0   0     0
Choc4.txt        0        0    0   0    0    0        0      0     0   0     0
Choc5.txt        0        0    0   0    0    0        0      0     0   0     0
Dog1.txt         0        0    0   0    0    0        0      0     0   0     0
Dog2.txt         1        1    1   3    1    1        1      1     1   1     2
Hike_dog.txt     0        0    0   0    0    0        0      0     0   0     0
Hike_dog2.txt    0        0    0   0    0    0        0      0     0   0     0
Hike1.txt        0        0    0   0    0    0        0      0     0   0     0
Hike2.txt        0        0    0   0    0    0        0      0     0   0     0
Hike3.txt        0        0    0   0    0    0        0      0     0   0     0
Hike4.txt        0        0    0   0    0    0        0      0     0   0     0
              unlike usually will gear get hike need exercise take climb
Choc1.txt          0       0    0    0   0    0    0        0    0     0
Choc2.txt          0       0    0    0   0    0    0        0    0     0
Choc3.txt          0       0    0    0   0    0    0        0    0     0
Choc4.txt          0       0    0    0   0    0    0        0    0     0
Choc5.txt          0       0    0    0   0    0    0        0    0     0
Dog1.txt           0       0    0    0   0    0    0        0    0     0
Dog2.txt           1       1    1    0   0    0    0        0    0     0
Hike_dog.txt       0       0    0    2   1    4    1        0    0     0
Hike_dog2.txt      0       0    0    1   0    3    0        0    0     0
Hike1.txt          0       0    0    0   0    2    0        2    1     0
Hike2.txt          0       0    0    0   0    1    0        0    0     1
Hike3.txt          0       0    0    0   0    2    0        0    0     1
Hike4.txt          0       0    0    2   0    3    0        0    1     0
              colorado iceland mountain switerland cluster
Choc1.txt            0       0        0          0       4
Choc2.txt            0       0        0          0       4
Choc3.txt            0       0        0          0       4
Choc4.txt            0       0        0          0       1
Choc5.txt            0       0        0          0       1
Dog1.txt             0       0        0          0       1
Dog2.txt             0       0        0          0       1
Hike_dog.txt         0       0        0          0       2
Hike_dog2.txt        0       0        0          0       3
Hike1.txt            0       0        0          0       3
Hike2.txt            1       1        2          1       1
Hike3.txt            1       1        2          1       1
Hike4.txt            0       0        2          0       2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="do">## See each cluster</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>kmeans_smallcorp_Result<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Choc1.txt     Choc2.txt     Choc3.txt     Choc4.txt     Choc5.txt 
            4             4             4             1             1 
     Dog1.txt      Dog2.txt  Hike_dog.txt Hike_dog2.txt     Hike1.txt 
            1             1             2             3             3 
    Hike2.txt     Hike3.txt     Hike4.txt 
            1             1             2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="do">## This is the size (the number of points in) each cluster</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster size</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>kmeans_smallcorp_Result<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6 2 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Here we have two clusters, each with 5 points (rows/vectors) </span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualize the clusters</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(kmeans_smallcorp_Result, SmallCorpus_DF_DT, </span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"Euclidean"</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/results%20table-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="k-means.on-words" class="level2">
<h2 class="anchored" data-anchor-id="k-means.on-words">k means………….on words…………</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kmeans_smallcorp_Result &lt;- kmeans(SC_DTM_mat_norm, 6, nstart=25) </span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>kmeans_smallcorp_Result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="fu">t</span>(SmallCorpus_DF_DT), <span class="dv">5</span>, <span class="at">nstart=</span><span class="dv">4</span>) </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(kmeans_smallcorp_Result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 5 clusters of sizes 39, 3, 2, 21, 2

Cluster means:
  Choc1.txt Choc2.txt Choc3.txt  Choc4.txt Choc5.txt  Dog1.txt  Dog2.txt
1 0.0000000 0.0000000 0.0000000 0.02564103 0.0000000 0.3333333 0.7692308
2 2.0000000 1.6666667 2.0000000 1.33333333 1.6666667 0.0000000 0.0000000
3 0.0000000 0.0000000 0.0000000 2.00000000 0.5000000 0.5000000 0.5000000
4 0.0952381 0.1428571 0.1428571 0.57142857 0.3333333 0.0952381 0.0000000
5 0.0000000 0.0000000 0.0000000 0.00000000 0.5000000 3.5000000 3.0000000
  Hike_dog.txt Hike_dog2.txt Hike1.txt  Hike2.txt  Hike3.txt  Hike4.txt
1    0.0000000    0.00000000 0.0000000 0.23076923 0.23076923 0.05128205
2    0.0000000    0.00000000 0.0000000 0.00000000 0.00000000 0.00000000
3    2.0000000    3.50000000 2.0000000 1.00000000 2.00000000 1.50000000
4    0.1904762    0.04761905 0.1428571 0.04761905 0.04761905 0.14285714
5    1.5000000    1.00000000 0.0000000 0.00000000 0.00000000 1.00000000

Clustering vector:
 chocolate     coffee        day  delicious        eat      great   together 
         2          2          4          2          4          4          4 
   healthy       like     almond       also       cake       dark      every 
         4          4          4          1          4          4          4 
everything       good       make      yummy        can       milk        one 
         4          3          4          4          5          4          4 
       soy     danger        dog       fall        fun       help       jump 
         4          1          5          1          1          1          1 
      pick       poop    protect        run     stinky      thing       time 
         1          1          1          1          1          1          1 
       bed        cat      couch  different   fairness     feline       hide 
         1          1          1          1          1          1          1 
      home   intruder       just        lot       much       play   probably 
         1          1          1          1          1          1          1 
    rather      since        sit      sleep     unlike    usually       will 
         1          1          1          1          1          1          1 
      gear        get       hike       need   exercise       take      climb 
         4          4          3          4          4          4          1 
  colorado    iceland   mountain switerland 
         1          1          1          1 

Within cluster sum of squares by cluster:
[1] 60.30769 20.00000 22.50000 45.80952  7.50000
 (between_SS / total_SS =  49.7 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>kmeans_smallcorp_Result<span class="sc">$</span>centers  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Choc1.txt Choc2.txt Choc3.txt  Choc4.txt Choc5.txt  Dog1.txt  Dog2.txt
1 0.0000000 0.0000000 0.0000000 0.02564103 0.0000000 0.3333333 0.7692308
2 2.0000000 1.6666667 2.0000000 1.33333333 1.6666667 0.0000000 0.0000000
3 0.0000000 0.0000000 0.0000000 2.00000000 0.5000000 0.5000000 0.5000000
4 0.0952381 0.1428571 0.1428571 0.57142857 0.3333333 0.0952381 0.0000000
5 0.0000000 0.0000000 0.0000000 0.00000000 0.5000000 3.5000000 3.0000000
  Hike_dog.txt Hike_dog2.txt Hike1.txt  Hike2.txt  Hike3.txt  Hike4.txt
1    0.0000000    0.00000000 0.0000000 0.23076923 0.23076923 0.05128205
2    0.0000000    0.00000000 0.0000000 0.00000000 0.00000000 0.00000000
3    2.0000000    3.50000000 2.0000000 1.00000000 2.00000000 1.50000000
4    0.1904762    0.04761905 0.1428571 0.04761905 0.04761905 0.14285714
5    1.5000000    1.00000000 0.0000000 0.00000000 0.00000000 1.00000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Place results in a tbale with the original data</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">t</span>(SmallCorpus_DF_DT), <span class="at">cluster =</span> kmeans_smallcorp_Result<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Choc1.txt Choc2.txt Choc3.txt Choc4.txt Choc5.txt Dog1.txt Dog2.txt
chocolate          3         2         3         4         2        0        0
coffee             1         2         1         0         3        0        0
day                1         0         0         1         0        0        0
delicious          2         1         2         0         0        0        0
eat                1         0         0         1         1        1        0
great              0         2         0         0         0        0        0
together           0         1         0         0         1        0        0
healthy            0         0         2         0         0        0        0
like               0         0         1         1         1        1        0
almond             0         0         0         3         0        0        0
also               0         0         0         1         0        0        1
cake               0         0         0         1         1        0        0
dark               0         0         0         1         0        0        0
every              0         0         0         1         0        0        0
everything         0         0         0         1         0        0        0
good               0         0         0         4         1        1        1
make               0         0         0         1         0        0        0
yummy              0         0         0         1         0        0        0
can                0         0         0         0         1        3        2
milk               0         0         0         0         1        0        0
one                0         0         0         0         1        0        0
soy                0         0         0         0         1        0        0
danger             0         0         0         0         0        1        0
dog                0         0         0         0         0        4        4
fall               0         0         0         0         0        1        0
fun                0         0         0         0         0        1        0
help               0         0         0         0         0        1        0
jump               0         0         0         0         0        1        1
pick               0         0         0         0         0        1        0
poop               0         0         0         0         0        1        0
protect            0         0         0         0         0        1        0
run                0         0         0         0         0        2        2
stinky             0         0         0         0         0        1        0
thing              0         0         0         0         0        1        0
time               0         0         0         0         0        1        0
bed                0         0         0         0         0        0        1
cat                0         0         0         0         0        0        3
couch              0         0         0         0         0        0        1
different          0         0         0         0         0        0        1
fairness           0         0         0         0         0        0        1
feline             0         0         0         0         0        0        1
hide               0         0         0         0         0        0        1
home               0         0         0         0         0        0        1
intruder           0         0         0         0         0        0        1
just               0         0         0         0         0        0        1
lot                0         0         0         0         0        0        3
much               0         0         0         0         0        0        1
play               0         0         0         0         0        0        1
probably           0         0         0         0         0        0        1
rather             0         0         0         0         0        0        1
since              0         0         0         0         0        0        1
sit                0         0         0         0         0        0        1
sleep              0         0         0         0         0        0        2
unlike             0         0         0         0         0        0        1
usually            0         0         0         0         0        0        1
will               0         0         0         0         0        0        1
gear               0         0         0         0         0        0        0
get                0         0         0         0         0        0        0
hike               0         0         0         0         0        0        0
need               0         0         0         0         0        0        0
exercise           0         0         0         0         0        0        0
take               0         0         0         0         0        0        0
climb              0         0         0         0         0        0        0
colorado           0         0         0         0         0        0        0
iceland            0         0         0         0         0        0        0
mountain           0         0         0         0         0        0        0
switerland         0         0         0         0         0        0        0
           Hike_dog.txt Hike_dog2.txt Hike1.txt Hike2.txt Hike3.txt Hike4.txt
chocolate             0             0         0         0         0         0
coffee                0             0         0         0         0         0
day                   0             0         0         0         0         0
delicious             0             0         0         0         0         0
eat                   0             0         0         0         0         0
great                 0             0         0         0         0         0
together              0             0         0         0         0         0
healthy               0             0         0         0         0         0
like                  0             0         0         1         1         0
almond                0             0         0         0         0         0
also                  0             0         0         1         1         0
cake                  0             0         0         0         0         0
dark                  0             0         0         0         0         0
every                 0             0         0         0         0         0
everything            0             0         0         0         0         0
good                  0             4         2         1         2         0
make                  0             0         0         0         0         0
yummy                 0             0         0         0         0         0
can                   1             0         0         0         0         0
milk                  0             0         0         0         0         0
one                   0             0         0         0         0         0
soy                   0             0         0         0         0         0
danger                0             0         0         0         0         0
dog                   2             2         0         0         0         2
fall                  0             0         0         0         0         0
fun                   0             0         0         2         2         0
help                  0             0         0         0         0         0
jump                  0             0         0         0         0         0
pick                  0             0         0         0         0         0
poop                  0             0         0         0         0         0
protect               0             0         0         0         0         0
run                   0             0         0         0         0         0
stinky                0             0         0         0         0         0
thing                 0             0         0         0         0         0
time                  0             0         0         0         0         0
bed                   0             0         0         0         0         0
cat                   0             0         0         0         0         0
couch                 0             0         0         0         0         0
different             0             0         0         0         0         0
fairness              0             0         0         0         0         0
feline                0             0         0         0         0         0
hide                  0             0         0         0         0         0
home                  0             0         0         0         0         0
intruder              0             0         0         0         0         0
just                  0             0         0         0         0         0
lot                   0             0         0         0         0         0
much                  0             0         0         0         0         0
play                  0             0         0         0         0         0
probably              0             0         0         0         0         0
rather                0             0         0         0         0         0
since                 0             0         0         0         0         0
sit                   0             0         0         0         0         0
sleep                 0             0         0         0         0         0
unlike                0             0         0         0         0         0
usually               0             0         0         0         0         0
will                  0             0         0         0         0         0
gear                  2             1         0         0         0         2
get                   1             0         0         0         0         0
hike                  4             3         2         1         2         3
need                  1             0         0         0         0         0
exercise              0             0         2         0         0         0
take                  0             0         1         0         0         1
climb                 0             0         0         1         1         0
colorado              0             0         0         1         1         0
iceland               0             0         0         1         1         0
mountain              0             0         0         2         2         2
switerland            0             0         0         1         1         0
           cluster
chocolate        2
coffee           2
day              4
delicious        2
eat              4
great            4
together         4
healthy          4
like             4
almond           4
also             1
cake             4
dark             4
every            4
everything       4
good             3
make             4
yummy            4
can              5
milk             4
one              4
soy              4
danger           1
dog              5
fall             1
fun              1
help             1
jump             1
pick             1
poop             1
protect          1
run              1
stinky           1
thing            1
time             1
bed              1
cat              1
couch            1
different        1
fairness         1
feline           1
hide             1
home             1
intruder         1
just             1
lot              1
much             1
play             1
probably         1
rather           1
since            1
sit              1
sleep            1
unlike           1
usually          1
will             1
gear             4
get              4
hike             3
need             4
exercise         4
take             4
climb            1
colorado         1
iceland          1
mountain         1
switerland       1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="do">## See each cluster</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>kmeans_smallcorp_Result<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chocolate     coffee        day  delicious        eat      great   together 
         2          2          4          2          4          4          4 
   healthy       like     almond       also       cake       dark      every 
         4          4          4          1          4          4          4 
everything       good       make      yummy        can       milk        one 
         4          3          4          4          5          4          4 
       soy     danger        dog       fall        fun       help       jump 
         4          1          5          1          1          1          1 
      pick       poop    protect        run     stinky      thing       time 
         1          1          1          1          1          1          1 
       bed        cat      couch  different   fairness     feline       hide 
         1          1          1          1          1          1          1 
      home   intruder       just        lot       much       play   probably 
         1          1          1          1          1          1          1 
    rather      since        sit      sleep     unlike    usually       will 
         1          1          1          1          1          1          1 
      gear        get       hike       need   exercise       take      climb 
         4          4          3          4          4          4          1 
  colorado    iceland   mountain switerland 
         1          1          1          1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="do">## This is the size (the number of points in) each cluster</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster size</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>kmeans_smallcorp_Result<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39  3  2 21  2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Here we have two clusters, each with 5 points (rows/vectors) </span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualize the clusters</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(kmeans_smallcorp_Result, <span class="fu">t</span>(SmallCorpus_DF_DT), </span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"Euclidean"</span>,<span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s see if we can do better with <code>Kmeans</code> (not <code>kmeans</code>) and different distance metrics…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="do">## k = 2</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>My_Kmeans_SmallCorp2<span class="ot">&lt;-</span><span class="fu">Kmeans</span>(<span class="fu">t</span>(SmallCorpus_DF_DT), <span class="at">centers=</span><span class="dv">3</span> ,<span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(My_Kmeans_SmallCorp2, <span class="fu">t</span>(SmallCorpus_DF_DT), <span class="at">main=</span><span class="st">"Euclidean k=3"</span>,<span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="do">## k = 3</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>My_Kmeans_SmallCorp3<span class="ot">&lt;-</span><span class="fu">Kmeans</span>(<span class="fu">t</span>(SmallCorpus_DF_DT), <span class="at">centers=</span><span class="dv">3</span> ,<span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(My_Kmeans_SmallCorp3, <span class="fu">t</span>(SmallCorpus_DF_DT), <span class="at">main=</span><span class="st">"Spearman"</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="do">## k = 4</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>My_Kmeans_SmallCorp4<span class="ot">&lt;-</span><span class="fu">Kmeans</span>((SmallCorpus_DF_DT), <span class="at">centers=</span><span class="dv">4</span> ,<span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co"># JK-note: I get an error running the next line so temporarily commented out</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co">#fviz_cluster(My_Kmeans_SmallCorp4, t(SmallCorpus_DF_DT), main="Spearman", repel = TRUE)</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="do">## k = 3 and different metric</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>My_Kmeans_SmallCorp4<span class="ot">&lt;-</span><span class="fu">Kmeans</span>(<span class="fu">t</span>(SmallCorpus_DF_DT), <span class="at">centers=</span><span class="dv">3</span> ,<span class="at">method =</span> <span class="st">"manhattan"</span>)</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(My_Kmeans_SmallCorp4, <span class="fu">t</span>(SmallCorpus_DF_DT), <span class="at">main=</span><span class="st">"manhattan"</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="do">## k = 5 and different metric</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>My_Kmeans_SmallCorp5<span class="ot">&lt;-</span><span class="fu">Kmeans</span>(<span class="fu">t</span>(SmallCorpus_DF_DT), <span class="at">centers=</span><span class="dv">5</span> ,<span class="at">method =</span> <span class="st">"canberra"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: empty cluster: try a better set of initial centers</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(My_Kmeans_SmallCorp5, <span class="fu">t</span>(SmallCorpus_DF_DT), <span class="at">main=</span><span class="st">"canberra"</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cluster-the-docs-and-not-the-words-with-kmeans." class="level2">
<h2 class="anchored" data-anchor-id="cluster-the-docs-and-not-the-words-with-kmeans.">Cluster the Docs and not the words with Kmeans….</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="do">## change the t (undo the transpose)</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>My_Kmeans_SmallCorpD<span class="ot">&lt;-</span><span class="fu">Kmeans</span>(SmallCorpus_DF_DT, <span class="at">centers=</span><span class="dv">3</span> ,</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>My_Kmeans_SmallCorpD<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Choc1.txt     Choc2.txt     Choc3.txt     Choc4.txt     Choc5.txt 
            2             2             2             3             2 
     Dog1.txt      Dog2.txt  Hike_dog.txt Hike_dog2.txt     Hike1.txt 
            1             1             2             2             2 
    Hike2.txt     Hike3.txt     Hike4.txt 
            2             2             2 </code></pre>
</div>
</div>
<p>[https://www.rdocumentation.org/packages/factoextra/versions/1.0.7/topics/fviz_cluster]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(My_Kmeans_SmallCorpD, SmallCorpus_DF_DT, </span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"Euclidean k = 3"</span>,<span class="at">repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="st">'Cluster'</span>, <span class="at">palette=</span><span class="st">'Set2'</span>) <span class="sc">+</span> </span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="st">'Cluster'</span>, <span class="at">palette=</span><span class="st">'Set2'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scale_shape_manual('Cluster', values=c(100,2,24, 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="lets-look-at-hierarchical-clustering" class="level3">
<h3 class="anchored" data-anchor-id="lets-look-at-hierarchical-clustering">Let’s look at hierarchical clustering…………</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example:</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>(Dist_CorpusM2<span class="ot">&lt;-</span> <span class="fu">dist</span>(SmallCorpus_DF_DT, <span class="at">method =</span> <span class="st">"minkowski"</span>, <span class="at">p=</span><span class="dv">2</span>)) <span class="co">#Euclidean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Choc1.txt Choc2.txt Choc3.txt Choc4.txt Choc5.txt  Dog1.txt
Choc2.txt      3.162278                                                  
Choc3.txt      2.645751  3.605551                                        
Choc4.txt      6.244998  7.000000  6.633250                              
Choc5.txt      4.242641  3.741657  4.582576  6.557439                    
Dog1.txt       7.549834  7.549834  7.745967  9.055385  7.280110          
Dog2.txt       9.110434  9.000000  9.273618 10.392305  9.110434  7.348469
Hike_dog.txt   6.557439  6.403124  6.782330  8.831761  6.855655  6.928203
Hike_dog2.txt  6.782330  6.633250  7.000000  7.000000  6.633250  7.000000
Hike1.txt      5.385165  5.196152  5.656854  6.928203  5.567764  7.211103
Hike2.txt      5.656854  5.477226  5.744563  7.416198  5.830952  7.141428
Hike3.txt      6.164414  6.000000  6.244998  7.280110  6.164414  7.416198
Hike4.txt      6.164414  6.000000  6.403124  8.544004  6.633250  7.000000
               Dog2.txt Hike_dog.txt Hike_dog2.txt Hike1.txt Hike2.txt
Choc2.txt                                                             
Choc3.txt                                                             
Choc4.txt                                                             
Choc5.txt                                                             
Dog1.txt                                                              
Dog2.txt                                                              
Hike_dog.txt   8.602325                                               
Hike_dog2.txt  8.544004     4.582576                                  
Hike1.txt      8.717798     4.898979      3.872983                    
Hike2.txt      8.888194     5.916080      5.656854  4.582576          
Hike3.txt      9.110434     5.744563      4.898979  4.358899  1.414214
Hike4.txt      8.544004     3.000000      4.690416  4.582576  4.898979
              Hike3.txt
Choc2.txt              
Choc3.txt              
Choc4.txt              
Choc5.txt              
Dog1.txt               
Dog2.txt               
Hike_dog.txt           
Hike_dog2.txt          
Hike1.txt              
Hike2.txt              
Hike3.txt              
Hike4.txt      4.898979</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Now run hclust...you may use many methods - Ward, Ward.D2, complete, etc..</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="do">## see above</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>(HClust_SmallCorp <span class="ot">&lt;-</span> <span class="fu">hclust</span>(Dist_CorpusM2, <span class="at">method =</span> <span class="st">"ward.D"</span> ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
hclust(d = Dist_CorpusM2, method = "ward.D")

Cluster method   : ward.D 
Distance         : minkowski 
Number of objects: 13 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(HClust_SmallCorp, <span class="at">cex=</span><span class="fl">0.9</span>, <span class="at">hang=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">main =</span> <span class="st">"Minkowski p=2 (Euclidean)"</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(HClust_SmallCorp, <span class="at">k=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="using-cosine-similarity-with-ward.d2" class="level2">
<h2 class="anchored" data-anchor-id="using-cosine-similarity-with-ward.d2">Using Cosine Similarity with Ward.D2…………………………</h2>
<p>SPEICAL EXAMPLE that uses <code>distance()</code> rather than <code>dist()</code></p>
<p>The distance method offer 46 metrics but requires some attention to data types… notice the <code>as.dist</code> below…</p>
<p>MORE: [https://cran.r-project.org/web/packages/philentropy/vignettes/Distances.html]</p>
<p>SCALE data before using cosine sim!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>(dist_C_smallCorp <span class="ot">&lt;-</span> <span class="fu">distance</span>(<span class="fu">as.matrix</span>(<span class="fu">scale</span>(<span class="fu">t</span>(SmallCorpus_DF_DT))), <span class="at">method=</span><span class="st">"cosine"</span>,<span class="at">use.row.names =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Metric: 'cosine'; comparing: 67 vectors.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>             chocolate      coffee           day   delicious         eat
chocolate   1.00000000  0.70192111  0.4775355392  0.79630582  0.57355209
coffee      0.70192111  1.00000000  0.0412667078  0.49800306  0.46874906
day         0.47753554  0.04126671  1.0000000000  0.49697495  0.62447417
delicious   0.79630582  0.49800306  0.4969749519  1.00000000  0.32854921
eat         0.57355209  0.46874906  0.6244741668  0.32854921  1.00000000
great       0.27488932  0.51082471 -0.0467260709  0.30998707 -0.14670091
together    0.33008816  0.82741802 -0.0932813208  0.17440684  0.18823381
healthy     0.37245695  0.13517126 -0.0306955237  0.58123811 -0.15057610
like        0.36890340  0.29096059 -0.2023385614  0.12422647  0.22260426
almond      0.27816511 -0.16111091  0.4555665545 -0.11455452  0.24015426
also       -0.09492584 -0.28422825 -0.0976267959 -0.24129860 -0.25884681
cake        0.25899031  0.43429902  0.2076637794 -0.17683509  0.52463651
dark       -0.02435179 -0.28984358  0.4885076000 -0.16050804  0.08613151
every      -0.02435179 -0.28984358  0.4885076000 -0.16050804  0.08613151
everything -0.02435179 -0.28984358  0.4885076000 -0.16050804  0.08613151
good        0.15423896 -0.01629575 -0.0951163206 -0.17507902  0.06614116
make       -0.02435179 -0.28984358  0.4885076000 -0.16050804  0.08613151
yummy      -0.02435179 -0.28984358  0.4885076000 -0.16050804  0.08613151
can        -0.07260830  0.09135898 -0.3621983508 -0.20944541  0.28874557
milk        0.01544079  0.49886305 -0.0007769817 -0.14806454  0.37778016
one         0.01544079  0.49886305 -0.0007769817 -0.14806454  0.37778016
soy         0.01544079  0.49886305 -0.0007769817 -0.14806454  0.37778016
danger     -0.39715607 -0.30401327  0.0206353756 -0.17965555  0.13487566
dog        -0.15491896 -0.17943593 -0.3772665958 -0.18738852 -0.05619669
fall       -0.39715607 -0.30401327  0.0206353756 -0.17965555  0.13487566
fun        -0.16617851 -0.16678388 -0.2419874142 -0.15147394 -0.16672041
help       -0.39715607 -0.30401327  0.0206353756 -0.17965555  0.13487566
jump       -0.45989494 -0.38805432 -0.2041689732 -0.27747036 -0.04688783
pick       -0.39715607 -0.30401327  0.0206353756 -0.17965555  0.13487566
poop       -0.39715607 -0.30401327  0.0206353756 -0.17965555  0.13487566
protect    -0.39715607 -0.30401327  0.0206353756 -0.17965555  0.13487566
run        -0.26601155 -0.25284325 -0.2978412726 -0.21521796  0.02937532
stinky     -0.39715607 -0.30401327  0.0206353756 -0.17965555  0.13487566
thing      -0.39715607 -0.30401327  0.0206353756 -0.17965555  0.13487566
time       -0.39715607 -0.30401327  0.0206353756 -0.17965555  0.13487566
bed        -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
cat        -0.24294715 -0.22272859 -0.2201428105 -0.18076437 -0.33473981
couch      -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
different  -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
fairness   -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
feline     -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
hide       -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
home       -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
intruder   -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
just       -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
lot        -0.24294715 -0.22272859 -0.2201428105 -0.18076437 -0.33473981
much       -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
play       -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
probably   -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
rather     -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
since      -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
sit        -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
sleep      -0.33336683 -0.28530424 -0.1734084371 -0.20886812 -0.37507002
unlike     -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
usually    -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
will       -0.49206491 -0.38407804 -0.0213834288 -0.23688208 -0.40001759
gear       -0.15468717 -0.13978930 -0.1273477511 -0.11119173 -0.20473811
get        -0.31261459 -0.23149791  0.0656405579 -0.12637354 -0.20225780
hike       -0.11458424 -0.13098876 -0.2680915125 -0.13526630 -0.26543904
need       -0.31261459 -0.23149791  0.0656405579 -0.12637354 -0.20225780
exercise   -0.14110358 -0.11506306 -0.0373222217 -0.07742381 -0.13513212
take       -0.22276153 -0.17986022 -0.0475802978 -0.11877701 -0.20590834
climb      -0.26422683 -0.22638372 -0.1390351810 -0.16603358 -0.29832295
colorado   -0.26422683 -0.22638372 -0.1390351810 -0.16603358 -0.29832295
iceland    -0.26422683 -0.22638372 -0.1390351810 -0.16603358 -0.29832295
mountain   -0.14721446 -0.15003946 -0.2288650098 -0.13860033 -0.26535078
switerland -0.26422683 -0.22638372 -0.1390351810 -0.16603358 -0.29832295
                  great     together      healthy         like      almond
chocolate   0.274889322  0.330088162  0.372456946  0.368903400  0.27816511
coffee      0.510824705  0.827418017  0.135171255  0.290960586 -0.16111091
day        -0.046726071 -0.093281321 -0.030695524 -0.202338561  0.45556655
delicious   0.309987071  0.174406841  0.581238113  0.124226469 -0.11455452
eat        -0.146700910  0.188233813 -0.150576102  0.222604260  0.24015426
great       1.000000000  0.764028171 -0.029412291 -0.216810850 -0.05786592
together    0.764028171  1.000000000 -0.058552375 -0.006839277 -0.10524280
healthy    -0.029412291 -0.058552375  1.000000000  0.311191371 -0.05120926
like       -0.216810850 -0.006839277  0.311191371  1.000000000  0.06901853
almond     -0.057865923 -0.105242803 -0.051209262  0.069018529  1.00000000
also       -0.196159224 -0.331099976 -0.206542011  0.491419812  0.20692104
cake       -0.075269961  0.466130212 -0.060375462  0.211690916  0.49390553
dark        0.005268300 -0.020253009  0.042968161 -0.220459351  0.81607459
every       0.005268300 -0.020253009  0.042968161 -0.220459351  0.81607459
everything  0.005268300 -0.020253009  0.042968161 -0.220459351  0.81607459
good       -0.196502990 -0.188807481 -0.221838084  0.350684449  0.27762777
make        0.005268300 -0.020253009  0.042968161 -0.220459351  0.81607459
yummy       0.005268300 -0.020253009  0.042968161 -0.220459351  0.81607459
can        -0.204775569 -0.064336312 -0.225127687  0.137548486 -0.26990966
milk       -0.026063734  0.587335416 -0.001447797  0.078266501 -0.06079368
one        -0.026063734  0.587335416 -0.001447797  0.078266501 -0.06079368
soy        -0.026063734  0.587335416 -0.001447797  0.078266501 -0.06079368
danger     -0.021591103 -0.063164616  0.011573828 -0.178997364 -0.06277452
dog        -0.207953285 -0.339065947 -0.234292368 -0.097140558 -0.26858679
fall       -0.021591103 -0.063164616  0.011573828 -0.178997364 -0.06277452
fun        -0.138815635 -0.230942923 -0.150484925  0.645002563 -0.18503679
help       -0.021591103 -0.063164616  0.011573828 -0.178997364 -0.06277452
jump       -0.143102148 -0.259248725 -0.127945020 -0.335119729 -0.21717125
pick       -0.021591103 -0.063164616  0.011573828 -0.178997364 -0.06277452
poop       -0.021591103 -0.063164616  0.011573828 -0.178997364 -0.06277452
protect    -0.021591103 -0.063164616  0.011573828 -0.178997364 -0.06277452
run        -0.175852325 -0.296631541 -0.185406939 -0.120206239 -0.23948629
stinky     -0.021591103 -0.063164616  0.011573828 -0.178997364 -0.06277452
thing      -0.021591103 -0.063164616  0.011573828 -0.178997364 -0.06277452
time       -0.021591103 -0.063164616  0.011573828 -0.178997364 -0.06277452
bed        -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
cat        -0.133742656 -0.228581550 -0.137181229 -0.409092732 -0.18585902
couch      -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
different  -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
fairness   -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
feline     -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
hide       -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
home       -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
intruder   -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
just       -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
lot        -0.133742656 -0.228581550 -0.137181229 -0.409092732 -0.18585902
much       -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
play       -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
probably   -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
rather     -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
since      -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
sit        -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
sleep      -0.116890228 -0.208659393 -0.108493389 -0.513634034 -0.17352044
unlike     -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
usually    -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
will       -0.051063285 -0.116571552 -0.014758574 -0.671158799 -0.10751901
gear       -0.078516948 -0.135079288 -0.079399603 -0.255719949 -0.11021719
get         0.008584984 -0.009409136  0.039725371 -0.397015349 -0.01811805
hike       -0.148140264 -0.241851302 -0.166505561  0.048172317 -0.19172066
need        0.008584984 -0.009409136  0.039725371 -0.397015349 -0.01811805
exercise   -0.030794360 -0.058879930 -0.023562966 -0.204026674 -0.05059125
take       -0.042742728 -0.083700051 -0.030170491 -0.317893305 -0.07268450
climb      -0.093471436 -0.166682320 -0.086978319  0.480292337 -0.13854068
colorado   -0.093471436 -0.166682320 -0.086978319  0.480292337 -0.13854068
iceland    -0.093471436 -0.166682320 -0.086978319  0.480292337 -0.13854068
mountain   -0.130479145 -0.216414574 -0.142294027  0.454849490 -0.17310198
switerland -0.093471436 -0.166682320 -0.086978319  0.480292337 -0.13854068
                  also        cake        dark       every  everything
chocolate  -0.09492584  0.25899031 -0.02435179 -0.02435179 -0.02435179
coffee     -0.28422825  0.43429902 -0.28984358 -0.28984358 -0.28984358
day        -0.09762680  0.20766378  0.48850760  0.48850760  0.48850760
delicious  -0.24129860 -0.17683509 -0.16050804 -0.16050804 -0.16050804
eat        -0.25884681  0.52463651  0.08613151  0.08613151  0.08613151
great      -0.19615922 -0.07526996  0.00526830  0.00526830  0.00526830
together   -0.33109998  0.46613021 -0.02025301 -0.02025301 -0.02025301
healthy    -0.20654201 -0.06037546  0.04296816  0.04296816  0.04296816
like        0.49141981  0.21169092 -0.22045935 -0.22045935 -0.22045935
almond      0.20692104  0.49390553  0.81607459  0.81607459  0.81607459
also        1.00000000 -0.14765521 -0.02373119 -0.02373119 -0.02373119
cake       -0.14765521  1.00000000  0.49506354  0.49506354  0.49506354
dark       -0.02373119  0.49506354  1.00000000  1.00000000  1.00000000
every      -0.02373119  0.49506354  1.00000000  1.00000000  1.00000000
everything -0.02373119  0.49506354  1.00000000  1.00000000  1.00000000
good        0.35473514  0.05572980 -0.11330300 -0.11330300 -0.11330300
make       -0.02373119  0.49506354  1.00000000  1.00000000  1.00000000
yummy      -0.02373119  0.49506354  1.00000000  1.00000000  1.00000000
can        -0.23857910 -0.07103383 -0.49400110 -0.49400110 -0.49400110
milk       -0.35547642  0.81624006  0.17922022  0.17922022  0.17922022
one        -0.35547642  0.81624006  0.17922022  0.17922022  0.17922022
soy        -0.35547642  0.81624006  0.17922022  0.17922022  0.17922022
danger     -0.43334767 -0.03991394  0.26212787  0.26212787  0.26212787
dog        -0.16292846 -0.44322946 -0.55213184 -0.55213184 -0.55213184
fall       -0.43334767 -0.03991394  0.26212787  0.26212787  0.26212787
fun         0.80051803 -0.29486464 -0.31594989 -0.31594989 -0.31594989
help       -0.43334767 -0.03991394  0.26212787  0.26212787  0.26212787
jump       -0.28659299 -0.29934643 -0.08378403 -0.08378403 -0.08378403
pick       -0.43334767 -0.03991394  0.26212787  0.26212787  0.26212787
poop       -0.43334767 -0.03991394  0.26212787  0.26212787  0.26212787
protect    -0.43334767 -0.03991394  0.26212787  0.26212787  0.26212787
run        -0.13998350 -0.37264688 -0.35372447 -0.35372447 -0.35372447
stinky     -0.43334767 -0.03991394  0.26212787  0.26212787  0.26212787
thing      -0.43334767 -0.03991394  0.26212787  0.26212787  0.26212787
time       -0.43334767 -0.03991394  0.26212787  0.26212787  0.26212787
bed        -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
cat         0.09403699 -0.28276170 -0.23495710 -0.23495710 -0.23495710
couch      -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
different  -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
fairness   -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
feline     -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
hide       -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
home       -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
intruder   -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
just       -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
lot         0.09403699 -0.28276170 -0.23495710 -0.23495710 -0.23495710
much       -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
play       -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
probably   -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
rather     -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
since      -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
sit        -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
sleep       0.02775427 -0.24519287 -0.10388883 -0.10388883 -0.10388883
unlike     -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
usually    -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
will       -0.14368169 -0.10156187  0.24503377  0.24503377  0.24503377
gear       -0.25504410 -0.16580908 -0.12782827 -0.12782827 -0.12782827
get        -0.30962831  0.02340878  0.29022149  0.29022149  0.29022149
hike        0.10108767 -0.31567694 -0.38978255 -0.38978255 -0.38978255
need       -0.30962831  0.02340878  0.29022149  0.29022149  0.29022149
exercise   -0.18241306 -0.06374170  0.01729497  0.01729497  0.01729497
take       -0.28075150 -0.08804270  0.04656349  0.04656349  0.04656349
climb       0.79250250 -0.19610648 -0.08504523 -0.08504523 -0.08504523
colorado    0.79250250 -0.19610648 -0.08504523 -0.08504523 -0.08504523
iceland     0.79250250 -0.19610648 -0.08504523 -0.08504523 -0.08504523
mountain    0.66800822 -0.27730066 -0.30450729 -0.30450729 -0.30450729
switerland  0.79250250 -0.19610648 -0.08504523 -0.08504523 -0.08504523
                    good        make       yummy          can          milk
chocolate   0.1542389626 -0.02435179 -0.02435179 -0.072608298  0.0154407930
coffee     -0.0162957490 -0.28984358 -0.28984358  0.091358982  0.4988630459
day        -0.0951163206  0.48850760  0.48850760 -0.362198351 -0.0007769817
delicious  -0.1750790227 -0.16050804 -0.16050804 -0.209445412 -0.1480645439
eat         0.0661411618  0.08613151  0.08613151  0.288745571  0.3777801553
great      -0.1965029898  0.00526830  0.00526830 -0.204775569 -0.0260637344
together   -0.1888074811 -0.02025301 -0.02025301 -0.064336312  0.5873354163
healthy    -0.2218380842  0.04296816  0.04296816 -0.225127687 -0.0014477973
like        0.3506844490 -0.22045935 -0.22045935  0.137548486  0.0782665005
almond      0.2776277669  0.81607459  0.81607459 -0.269909662 -0.0607936847
also        0.3547351373 -0.02373119 -0.02373119 -0.238579101 -0.3554764232
cake        0.0557298015  0.49506354  0.49506354 -0.071033834  0.8162400612
dark       -0.1133029997  1.00000000  1.00000000 -0.494001104  0.1792202183
every      -0.1133029997  1.00000000  1.00000000 -0.494001104  0.1792202183
everything -0.1133029997  1.00000000  1.00000000 -0.494001104  0.1792202183
good        1.0000000000 -0.11330300 -0.11330300  0.003855799 -0.2366192350
make       -0.1133029997  1.00000000  1.00000000 -0.494001104  0.1792202183
yummy      -0.1133029997  1.00000000  1.00000000 -0.494001104  0.1792202183
can         0.0038557988 -0.49400110 -0.49400110  1.000000000 -0.0235556269
milk       -0.2366192350  0.17922022  0.17922022 -0.023555627  1.0000000000
one        -0.2366192350  0.17922022  0.17922022 -0.023555627  1.0000000000
soy        -0.2366192350  0.17922022  0.17922022 -0.023555627  1.0000000000
danger     -0.4046134804  0.26212787  0.26212787  0.294477495  0.1164300631
dog         0.2034052066 -0.55213184 -0.55213184  0.725018917 -0.4463674147
fall       -0.4046134804  0.26212787  0.26212787  0.294477495  0.1164300631
fun         0.2785184094 -0.31594989 -0.31594989 -0.044733849 -0.2711547521
help       -0.4046134804  0.26212787  0.26212787  0.294477495  0.1164300631
jump       -0.3731358192 -0.08378403 -0.08378403  0.609304455 -0.1562585002
pick       -0.4046134804  0.26212787  0.26212787  0.294477495  0.1164300631
poop       -0.4046134804  0.26212787  0.26212787  0.294477495  0.1164300631
protect    -0.4046134804  0.26212787  0.26212787  0.294477495  0.1164300631
run        -0.1161427492 -0.35372447 -0.35372447  0.801306098 -0.3197950923
stinky     -0.4046134804  0.26212787  0.26212787  0.294477495  0.1164300631
thing      -0.4046134804  0.26212787  0.26212787  0.294477495  0.1164300631
time       -0.4046134804  0.26212787  0.26212787  0.294477495  0.1164300631
bed        -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
cat        -0.1739077590 -0.23495710 -0.23495710  0.223752962 -0.2258596324
couch      -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
different  -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
fairness   -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
feline     -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
hide       -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
home       -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
intruder   -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
just       -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
lot        -0.1739077590 -0.23495710 -0.23495710  0.223752962 -0.2258596324
much       -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
play       -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
probably   -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
rather     -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
since      -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
sit        -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
sleep      -0.2958810401 -0.10388883 -0.10388883  0.122423747 -0.1457007197
unlike     -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
usually    -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
will       -0.5411053724  0.24503377  0.24503377 -0.155855084  0.0843305432
gear       -0.0003580768 -0.12782827 -0.12782827  0.005771964 -0.1274454904
get        -0.4226748935  0.29022149  0.29022149 -0.088452155  0.1546929191
hike        0.5103253044 -0.38978255 -0.38978255 -0.001775932 -0.3161756384
need       -0.4226748935  0.29022149  0.29022149 -0.088452155  0.1546929191
exercise    0.3027407987  0.01729497  0.01729497 -0.193576911 -0.0156261678
take        0.0948708007  0.04656349  0.04656349 -0.303004178 -0.0101949753
climb       0.1201820751 -0.08504523 -0.08504523 -0.378324580 -0.1175137741
colorado    0.1201820751 -0.08504523 -0.08504523 -0.378324580 -0.1175137741
iceland     0.1201820751 -0.08504523 -0.08504523 -0.378324580 -0.1175137741
mountain    0.2023682120 -0.30450729 -0.30450729 -0.245461701 -0.2587083665
switerland  0.1201820751 -0.08504523 -0.08504523 -0.378324580 -0.1175137741
                     one           soy       danger         dog         fall
chocolate   0.0154407930  0.0154407930 -0.397156070 -0.15491896 -0.397156070
coffee      0.4988630459  0.4988630459 -0.304013266 -0.17943593 -0.304013266
day        -0.0007769817 -0.0007769817  0.020635376 -0.37726660  0.020635376
delicious  -0.1480645439 -0.1480645439 -0.179655555 -0.18738852 -0.179655555
eat         0.3777801553  0.3777801553  0.134875658 -0.05619669  0.134875658
great      -0.0260637344 -0.0260637344 -0.021591103 -0.20795328 -0.021591103
together    0.5873354163  0.5873354163 -0.063164616 -0.33906595 -0.063164616
healthy    -0.0014477973 -0.0014477973  0.011573828 -0.23429237  0.011573828
like        0.0782665005  0.0782665005 -0.178997364 -0.09714056 -0.178997364
almond     -0.0607936847 -0.0607936847 -0.062774518 -0.26858679 -0.062774518
also       -0.3554764232 -0.3554764232 -0.433347670 -0.16292846 -0.433347670
cake        0.8162400612  0.8162400612 -0.039913940 -0.44322946 -0.039913940
dark        0.1792202183  0.1792202183  0.262127869 -0.55213184  0.262127869
every       0.1792202183  0.1792202183  0.262127869 -0.55213184  0.262127869
everything  0.1792202183  0.1792202183  0.262127869 -0.55213184  0.262127869
good       -0.2366192350 -0.2366192350 -0.404613480  0.20340521 -0.404613480
make        0.1792202183  0.1792202183  0.262127869 -0.55213184  0.262127869
yummy       0.1792202183  0.1792202183  0.262127869 -0.55213184  0.262127869
can        -0.0235556269 -0.0235556269  0.294477495  0.72501892  0.294477495
milk        1.0000000000  1.0000000000  0.116430063 -0.44636741  0.116430063
one         1.0000000000  1.0000000000  0.116430063 -0.44636741  0.116430063
soy         1.0000000000  1.0000000000  0.116430063 -0.44636741  0.116430063
danger      0.1164300631  0.1164300631  1.000000000  0.02822418  1.000000000
dog        -0.4463674147 -0.4463674147  0.028224178  1.00000000  0.028224178
fall        0.1164300631  0.1164300631  1.000000000  0.02822418  1.000000000
fun        -0.2711547521 -0.2711547521 -0.104876608 -0.06183312 -0.104876608
help        0.1164300631  0.1164300631  1.000000000  0.02822418  1.000000000
jump       -0.1562585002 -0.1562585002  0.681772686  0.42569752  0.681772686
pick        0.1164300631  0.1164300631  1.000000000  0.02822418  1.000000000
poop        0.1164300631  0.1164300631  1.000000000  0.02822418  1.000000000
protect     0.1164300631  0.1164300631  1.000000000  0.02822418  1.000000000
run        -0.3197950923 -0.3197950923  0.428217083  0.66769342  0.428217083
stinky      0.1164300631  0.1164300631  1.000000000  0.02822418  1.000000000
thing       0.1164300631  0.1164300631  1.000000000  0.02822418  1.000000000
time        0.1164300631  0.1164300631  1.000000000  0.02822418  1.000000000
bed         0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
cat        -0.2258596324 -0.2258596324 -0.271090605  0.31005141 -0.271090605
couch       0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
different   0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
fairness    0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
feline      0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
hide        0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
home        0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
intruder    0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
just        0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
lot        -0.2258596324 -0.2258596324 -0.271090605  0.31005141 -0.271090605
much        0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
play        0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
probably    0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
rather      0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
since       0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
sit         0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
sleep      -0.1457007197 -0.1457007197 -0.160607704  0.18808087 -0.160607704
unlike      0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
usually     0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
will        0.0843305432  0.0843305432  0.148301982 -0.15512965  0.148301982
gear       -0.1274454904 -0.1274454904 -0.151545998  0.47840758 -0.151545998
get         0.1546929191  0.1546929191  0.224371931 -0.10900604  0.224371931
hike       -0.3161756384 -0.3161756384 -0.397712851  0.43781493 -0.397712851
need        0.1546929191  0.1546929191  0.224371931 -0.10900604  0.224371931
exercise   -0.0156261678 -0.0156261678 -0.008713496 -0.19845943 -0.008713496
take       -0.0101949753 -0.0101949753  0.004874612 -0.04652189  0.004874612
climb      -0.1175137741 -0.1175137741 -0.129912370 -0.36973723 -0.129912370
colorado   -0.1175137741 -0.1175137741 -0.129912370 -0.36973723 -0.129912370
iceland    -0.1175137741 -0.1175137741 -0.129912370 -0.36973723 -0.129912370
mountain   -0.2587083665 -0.2587083665 -0.321106736  0.04262269 -0.321106736
switerland -0.1175137741 -0.1175137741 -0.129912370 -0.36973723 -0.129912370
                   fun         help        jump         pick         poop
chocolate  -0.16617851 -0.397156070 -0.45989494 -0.397156070 -0.397156070
coffee     -0.16678388 -0.304013266 -0.38805432 -0.304013266 -0.304013266
day        -0.24198741  0.020635376 -0.20416897  0.020635376  0.020635376
delicious  -0.15147394 -0.179655555 -0.27747036 -0.179655555 -0.179655555
eat        -0.16672041  0.134875658 -0.04688783  0.134875658  0.134875658
great      -0.13881564 -0.021591103 -0.14310215 -0.021591103 -0.021591103
together   -0.23094292 -0.063164616 -0.25924873 -0.063164616 -0.063164616
healthy    -0.15048492  0.011573828 -0.12794502  0.011573828  0.011573828
like        0.64500256 -0.178997364 -0.33511973 -0.178997364 -0.178997364
almond     -0.18503679 -0.062774518 -0.21717125 -0.062774518 -0.062774518
also        0.80051803 -0.433347670 -0.28659299 -0.433347670 -0.433347670
cake       -0.29486464 -0.039913940 -0.29934643 -0.039913940 -0.039913940
dark       -0.31594989  0.262127869 -0.08378403  0.262127869  0.262127869
every      -0.31594989  0.262127869 -0.08378403  0.262127869  0.262127869
everything -0.31594989  0.262127869 -0.08378403  0.262127869  0.262127869
good        0.27851841 -0.404613480 -0.37313582 -0.404613480 -0.404613480
make       -0.31594989  0.262127869 -0.08378403  0.262127869  0.262127869
yummy      -0.31594989  0.262127869 -0.08378403  0.262127869  0.262127869
can        -0.04473385  0.294477495  0.60930445  0.294477495  0.294477495
milk       -0.27115475  0.116430063 -0.15625850  0.116430063  0.116430063
one        -0.27115475  0.116430063 -0.15625850  0.116430063  0.116430063
soy        -0.27115475  0.116430063 -0.15625850  0.116430063  0.116430063
danger     -0.10487661  1.000000000  0.68177269  1.000000000  1.000000000
dog        -0.06183312  0.028224178  0.42569752  0.028224178  0.028224178
fall       -0.10487661  1.000000000  0.68177269  1.000000000  1.000000000
fun         1.00000000 -0.104876608 -0.20772880 -0.104876608 -0.104876608
help       -0.10487661  1.000000000  0.68177269  1.000000000  1.000000000
jump       -0.20772880  0.681772686  1.00000000  0.681772686  0.681772686
pick       -0.10487661  1.000000000  0.68177269  1.000000000  1.000000000
poop       -0.10487661  1.000000000  0.68177269  1.000000000  1.000000000
protect    -0.10487661  1.000000000  0.68177269  1.000000000  1.000000000
run        -0.07275605  0.428217083  0.90440923  0.428217083  0.428217083
stinky     -0.10487661  1.000000000  0.68177269  1.000000000  1.000000000
thing      -0.10487661  1.000000000  0.68177269  1.000000000  1.000000000
time       -0.10487661  1.000000000  0.68177269  1.000000000  1.000000000
bed        -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
cat        -0.26412804 -0.271090605  0.47669810 -0.271090605 -0.271090605
couch      -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
different  -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
fairness   -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
feline     -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
hide       -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
home       -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
intruder   -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
just       -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
lot        -0.26412804 -0.271090605  0.47669810 -0.271090605 -0.271090605
much       -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
play       -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
probably   -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
rather     -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
since      -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
sit        -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
sleep      -0.32990629 -0.160607704  0.51293467 -0.160607704 -0.160607704
unlike     -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
usually    -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
will       -0.42766080  0.148301982  0.49972645  0.148301982  0.148301982
gear       -0.16493272 -0.151545998 -0.26787074 -0.151545998 -0.151545998
get        -0.25167116  0.224371931 -0.05463509  0.224371931  0.224371931
hike        0.23363465 -0.397712851 -0.46025309 -0.397712851 -0.397712851
need       -0.25167116  0.224371931 -0.05463509  0.224371931  0.224371931
exercise   -0.13051950 -0.008713496 -0.12554412 -0.008713496 -0.008713496
take       -0.20318566  0.004874612 -0.18110905  0.004874612  0.004874612
climb       0.91334221 -0.129912370 -0.33928401 -0.129912370 -0.129912370
colorado    0.91334221 -0.129912370 -0.33928401 -0.129912370 -0.129912370
iceland     0.91334221 -0.129912370 -0.33928401 -0.129912370 -0.129912370
mountain    0.79273014 -0.321106736 -0.41717153 -0.321106736 -0.321106736
switerland  0.91334221 -0.129912370 -0.33928401 -0.129912370 -0.129912370
                protect         run       stinky        thing         time
chocolate  -0.397156070 -0.26601155 -0.397156070 -0.397156070 -0.397156070
coffee     -0.304013266 -0.25284325 -0.304013266 -0.304013266 -0.304013266
day         0.020635376 -0.29784127  0.020635376  0.020635376  0.020635376
delicious  -0.179655555 -0.21521796 -0.179655555 -0.179655555 -0.179655555
eat         0.134875658  0.02937532  0.134875658  0.134875658  0.134875658
great      -0.021591103 -0.17585233 -0.021591103 -0.021591103 -0.021591103
together   -0.063164616 -0.29663154 -0.063164616 -0.063164616 -0.063164616
healthy     0.011573828 -0.18540694  0.011573828  0.011573828  0.011573828
like       -0.178997364 -0.12020624 -0.178997364 -0.178997364 -0.178997364
almond     -0.062774518 -0.23948629 -0.062774518 -0.062774518 -0.062774518
also       -0.433347670 -0.13998350 -0.433347670 -0.433347670 -0.433347670
cake       -0.039913940 -0.37264688 -0.039913940 -0.039913940 -0.039913940
dark        0.262127869 -0.35372447  0.262127869  0.262127869  0.262127869
every       0.262127869 -0.35372447  0.262127869  0.262127869  0.262127869
everything  0.262127869 -0.35372447  0.262127869  0.262127869  0.262127869
good       -0.404613480 -0.11614275 -0.404613480 -0.404613480 -0.404613480
make        0.262127869 -0.35372447  0.262127869  0.262127869  0.262127869
yummy       0.262127869 -0.35372447  0.262127869  0.262127869  0.262127869
can         0.294477495  0.80130610  0.294477495  0.294477495  0.294477495
milk        0.116430063 -0.31979509  0.116430063  0.116430063  0.116430063
one         0.116430063 -0.31979509  0.116430063  0.116430063  0.116430063
soy         0.116430063 -0.31979509  0.116430063  0.116430063  0.116430063
danger      1.000000000  0.42821708  1.000000000  1.000000000  1.000000000
dog         0.028224178  0.66769342  0.028224178  0.028224178  0.028224178
fall        1.000000000  0.42821708  1.000000000  1.000000000  1.000000000
fun        -0.104876608 -0.07275605 -0.104876608 -0.104876608 -0.104876608
help        1.000000000  0.42821708  1.000000000  1.000000000  1.000000000
jump        0.681772686  0.90440923  0.681772686  0.681772686  0.681772686
pick        1.000000000  0.42821708  1.000000000  1.000000000  1.000000000
poop        1.000000000  0.42821708  1.000000000  1.000000000  1.000000000
protect     1.000000000  0.42821708  1.000000000  1.000000000  1.000000000
run         0.428217083  1.00000000  0.428217083  0.428217083  0.428217083
stinky      1.000000000  0.42821708  1.000000000  1.000000000  1.000000000
thing       1.000000000  0.42821708  1.000000000  1.000000000  1.000000000
time        1.000000000  0.42821708  1.000000000  1.000000000  1.000000000
bed         0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
cat        -0.271090605  0.52872265 -0.271090605 -0.271090605 -0.271090605
couch       0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
different   0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
fairness    0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
feline      0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
hide        0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
home        0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
intruder    0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
just        0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
lot        -0.271090605  0.52872265 -0.271090605 -0.271090605 -0.271090605
much        0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
play        0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
probably    0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
rather      0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
since       0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
sit         0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
sleep      -0.160607704  0.47333110 -0.160607704 -0.160607704 -0.160607704
unlike      0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
usually     0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
will        0.148301982  0.23892022  0.148301982  0.148301982  0.148301982
gear       -0.151545998 -0.22775349 -0.151545998 -0.151545998 -0.151545998
get         0.224371931 -0.27943313  0.224371931  0.224371931  0.224371931
hike       -0.397712851 -0.26599284 -0.397712851 -0.397712851 -0.397712851
need        0.224371931 -0.27943313  0.224371931  0.224371931  0.224371931
exercise   -0.008713496 -0.16361092 -0.008713496 -0.008713496 -0.008713496
take        0.004874612 -0.25194463  0.004874612  0.004874612  0.004874612
climb      -0.129912370 -0.34508756 -0.129912370 -0.129912370 -0.129912370
colorado   -0.129912370 -0.34508756 -0.129912370 -0.129912370 -0.129912370
iceland    -0.129912370 -0.34508756 -0.129912370 -0.129912370 -0.129912370
mountain   -0.321106736 -0.27703336 -0.321106736 -0.321106736 -0.321106736
switerland -0.129912370 -0.34508756 -0.129912370 -0.129912370 -0.129912370
                   bed         cat       couch   different    fairness
chocolate  -0.49206491 -0.24294715 -0.49206491 -0.49206491 -0.49206491
coffee     -0.38407804 -0.22272859 -0.38407804 -0.38407804 -0.38407804
day        -0.02138343 -0.22014281 -0.02138343 -0.02138343 -0.02138343
delicious  -0.23688208 -0.18076437 -0.23688208 -0.23688208 -0.23688208
eat        -0.40001759 -0.33473981 -0.40001759 -0.40001759 -0.40001759
great      -0.05106328 -0.13374266 -0.05106328 -0.05106328 -0.05106328
together   -0.11657155 -0.22858155 -0.11657155 -0.11657155 -0.11657155
healthy    -0.01475857 -0.13718123 -0.01475857 -0.01475857 -0.01475857
like       -0.67115880 -0.40909273 -0.67115880 -0.67115880 -0.67115880
almond     -0.10751901 -0.18585902 -0.10751901 -0.10751901 -0.10751901
also       -0.14368169  0.09403699 -0.14368169 -0.14368169 -0.14368169
cake       -0.10156187 -0.28276170 -0.10156187 -0.10156187 -0.10156187
dark        0.24503377 -0.23495710  0.24503377  0.24503377  0.24503377
every       0.24503377 -0.23495710  0.24503377  0.24503377  0.24503377
everything  0.24503377 -0.23495710  0.24503377  0.24503377  0.24503377
good       -0.54110537 -0.17390776 -0.54110537 -0.54110537 -0.54110537
make        0.24503377 -0.23495710  0.24503377  0.24503377  0.24503377
yummy       0.24503377 -0.23495710  0.24503377  0.24503377  0.24503377
can        -0.15585508  0.22375296 -0.15585508 -0.15585508 -0.15585508
milk        0.08433054 -0.22585963  0.08433054  0.08433054  0.08433054
one         0.08433054 -0.22585963  0.08433054  0.08433054  0.08433054
soy         0.08433054 -0.22585963  0.08433054  0.08433054  0.08433054
danger      0.14830198 -0.27109060  0.14830198  0.14830198  0.14830198
dog        -0.15512965  0.31005141 -0.15512965 -0.15512965 -0.15512965
fall        0.14830198 -0.27109060  0.14830198  0.14830198  0.14830198
fun        -0.42766080 -0.26412804 -0.42766080 -0.42766080 -0.42766080
help        0.14830198 -0.27109060  0.14830198  0.14830198  0.14830198
jump        0.49972645  0.47669810  0.49972645  0.49972645  0.49972645
pick        0.14830198 -0.27109060  0.14830198  0.14830198  0.14830198
poop        0.14830198 -0.27109060  0.14830198  0.14830198  0.14830198
protect     0.14830198 -0.27109060  0.14830198  0.14830198  0.14830198
run         0.23892022  0.52872265  0.23892022  0.23892022  0.23892022
stinky      0.14830198 -0.27109060  0.14830198  0.14830198  0.14830198
thing       0.14830198 -0.27109060  0.14830198  0.14830198  0.14830198
time        0.14830198 -0.27109060  0.14830198  0.14830198  0.14830198
bed         1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
cat         0.72477442  1.00000000  0.72477442  0.72477442  0.72477442
couch       1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
different   1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
fairness    1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
feline      1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
hide        1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
home        1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
intruder    1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
just        1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
lot         0.72477442  1.00000000  0.72477442  0.72477442  0.72477442
much        1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
play        1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
probably    1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
rather      1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
since       1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
sit         1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
sleep       0.85267888  0.97795063  0.85267888  0.85267888  0.85267888
unlike      1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
usually     1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
will        1.00000000  0.72477442  1.00000000  1.00000000  1.00000000
gear       -0.20677981 -0.18699283 -0.20677981 -0.20677981 -0.20677981
get         0.21325636 -0.18368160  0.21325636  0.21325636  0.21325636
hike       -0.49269575 -0.24299525 -0.49269575 -0.49269575 -0.49269575
need        0.21325636 -0.18368160  0.21325636  0.21325636  0.21325636
exercise   -0.03456356 -0.12316451 -0.03456356 -0.03456356 -0.03456356
take       -0.03240625 -0.18762187 -0.03240625 -0.03240625 -0.03240625
climb      -0.19983485 -0.27221222 -0.19983485 -0.19983485 -0.19983485
colorado   -0.19983485 -0.27221222 -0.19983485 -0.19983485 -0.19983485
iceland    -0.19983485 -0.27221222 -0.19983485 -0.19983485 -0.19983485
mountain   -0.40717572 -0.24270064 -0.40717572 -0.40717572 -0.40717572
switerland -0.19983485 -0.27221222 -0.19983485 -0.19983485 -0.19983485
                feline        hide        home    intruder        just
chocolate  -0.49206491 -0.49206491 -0.49206491 -0.49206491 -0.49206491
coffee     -0.38407804 -0.38407804 -0.38407804 -0.38407804 -0.38407804
day        -0.02138343 -0.02138343 -0.02138343 -0.02138343 -0.02138343
delicious  -0.23688208 -0.23688208 -0.23688208 -0.23688208 -0.23688208
eat        -0.40001759 -0.40001759 -0.40001759 -0.40001759 -0.40001759
great      -0.05106328 -0.05106328 -0.05106328 -0.05106328 -0.05106328
together   -0.11657155 -0.11657155 -0.11657155 -0.11657155 -0.11657155
healthy    -0.01475857 -0.01475857 -0.01475857 -0.01475857 -0.01475857
like       -0.67115880 -0.67115880 -0.67115880 -0.67115880 -0.67115880
almond     -0.10751901 -0.10751901 -0.10751901 -0.10751901 -0.10751901
also       -0.14368169 -0.14368169 -0.14368169 -0.14368169 -0.14368169
cake       -0.10156187 -0.10156187 -0.10156187 -0.10156187 -0.10156187
dark        0.24503377  0.24503377  0.24503377  0.24503377  0.24503377
every       0.24503377  0.24503377  0.24503377  0.24503377  0.24503377
everything  0.24503377  0.24503377  0.24503377  0.24503377  0.24503377
good       -0.54110537 -0.54110537 -0.54110537 -0.54110537 -0.54110537
make        0.24503377  0.24503377  0.24503377  0.24503377  0.24503377
yummy       0.24503377  0.24503377  0.24503377  0.24503377  0.24503377
can        -0.15585508 -0.15585508 -0.15585508 -0.15585508 -0.15585508
milk        0.08433054  0.08433054  0.08433054  0.08433054  0.08433054
one         0.08433054  0.08433054  0.08433054  0.08433054  0.08433054
soy         0.08433054  0.08433054  0.08433054  0.08433054  0.08433054
danger      0.14830198  0.14830198  0.14830198  0.14830198  0.14830198
dog        -0.15512965 -0.15512965 -0.15512965 -0.15512965 -0.15512965
fall        0.14830198  0.14830198  0.14830198  0.14830198  0.14830198
fun        -0.42766080 -0.42766080 -0.42766080 -0.42766080 -0.42766080
help        0.14830198  0.14830198  0.14830198  0.14830198  0.14830198
jump        0.49972645  0.49972645  0.49972645  0.49972645  0.49972645
pick        0.14830198  0.14830198  0.14830198  0.14830198  0.14830198
poop        0.14830198  0.14830198  0.14830198  0.14830198  0.14830198
protect     0.14830198  0.14830198  0.14830198  0.14830198  0.14830198
run         0.23892022  0.23892022  0.23892022  0.23892022  0.23892022
stinky      0.14830198  0.14830198  0.14830198  0.14830198  0.14830198
thing       0.14830198  0.14830198  0.14830198  0.14830198  0.14830198
time        0.14830198  0.14830198  0.14830198  0.14830198  0.14830198
bed         1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
cat         0.72477442  0.72477442  0.72477442  0.72477442  0.72477442
couch       1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
different   1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
fairness    1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
feline      1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
hide        1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
home        1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
intruder    1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
just        1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
lot         0.72477442  0.72477442  0.72477442  0.72477442  0.72477442
much        1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
play        1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
probably    1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
rather      1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
since       1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
sit         1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
sleep       0.85267888  0.85267888  0.85267888  0.85267888  0.85267888
unlike      1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
usually     1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
will        1.00000000  1.00000000  1.00000000  1.00000000  1.00000000
gear       -0.20677981 -0.20677981 -0.20677981 -0.20677981 -0.20677981
get         0.21325636  0.21325636  0.21325636  0.21325636  0.21325636
hike       -0.49269575 -0.49269575 -0.49269575 -0.49269575 -0.49269575
need        0.21325636  0.21325636  0.21325636  0.21325636  0.21325636
exercise   -0.03456356 -0.03456356 -0.03456356 -0.03456356 -0.03456356
take       -0.03240625 -0.03240625 -0.03240625 -0.03240625 -0.03240625
climb      -0.19983485 -0.19983485 -0.19983485 -0.19983485 -0.19983485
colorado   -0.19983485 -0.19983485 -0.19983485 -0.19983485 -0.19983485
iceland    -0.19983485 -0.19983485 -0.19983485 -0.19983485 -0.19983485
mountain   -0.40717572 -0.40717572 -0.40717572 -0.40717572 -0.40717572
switerland -0.19983485 -0.19983485 -0.19983485 -0.19983485 -0.19983485
                   lot        much        play    probably      rather
chocolate  -0.24294715 -0.49206491 -0.49206491 -0.49206491 -0.49206491
coffee     -0.22272859 -0.38407804 -0.38407804 -0.38407804 -0.38407804
day        -0.22014281 -0.02138343 -0.02138343 -0.02138343 -0.02138343
delicious  -0.18076437 -0.23688208 -0.23688208 -0.23688208 -0.23688208
eat        -0.33473981 -0.40001759 -0.40001759 -0.40001759 -0.40001759
great      -0.13374266 -0.05106328 -0.05106328 -0.05106328 -0.05106328
together   -0.22858155 -0.11657155 -0.11657155 -0.11657155 -0.11657155
healthy    -0.13718123 -0.01475857 -0.01475857 -0.01475857 -0.01475857
like       -0.40909273 -0.67115880 -0.67115880 -0.67115880 -0.67115880
almond     -0.18585902 -0.10751901 -0.10751901 -0.10751901 -0.10751901
also        0.09403699 -0.14368169 -0.14368169 -0.14368169 -0.14368169
cake       -0.28276170 -0.10156187 -0.10156187 -0.10156187 -0.10156187
dark       -0.23495710  0.24503377  0.24503377  0.24503377  0.24503377
every      -0.23495710  0.24503377  0.24503377  0.24503377  0.24503377
everything -0.23495710  0.24503377  0.24503377  0.24503377  0.24503377
good       -0.17390776 -0.54110537 -0.54110537 -0.54110537 -0.54110537
make       -0.23495710  0.24503377  0.24503377  0.24503377  0.24503377
yummy      -0.23495710  0.24503377  0.24503377  0.24503377  0.24503377
can         0.22375296 -0.15585508 -0.15585508 -0.15585508 -0.15585508
milk       -0.22585963  0.08433054  0.08433054  0.08433054  0.08433054
one        -0.22585963  0.08433054  0.08433054  0.08433054  0.08433054
soy        -0.22585963  0.08433054  0.08433054  0.08433054  0.08433054
danger     -0.27109060  0.14830198  0.14830198  0.14830198  0.14830198
dog         0.31005141 -0.15512965 -0.15512965 -0.15512965 -0.15512965
fall       -0.27109060  0.14830198  0.14830198  0.14830198  0.14830198
fun        -0.26412804 -0.42766080 -0.42766080 -0.42766080 -0.42766080
help       -0.27109060  0.14830198  0.14830198  0.14830198  0.14830198
jump        0.47669810  0.49972645  0.49972645  0.49972645  0.49972645
pick       -0.27109060  0.14830198  0.14830198  0.14830198  0.14830198
poop       -0.27109060  0.14830198  0.14830198  0.14830198  0.14830198
protect    -0.27109060  0.14830198  0.14830198  0.14830198  0.14830198
run         0.52872265  0.23892022  0.23892022  0.23892022  0.23892022
stinky     -0.27109060  0.14830198  0.14830198  0.14830198  0.14830198
thing      -0.27109060  0.14830198  0.14830198  0.14830198  0.14830198
time       -0.27109060  0.14830198  0.14830198  0.14830198  0.14830198
bed         0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
cat         1.00000000  0.72477442  0.72477442  0.72477442  0.72477442
couch       0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
different   0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
fairness    0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
feline      0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
hide        0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
home        0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
intruder    0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
just        0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
lot         1.00000000  0.72477442  0.72477442  0.72477442  0.72477442
much        0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
play        0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
probably    0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
rather      0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
since       0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
sit         0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
sleep       0.97795063  0.85267888  0.85267888  0.85267888  0.85267888
unlike      0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
usually     0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
will        0.72477442  1.00000000  1.00000000  1.00000000  1.00000000
gear       -0.18699283 -0.20677981 -0.20677981 -0.20677981 -0.20677981
get        -0.18368160  0.21325636  0.21325636  0.21325636  0.21325636
hike       -0.24299525 -0.49269575 -0.49269575 -0.49269575 -0.49269575
need       -0.18368160  0.21325636  0.21325636  0.21325636  0.21325636
exercise   -0.12316451 -0.03456356 -0.03456356 -0.03456356 -0.03456356
take       -0.18762187 -0.03240625 -0.03240625 -0.03240625 -0.03240625
climb      -0.27221222 -0.19983485 -0.19983485 -0.19983485 -0.19983485
colorado   -0.27221222 -0.19983485 -0.19983485 -0.19983485 -0.19983485
iceland    -0.27221222 -0.19983485 -0.19983485 -0.19983485 -0.19983485
mountain   -0.24270064 -0.40717572 -0.40717572 -0.40717572 -0.40717572
switerland -0.27221222 -0.19983485 -0.19983485 -0.19983485 -0.19983485
                 since         sit       sleep      unlike     usually
chocolate  -0.49206491 -0.49206491 -0.33336683 -0.49206491 -0.49206491
coffee     -0.38407804 -0.38407804 -0.28530424 -0.38407804 -0.38407804
day        -0.02138343 -0.02138343 -0.17340844 -0.02138343 -0.02138343
delicious  -0.23688208 -0.23688208 -0.20886812 -0.23688208 -0.23688208
eat        -0.40001759 -0.40001759 -0.37507002 -0.40001759 -0.40001759
great      -0.05106328 -0.05106328 -0.11689023 -0.05106328 -0.05106328
together   -0.11657155 -0.11657155 -0.20865939 -0.11657155 -0.11657155
healthy    -0.01475857 -0.01475857 -0.10849339 -0.01475857 -0.01475857
like       -0.67115880 -0.67115880 -0.51363403 -0.67115880 -0.67115880
almond     -0.10751901 -0.10751901 -0.17352044 -0.10751901 -0.10751901
also       -0.14368169 -0.14368169  0.02775427 -0.14368169 -0.14368169
cake       -0.10156187 -0.10156187 -0.24519287 -0.10156187 -0.10156187
dark        0.24503377  0.24503377 -0.10388883  0.24503377  0.24503377
every       0.24503377  0.24503377 -0.10388883  0.24503377  0.24503377
everything  0.24503377  0.24503377 -0.10388883  0.24503377  0.24503377
good       -0.54110537 -0.54110537 -0.29588104 -0.54110537 -0.54110537
make        0.24503377  0.24503377 -0.10388883  0.24503377  0.24503377
yummy       0.24503377  0.24503377 -0.10388883  0.24503377  0.24503377
can        -0.15585508 -0.15585508  0.12242375 -0.15585508 -0.15585508
milk        0.08433054  0.08433054 -0.14570072  0.08433054  0.08433054
one         0.08433054  0.08433054 -0.14570072  0.08433054  0.08433054
soy         0.08433054  0.08433054 -0.14570072  0.08433054  0.08433054
danger      0.14830198  0.14830198 -0.16060770  0.14830198  0.14830198
dog        -0.15512965 -0.15512965  0.18808087 -0.15512965 -0.15512965
fall        0.14830198  0.14830198 -0.16060770  0.14830198  0.14830198
fun        -0.42766080 -0.42766080 -0.32990629 -0.42766080 -0.42766080
help        0.14830198  0.14830198 -0.16060770  0.14830198  0.14830198
jump        0.49972645  0.49972645  0.51293467  0.49972645  0.49972645
pick        0.14830198  0.14830198 -0.16060770  0.14830198  0.14830198
poop        0.14830198  0.14830198 -0.16060770  0.14830198  0.14830198
protect     0.14830198  0.14830198 -0.16060770  0.14830198  0.14830198
run         0.23892022  0.23892022  0.47333110  0.23892022  0.23892022
stinky      0.14830198  0.14830198 -0.16060770  0.14830198  0.14830198
thing       0.14830198  0.14830198 -0.16060770  0.14830198  0.14830198
time        0.14830198  0.14830198 -0.16060770  0.14830198  0.14830198
bed         1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
cat         0.72477442  0.72477442  0.97795063  0.72477442  0.72477442
couch       1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
different   1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
fairness    1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
feline      1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
hide        1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
home        1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
intruder    1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
just        1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
lot         0.72477442  0.72477442  0.97795063  0.72477442  0.72477442
much        1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
play        1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
probably    1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
rather      1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
since       1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
sit         1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
sleep       0.85267888  0.85267888  1.00000000  0.85267888  0.85267888
unlike      1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
usually     1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
will        1.00000000  1.00000000  0.85267888  1.00000000  1.00000000
gear       -0.20677981 -0.20677981 -0.20446675 -0.20677981 -0.20677981
get         0.21325636  0.21325636 -0.07464027  0.21325636  0.21325636
hike       -0.49269575 -0.49269575 -0.33359451 -0.49269575 -0.49269575
need        0.21325636  0.21325636 -0.07464027  0.21325636  0.21325636
exercise   -0.03456356 -0.03456356 -0.10386800 -0.03456356 -0.03456356
take       -0.03240625 -0.03240625 -0.15208998 -0.03240625 -0.03240625
climb      -0.19983485 -0.19983485 -0.26698073 -0.19983485 -0.19983485
colorado   -0.19983485 -0.19983485 -0.26698073 -0.19983485 -0.19983485
iceland    -0.19983485 -0.19983485 -0.26698073 -0.19983485 -0.19983485
mountain   -0.40717572 -0.40717572 -0.30744944 -0.40717572 -0.40717572
switerland -0.19983485 -0.19983485 -0.26698073 -0.19983485 -0.19983485
                  will          gear          get         hike         need
chocolate  -0.49206491 -0.1546871701 -0.312614594 -0.114584244 -0.312614594
coffee     -0.38407804 -0.1397893016 -0.231497913 -0.130988756 -0.231497913
day        -0.02138343 -0.1273477511  0.065640558 -0.268091512  0.065640558
delicious  -0.23688208 -0.1111917339 -0.126373544 -0.135266305 -0.126373544
eat        -0.40001759 -0.2047381138 -0.202257802 -0.265439042 -0.202257802
great      -0.05106328 -0.0785169483  0.008584984 -0.148140264  0.008584984
together   -0.11657155 -0.1350792878 -0.009409136 -0.241851302 -0.009409136
healthy    -0.01475857 -0.0793996028  0.039725371 -0.166505561  0.039725371
like       -0.67115880 -0.2557199487 -0.397015349  0.048172317 -0.397015349
almond     -0.10751901 -0.1102171890 -0.018118049 -0.191720662 -0.018118049
also       -0.14368169 -0.2550440976 -0.309628313  0.101087666 -0.309628313
cake       -0.10156187 -0.1658090814  0.023408778 -0.315676936  0.023408778
dark        0.24503377 -0.1278282745  0.290221489 -0.389782546  0.290221489
every       0.24503377 -0.1278282745  0.290221489 -0.389782546  0.290221489
everything  0.24503377 -0.1278282745  0.290221489 -0.389782546  0.290221489
good       -0.54110537 -0.0003580768 -0.422674894  0.510325304 -0.422674894
make        0.24503377 -0.1278282745  0.290221489 -0.389782546  0.290221489
yummy       0.24503377 -0.1278282745  0.290221489 -0.389782546  0.290221489
can        -0.15585508  0.0057719642 -0.088452155 -0.001775932 -0.088452155
milk        0.08433054 -0.1274454904  0.154692919 -0.316175638  0.154692919
one         0.08433054 -0.1274454904  0.154692919 -0.316175638  0.154692919
soy         0.08433054 -0.1274454904  0.154692919 -0.316175638  0.154692919
danger      0.14830198 -0.1515459983  0.224371931 -0.397712851  0.224371931
dog        -0.15512965  0.4784075820 -0.109006042  0.437814927 -0.109006042
fall        0.14830198 -0.1515459983  0.224371931 -0.397712851  0.224371931
fun        -0.42766080 -0.1649327230 -0.251671161  0.233634647 -0.251671161
help        0.14830198 -0.1515459983  0.224371931 -0.397712851  0.224371931
jump        0.49972645 -0.2678707386 -0.054635088 -0.460253086 -0.054635088
pick        0.14830198 -0.1515459983  0.224371931 -0.397712851  0.224371931
poop        0.14830198 -0.1515459983  0.224371931 -0.397712851  0.224371931
protect     0.14830198 -0.1515459983  0.224371931 -0.397712851  0.224371931
run         0.23892022 -0.2277534871 -0.279433134 -0.265992844 -0.279433134
stinky      0.14830198 -0.1515459983  0.224371931 -0.397712851  0.224371931
thing       0.14830198 -0.1515459983  0.224371931 -0.397712851  0.224371931
time        0.14830198 -0.1515459983  0.224371931 -0.397712851  0.224371931
bed         1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
cat         0.72477442 -0.1869928254 -0.183681605 -0.242995246 -0.183681605
couch       1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
different   1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
fairness    1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
feline      1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
hide        1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
home        1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
intruder    1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
just        1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
lot         0.72477442 -0.1869928254 -0.183681605 -0.242995246 -0.183681605
much        1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
play        1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
probably    1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
rather      1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
since       1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
sit         1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
sleep       0.85267888 -0.2044667543 -0.074640267 -0.333594514 -0.074640267
unlike      1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
usually     1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
will        1.00000000 -0.2067798065  0.213256361 -0.492695749  0.213256361
gear       -0.20677981  1.0000000000  0.486773363  0.749509281  0.486773363
get         0.21325636  0.4867733633  1.000000000  0.204175182  1.000000000
hike       -0.49269575  0.7495092815  0.204175182  1.000000000  0.204175182
need        0.21325636  0.4867733633  1.000000000  0.204175182  1.000000000
exercise   -0.03456356 -0.0719304656  0.018148228  0.290682083  0.018148228
take       -0.03240625  0.3586616495  0.044287070  0.431540964  0.044287070
climb      -0.19983485 -0.1627052148 -0.061354284  0.148148313 -0.061354284
colorado   -0.19983485 -0.1627052148 -0.061354284  0.148148313 -0.061354284
iceland    -0.19983485 -0.1627052148 -0.061354284  0.148148313 -0.061354284
mountain   -0.40717572  0.2760413069 -0.242933318  0.479165698 -0.242933318
switerland -0.19983485 -0.1627052148 -0.061354284  0.148148313 -0.061354284
               exercise         take       climb    colorado     iceland
chocolate  -0.141103576 -0.222761533 -0.26422683 -0.26422683 -0.26422683
coffee     -0.115063065 -0.179860216 -0.22638372 -0.22638372 -0.22638372
day        -0.037322222 -0.047580298 -0.13903518 -0.13903518 -0.13903518
delicious  -0.077423808 -0.118777008 -0.16603358 -0.16603358 -0.16603358
eat        -0.135132124 -0.205908342 -0.29832295 -0.29832295 -0.29832295
great      -0.030794360 -0.042742728 -0.09347144 -0.09347144 -0.09347144
together   -0.058879930 -0.083700051 -0.16668232 -0.16668232 -0.16668232
healthy    -0.023562966 -0.030170491 -0.08697832 -0.08697832 -0.08697832
like       -0.204026674 -0.317893305  0.48029234  0.48029234  0.48029234
almond     -0.050591248 -0.072684500 -0.13854068 -0.13854068 -0.13854068
also       -0.182413064 -0.280751498  0.79250250  0.79250250  0.79250250
cake       -0.063741704 -0.088042699 -0.19610648 -0.19610648 -0.19610648
dark        0.017294969  0.046563493 -0.08504523 -0.08504523 -0.08504523
every       0.017294969  0.046563493 -0.08504523 -0.08504523 -0.08504523
everything  0.017294969  0.046563493 -0.08504523 -0.08504523 -0.08504523
good        0.302740799  0.094870801  0.12018208  0.12018208  0.12018208
make        0.017294969  0.046563493 -0.08504523 -0.08504523 -0.08504523
yummy       0.017294969  0.046563493 -0.08504523 -0.08504523 -0.08504523
can        -0.193576911 -0.303004178 -0.37832458 -0.37832458 -0.37832458
milk       -0.015626168 -0.010194975 -0.11751377 -0.11751377 -0.11751377
one        -0.015626168 -0.010194975 -0.11751377 -0.11751377 -0.11751377
soy        -0.015626168 -0.010194975 -0.11751377 -0.11751377 -0.11751377
danger     -0.008713496  0.004874612 -0.12991237 -0.12991237 -0.12991237
dog        -0.198459432 -0.046521893 -0.36973723 -0.36973723 -0.36973723
fall       -0.008713496  0.004874612 -0.12991237 -0.12991237 -0.12991237
fun        -0.130519503 -0.203185660  0.91334221  0.91334221  0.91334221
help       -0.008713496  0.004874612 -0.12991237 -0.12991237 -0.12991237
jump       -0.125544120 -0.181109046 -0.33928401 -0.33928401 -0.33928401
pick       -0.008713496  0.004874612 -0.12991237 -0.12991237 -0.12991237
poop       -0.008713496  0.004874612 -0.12991237 -0.12991237 -0.12991237
protect    -0.008713496  0.004874612 -0.12991237 -0.12991237 -0.12991237
run        -0.163610916 -0.251944635 -0.34508756 -0.34508756 -0.34508756
stinky     -0.008713496  0.004874612 -0.12991237 -0.12991237 -0.12991237
thing      -0.008713496  0.004874612 -0.12991237 -0.12991237 -0.12991237
time       -0.008713496  0.004874612 -0.12991237 -0.12991237 -0.12991237
bed        -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
cat        -0.123164510 -0.187621873 -0.27221222 -0.27221222 -0.27221222
couch      -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
different  -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
fairness   -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
feline     -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
hide       -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
home       -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
intruder   -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
just       -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
lot        -0.123164510 -0.187621873 -0.27221222 -0.27221222 -0.27221222
much       -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
play       -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
probably   -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
rather     -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
since      -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
sit        -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
sleep      -0.103867996 -0.152089981 -0.26698073 -0.26698073 -0.26698073
unlike     -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
usually    -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
will       -0.034563558 -0.032406255 -0.19983485 -0.19983485 -0.19983485
gear       -0.071930466  0.358661650 -0.16270521 -0.16270521 -0.16270521
get         0.018148228  0.044287070 -0.06135428 -0.06135428 -0.06135428
hike        0.290682083  0.431540964  0.14814831  0.14814831  0.14814831
need        0.018148228  0.044287070 -0.06135428 -0.06135428 -0.06135428
exercise    1.000000000  0.784370962 -0.08313154 -0.08313154 -0.08313154
take        0.784370962  1.000000000 -0.12184988 -0.12184988 -0.12184988
climb      -0.083131539 -0.121849876  1.00000000  1.00000000  1.00000000
colorado   -0.083131539 -0.121849876  1.00000000  1.00000000  1.00000000
iceland    -0.083131539 -0.121849876  1.00000000  1.00000000  1.00000000
mountain   -0.122961600  0.166410260  0.76424783  0.76424783  0.76424783
switerland -0.083131539 -0.121849876  1.00000000  1.00000000  1.00000000
              mountain  switerland
chocolate  -0.14721446 -0.26422683
coffee     -0.15003946 -0.22638372
day        -0.22886501 -0.13903518
delicious  -0.13860033 -0.16603358
eat        -0.26535078 -0.29832295
great      -0.13047915 -0.09347144
together   -0.21641457 -0.16668232
healthy    -0.14229403 -0.08697832
like        0.45484949  0.48029234
almond     -0.17310198 -0.13854068
also        0.66800822  0.79250250
cake       -0.27730066 -0.19610648
dark       -0.30450729 -0.08504523
every      -0.30450729 -0.08504523
everything -0.30450729 -0.08504523
good        0.20236821  0.12018208
make       -0.30450729 -0.08504523
yummy      -0.30450729 -0.08504523
can        -0.24546170 -0.37832458
milk       -0.25870837 -0.11751377
one        -0.25870837 -0.11751377
soy        -0.25870837 -0.11751377
danger     -0.32110674 -0.12991237
dog         0.04262269 -0.36973723
fall       -0.32110674 -0.12991237
fun         0.79273014  0.91334221
help       -0.32110674 -0.12991237
jump       -0.41717153 -0.33928401
pick       -0.32110674 -0.12991237
poop       -0.32110674 -0.12991237
protect    -0.32110674 -0.12991237
run        -0.27703336 -0.34508756
stinky     -0.32110674 -0.12991237
thing      -0.32110674 -0.12991237
time       -0.32110674 -0.12991237
bed        -0.40717572 -0.19983485
cat        -0.24270064 -0.27221222
couch      -0.40717572 -0.19983485
different  -0.40717572 -0.19983485
fairness   -0.40717572 -0.19983485
feline     -0.40717572 -0.19983485
hide       -0.40717572 -0.19983485
home       -0.40717572 -0.19983485
intruder   -0.40717572 -0.19983485
just       -0.40717572 -0.19983485
lot        -0.24270064 -0.27221222
much       -0.40717572 -0.19983485
play       -0.40717572 -0.19983485
probably   -0.40717572 -0.19983485
rather     -0.40717572 -0.19983485
since      -0.40717572 -0.19983485
sit        -0.40717572 -0.19983485
sleep      -0.30744944 -0.26698073
unlike     -0.40717572 -0.19983485
usually    -0.40717572 -0.19983485
will       -0.40717572 -0.19983485
gear        0.27604131 -0.16270521
get        -0.24293332 -0.06135428
hike        0.47916570  0.14814831
need       -0.24293332 -0.06135428
exercise   -0.12296160 -0.08313154
take        0.16641026 -0.12184988
climb       0.76424783  1.00000000
colorado    0.76424783  1.00000000
iceland     0.76424783  1.00000000
mountain    1.00000000  0.76424783
switerland  0.76424783  1.00000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>dist_C_smallCorp<span class="ot">&lt;-</span> <span class="fu">as.dist</span>(dist_C_smallCorp)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>HClust_Ward_CosSim_SmallCorp <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_C_smallCorp, <span class="at">method=</span><span class="st">"ward.D"</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(HClust_Ward_CosSim_SmallCorp, <span class="at">cex=</span>.<span class="dv">7</span>, <span class="at">hang=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">main =</span> <span class="st">"Cosine Sim"</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(HClust_Ward_CosSim_SmallCorp, <span class="at">k=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="or-create-your-own-cosine-sim-distance-metric-function" class="level3">
<h3 class="anchored" data-anchor-id="or-create-your-own-cosine-sim-distance-metric-function"><strong>OR</strong> ### Create your own Cosine Sim Distance Metric function</h3>
<p>This one works much better………..</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>(My_m <span class="ot">&lt;-</span> (<span class="fu">as.matrix</span>(<span class="fu">scale</span>(<span class="fu">t</span>(SmallCorpus_DF_DT)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Choc1.txt Choc2.txt  Choc3.txt  Choc4.txt  Choc5.txt   Dog1.txt
chocolate   6.0333929  4.230088  5.5194737  4.4938136  3.3315811 -0.4706995
coffee      1.8444051  4.230088  1.6673410 -0.3820651  5.1917138 -0.4706995
day         1.8444051 -0.268577 -0.2587253  0.8369046 -0.3886845 -0.4706995
delicious   3.9388990  1.980755  3.5934073 -0.3820651 -0.3886845 -0.4706995
eat         1.8444051 -0.268577 -0.2587253  0.8369046  1.4714483  0.9004686
great      -0.2500888  4.230088 -0.2587253 -0.3820651 -0.3886845 -0.4706995
together   -0.2500888  1.980755 -0.2587253 -0.3820651  1.4714483 -0.4706995
healthy    -0.2500888 -0.268577  3.5934073 -0.3820651 -0.3886845 -0.4706995
like       -0.2500888 -0.268577  1.6673410  0.8369046  1.4714483  0.9004686
almond     -0.2500888 -0.268577 -0.2587253  3.2748439 -0.3886845 -0.4706995
also       -0.2500888 -0.268577 -0.2587253  0.8369046 -0.3886845 -0.4706995
cake       -0.2500888 -0.268577 -0.2587253  0.8369046  1.4714483 -0.4706995
dark       -0.2500888 -0.268577 -0.2587253  0.8369046 -0.3886845 -0.4706995
every      -0.2500888 -0.268577 -0.2587253  0.8369046 -0.3886845 -0.4706995
everything -0.2500888 -0.268577 -0.2587253  0.8369046 -0.3886845 -0.4706995
good       -0.2500888 -0.268577 -0.2587253  4.4938136  1.4714483  0.9004686
make       -0.2500888 -0.268577 -0.2587253  0.8369046 -0.3886845 -0.4706995
yummy      -0.2500888 -0.268577 -0.2587253  0.8369046 -0.3886845 -0.4706995
can        -0.2500888 -0.268577 -0.2587253 -0.3820651  1.4714483  3.6428049
milk       -0.2500888 -0.268577 -0.2587253 -0.3820651  1.4714483 -0.4706995
one        -0.2500888 -0.268577 -0.2587253 -0.3820651  1.4714483 -0.4706995
soy        -0.2500888 -0.268577 -0.2587253 -0.3820651  1.4714483 -0.4706995
danger     -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  0.9004686
dog        -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  5.0139730
fall       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  0.9004686
fun        -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  0.9004686
help       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  0.9004686
jump       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  0.9004686
pick       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  0.9004686
poop       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  0.9004686
protect    -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  0.9004686
run        -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  2.2716368
stinky     -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  0.9004686
thing      -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  0.9004686
time       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845  0.9004686
bed        -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
cat        -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
couch      -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
different  -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
fairness   -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
feline     -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
hide       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
home       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
intruder   -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
just       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
lot        -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
much       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
play       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
probably   -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
rather     -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
since      -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
sit        -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
sleep      -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
unlike     -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
usually    -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
will       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
gear       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
get        -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
hike       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
need       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
exercise   -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
take       -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
climb      -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
colorado   -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
iceland    -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
mountain   -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
switerland -0.2500888 -0.268577 -0.2587253 -0.3820651 -0.3886845 -0.4706995
             Dog2.txt Hike_dog.txt Hike_dog2.txt  Hike1.txt  Hike2.txt
chocolate  -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
coffee     -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
day        -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
delicious  -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
eat        -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
great      -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
together   -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
healthy    -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
like       -0.6574443   -0.2657303    -0.2271004 -0.2423241  1.7919392
almond     -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
also        0.5330630   -0.2657303    -0.2271004 -0.2423241  1.7919392
cake       -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
dark       -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
every      -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
everything -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
good        0.5330630   -0.2657303     5.8591901  4.3964524  1.7919392
make       -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
yummy      -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
can         1.7235703    1.3528087    -0.2271004 -0.2423241 -0.3909686
milk       -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
one        -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
soy        -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
danger     -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
dog         4.1045850    2.9713476     2.8160449 -0.2423241 -0.3909686
fall       -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
fun        -0.6574443   -0.2657303    -0.2271004 -0.2423241  3.9748469
help       -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
jump        0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
pick       -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
poop       -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
protect    -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
run         1.7235703   -0.2657303    -0.2271004 -0.2423241 -0.3909686
stinky     -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
thing      -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
time       -0.6574443   -0.2657303    -0.2271004 -0.2423241 -0.3909686
bed         0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
cat         2.9140776   -0.2657303    -0.2271004 -0.2423241 -0.3909686
couch       0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
different   0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
fairness    0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
feline      0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
hide        0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
home        0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
intruder    0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
just        0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
lot         2.9140776   -0.2657303    -0.2271004 -0.2423241 -0.3909686
much        0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
play        0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
probably    0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
rather      0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
since       0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
sit         0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
sleep       1.7235703   -0.2657303    -0.2271004 -0.2423241 -0.3909686
unlike      0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
usually     0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
will        0.5330630   -0.2657303    -0.2271004 -0.2423241 -0.3909686
gear       -0.6574443    2.9713476     1.2944722 -0.2423241 -0.3909686
get        -0.6574443    1.3528087    -0.2271004 -0.2423241 -0.3909686
hike       -0.6574443    6.2084254     4.3376175  4.3964524  1.7919392
need       -0.6574443    1.3528087    -0.2271004 -0.2423241 -0.3909686
exercise   -0.6574443   -0.2657303    -0.2271004  4.3964524 -0.3909686
take       -0.6574443   -0.2657303    -0.2271004  2.0770641 -0.3909686
climb      -0.6574443   -0.2657303    -0.2271004 -0.2423241  1.7919392
colorado   -0.6574443   -0.2657303    -0.2271004 -0.2423241  1.7919392
iceland    -0.6574443   -0.2657303    -0.2271004 -0.2423241  1.7919392
mountain   -0.6574443   -0.2657303    -0.2271004 -0.2423241  3.9748469
switerland -0.6574443   -0.2657303    -0.2271004 -0.2423241  1.7919392
            Hike3.txt  Hike4.txt
chocolate  -0.3886845 -0.2677572
coffee     -0.3886845 -0.2677572
day        -0.3886845 -0.2677572
delicious  -0.3886845 -0.2677572
eat        -0.3886845 -0.2677572
great      -0.3886845 -0.2677572
together   -0.3886845 -0.2677572
healthy    -0.3886845 -0.2677572
like        1.4714483 -0.2677572
almond     -0.3886845 -0.2677572
also        1.4714483 -0.2677572
cake       -0.3886845 -0.2677572
dark       -0.3886845 -0.2677572
every      -0.3886845 -0.2677572
everything -0.3886845 -0.2677572
good        3.3315811 -0.2677572
make       -0.3886845 -0.2677572
yummy      -0.3886845 -0.2677572
can        -0.3886845 -0.2677572
milk       -0.3886845 -0.2677572
one        -0.3886845 -0.2677572
soy        -0.3886845 -0.2677572
danger     -0.3886845 -0.2677572
dog        -0.3886845  3.3201896
fall       -0.3886845 -0.2677572
fun         3.3315811 -0.2677572
help       -0.3886845 -0.2677572
jump       -0.3886845 -0.2677572
pick       -0.3886845 -0.2677572
poop       -0.3886845 -0.2677572
protect    -0.3886845 -0.2677572
run        -0.3886845 -0.2677572
stinky     -0.3886845 -0.2677572
thing      -0.3886845 -0.2677572
time       -0.3886845 -0.2677572
bed        -0.3886845 -0.2677572
cat        -0.3886845 -0.2677572
couch      -0.3886845 -0.2677572
different  -0.3886845 -0.2677572
fairness   -0.3886845 -0.2677572
feline     -0.3886845 -0.2677572
hide       -0.3886845 -0.2677572
home       -0.3886845 -0.2677572
intruder   -0.3886845 -0.2677572
just       -0.3886845 -0.2677572
lot        -0.3886845 -0.2677572
much       -0.3886845 -0.2677572
play       -0.3886845 -0.2677572
probably   -0.3886845 -0.2677572
rather     -0.3886845 -0.2677572
since      -0.3886845 -0.2677572
sit        -0.3886845 -0.2677572
sleep      -0.3886845 -0.2677572
unlike     -0.3886845 -0.2677572
usually    -0.3886845 -0.2677572
will       -0.3886845 -0.2677572
gear       -0.3886845  3.3201896
get        -0.3886845 -0.2677572
hike        3.3315811  5.1141630
need       -0.3886845 -0.2677572
exercise   -0.3886845 -0.2677572
take       -0.3886845  1.5262162
climb       1.4714483 -0.2677572
colorado    1.4714483 -0.2677572
iceland     1.4714483 -0.2677572
mountain    3.3315811  3.3201896
switerland  1.4714483 -0.2677572
attr(,"scaled:center")
    Choc1.txt     Choc2.txt     Choc3.txt     Choc4.txt     Choc5.txt 
    0.1194030     0.1194030     0.1343284     0.3134328     0.2089552 
     Dog1.txt      Dog2.txt  Hike_dog.txt Hike_dog2.txt     Hike1.txt 
    0.3432836     0.5522388     0.1641791     0.1492537     0.1044776 
    Hike2.txt     Hike3.txt     Hike4.txt 
    0.1791045     0.2089552     0.1492537 
attr(,"scaled:scale")
    Choc1.txt     Choc2.txt     Choc3.txt     Choc4.txt     Choc5.txt 
    0.4774423     0.4445763     0.5191929     0.8203649     0.5375960 
     Dog1.txt      Dog2.txt  Hike_dog.txt Hike_dog2.txt     Hike1.txt 
    0.7293052     0.8399780     0.6178412     0.6572148     0.4311482 
    Hike2.txt     Hike3.txt     Hike4.txt 
    0.4581046     0.5375960     0.5574219 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">My_cosine_dist =</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">crossprod</span>(My_m) <span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="fu">colSums</span>(My_m<span class="sc">^</span><span class="dv">2</span>)<span class="sc">%*%</span><span class="fu">t</span>(<span class="fu">colSums</span>(My_m<span class="sc">^</span><span class="dv">2</span>)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Choc1.txt    Choc2.txt     Choc3.txt    Choc4.txt    Choc5.txt
Choc1.txt     3.219647e-15 3.543656e-01  2.099592e-01 5.554261e-01 5.083699e-01
Choc2.txt     3.543656e-01 2.553513e-15  4.141218e-01 7.718210e-01 4.086306e-01
Choc3.txt     2.099592e-01 4.141218e-01 -4.440892e-16 6.378990e-01 5.592469e-01
Choc4.txt     5.554261e-01 7.718210e-01  6.378990e-01 1.776357e-15 6.354243e-01
Choc5.txt     5.083699e-01 4.086306e-01  5.592469e-01 6.354243e-01 2.775558e-15
Dog1.txt      1.075987e+00 1.128335e+00  1.083613e+00 1.030616e+00 9.538570e-01
Dog2.txt      1.166911e+00 1.179250e+00  1.172675e+00 1.145054e+00 1.158751e+00
Hike_dog.txt  1.067463e+00 1.072450e+00  1.069793e+00 1.103065e+00 1.059234e+00
Hike_dog2.txt 1.057656e+00 1.061918e+00  1.059647e+00 6.384452e-01 9.180728e-01
Hike1.txt     1.061521e+00 1.066069e+00  1.063645e+00 7.512877e-01 9.648762e-01
Hike2.txt     1.099258e+00 1.106596e+00  1.038983e+00 9.097389e-01 1.031220e+00
Hike3.txt     1.098678e+00 1.105973e+00  1.047802e+00 8.072005e-01 9.960876e-01
Hike4.txt     1.067978e+00 1.073003e+00  1.070325e+00 1.103851e+00 1.105650e+00
               Dog1.txt  Dog2.txt  Hike_dog.txt Hike_dog2.txt    Hike1.txt
Choc1.txt     1.0759866 1.1669107  1.067463e+00  1.057656e+00 1.061521e+00
Choc2.txt     1.1283345 1.1792498  1.072450e+00  1.061918e+00 1.066069e+00
Choc3.txt     1.0836125 1.1726747  1.069793e+00  1.059647e+00 1.063645e+00
Choc4.txt     1.0306161 1.1450536  1.103065e+00  6.384452e-01 7.512877e-01
Choc5.txt     0.9538570 1.1587510  1.059234e+00  9.180728e-01 9.648762e-01
Dog1.txt      0.0000000 0.6216202  7.570927e-01  7.291826e-01 1.019418e+00
Dog2.txt      0.6216202 0.0000000  8.853980e-01  8.222147e-01 1.078054e+00
Hike_dog.txt  0.7570927 0.8853980 -2.220446e-16  3.896097e-01 6.103358e-01
Hike_dog2.txt 0.7291826 0.8222147  3.896097e-01  4.440892e-16 3.072650e-01
Hike1.txt     1.0194182 1.0780543  6.103358e-01  3.072650e-01 1.110223e-15
Hike2.txt     1.0054150 1.1821841  8.913377e-01  7.378591e-01 7.893275e-01
Hike3.txt     0.9925018 1.1587510  7.399172e-01  4.892354e-01 5.726608e-01
Hike4.txt     0.8297805 0.9198253  1.923457e-01  4.413516e-01 6.245573e-01
                 Hike2.txt    Hike3.txt Hike4.txt
Choc1.txt     1.099258e+00 1.098678e+00 1.0679777
Choc2.txt     1.106596e+00 1.105973e+00 1.0730030
Choc3.txt     1.038983e+00 1.047802e+00 1.0703252
Choc4.txt     9.097389e-01 8.072005e-01 1.1038507
Choc5.txt     1.031220e+00 9.960876e-01 1.1056499
Dog1.txt      1.005415e+00 9.925018e-01 0.8297805
Dog2.txt      1.182184e+00 1.158751e+00 0.9198253
Hike_dog.txt  8.913377e-01 7.399172e-01 0.1923457
Hike_dog2.txt 7.378591e-01 4.892354e-01 0.4413516
Hike1.txt     7.893275e-01 5.726608e-01 0.6245573
Hike2.txt     2.220446e-16 4.685727e-02 0.6909291
Hike3.txt     4.685727e-02 8.881784e-16 0.6000395
Hike4.txt     6.909291e-01 6.000395e-01 0.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dist object</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>My_cosine_dist <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(My_cosine_dist) <span class="do">## Important</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>HClust_Ward_CosSim_SmallCorp2 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(My_cosine_dist, <span class="at">method=</span><span class="st">"ward.D"</span>)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(HClust_Ward_CosSim_SmallCorp2, <span class="at">cex=</span>.<span class="dv">7</span>, <span class="at">hang=</span><span class="sc">-</span><span class="dv">30</span>,<span class="at">main =</span> <span class="st">"Cosine Sim"</span>)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(HClust_Ward_CosSim_SmallCorp2, <span class="at">k=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>SOOO much more you can do…. #[http://www.sthda.com/english/wiki/factoextra-r-package-easy-multivariate-data-analyses-and-elegant-visualization]</p>
</section>
</section>
</section>
<section id="finally---lets-try-this-on-novels" class="level1">
<h1>FINALLY!! - let’s try this on Novels</h1>
<section id="can-we-cluster-authors-based-on-their-writing" class="level2">
<h2 class="anchored" data-anchor-id="can-we-cluster-authors-based-on-their-writing">Can we cluster authors based on their writing?</h2>
<p>Novels Corpus: [https://drive.google.com/drive/folders/1xhsk_Dwq4sZ_1q2CtVdSIJWHEZqzMwhG?usp=sharing]</p>
<p>Next, load in the documents ( from the corpus)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>NovelCorpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">DirSource</span>(<span class="st">"Novels_Corpus"</span>))</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>(<span class="fu">getTransformations</span>()) <span class="do">## These work with library tm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "removeNumbers"     "removePunctuation" "removeWords"      
[4] "stemDocument"      "stripWhitespace"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>(ndocs<span class="ot">&lt;-</span><span class="fu">length</span>(NovelCorpus))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Do some clean-up.............</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>NovelCorpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(NovelCorpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>NovelCorpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(NovelCorpus, removePunctuation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="convert-to-document-term-matrix-and-term-document-matrix" class="level2">
<h2 class="anchored" data-anchor-id="convert-to-document-term-matrix-and-term-document-matrix">Convert to Document Term Matrix and TERM document matrix</h2>
<p>Each has its own purpose.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="do">## DOCUMENT Term Matrix  (Docs are rows)</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>NovelsCorpus_DTM <span class="ot">&lt;-</span> <span class="fu">DocumentTermMatrix</span>(NovelCorpus,</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">stopwords =</span> <span class="cn">TRUE</span>, <span class="do">## remove normal stopwords</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">wordLengths=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">10</span>), </span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">removePunctuation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">removeNumbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">tolower=</span><span class="cn">TRUE</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>                                         <span class="co">#stemming = TRUE,</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>                                       ))</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(NovelsCorpus_DTM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;DocumentTermMatrix (documents: 13, terms: 40629)&gt;&gt;
Non-/sparse entries: 133454/394723
Sparsity           : 75%
Maximal term length: 10
Weighting          : term frequency (tf)
Sample             :
                       Terms
Docs                    know like little much must never said think well will
  Austen_Emma.txt        319  193    361  473  566   344  474   383  350  555
  Austen_Pride.txt       237   77    189  327  308   220  401   211  212  407
  CBronte_Jane.txt       228  365    342  206  310   294  583   220  325  614
  CBronte_Villette.txt   310  378    511  241  282   275  581   243  333  414
  Dickens_Bleak.txt      881  599   1148  615  362   670 1737   499  576  797
  Dickens_David.txt      793  617   1096  654  357   662 2950   592  556  525
  EBronte_Wuthering.txt  123  154    178   97  187   181  375   113  145  241
  Eliot_Adam.txt         448  638    435  297  396   370 1210   391  414  329
  Eliot_Middlemarch.txt  673  661    622  532  565   541 2282   540  463 1249
  Eliot_Mill.txt         395  538    402  307  371   376 1643   336  390  353</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Create a DF as well................</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>Novels_DF_DT <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.matrix</span>(NovelsCorpus_DTM))</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a Novels Matrix</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>My_novels_m <span class="ot">&lt;-</span> (<span class="fu">as.matrix</span>(Novels_DF_DT))</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(My_novels_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="do">## WORD CLOUD</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="co">#word.freq &lt;- sort(rowSums(t(My_novels_m)), decreasing = T)</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co">#wordcloud(words = names(word.freq), freq = word.freq*2, min.freq = 2,</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  random.order = F)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cosine-sim" class="level2">
<h2 class="anchored" data-anchor-id="cosine-sim">COsine Sim</h2>
<p><span class="math display">\[\frac{a * b }{(|a| * |b|)}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>CosineSim <span class="ot">&lt;-</span> My_novels_m <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">rowSums</span>(My_novels_m <span class="sc">*</span> My_novels_m))</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>CosineSim <span class="ot">&lt;-</span> CosineSim <span class="sc">%*%</span> <span class="fu">t</span>(CosineSim)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert to distance metric</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>D_Cos_Sim <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span><span class="sc">-</span>CosineSim)</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>HClust_Ward_CosSim_SmallCorp2 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(D_Cos_Sim, <span class="at">method=</span><span class="st">"ward.D2"</span>)</span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(HClust_Ward_CosSim_SmallCorp2, <span class="at">cex=</span>.<span class="dv">7</span>, <span class="at">hang=</span><span class="sc">-</span><span class="dv">11</span>,<span class="at">main =</span> <span class="st">"Cosine Sim"</span>)</span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(HClust_Ward_CosSim_SmallCorp2, <span class="at">k=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="clust-ex1-mkdn_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<pre><code>This tutorial will not cover csv text files
But, the following will offer syntax and hints in case you have text data in a csv file rather than in a corpus</code></pre>
<p>In R, there is a PROCESS required to convert a csv file into a DTM…</p>
<p>HERE, “Open” is the name of a dataframe that contains</p>
<p>open student feedback comments - which is why is it called Open.</p>
<p>However - the name does not matter. “Open” is a dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(Open)</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="co"># str(Open)</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ## --CONVERT TO TEXT (not factor)</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Open$V1&lt;-as.character(Open$V1)  ##V1 stands for variable 1</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="do">## --Again- this is example syntax that must be UPDATED for a different</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="do">## --dataset.....</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="co"># str(Open)</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Next - and this is crazy hard to find - </span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ## In R, when using tm on a csv file</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ## The csv MUST have two columns and the following names:  doc_id   and text</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ## DO NOT ALTER THESE NAMES!! To add them...use this........</span></span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ## colnames(x) &lt;- c("doc_id", "text") </span></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ## 1) Create a column with the row numbers</span></span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a><span class="co"># id &lt;- rownames(Open)</span></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Open &lt;- cbind(doc_id=id, Open)</span></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ## 2) Make sure the DF has the EXACT column names of doc_id and text....</span></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(Open) &lt;- c("doc_id", "text") </span></span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Check it</span></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a><span class="co"># head(Open)</span></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">###</span><span class="co"> CONVERT csv to corpus............................</span></span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a><span class="co"># OpenCorp &lt;- Corpus(DataframeSource(Open))</span></span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a><span class="co"># OpenCorp &lt;- tm_map(OpenCorp, tolower)  </span><span class="al">###</span><span class="co"> DO THIS FIRST before removing specific words!</span></span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a><span class="co"># OpenCorp &lt;- tm_map(OpenCorp, removeWords, c("also", "that", "this", "with", "anly", "have",</span></span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                                             "class", "classes", "data"))</span></span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a><span class="co"># OpenCorp &lt;- tm_map(OpenCorp, removeWords, stopwords("english"))</span></span>
<span id="cb162-30"><a href="#cb162-30" aria-hidden="true" tabindex="-1"></a><span class="co"># ##OpenCorp &lt;-tm_map(OpenCorp, stemDocument)</span></span>
<span id="cb162-31"><a href="#cb162-31" aria-hidden="true" tabindex="-1"></a><span class="co"># OpenCorp &lt;- tm_map(OpenCorp, lemmatize_strings)</span></span>
<span id="cb162-32"><a href="#cb162-32" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb162-33"><a href="#cb162-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Open_dtm &lt;- DocumentTermMatrix(OpenCorp,</span></span>
<span id="cb162-34"><a href="#cb162-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                                control = list(</span></span>
<span id="cb162-35"><a href="#cb162-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  #stopwords = TRUE, </span></span>
<span id="cb162-36"><a href="#cb162-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  wordLengths=c(4, 10),</span></span>
<span id="cb162-37"><a href="#cb162-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  removePunctuation = TRUE,</span></span>
<span id="cb162-38"><a href="#cb162-38" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  removeNumbers = TRUE,</span></span>
<span id="cb162-39"><a href="#cb162-39" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  tolower=TRUE,</span></span>
<span id="cb162-40"><a href="#cb162-40" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  remove_separators = TRUE</span></span>
<span id="cb162-41"><a href="#cb162-41" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  </span></span>
<span id="cb162-42"><a href="#cb162-42" aria-hidden="true" tabindex="-1"></a><span class="co">#                                )</span></span>
<span id="cb162-43"><a href="#cb162-43" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb162-44"><a href="#cb162-44" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb162-45"><a href="#cb162-45" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect(Open_dtm)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>